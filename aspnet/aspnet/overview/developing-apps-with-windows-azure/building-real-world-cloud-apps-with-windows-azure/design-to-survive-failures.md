---
uid: aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/design-to-survive-failures
title: "障害 (Azure と実際のクラウド アプリのビルド) にも対処デザイン |Microsoft ドキュメント"
author: MikeWasson
description: "Azure の電子書籍と構築実世界クラウド アプリは、Scott Guthrie が開発したプレゼンテーションに基づいています。 13 のパターンと彼をできるベスト プラクティスについて説明しています."
ms.author: aspnetcontent
manager: wpickett
ms.date: 06/12/2014
ms.topic: article
ms.assetid: 364ce84e-5af8-4e08-afc9-75a512b01f84
ms.technology: 
ms.prod: .net-framework
msc.legacyurl: /aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/design-to-survive-failures
msc.type: authoredcontent
ms.openlocfilehash: a0ee790da07c99cdb1279a6bca637a4ce8076e84
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/10/2017
---
<a name="design-to-survive-failures-building-real-world-cloud-apps-with-azure"></a><span data-ttu-id="2a760-104">障害 (Azure と実際のクラウド アプリのビルド) にも対処デザインします。</span><span class="sxs-lookup"><span data-stu-id="2a760-104">Design to Survive Failures (Building Real-World Cloud Apps with Azure)</span></span>
====================
<span data-ttu-id="2a760-105">によって[Mike Wasson](https://github.com/MikeWasson)、 [Rick Anderson](https://github.com/Rick-Anderson)、 [Tom Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="2a760-105">by [Mike Wasson](https://github.com/MikeWasson), [Rick Anderson](https://github.com/Rick-Anderson), [Tom Dykstra](https://github.com/tdykstra)</span></span>

<span data-ttu-id="2a760-106">[ダウンロード修正プロジェクト](http://code.msdn.microsoft.com/Fix-It-app-for-Building-cdd80df4)または[電子書籍をダウンロード](http://blogs.msdn.com/b/microsoft_press/archive/2014/07/23/free-ebook-building-cloud-apps-with-microsoft-azure.aspx)</span><span class="sxs-lookup"><span data-stu-id="2a760-106">[Download Fix It Project](http://code.msdn.microsoft.com/Fix-It-app-for-Building-cdd80df4) or [Download E-book](http://blogs.msdn.com/b/microsoft_press/archive/2014/07/23/free-ebook-building-cloud-apps-with-microsoft-azure.aspx)</span></span>

> <span data-ttu-id="2a760-107">**現実世界クラウド アプリのビルドと Azure**電子書籍は Scott Guthrie が開発したプレゼンテーションに基づいています。</span><span class="sxs-lookup"><span data-stu-id="2a760-107">The **Building Real World Cloud Apps with Azure** e-book is based on a presentation developed by Scott Guthrie.</span></span> <span data-ttu-id="2a760-108">13 パターンについて説明します、プラクティスするのに役立つ、クラウドの web アプリの開発が成功します。</span><span class="sxs-lookup"><span data-stu-id="2a760-108">It explains 13 patterns and practices that can help you be successful developing web apps for the cloud.</span></span> <span data-ttu-id="2a760-109">電子書籍の詳細については、次を参照してください。[第 1 章](introduction.md)です。</span><span class="sxs-lookup"><span data-stu-id="2a760-109">For information about the e-book, see [the first chapter](introduction.md).</span></span>


<span data-ttu-id="2a760-110">正常にエラーを処理して価値を提供する続行できるように、アプリを設計する方法はのいずれかのアプリケーションでは、特に、多くの人を使用する、クラウドで実行される任意の型を作成する場合について検討する必要がある限り考えられる。</span><span class="sxs-lookup"><span data-stu-id="2a760-110">One of the things you have to think about when you build any type of application, but especially one that will run in the cloud where lots of people will be using it, is how to design the app so that it can gracefully handle failures and continue to deliver value as much as possible.</span></span> <span data-ttu-id="2a760-111">十分な時間を指定するには、進捗状況を任意の環境またはソフトウェアの任意のシステムで問題が発生します。</span><span class="sxs-lookup"><span data-stu-id="2a760-111">Given enough time, things are going to go wrong in any environment or any software system.</span></span> <span data-ttu-id="2a760-112">アプリがそのような状況を処理する方法を調べ、お客様の取得方法不安を感じている時間の分析と問題の解決にかかります。</span><span class="sxs-lookup"><span data-stu-id="2a760-112">How your app handles those situations determines how upset your customers will get and how much time you have to spend analyzing and fixing problems.</span></span>

## <a name="types-of-failures"></a><span data-ttu-id="2a760-113">失敗の種類</span><span class="sxs-lookup"><span data-stu-id="2a760-113">Types of failures</span></span>

<span data-ttu-id="2a760-114">異なる方法で処理する必要ありますエラーの 2 つの基本的なカテゴリがあります。</span><span class="sxs-lookup"><span data-stu-id="2a760-114">There are two basic categories of failures that you'll want to handle differently:</span></span>

- <span data-ttu-id="2a760-115">一時的なもの、断続的なネットワーク接続の問題などのエラーを自己修復します。</span><span class="sxs-lookup"><span data-stu-id="2a760-115">Transient, self-healing failures such as intermittent network connectivity issues.</span></span>
- <span data-ttu-id="2a760-116">操作が必要な障害を支えます。</span><span class="sxs-lookup"><span data-stu-id="2a760-116">Enduring failures that require intervention.</span></span>

<span data-ttu-id="2a760-117">一時的な障害は、迅速かつ自動的に、アプリが復旧時間の大部分を確保するための再試行ポリシーを実装することができます。</span><span class="sxs-lookup"><span data-stu-id="2a760-117">For transient failures, you can implement a retry policy to ensure that most of the time the app recovers quickly and automatically.</span></span> <span data-ttu-id="2a760-118">お客様は応答時間が長くなる可能性がありますに注意してくださいが、それ以外の場合、影響しません。</span><span class="sxs-lookup"><span data-stu-id="2a760-118">Your customers might notice slightly longer response time, but otherwise they won't be affected.</span></span> <span data-ttu-id="2a760-119">これらのエラーを処理する方法を説明します、[章の一時的な障害処理](transient-fault-handling.md)です。</span><span class="sxs-lookup"><span data-stu-id="2a760-119">We'll show some ways to handle these errors in the [Transient Fault Handling chapter](transient-fault-handling.md).</span></span>

<span data-ttu-id="2a760-120">エラーを支えますの監視と問題が発生して、根本原因分析を容易にするときにすぐに通知する機能をログ記録を実装できます。</span><span class="sxs-lookup"><span data-stu-id="2a760-120">For enduring failures, you can implement monitoring and logging functionality that notifies you promptly when issues arise and that facilitates root cause analysis.</span></span> <span data-ttu-id="2a760-121">これらのエラーの上に維持できるように、いくつかの方法を説明します、[監視と遠隔測定の章](monitoring-and-telemetry.md)です。</span><span class="sxs-lookup"><span data-stu-id="2a760-121">We'll show some ways to help you stay on top of these kinds of errors in the [Monitoring and Telemetry chapter](monitoring-and-telemetry.md).</span></span>

## <a name="failure-scope"></a><span data-ttu-id="2a760-122">障害のスコープ</span><span class="sxs-lookup"><span data-stu-id="2a760-122">Failure scope</span></span>

<span data-ttu-id="2a760-123">考慮する必要がエラー スコープ – は、1 台のコンピューターが影響を受けるかどうかなど、SQL データベースやストレージ、または地域全体全体のサービスです。</span><span class="sxs-lookup"><span data-stu-id="2a760-123">You also have to think about failure scope – whether a single machine is affected, a whole service such as SQL Database or Storage, or an entire region.</span></span>

![障害のスコープ](design-to-survive-failures/_static/image1.png)

### <a name="machine-failures"></a><span data-ttu-id="2a760-125">コンピューターの障害</span><span class="sxs-lookup"><span data-stu-id="2a760-125">Machine failures</span></span>

<span data-ttu-id="2a760-126">Azure では、障害が発生したサーバーは自動的に置き換え、新しいものと適切に設計されたクラウド アプリケーションは、自動的かつ迅速にこの種類のエラーから回復します。</span><span class="sxs-lookup"><span data-stu-id="2a760-126">In Azure, a failed server is automatically replaced by a new one, and a well-designed cloud app recovers from this kind of failure automatically and quickly.</span></span> <span data-ttu-id="2a760-127">ステートレス web 層のスケーラビリティ上のメリットを強調して以前であり、障害が発生したサーバーからの回復性のステートレス性の利点の 1 つ。</span><span class="sxs-lookup"><span data-stu-id="2a760-127">Earlier we stressed the scalability benefits of a stateless web tier, and ease of recovery from a failed server is another benefit of statelessness.</span></span> <span data-ttu-id="2a760-128">回復性も SQL データベースと Azure App Service Web Apps などのサービスとしてのプラットフォーム (PaaS) 機能の利点の 1 つあります。</span><span class="sxs-lookup"><span data-stu-id="2a760-128">Ease of recovery is also one of the benefits of platform-as-a-service (PaaS) features such as SQL Database and Azure App Service Web Apps.</span></span> <span data-ttu-id="2a760-129">ハードウェアの障害はまれですが、これらのサービスは、それらを自動的に処理が発生しました。これらのサービスを使用しているときに、コンピューターの障害を処理するコードを記述する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="2a760-129">Hardware failures are rare, but when they occur these services handle them automatically; you don't even have to write code to handle machine failures when you're using one of these services.</span></span>

### <a name="service-failures"></a><span data-ttu-id="2a760-130">サービスの失敗</span><span class="sxs-lookup"><span data-stu-id="2a760-130">Service failures</span></span>

<span data-ttu-id="2a760-131">クラウド アプリは、通常複数のサービスを使用します。</span><span class="sxs-lookup"><span data-stu-id="2a760-131">Cloud apps typically use multiple services.</span></span> <span data-ttu-id="2a760-132">たとえば、修正アプリで、SQL データベース サービス、ストレージ サービスを使用し、Azure App Service に web アプリを展開します。</span><span class="sxs-lookup"><span data-stu-id="2a760-132">For example, the Fix It app uses the SQL Database service, the Storage service, and the web app is deployed to Azure App Service.</span></span> <span data-ttu-id="2a760-133">アプリは何に依存しているサービスの 1 つが失敗した場合か。</span><span class="sxs-lookup"><span data-stu-id="2a760-133">What will your app do if one of the services you depend on fails?</span></span> <span data-ttu-id="2a760-134">障害をわかりやすいサービスいくつかの"申し訳ありませんが、後で再試行"メッセージに行うことができます最適な可能性があります。</span><span class="sxs-lookup"><span data-stu-id="2a760-134">For some service failures a friendly "sorry, try again later" message might be the best you can do.</span></span> <span data-ttu-id="2a760-135">多くのシナリオで行うことができます向上。</span><span class="sxs-lookup"><span data-stu-id="2a760-135">But in many scenarios you can do better.</span></span> <span data-ttu-id="2a760-136">たとえば、バックエンド データ ストアは、ときにユーザー入力を受け付ける、"、要求が受信された、"を表示して他の任意の場所の入力を一時的に格納必要なサービスがもう一度、運用し、入力を取得してそれを処理することができます。</span><span class="sxs-lookup"><span data-stu-id="2a760-136">For example, when your back-end data store is down, you can accept user input, display "your request has been received," and store the input someplace else temporarily; then when the service you need is operational again, you can retrieve the input and process it.</span></span>

<span data-ttu-id="2a760-137">[キュー中心作業パターン](queue-centric-work-pattern.md)章がこのシナリオを処理する方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="2a760-137">The [Queue-centric Work Pattern](queue-centric-work-pattern.md) chapter shows one way to handle this scenario.</span></span> <span data-ttu-id="2a760-138">SQL データベースが下向きのときの操作を終了する必要はありませんは、修正、アプリは、SQL データベースでタスクを保存します。</span><span class="sxs-lookup"><span data-stu-id="2a760-138">The Fix It app stores tasks in SQL Database, but it doesn't have to quit working when SQL Database is down.</span></span> <span data-ttu-id="2a760-139">章では、キューにタスクのユーザー入力を保存し、ワーカー プロセスを使用してキューを読み取るし、タスクを更新する方法が表示されます。</span><span class="sxs-lookup"><span data-stu-id="2a760-139">In that chapter we'll see how to store user input for a task in a queue, and use a worker process to read the queue and update the task.</span></span> <span data-ttu-id="2a760-140">修正タスクを作成する機能は影響を受ける; SQL がダウンしている場合はありません。ワーカー プロセスでは、待機でき、SQL データベースが使用可能な場合に、新しいタスクを処理することができます。</span><span class="sxs-lookup"><span data-stu-id="2a760-140">If SQL is down, the ability to create Fix It tasks is unaffected; the worker process can wait and process new tasks when SQL Database is available.</span></span>

### <a name="region-failures"></a><span data-ttu-id="2a760-141">地域の障害</span><span class="sxs-lookup"><span data-stu-id="2a760-141">Region failures</span></span>

<span data-ttu-id="2a760-142">地域全体が失敗する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="2a760-142">Entire regions may fail.</span></span> <span data-ttu-id="2a760-143">自然災害がデータ センターに壊れる可能性がありますの meteor でフラット化された可能性がありますを取得、backhoe など cow 埋没させる farmer によって、データ センターにトランク行を切り取る。アプリが stricken データ センターでホストされている場合は何か。</span><span class="sxs-lookup"><span data-stu-id="2a760-143">A natural disaster might destroy a data center, it might get flattened by a meteor, the trunk line into the datacenter could be cut by a farmer burying a cow with a backhoe, etc. If your app is hosted in the stricken datacenter what do you do?</span></span> <span data-ttu-id="2a760-144">ある場合、災害いずれかで、別の領域で実行されているを続行するように、複数の地域で同時に実行する Azure でのアプリを設定することができます。</span><span class="sxs-lookup"><span data-stu-id="2a760-144">It's possible to set up your app in Azure to run in multiple regions simultaneously so that if there's a disaster in one, you continue running in another region.</span></span> <span data-ttu-id="2a760-145">このような障害は非常にまれな回の出現とほとんどのアプリはこの種のエラーをサービスが中断されないようにするために必要な分かれてジャンプしません。</span><span class="sxs-lookup"><span data-stu-id="2a760-145">Such failures are extremely rare occurrences, and most apps don't jump through the hoops necessary to ensure uninterrupted service through failures of this sort.</span></span> <span data-ttu-id="2a760-146">地域の障害も、使用可能なアプリを保持する方法についての章の末尾には、リソースを参照してください。</span><span class="sxs-lookup"><span data-stu-id="2a760-146">See the Resources section at the end of the chapter for information about how to keep your app available even through a region failure.</span></span>

<span data-ttu-id="2a760-147">はるかに簡単障害のような種類のすべての処理を行うには、Azure の目標とどのように行ってを次の章での例をいくつかが表示されます。</span><span class="sxs-lookup"><span data-stu-id="2a760-147">A goal of Azure is to make handling all of these kinds of failures a lot easier, and you'll see some examples of how we're doing that in the following chapters.</span></span>

## <a name="slas"></a><span data-ttu-id="2a760-148">Sla</span><span class="sxs-lookup"><span data-stu-id="2a760-148">SLAs</span></span>

<span data-ttu-id="2a760-149">ユーザーは多くの場合、クラウド環境内のサービス レベル アグリーメント (Sla) に関する聞きます。</span><span class="sxs-lookup"><span data-stu-id="2a760-149">People often hear about service-level agreements (SLAs) in the cloud environment.</span></span> <span data-ttu-id="2a760-150">基本的に、これらは、そのサービスの信頼性の高い方法に関する企業した約束を守るです。</span><span class="sxs-lookup"><span data-stu-id="2a760-150">Basically these are promises that companies make about how reliable their service is.</span></span> <span data-ttu-id="2a760-151">SLA は、99.9% は、サービスを正しく機能している 99.9% の時間を想定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="2a760-151">A 99.9% SLA means you should expect the service to be working correctly 99.9% of the time.</span></span> <span data-ttu-id="2a760-152">SLA の非常に典型的な値であるのと音が非常に大量のようがどの程度のダウンタイムが気付かない可能性があります。 1% が実際には金額をします。</span><span class="sxs-lookup"><span data-stu-id="2a760-152">That's a fairly typical value for an SLA and it sounds like a very high number, but you might not realize how much down time .1% actually amounts to.</span></span> <span data-ttu-id="2a760-153">さまざまな SLA の割合が、年、月、および 1 週間で金額をどの程度のダウンタイムを示すテーブルを次に示します。</span><span class="sxs-lookup"><span data-stu-id="2a760-153">Here's a table that shows how much downtime various SLA percentages amount to over a year, a month, and a week.</span></span>

![SLA テーブル](design-to-survive-failures/_static/image2.png)

<span data-ttu-id="2a760-155">したがって年または 43.2 分 1 か月稼働ダウン、99.9% の SLA は、サービスを意味があります。</span><span class="sxs-lookup"><span data-stu-id="2a760-155">So a 99.9% SLA means your service could be down 8.76 hours a year or 43.2 minutes a month.</span></span> <span data-ttu-id="2a760-156">よりダウン時間よりも多くの人を実現します。</span><span class="sxs-lookup"><span data-stu-id="2a760-156">That's more down time than most people realize.</span></span> <span data-ttu-id="2a760-157">開発者は、ある程度のダウン タイムが可能なことに注意してください、正常な方法で処理したいです。</span><span class="sxs-lookup"><span data-stu-id="2a760-157">So as a developer you want to be aware that a certain amount of down time is possible and handle it in a graceful way.</span></span> <span data-ttu-id="2a760-158">ある時点でアプリでは、使用する予定のユーザーは、サービスが停止しているしようとしたお客様にその影響を及ぼすを最小限に抑えたいです。</span><span class="sxs-lookup"><span data-stu-id="2a760-158">At some point someone is going to be using your app, and a service is going to be down, and you want to minimize the negative impact of that on the customer.</span></span>

<span data-ttu-id="2a760-159">SLA を知っておく必要が 1 つの点はどのような時間枠を参照して: に毎週、毎月、または毎年、時計はリセットを取得しますか?</span><span class="sxs-lookup"><span data-stu-id="2a760-159">One thing you should know about an SLA is what time-frame it refers to: does the clock get reset every week, every month, or every year?</span></span> <span data-ttu-id="2a760-160">Azure yearly SLA も良いか月間の一連のオフセットによって正しくないか月間を非表示にするための年間の SLA をよりはすべての月をクロックにリセットします。</span><span class="sxs-lookup"><span data-stu-id="2a760-160">In Azure we reset the clock every month, which is better for you than a yearly SLA, since a yearly SLA could hide bad months by offsetting them with a series of good months.</span></span>

<span data-ttu-id="2a760-161">もちろんお常にユーザーに気付かれない SLA; よりも優れた通常よりもより少ないダウンことになります。</span><span class="sxs-lookup"><span data-stu-id="2a760-161">Of course we always aspire to do better than the SLA; usually you'll be down much less than that.</span></span> <span data-ttu-id="2a760-162">Promise は、私たちはこれまで下へのダウン時間の最大長を超えて場合でも、返金にもらうことができます。</span><span class="sxs-lookup"><span data-stu-id="2a760-162">The promise is that if we're ever down for longer than the maximum down time you can ask for money back.</span></span> <span data-ttu-id="2a760-163">金額を取得する可能性はありませんが完全に補償のたびに、余分なビジネスへの影響が、SLA の部分は強制ポリシーとして機能することがわかったことは、非常に深刻なことができます。</span><span class="sxs-lookup"><span data-stu-id="2a760-163">The amount of money you get back probably wouldn't fully compensate you for the business impact of the excess down time, but that aspect of the SLA acts as an enforcement policy and lets you know that we do take it very seriously.</span></span>

### <a name="composite-slas"></a><span data-ttu-id="2a760-164">複合 Sla</span><span class="sxs-lookup"><span data-stu-id="2a760-164">Composite SLAs</span></span>

<span data-ttu-id="2a760-165">Sla で表示している場合を考慮して、重要な点は、個別の SLA を持つ各サービスとアプリケーションでは、複数のサービスを使用しての影響です。</span><span class="sxs-lookup"><span data-stu-id="2a760-165">An important thing to think about when you're looking at SLAs is the impact of using multiple services in an app, with each service having a separate SLA.</span></span> <span data-ttu-id="2a760-166">たとえば、修正、アプリは、Azure App Service Web Apps、Azure ストレージ、および SQL データベースを使用します。</span><span class="sxs-lookup"><span data-stu-id="2a760-166">For example, the Fix It app uses Azure App Service Web Apps, Azure Storage, and SQL Database.</span></span> <span data-ttu-id="2a760-167">時点でこの電子ブックは、2013 年 12 月で記述されている場合は、その SLA 番号を次に示します。</span><span class="sxs-lookup"><span data-stu-id="2a760-167">Here are their SLA numbers as of the date this e-book is being written in December, 2013:</span></span>

![Web サイト、ストレージ、SQL データベースの SLA](design-to-survive-failures/_static/image3.png)

<span data-ttu-id="2a760-169">これらのサービスの Sla に基づいてアプリが期待する時間を最大値とは何ですか。</span><span class="sxs-lookup"><span data-stu-id="2a760-169">What is the maximum down time you would expect for the app based on these service SLAs?</span></span> <span data-ttu-id="2a760-170">ダウンタイムことが、最悪の SLA の割合、または 99.9% に等しいここでを想定する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="2a760-170">You might think that your down time would be equal to the worst SLA percentage, or 99.9% in this case.</span></span> <span data-ttu-id="2a760-171">True の場合は、同時に 3 つすべてのサービスが常に失敗しましたが、それは必ずしも実際の動作です。</span><span class="sxs-lookup"><span data-stu-id="2a760-171">That would be true if all three services always failed at the same time, but that isn't necessarily what actually happens.</span></span> <span data-ttu-id="2a760-172">各サービスが失敗していない個別に異なるタイミングで個別の SLA の数値を乗算することによって、複合 SLA を計算する必要があるためです。</span><span class="sxs-lookup"><span data-stu-id="2a760-172">Each service may fail independently at different times, so you have to calculate the composite SLA by multiplying the individual SLA numbers.</span></span>

![複合 SLA](design-to-survive-failures/_static/image4.png)

<span data-ttu-id="2a760-174">このため、アプリは、ダウンしている 43.2 分だけでなく、1 か月、3 倍になる、1 か月 – 108 分と、まだ Azure SLA の制限内である可能性があります。</span><span class="sxs-lookup"><span data-stu-id="2a760-174">So your app could be down not just 43.2 minutes a month but 3 times that amount, 108 minutes a month – and still be within the Azure SLA limits.</span></span>

<span data-ttu-id="2a760-175">この問題は、Azure に一意ではありません。</span><span class="sxs-lookup"><span data-stu-id="2a760-175">This issue is not unique to Azure.</span></span> <span data-ttu-id="2a760-176">実際に提供する最適なクラウド、使用可能なすべてのクラウド サービスの Sla と同様の問題に任意のベンダーのクラウド サービスを使用する場合に対処する必要があります。</span><span class="sxs-lookup"><span data-stu-id="2a760-176">We actually provide the best cloud SLAs of any cloud service available, and you'll have similar issues to deal with if you use any vendor's cloud services.</span></span> <span data-ttu-id="2a760-177">この強調表示は、重要性、顧客やユーザーに影響する多くの場合ほど、発生する可能性がありますので、必然的なサービスのエラーを適切に処理するアプリを設計する方法について検討します。</span><span class="sxs-lookup"><span data-stu-id="2a760-177">What this highlights is the importance of thinking about how you can design your app to handle the inevitable service failures gracefully, because they might happen often enough to impact your customers or users.</span></span>

### <a name="cloud-slas-compared-to-enterprise-down-time-experience"></a><span data-ttu-id="2a760-178">エンタープライズ ダウン時のエクスペリエンスと比較してクラウド Sla</span><span class="sxs-lookup"><span data-stu-id="2a760-178">Cloud SLAs compared to enterprise down-time experience</span></span>

<span data-ttu-id="2a760-179">場合によってと言われる、「エンタープライズ アプリしない問題があるこれら」</span><span class="sxs-lookup"><span data-stu-id="2a760-179">People sometimes say, "In my enterprise app I never have these problems."</span></span> <span data-ttu-id="2a760-180">1 か月のどの程度のダウンタイムを依頼する場合、実際にあるは、通常言った「も、発生する場合があります」</span><span class="sxs-lookup"><span data-stu-id="2a760-180">If you ask how much down time a month they actually have, they usually say, "Well, it happens occasionally."</span></span> <span data-ttu-id="2a760-181">どのくらいの頻度を依頼する場合、許可を「をバックアップするか、新しいサーバーまたは更新プログラムのソフトウェアをインストールする必要はあります」。</span><span class="sxs-lookup"><span data-stu-id="2a760-181">And if you ask how often, they admit that "Sometimes we do need to back up or install a new server or update software."</span></span> <span data-ttu-id="2a760-182">もちろん、するはダウン時間としてカウントします。</span><span class="sxs-lookup"><span data-stu-id="2a760-182">Of course, that counts as down time.</span></span> <span data-ttu-id="2a760-183">ほとんどのエンタープライズ アプリで特にミッション クリティカルでない限り、ダウンしている実際には、サービスの Sla で許容される量より多くの。</span><span class="sxs-lookup"><span data-stu-id="2a760-183">Most enterprise apps unless they are especially mission-critical are actually down for more than the amount of time allowed by our service SLAs.</span></span> <span data-ttu-id="2a760-184">終了時間小さい不安を感じする傾向があるとは、サーバーとインフラストラクチャにしたり、そのコントロールでするできたら。</span><span class="sxs-lookup"><span data-stu-id="2a760-184">But when it's your server and your infrastructure and you're responsible for it and in control of it, you tend to feel less angst about down times.</span></span> <span data-ttu-id="2a760-185">他のユーザーに依存しているクラウド環境で不明な何が起こってためより気を取得する傾向がある可能性があります。</span><span class="sxs-lookup"><span data-stu-id="2a760-185">In a cloud environment you're dependent on someone else and you don't know what's going on, so you might tend to get more worried about it.</span></span>

<span data-ttu-id="2a760-186">獲得すると、エンタープライズ クラウド SLA から取得するよりも大きい稼働時間をパーセント、それらによって実行するハードウェアにより多くのコストを費やすです。</span><span class="sxs-lookup"><span data-stu-id="2a760-186">When an enterprise achieves a greater up-time percentage than you get from a cloud SLA, they do it by spending a lot more money on hardware.</span></span> <span data-ttu-id="2a760-187">クラウド サービスでは、操作を行うことが、そのサービスの多くを充電する必要があります。</span><span class="sxs-lookup"><span data-stu-id="2a760-187">A cloud service could do that but would have to charge much more for its services.</span></span> <span data-ttu-id="2a760-188">代わりに、コスト効果の高いサービスを利用し、必然的な障害は、顧客に最小の中断を引き起こすできるように、ソフトウェアをデザインします。</span><span class="sxs-lookup"><span data-stu-id="2a760-188">Instead, you take advantage of a cost-effective service and design your software so that the inevitable failures cause minimum disruption to your customers.</span></span> <span data-ttu-id="2a760-189">クラウド アプリの設計者は、ジョブができないようにしてください災害、エラーを回避するのにはあまりで行うにはハードウェアではなく、ソフトウェアに注目すること。</span><span class="sxs-lookup"><span data-stu-id="2a760-189">Your job as a cloud app designer is not so much to avoid failure as to avoid catastrophe, and you do that by focusing on software, not on hardware.</span></span> <span data-ttu-id="2a760-190">一方、エンタープライズ アプリでは、平均故障間隔を最大化しようとして、クラウド アプリが平均復旧時間を最小限に抑えるに努めています。</span><span class="sxs-lookup"><span data-stu-id="2a760-190">Whereas enterprise apps strive to maximize mean time between failures, cloud apps strive to minimize mean time to recover.</span></span>

### <a name="not-all-cloud-services-have-slas"></a><span data-ttu-id="2a760-191">すべてのクラウド サービスの Sla があります。</span><span class="sxs-lookup"><span data-stu-id="2a760-191">Not all cloud services have SLAs</span></span>

<span data-ttu-id="2a760-192">注意してくださいもいないすべてのクラウド サービスは、SLA をでもは。</span><span class="sxs-lookup"><span data-stu-id="2a760-192">Be aware also that not every cloud service even has an SLA.</span></span> <span data-ttu-id="2a760-193">アプリが稼働時間保証はありませんでサービスに依存する場合は、想像よりも長くダウンすることもできます。</span><span class="sxs-lookup"><span data-stu-id="2a760-193">If your app is dependent on a service with no up-time guarantee, you could be down far longer than you might imagine.</span></span> <span data-ttu-id="2a760-194">たとえば、Facebook、Twitter などのソーシャル プロバイダーを使用して、サイトに、ログで有効にすると場合、は、どうか調べます、SLA がある場合がありますがない場合にサービス プロバイダーに確認します。</span><span class="sxs-lookup"><span data-stu-id="2a760-194">For example, if you enable log-in to your site using a social provider such as Facebook or Twitter, check with the service provider to find out if there is an SLA, and you might find out there isn't one.</span></span> <span data-ttu-id="2a760-195">顧客がアプリからロックアウトされている場合は認証サービスがダウンしても、大量の要求をサポートするようになっています。</span><span class="sxs-lookup"><span data-stu-id="2a760-195">But if the authentication service goes down or is unable to support the volume of requests you throw at it, your customers are locked out of your app.</span></span> <span data-ttu-id="2a760-196">日数以上、ダウンしている可能性があります。</span><span class="sxs-lookup"><span data-stu-id="2a760-196">You could be down for days or longer.</span></span> <span data-ttu-id="2a760-197">1 つの新しいアプリの作成元が必要数億件のダウンロードと Facebook 認証 – に対する依存関係が進んでライブと検出された遅すぎます Facebook に説明しませんでしたそのサービスの SLA がないこと。</span><span class="sxs-lookup"><span data-stu-id="2a760-197">The creators of one new app expected hundreds of millions of downloads and took a dependency on Facebook authentication – but didn't talk to Facebook before going live and discovered too late that there was no SLA for that service.</span></span>

### <a name="not-all-downtime-counts-toward-slas"></a><span data-ttu-id="2a760-198">Sla に向けたいないダウンタイム ページ数</span><span class="sxs-lookup"><span data-stu-id="2a760-198">Not all downtime counts toward SLAs</span></span>

<span data-ttu-id="2a760-199">いくつかのクラウド サービスは、アプリが過剰に使用する場合、サービスを拒否意図的に可能性があります。</span><span class="sxs-lookup"><span data-stu-id="2a760-199">Some cloud services may deliberately deny service if your app over-uses them.</span></span> <span data-ttu-id="2a760-200">これと呼ばれる*調整*です。</span><span class="sxs-lookup"><span data-stu-id="2a760-200">This is called *throttling*.</span></span> <span data-ttu-id="2a760-201">サービスに SLA がある場合は、条件は、するが抑制される可能性がある、アプリケーションの設計する必要がありますそれらの状態を回避して発生する場合は、調整を適切に対処される、条件の状態にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="2a760-201">If a service has an SLA, it should state the conditions under which you might be throttled, and your app design should avoid those conditions and react appropriately to the throttling if it happens.</span></span> <span data-ttu-id="2a760-202">たとえば、サービスへの要求を開始できない 1 秒あたりの特定の数を超過すると、場合自動再試行が続行を調整することと、迅速に発生しないことを確認します。</span><span class="sxs-lookup"><span data-stu-id="2a760-202">For example, if requests to a service start to fail when you exceed a certain number per second, you want to make sure automatic retries don't happen so fast that they cause the throttling to continue.</span></span> <span data-ttu-id="2a760-203">必要があるの制限についての詳細、[章の一時的な障害処理](transient-fault-handling.md)です。</span><span class="sxs-lookup"><span data-stu-id="2a760-203">We'll have more to say about throttling in the [Transient Fault Handling chapter](transient-fault-handling.md).</span></span>

## <a name="summary"></a><span data-ttu-id="2a760-204">概要</span><span class="sxs-lookup"><span data-stu-id="2a760-204">Summary</span></span>

<span data-ttu-id="2a760-205">この章が、現実の世界クラウド アプリに障害を適切に存続するように設計する理由を実現できるようにしようとしています。</span><span class="sxs-lookup"><span data-stu-id="2a760-205">This chapter has tried to help you realize why a real world cloud app has to be designed to survive failures gracefully.</span></span> <span data-ttu-id="2a760-206">以降で、[次のチャプター](monitoring-and-telemetry.md)、このシリーズの残りのパターンの移動を行うには使用できるいくつかの戦略について詳細に説明します。</span><span class="sxs-lookup"><span data-stu-id="2a760-206">Starting with the [next chapter](monitoring-and-telemetry.md), the remaining patterns in this series go into more detail about some strategies you can use to do that:</span></span>

- <span data-ttu-id="2a760-207">良いが[監視と遠隔測定](monitoring-and-telemetry.md)、問題を解決するための十分な情報を使用して、操作は必要のある失敗に関するすばやくを調べるようにします。</span><span class="sxs-lookup"><span data-stu-id="2a760-207">Have good [monitoring and telemetry](monitoring-and-telemetry.md), so that you find out quickly about failures that require intervention, and you have sufficient information to resolve them.</span></span>
- <span data-ttu-id="2a760-208">[一時的なエラー処理](transient-fault-handling.md)でき、にフォールバックするときに、アプリが自動的にリカバリするように、インテリジェントな再試行ロジックを実装することによって[遮断器](transient-fault-handling.md#circuitbreakers)ロジックできない場合。</span><span class="sxs-lookup"><span data-stu-id="2a760-208">[Handle transient faults](transient-fault-handling.md) by implementing intelligent retry logic, so that your app recovers automatically when it can and falls back to [circuit breaker](transient-fault-handling.md#circuitbreakers) logic when it can't.</span></span>
- <span data-ttu-id="2a760-209">使用して[分散キャッシュ](distributed-caching.md)データベース アクセスのスループット、待ち時間、および接続の問題を最小限に抑える。</span><span class="sxs-lookup"><span data-stu-id="2a760-209">Use [distributed caching](distributed-caching.md) in order to minimize throughput, latency, and connection problems with database access.</span></span>
- <span data-ttu-id="2a760-210">疎結合を使用して実装、[キュー中心作業パターン](queue-centric-work-pattern.md)バックエンドが下にあるときに、アプリのフロント エンドを続行するため、します。</span><span class="sxs-lookup"><span data-stu-id="2a760-210">Implement loose coupling via the [queue-centric work pattern](queue-centric-work-pattern.md), so that your app front end can continue to work when the back end is down.</span></span>

## <a name="resources"></a><span data-ttu-id="2a760-211">リソース</span><span class="sxs-lookup"><span data-stu-id="2a760-211">Resources</span></span>

<span data-ttu-id="2a760-212">詳細については、この電子書籍と、次のリソースの後の章を参照してください。</span><span class="sxs-lookup"><span data-stu-id="2a760-212">For more information, see later chapters in this e-book and the following resources.</span></span>

<span data-ttu-id="2a760-213">ドキュメント:</span><span class="sxs-lookup"><span data-stu-id="2a760-213">Documentation:</span></span>

- <span data-ttu-id="2a760-214">[フェール セーフ: 回復力のあるクラウド アーキテクチャについて](https://msdn.microsoft.com/en-us/library/windowsazure/jj853352.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="2a760-214">[Failsafe: Guidance for Resilient Cloud Architectures](https://msdn.microsoft.com/en-us/library/windowsazure/jj853352.aspx).</span></span> <span data-ttu-id="2a760-215">Marc Mercuri、Ulrich Homann、Andrew Townhill、ホワイト ペーパー。</span><span class="sxs-lookup"><span data-stu-id="2a760-215">White paper by Marc Mercuri, Ulrich Homann, and Andrew Townhill.</span></span> <span data-ttu-id="2a760-216">フェール セーフ ビデオ シリーズの web ページ バージョンです。</span><span class="sxs-lookup"><span data-stu-id="2a760-216">Web page version of the FailSafe video series.</span></span>
- <span data-ttu-id="2a760-217">[Azure クラウド サービスで大規模なサービスのデザインに関するヒント集](https://msdn.microsoft.com/en-us/library/windowsazure/jj717232.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="2a760-217">[Best Practices for the Design of Large-Scale Services on Azure Cloud Services](https://msdn.microsoft.com/en-us/library/windowsazure/jj717232.aspx).</span></span> <span data-ttu-id="2a760-218">Mark Simms、Michael Thomassy、ホワイト ペーパー。</span><span class="sxs-lookup"><span data-stu-id="2a760-218">White paper by Mark Simms and Michael Thomassy.</span></span>
- <span data-ttu-id="2a760-219">[Azure のビジネス継続性テクニカル ガイダンス](https://msdn.microsoft.com/en-us/library/windowsazure/hh873027.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="2a760-219">[Azure Business Continuity Technical Guidance](https://msdn.microsoft.com/en-us/library/windowsazure/hh873027.aspx).</span></span> <span data-ttu-id="2a760-220">Patrick Wickline、Jason Roth、ホワイト ペーパー。</span><span class="sxs-lookup"><span data-stu-id="2a760-220">White paper by Patrick Wickline and Jason Roth.</span></span>
- <span data-ttu-id="2a760-221">[災害復旧と Azure アプリケーションの高可用性](https://msdn.microsoft.com/en-us/library/windowsazure/dn251004.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="2a760-221">[Disaster Recovery and High Availability for Azure Applications](https://msdn.microsoft.com/en-us/library/windowsazure/dn251004.aspx).</span></span> <span data-ttu-id="2a760-222">Michael McKeown、Hanu Kommalapati Jason Roth、ホワイト ペーパー。</span><span class="sxs-lookup"><span data-stu-id="2a760-222">White paper by Michael McKeown, Hanu Kommalapati, and Jason Roth.</span></span>
- <span data-ttu-id="2a760-223">[Microsoft Patterns and Practices - Azure ガイダンス](https://msdn.microsoft.com/en-us/library/dn568099.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="2a760-223">[Microsoft Patterns and Practices - Azure Guidance](https://msdn.microsoft.com/en-us/library/dn568099.aspx).</span></span> <span data-ttu-id="2a760-224">複数のデータ センターの展開ガイド、遮断器のパターンを参照してください。</span><span class="sxs-lookup"><span data-stu-id="2a760-224">See Multi Data Center Deployment guidance, Circuit breaker pattern.</span></span>
- <span data-ttu-id="2a760-225">[Azure のサポート - サービス レベル契約](https://azure.microsoft.com/support/legal/sla/)です。</span><span class="sxs-lookup"><span data-stu-id="2a760-225">[Azure Support - Service Level Agreements](https://azure.microsoft.com/support/legal/sla/).</span></span>
- <span data-ttu-id="2a760-226">[Azure SQL データベースにおけるビジネス継続性](https://msdn.microsoft.com/en-us/library/windowsazure/hh852669.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="2a760-226">[Business Continuity in Azure SQL Database](https://msdn.microsoft.com/en-us/library/windowsazure/hh852669.aspx).</span></span> <span data-ttu-id="2a760-227">SQL データベース高可用性と災害復旧機能に関するドキュメントです。</span><span class="sxs-lookup"><span data-stu-id="2a760-227">Documentation about SQL Database high availability and disaster recovery features.</span></span>
- <span data-ttu-id="2a760-228">[高可用性と Azure の仮想マシンにおける SQL Server の災害復旧](https://msdn.microsoft.com/en-us/library/windowsazure/jj870962.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="2a760-228">[High Availability and Disaster Recovery for SQL Server in Azure Virtual Machines](https://msdn.microsoft.com/en-us/library/windowsazure/jj870962.aspx).</span></span>

<span data-ttu-id="2a760-229">ビデオ:</span><span class="sxs-lookup"><span data-stu-id="2a760-229">Videos:</span></span>

- <span data-ttu-id="2a760-230">[フェール セーフ: スケーラブル、かつ回復力のクラウド サービスの構築](https://channel9.msdn.com/Series/FailSafe)です。</span><span class="sxs-lookup"><span data-stu-id="2a760-230">[FailSafe: Building Scalable, Resilient Cloud Services](https://channel9.msdn.com/Series/FailSafe).</span></span> <span data-ttu-id="2a760-231">Ulrich Homann、Marc Mercuri、Mark Simms、系列を 9 つの部分で構成します。</span><span class="sxs-lookup"><span data-stu-id="2a760-231">Nine-part series by Ulrich Homann, Marc Mercuri, and Mark Simms.</span></span> <span data-ttu-id="2a760-232">実際のお客様と Microsoft Customer ・ Advisory Team (CAT) エクスペリエンスから抽出されたストーリーで非常にアクセス可能な興味深い方法で高度な概念とアーキテクチャの原則を説明します。</span><span class="sxs-lookup"><span data-stu-id="2a760-232">Presents high-level concepts and architectural principles in a very accessible and interesting way, with stories drawn from Microsoft Customer Advisory Team (CAT) experience with actual customers.</span></span> <span data-ttu-id="2a760-233">1 から 8 のエピソード数は、障害にも対処クラウド アプリをデザインする理由に徹底的に移動します。</span><span class="sxs-lookup"><span data-stu-id="2a760-233">Episodes 1 and 8 go in depth into the reasons for designing cloud apps to survive failures.</span></span> <span data-ttu-id="2a760-234">49:57、障害点と障害モード 56:05、始まるエピソード 2 での説明およびブレーカー 40:55 始まるエピソード 3 での説明で 2 回の起動に制限のフォロー アップの説明を参照してください。</span><span class="sxs-lookup"><span data-stu-id="2a760-234">See also the follow-up discussion of throttling in episode 2 starting at 49:57, the discussion of failure points and failure modes in episode 2 starting at 56:05, and the discussion of circuit breakers in episode 3 starting at 40:55.</span></span>
- <span data-ttu-id="2a760-235">[構築 Big: Azure のお客様のパート II から学んだ教訓](https://channel9.msdn.com/Events/Build/2012/3-030)です。</span><span class="sxs-lookup"><span data-stu-id="2a760-235">[Building Big: Lessons learned from Azure customers - Part II](https://channel9.msdn.com/Events/Build/2012/3-030).</span></span> <span data-ttu-id="2a760-236">Mark Simms は、エラーのための設計と、すべてのインストルメント化について説明します。</span><span class="sxs-lookup"><span data-stu-id="2a760-236">Mark Simms talks about designing for failure and instrumenting everything.</span></span> <span data-ttu-id="2a760-237">フェール セーフ系列の詳細の操作方法に関する詳細情報になるに似ています。</span><span class="sxs-lookup"><span data-stu-id="2a760-237">Similar to the Failsafe series but goes into more how-to details.</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="2a760-238">[前へ](unstructured-blob-storage.md)
[次へ](monitoring-and-telemetry.md)</span><span class="sxs-lookup"><span data-stu-id="2a760-238">[Previous](unstructured-blob-storage.md)
[Next](monitoring-and-telemetry.md)</span></span>
