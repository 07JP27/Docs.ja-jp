---
uid: mvc/overview/older-versions-1/views/passing-data-to-view-master-pages-vb
title: "ビュー マスター ページ (VB) にデータを渡す |Microsoft ドキュメント"
author: microsoft
description: "このチュートリアルの目的では、ビュー マスター ページへのコント ローラーからデータを渡す方法について説明します。 ビュー m にデータを渡すための 2 つの方法を説明しています."
ms.author: aspnetcontent
manager: wpickett
ms.date: 10/16/2008
ms.topic: article
ms.assetid: 37a1ebae-8773-408f-8645-d21da7ff9ae1
ms.technology: dotnet-mvc
ms.prod: .net-framework
msc.legacyurl: /mvc/overview/older-versions-1/views/passing-data-to-view-master-pages-vb
msc.type: authoredcontent
ms.openlocfilehash: d92a1afe46af124e835b3d59f2b2093402742bbd
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/10/2017
---
<a name="passing-data-to-view-master-pages-vb"></a>ビュー マスター ページ (VB) にデータを渡す
====================
によって[Microsoft](https://github.com/microsoft)

[PDF をダウンロードします。](http://download.microsoft.com/download/e/f/3/ef3f2ff6-7424-48f7-bdaa-180ef64c3490/ASPNET_MVC_Tutorial_13_VB.pdf)

> このチュートリアルの目的では、ビュー マスター ページへのコント ローラーからデータを渡す方法について説明します。 ビュー マスター ページにデータを渡すための 2 つの方法を説明します。 最初に、保守が困難なアプリケーションで発生するための簡単な解決策について説明します。 次に、少しより保守が容易なアプリケーションで結果より多くの初期作業を必要とするより良いソリューションを調べます。


## <a name="passing-data-to-view-master-pages"></a>マスター ページの表示にデータを渡す

このチュートリアルの目的では、ビュー マスター ページへのコント ローラーからデータを渡す方法について説明します。 ビュー マスター ページにデータを渡すための 2 つの方法を説明します。 最初に、保守が困難なアプリケーションで発生するための簡単な解決策について説明します。 次に、少しより保守が容易なアプリケーションで結果より多くの初期作業を必要とするより良いソリューションを調べます。

### <a name="the-problem"></a>問題を

ムービーのデータベース アプリケーションを構築して、アプリケーション内の各ページにムービーのカテゴリの一覧を表示することを想像してください (図 1 を参照してください)。 さらに、ムービーのカテゴリの一覧が、データベース テーブルに格納される想像してみてください。 その場合は、データベースからカテゴリを取得し、ビューのマスター ページ内のムービーのカテゴリの一覧を表示します。


[![ビュー マスター ページで、ムービーのカテゴリを表示します。](passing-data-to-view-master-pages-vb/_static/image2.png)](passing-data-to-view-master-pages-vb/_static/image1.png)

**図 01**: ビュー マスター ページで、ムービーのカテゴリを表示する ([フルサイズのイメージを表示するをクリックして](passing-data-to-view-master-pages-vb/_static/image3.png))


この問題を次に示します。 マスター ページ内のムービーのカテゴリの一覧を取得する方法 ことは避けて、マスター ページで、モデル クラスのメソッドを直接呼び出します。 つまりは、マスター ページの右側にデータベースからデータを取得するためのコードを含めます。 ただし、データベースへのアクセス、MVC コント ローラーをバイパスする違反となる、クリーン関心の分離は、MVC アプリケーションの構築の主な利点の 1 つです。

MVC アプリケーション、MVC コント ローラーによって処理するには、MVC ビューと、MVC モデルの間のすべての対話できるようにします。 この関心の分離は、保守が容易な適応性、およびテストが容易なアプリケーションで発生します。

MVC アプリケーションで、ビュー マスター ページを含むビューに渡されるすべてのデータをコント ローラーのアクションでのビューに渡される必要があります。 さらに、データは、データの表示を活用して渡されます。 このチュートリアルの残りの部分では、ビューのマスター ページ ビューのデータを渡すことの 2 つのメソッドを調べます。

### <a name="the-simple-solution"></a>単純なソリューション

ビュー マスター ページに、コント ローラーからビューのデータを渡す最も簡単なソリューションから始めましょう。 最も簡単なソリューションでは、各コント ローラーのアクションで、マスター ページのビュー データを渡します。

リスト 1 のコント ローラーを検討してください。 という名前の 2 つのアクションを公開`Index()`と`Details()`です。 `Index()`アクション メソッドは、映画データベース テーブルですべてのムービーを返します。 `Details()`アクション メソッドは、特定のムービーのカテゴリにどのムービーを返します。

**1 – を一覧表示します。`Controllers\HomeController.vb`**

[!code-vb[Main](passing-data-to-view-master-pages-vb/samples/sample1.vb)]

注意して両方の`Index()`と`Details()`アクションは、データを表示する 2 つの項目を追加します。 `Index()`操作は、2 つのキーを追加: カテゴリおよびビデオ。 カテゴリのキーでは、ビュー マスター ページで表示されるビデオ カテゴリの一覧を表します。 映画キーでは、インデックスの表示 ページで表示されるムービーの一覧を表します。

`Details()`アクションもカテゴリや映画をという名前の 2 つのキーを追加します。 カテゴリ キーは、もう一度ビュー マスター ページで表示されるビデオ カテゴリの一覧を表します。 映画キーは、詳細ビュー ページで表示される特定のカテゴリにムービーの一覧を表します (図 2 を参照してください)。


[![詳細ビュー](passing-data-to-view-master-pages-vb/_static/image5.png)](passing-data-to-view-master-pages-vb/_static/image4.png)

**図 02**: [詳細] ビュー ([フルサイズのイメージを表示するをクリックして](passing-data-to-view-master-pages-vb/_static/image6.png))


インデックス ビューは、2 のリストに含まれます。 データの表示の動画アイテムで表されるムービーの一覧を反復処理するだけです。

**2 – を一覧表示します。`Views\Home\Index.aspx`**

[!code-aspx[Main](passing-data-to-view-master-pages-vb/samples/sample2.aspx)]

ビュー マスター ページは、3 の一覧に含まれます。 ビュー マスター ページでは、反復処理し、すべてのデータの表示からカテゴリ項目によって表される映画カテゴリを表示します。

**3 – を一覧表示します。`Views\Shared\Site.master`**

[!code-aspx[Main](passing-data-to-view-master-pages-vb/samples/sample3.aspx)]

すべてのデータは、ビュー データをビューとビューのマスター ページに渡されます。 マスター ページにデータを渡すための正しい方法です。

そのため、このソリューションに関する問題ですか。 この問題は、このソリューションがドライ (しないことを繰り返さない) の原則に違反します。 各コント ローラーのアクションは、非常に同じデータを表示するムービーのカテゴリの一覧を追加する必要があります。 アプリケーションで重複するコードを持つによってにより、アプリケーションの管理、改変、および変更する非常に困難です。

### <a name="the-good-solution"></a>適切なソリューション

このセクションでは、代替、およびより優れたソリューションがコント ローラーのアクションからビュー マスター ページにデータを渡すことを確認します。 マスター ページのムービーのカテゴリを追加する、各コント ローラーのアクションで、代わりにカテゴリを追加、ムービー ビュー データを 1 回だけ。 ビュー マスター ページで使用されるすべてのビュー データは、アプリケーションのコント ローラーに追加されます。

ApplicationController クラスは、4 の一覧に含まれます。

ApplicationController クラスは、4 の一覧に含まれます。

**4 – を一覧表示します。`Controllers\ApplicationController.vb`**

[!code-vb[Main](passing-data-to-view-master-pages-vb/samples/sample4.vb)]

一覧表示する 4 でアプリケーションのコント ローラーに関する注意すべき次の 3 つの点があります。 最初に、クラスが基本 System.Web.Mvc.Controller クラスから継承されていることを確認します。 アプリケーションのコント ローラーは、コント ローラー クラスです。

第二に、アプリケーションのコント ローラー クラスが MustInherit クラスであるに注意してください。 MustInherit クラスは、具象クラスで実装される必要があるクラスです。 アプリケーションのコント ローラーは MustInherit クラスであるため、クラスで直接定義されているすべてのメソッドを呼び出せませんことはできません。 アプリケーションのクラスを直接呼び出すしようとすると、リソースが検出されないエラー メッセージが表示されます。

3 番目に、アプリケーション コント ローラーにデータを表示するムービーのカテゴリの一覧に追加するコンス トラクターが含まれていることを確認します。 アプリケーションのコント ローラーから継承するすべてのコント ローラー クラスでは、自動的にアプリケーションのコント ローラーのコンス トラクターを呼び出します。 アプリケーションのコント ローラーから継承する任意のコント ローラーで任意のアクションを呼び出すと、ときに、ムービーのカテゴリがビュー データに自動的に追加します。

リスト 5 のビデオ コント ローラーは、アプリケーションのコント ローラーから継承します。

**5 – を一覧表示します。`Controllers\MoviesController.vb`**

[!code-vb[Main](passing-data-to-view-master-pages-vb/samples/sample5.vb)]

前のセクションで説明されている、Home コント ローラーと同じように、ムービーのコント ローラーという 2 つのアクション メソッドを公開する`Index()`と`Details()`です。 いずれかでデータを表示するビュー マスター ページで表示されるビデオ カテゴリの一覧ではない通知が追加された、`Index()`または`Details()`メソッドです。 ビデオ コント ローラーは、アプリケーションのコント ローラーから継承、するために自動的にデータを表示するムービーのカテゴリの一覧が追加されます。

ビュー マスター ページのビュー データを追加するには、このソリューションにドライ (しないことを繰り返さない) の原則に違反していないことに注意してください。 1 つの場所にデータを表示するムービーのカテゴリの一覧を追加するためのコードが含まれている: アプリケーションのコント ローラーのコンス トラクターです。

### <a name="summary"></a>概要

このチュートリアルでは、コント ローラーからビュー マスター ページ ビュー データを渡す 2 つの方法について説明します。 まず、アプローチを維持するが困難ですが、単純なを調査します。 最初のセクションでは、アプリケーションで各すべてコント ローラーのアクションでビュー マスター ページのビュー データを追加する方法について説明しました。 という結論に達しました (しないことを繰り返さない) ドライ原則に違反しているために、不適切なアプローチがこれことです。

次に、データを表示するビュー マスター ページで必要なデータを追加するためより適切な程度戦略を調査します。 ビュー データを追加する、各コント ローラーのアクションで、代わりに、アプリケーションのコント ローラー内では、ビュー データを 1 回だけを追加しています。 ようにして、ビュー マスター ページ、ASP.NET MVC アプリケーションでデータを渡す場合は、重複するコードを回避できます。

>[!div class="step-by-step"]
[前へ](creating-page-layouts-with-view-master-pages-vb.md)
