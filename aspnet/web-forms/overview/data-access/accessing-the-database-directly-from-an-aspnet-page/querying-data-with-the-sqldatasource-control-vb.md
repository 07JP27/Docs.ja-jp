---
uid: web-forms/overview/data-access/accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-vb
title: SqlDataSource コントロール (VB) を使用してデータを照会 |Microsoft ドキュメント
author: rick-anderson
description: 前のチュートリアルでは、ObjectDataSource コントロールを使用して、データ アクセス層からプレゼンテーション層を完全に分離します。 この家庭教師としてを開始しています.
ms.author: aspnetcontent
manager: wpickett
ms.date: 02/20/2007
ms.topic: article
ms.assetid: b12f752d-3502-40a4-b695-fc7b7d08cfd3
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-vb
msc.type: authoredcontent
ms.openlocfilehash: 6f886ca85a2a4dea5daeff109370bedc1a3f7265
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/06/2018
ms.locfileid: "30876567"
---
<a name="querying-data-with-the-sqldatasource-control-vb"></a><span data-ttu-id="cfe15-104">SqlDataSource コントロール (VB) を使用してデータのクエリを実行します。</span><span class="sxs-lookup"><span data-stu-id="cfe15-104">Querying Data with the SqlDataSource Control (VB)</span></span>
====================
<span data-ttu-id="cfe15-105">によって[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="cfe15-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="cfe15-106">[サンプル アプリをダウンロード](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_47_VB.exe)または[PDF のダウンロード](querying-data-with-the-sqldatasource-control-vb/_static/datatutorial47vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="cfe15-106">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_47_VB.exe) or [Download PDF](querying-data-with-the-sqldatasource-control-vb/_static/datatutorial47vb1.pdf)</span></span>

> <span data-ttu-id="cfe15-107">前のチュートリアルでは、ObjectDataSource コントロールを使用して、データ アクセス層からプレゼンテーション層を完全に分離します。</span><span class="sxs-lookup"><span data-stu-id="cfe15-107">In the preceding tutorials we used the ObjectDataSource control to fully separate the presentation layer from the Data Access layer.</span></span> <span data-ttu-id="cfe15-108">SqlDataSource コントロールを使用して、単純なアプリケーションのプレゼンテーションとデータ アクセスの厳密な分離を必要としない方法を学習お以降このチュートリアルでは、します。</span><span class="sxs-lookup"><span data-stu-id="cfe15-108">Starting with this tutorial, we learn how the SqlDataSource control can be used for simple applications that do not require such a strict separation of presentation and data access.</span></span>


## <a name="introduction"></a><span data-ttu-id="cfe15-109">はじめに</span><span class="sxs-lookup"><span data-stu-id="cfe15-109">Introduction</span></span>

<span data-ttu-id="cfe15-110">すべてのチュートリアルでは、お解析してきた ve プレゼンテーション、ビジネス ロジックとデータ アクセス レイヤーで構成される階層化されたアーキテクチャを使用します。</span><span class="sxs-lookup"><span data-stu-id="cfe15-110">All of the tutorials we ve examined so far have used a tiered architecture consisting of presentation, Business Logic, and Data Access layers.</span></span> <span data-ttu-id="cfe15-111">データ アクセス層 (DAL) を最初のチュートリアルで作成された ([データ アクセス レイヤーを作成する](../introduction/creating-a-data-access-layer-vb.md)) と、ビジネス ロジック層、2 つ目の ([ビジネス ロジック層を作成する](../introduction/creating-a-business-logic-layer-vb.md))。</span><span class="sxs-lookup"><span data-stu-id="cfe15-111">The Data Access Layer (DAL) was crafted in the first tutorial ([Creating a Data Access Layer](../introduction/creating-a-data-access-layer-vb.md)) and the Business Logic Layer in the second ([Creating a Business Logic Layer](../introduction/creating-a-business-logic-layer-vb.md)).</span></span> <span data-ttu-id="cfe15-112">以降で、 [、ObjectDataSource でデータを表示する](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md)チュートリアルでは、ASP.NET 2.0 s の新しい ObjectDataSource コントロールを使用して、プレゼンテーション層からのアーキテクチャを持つインターフェイスの宣言する方法を説明しました。</span><span class="sxs-lookup"><span data-stu-id="cfe15-112">Starting with the [Displaying Data With the ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md) tutorial, we saw how to use ASP.NET 2.0 s new ObjectDataSource control to declaratively interface with the architecture from the presentation layer.</span></span>

<span data-ttu-id="cfe15-113">データを操作するすべてのチュートリアルはこれまでのアーキテクチャを使用して、アクセス、挿入、更新、およびアーキテクチャをバイパスして、ASP.NET ページから直接データベースのデータを削除することはもです。</span><span class="sxs-lookup"><span data-stu-id="cfe15-113">While all of the tutorials so far have used the architecture to work with data, it is also possible to access, insert, update, and delete database data directly from an ASP.NET page, bypassing the architecture.</span></span> <span data-ttu-id="cfe15-114">これにより、web ページに直接特定のデータベースのクエリやビジネス ロジックを配置します。</span><span class="sxs-lookup"><span data-stu-id="cfe15-114">Doing so places the specific database queries and business logic directly in the web page.</span></span> <span data-ttu-id="cfe15-115">十分に大規模または複雑なアプリケーションの場合、設計、実装、および階層化されたアーキテクチャを使用するが、成功した場合、更新、およびアプリケーションの保守容易性のきわめて重要です。</span><span class="sxs-lookup"><span data-stu-id="cfe15-115">For sufficiently large or complex applications, designing, implementing, and using a tiered architecture is vitally important for the success, updatability, and maintainability of the application.</span></span> <span data-ttu-id="cfe15-116">堅牢なアーキテクチャの開発、ただし、必要がありますいない非常に単純な 1 回限りのアプリケーションを作成するときにします。</span><span class="sxs-lookup"><span data-stu-id="cfe15-116">Developing a robust architecture, however, may be unnecessary when creating exceedingly simple, one-off applications.</span></span>

<span data-ttu-id="cfe15-117">ASP.NET 2.0 には 5 つの組み込みデータ ソース コントロール[SqlDataSource](https://msdn.microsoft.com/library/dz12d98w%28vs.80%29.aspx)、 [AccessDataSource](https://msdn.microsoft.com/library/8e5545e1.aspx)、 [ObjectDataSource](https://msdn.microsoft.com/library/9a4kyhcx.aspx)、 [XmlDataSource](https://msdn.microsoft.com/library/e8d8587a%28en-US,VS.80%29.aspx)、および[SiteMapDataSource](https://msdn.microsoft.com/library/5ex9t96x%28en-US,VS.80%29.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="cfe15-117">ASP.NET 2.0 provides five built-in data source controls [SqlDataSource](https://msdn.microsoft.com/library/dz12d98w%28vs.80%29.aspx), [AccessDataSource](https://msdn.microsoft.com/library/8e5545e1.aspx), [ObjectDataSource](https://msdn.microsoft.com/library/9a4kyhcx.aspx), [XmlDataSource](https://msdn.microsoft.com/library/e8d8587a%28en-US,VS.80%29.aspx), and [SiteMapDataSource](https://msdn.microsoft.com/library/5ex9t96x%28en-US,VS.80%29.aspx).</span></span> <span data-ttu-id="cfe15-118">アクセスして、Microsoft SQL Server、Microsoft Access、Oracle、MySQL、および他のユーザーを含む、リレーショナル データベースから直接データを変更するは、SqlDataSource を使用できます。</span><span class="sxs-lookup"><span data-stu-id="cfe15-118">The SqlDataSource can be used to access and modify data directly from a relational database, including Microsoft SQL Server, Microsoft Access, Oracle, MySQL, and others.</span></span> <span data-ttu-id="cfe15-119">このチュートリアルと、次の 3 つの場合は、SqlDataSource コントロールの使用、挿入、更新、およびデータの削除を照会する方法とフィルター データだけでなくを SqlDataSource を使用する方法を調査する方法について確認します。</span><span class="sxs-lookup"><span data-stu-id="cfe15-119">In this tutorial and the next three, we'll examine how to work with the SqlDataSource control, exploring how to query and filter database data, as well as how to use the SqlDataSource to insert, update, and delete data.</span></span>


![ASP.NET 2.0 には、5 つの組み込みのデータ ソース コントロールが含まれています。](querying-data-with-the-sqldatasource-control-vb/_static/image1.gif)

<span data-ttu-id="cfe15-121">**図 1**: ASP.NET 2.0 には、5 つの組み込みのデータ ソース コントロールが含まれています。</span><span class="sxs-lookup"><span data-stu-id="cfe15-121">**Figure 1**: ASP.NET 2.0 Includes Five Built-In Data Source Controls</span></span>


## <a name="comparing-the-objectdatasource-and-sqldatasource"></a><span data-ttu-id="cfe15-122">ObjectDataSource と SqlDataSource の比較</span><span class="sxs-lookup"><span data-stu-id="cfe15-122">Comparing the ObjectDataSource and SqlDataSource</span></span>

<span data-ttu-id="cfe15-123">概念的には、ObjectDataSource と SqlDataSource コントロールは、データをプロキシするだけです。</span><span class="sxs-lookup"><span data-stu-id="cfe15-123">Conceptually, both the ObjectDataSource and SqlDataSource controls are simply proxies to data.</span></span> <span data-ttu-id="cfe15-124">説明したように、 [、ObjectDataSource でデータを表示する](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md)チュートリアルでは、ObjectDataSource が挿入、更新、およびデータを削除するデータとを選択するために呼び出すメソッドを提供するオブジェクトの種類を示すプロパティオブジェクトの基になる型。</span><span class="sxs-lookup"><span data-stu-id="cfe15-124">As discussed in the [Displaying Data With the ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md) tutorial, the ObjectDataSource has properties that indicate the object type that provides the data and the methods to invoke to select, insert, update, and delete data from the underlying object type.</span></span> <span data-ttu-id="cfe15-125">ObjectDataSource s を使用して、コントロールにデータ GridView、DetailsView、DataList などの Web コントロールをバインドできます、ObjectDataSource プロパティが構成されると、 `Select()`、 `Insert()`、 `Delete()`、および`Update()`メソッド基になるアーキテクチャと対話します。</span><span class="sxs-lookup"><span data-stu-id="cfe15-125">Once the ObjectDataSource s properties have been configured, a data Web control such as a GridView, DetailsView, or DataList can be bound to the control, using the ObjectDataSource s `Select()`, `Insert()`, `Delete()`, and `Update()` methods to interact with the underlying architecture.</span></span>

<span data-ttu-id="cfe15-126">SqlDataSource は同様の機能を提供しますが、オブジェクト ライブラリではなく、リレーショナル データベースに作用します。</span><span class="sxs-lookup"><span data-stu-id="cfe15-126">The SqlDataSource provides the same functionality, but operates against a relational database rather than an object library.</span></span> <span data-ttu-id="cfe15-127">SqlDataSource おは、データベース接続文字列とアドホック SQL クエリを指定する必要があります。 またはストアド プロシージャを挿入、更新、削除、およびデータを取得するために実行できます。</span><span class="sxs-lookup"><span data-stu-id="cfe15-127">With the SqlDataSource, we must specify the database connection string and the ad-hoc SQL queries or stored procedures to execute to insert, update, delete, and retrieve data.</span></span> <span data-ttu-id="cfe15-128">SqlDataSource s `Select()`、 `Insert()`、 `Update()`、および`Delete()`呼び出されると、指定したデータベースへの接続し、適切な SQL クエリを発行します。</span><span class="sxs-lookup"><span data-stu-id="cfe15-128">The SqlDataSource s `Select()`, `Insert()`, `Update()`, and `Delete()` methods, when invoked, connect to the specified database and issue the appropriate SQL query.</span></span> <span data-ttu-id="cfe15-129">次の図に示すように、これらのメソッドは、データベースへの接続、クエリを発行して、結果を返すの grunt 作業を行います。</span><span class="sxs-lookup"><span data-stu-id="cfe15-129">As the following diagram illustrates, the these methods do the grunt work of connecting to a database, issuing a query, and returning the results.</span></span>


![SqlDataSource は、データベースへのプロキシとして機能します。](querying-data-with-the-sqldatasource-control-vb/_static/image2.gif)

<span data-ttu-id="cfe15-131">**図 2**: SqlDataSource は、データベースへのプロキシとして機能</span><span class="sxs-lookup"><span data-stu-id="cfe15-131">**Figure 2**: The SqlDataSource Serves as a Proxy to the Database</span></span>


> [!NOTE]
> <span data-ttu-id="cfe15-132">このチュートリアルでは、データベースからデータを取得中に注目します。</span><span class="sxs-lookup"><span data-stu-id="cfe15-132">In this tutorial we'll focus on retrieving data from the database.</span></span> <span data-ttu-id="cfe15-133">[挿入、更新、および SqlDataSource コントロールにデータを削除しても](inserting-updating-and-deleting-data-with-the-sqldatasource-vb.md)チュートリアルでは、挿入、更新、および削除をサポートするために SqlDataSource を構成する方法を見てみましょう。</span><span class="sxs-lookup"><span data-stu-id="cfe15-133">In the [Inserting, Updating, and Deleteing Data with the SqlDataSource Control](inserting-updating-and-deleting-data-with-the-sqldatasource-vb.md) tutorial, we'll see how to configure the SqlDataSource to support inserting, updating, and deleting.</span></span>


## <a name="the-sqldatasource-and-accessdatasource-controls"></a><span data-ttu-id="cfe15-134">SqlDataSource と AccessDataSource コントロール</span><span class="sxs-lookup"><span data-stu-id="cfe15-134">The SqlDataSource and AccessDataSource Controls</span></span>

<span data-ttu-id="cfe15-135">ASP.NET 2.0 には、SqlDataSource コントロールだけでなく、AccessDataSource コントロールも含まれています。</span><span class="sxs-lookup"><span data-stu-id="cfe15-135">In addition to the SqlDataSource control, ASP.NET 2.0 also includes an AccessDataSource control.</span></span> <span data-ttu-id="cfe15-136">これら 2 つのコントロールが生じる AccessDataSource コントロールがのみ Microsoft SQL Server と連携するように設計 SqlDataSource コントロールと Microsoft Access で排他的に作られていることが問題ありに ASP.NET 2.0 に新しい多くの開発者。</span><span class="sxs-lookup"><span data-stu-id="cfe15-136">These two different controls lead many developers new to ASP.NET 2.0 to suspect that the AccessDataSource control is designed to work exclusively with Microsoft Access with the SqlDataSource control designed to work exclusively with Microsoft SQL Server.</span></span> <span data-ttu-id="cfe15-137">SqlDataSource コントロールが連動する、AccessDataSource が Microsoft Access を具体的に使用するように設計中に*任意*.NET 経由でアクセスできるリレーショナル データベースです。</span><span class="sxs-lookup"><span data-stu-id="cfe15-137">While the AccessDataSource is designed to work specifically with Microsoft Access, the SqlDataSource control works with *any* relational database that can be accessed through .NET.</span></span> <span data-ttu-id="cfe15-138">これには、ole Db または ODBC の準拠データ ストア、Microsoft SQL Server、Microsoft Access、Oracle、Informix、MySQL、PostgreSQL などその他の多くが含まれます。</span><span class="sxs-lookup"><span data-stu-id="cfe15-138">This includes any OleDb- or ODBC-compliant data stores, such as Microsoft SQL Server, Microsoft Access, Oracle, Informix, MySQL, and PostgreSQL, among many others.</span></span>

<span data-ttu-id="cfe15-139">唯一の違い、AccessDataSource および SqlDataSource コントロールは、データベースの接続情報を指定する方法です。</span><span class="sxs-lookup"><span data-stu-id="cfe15-139">The sole difference between the AccessDataSource and SqlDataSource controls is how the database connection information is specified.</span></span> <span data-ttu-id="cfe15-140">AccessDataSource コントロールには、Access データベース ファイルへのファイル パスだけが必要があります。</span><span class="sxs-lookup"><span data-stu-id="cfe15-140">The AccessDataSource control needs just the file path to the Access database file.</span></span> <span data-ttu-id="cfe15-141">SqlDataSource には、その一方で、完全な接続文字列が必要です。</span><span class="sxs-lookup"><span data-stu-id="cfe15-141">The SqlDataSource, on the other hand, requires a complete connection string.</span></span>

## <a name="step-1-creating-the-sqldatasource-web-pages"></a><span data-ttu-id="cfe15-142">手順 1: SqlDataSource Web ページの作成</span><span class="sxs-lookup"><span data-stu-id="cfe15-142">Step 1: Creating the SqlDataSource Web Pages</span></span>

<span data-ttu-id="cfe15-143">SqlDataSource コントロールを使用してデータベースのデータを直接操作する方法の探索を開始して、前に、まず、このチュートリアルと、次の 3 つの必要がありますを web サイト プロジェクトに、ASP.NET ページを作成するのにはしばらく s を使用できます。</span><span class="sxs-lookup"><span data-stu-id="cfe15-143">Before we start exploring how to work directly with database data using the SqlDataSource control, let s first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial and the next three.</span></span> <span data-ttu-id="cfe15-144">という名前の新しいフォルダーを追加することによって開始`SqlDataSource`です。</span><span class="sxs-lookup"><span data-stu-id="cfe15-144">Start by adding a new folder named `SqlDataSource`.</span></span> <span data-ttu-id="cfe15-145">次に、各ページに関連付けるように、そのフォルダーに次の ASP.NET ページを追加、`Site.master`マスター ページ。</span><span class="sxs-lookup"><span data-stu-id="cfe15-145">Next, add the following ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `Querying.aspx`
- `ParameterizedQueries.aspx`
- `InsertUpdateDelete.aspx`
- `OptimisticConcurrency.aspx`


![SqlDataSource に関連するチュートリアルについては、ASP.NET ページを追加します。](querying-data-with-the-sqldatasource-control-vb/_static/image3.gif)

<span data-ttu-id="cfe15-147">**図 3**: SqlDataSource に関連するチュートリアルについては、ASP.NET ページを追加します。</span><span class="sxs-lookup"><span data-stu-id="cfe15-147">**Figure 3**: Add the ASP.NET Pages for the SqlDataSource-Related Tutorials</span></span>


<span data-ttu-id="cfe15-148">などの他のフォルダーで`Default.aspx`で、`SqlDataSource`フォルダーは、チュートリアルのセクションに一覧表示します。</span><span class="sxs-lookup"><span data-stu-id="cfe15-148">Like in the other folders, `Default.aspx` in the `SqlDataSource` folder will list the tutorials in its section.</span></span> <span data-ttu-id="cfe15-149">注意してください、`SectionLevelTutorialListing.ascx`ユーザー コントロールは、この機能を提供します。</span><span class="sxs-lookup"><span data-stu-id="cfe15-149">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="cfe15-150">そのため、このユーザー コントロールを追加`Default.aspx`をページのデザイン ビューに、ソリューション エクスプ ローラーからドラッグしています。</span><span class="sxs-lookup"><span data-stu-id="cfe15-150">Therefore, add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page s Design view.</span></span>


<span data-ttu-id="cfe15-151">[![Default.aspx に SectionLevelTutorialListing.ascx ユーザー コントロールを追加します。](querying-data-with-the-sqldatasource-control-vb/_static/image5.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image4.gif)</span><span class="sxs-lookup"><span data-stu-id="cfe15-151">[![Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](querying-data-with-the-sqldatasource-control-vb/_static/image5.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image4.gif)</span></span>

<span data-ttu-id="cfe15-152">**図 4**: 追加、`SectionLevelTutorialListing.ascx`ユーザー コントロールを`Default.aspx`([フルサイズのイメージを表示するをクリックして](querying-data-with-the-sqldatasource-control-vb/_static/image6.gif))</span><span class="sxs-lookup"><span data-stu-id="cfe15-152">**Figure 4**: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](querying-data-with-the-sqldatasource-control-vb/_static/image6.gif))</span></span>


<span data-ttu-id="cfe15-153">最後に、これら 4 つのページを追加するエントリとして、`Web.sitemap`ファイル。</span><span class="sxs-lookup"><span data-stu-id="cfe15-153">Lastly, add these four pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="cfe15-154">具体的には、DataList とリピータにカスタム ボタンの追加後に、次のマークアップを追加`<siteMapNode>`:</span><span class="sxs-lookup"><span data-stu-id="cfe15-154">Specifically, add the following markup after the Adding Custom Buttons to the DataList and Repeater `<siteMapNode>`:</span></span>


[!code-sql[Main](querying-data-with-the-sqldatasource-control-vb/samples/sample1.sql)]

<span data-ttu-id="cfe15-155">更新した後に`Web.sitemap`ブラウザーを使って、チュートリアルの web サイトを表示します。</span><span class="sxs-lookup"><span data-stu-id="cfe15-155">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="cfe15-156">左側のメニューには、編集、挿入、およびチュートリアルを削除する項目が含まれています。</span><span class="sxs-lookup"><span data-stu-id="cfe15-156">The menu on the left now includes items for the editing, inserting, and deleting tutorials.</span></span>


![サイト マップでは SqlDataSource チュートリアルについては、エントリが含まれるようになりました](querying-data-with-the-sqldatasource-control-vb/_static/image7.gif)

<span data-ttu-id="cfe15-158">**図 5**: サイト マップでは SqlDataSource チュートリアルについては、エントリが含まれるようになりました</span><span class="sxs-lookup"><span data-stu-id="cfe15-158">**Figure 5**: The Site Map Now Includes Entries for the SqlDataSource Tutorials</span></span>


## <a name="step-2-adding-and-configuring-the-sqldatasource-control"></a><span data-ttu-id="cfe15-159">手順 2: 追加して、SqlDataSource コントロールを構成します。</span><span class="sxs-lookup"><span data-stu-id="cfe15-159">Step 2: Adding and Configuring the SqlDataSource Control</span></span>

<span data-ttu-id="cfe15-160">開いて開始、 `Querying.aspx`  ページで、`SqlDataSource`フォルダーとデザイン ビューに切り替えます。</span><span class="sxs-lookup"><span data-stu-id="cfe15-160">Start by opening the `Querying.aspx` page in the `SqlDataSource` folder and switch to Design view.</span></span> <span data-ttu-id="cfe15-161">SqlDataSource コントロールをドラッグして、ツールボックスからデザイナーとセットにその`ID`に`ProductsDataSource`です。</span><span class="sxs-lookup"><span data-stu-id="cfe15-161">Drag a SqlDataSource control from the Toolbox onto the Designer and set its `ID` to `ProductsDataSource`.</span></span> <span data-ttu-id="cfe15-162">同様に、ObjectDataSource SqlDataSource レンダリングされた出力を生成しないしたがってデザイン サーフェイス上の灰色のボックスとして表示されます。</span><span class="sxs-lookup"><span data-stu-id="cfe15-162">As with the ObjectDataSource, the SqlDataSource does not produce any rendered output and therefore appears as a gray box on the design surface.</span></span> <span data-ttu-id="cfe15-163">SqlDataSource を構成するのには、SqlDataSource s のスマート タグからのデータ ソースの構成のリンクをクリックします。</span><span class="sxs-lookup"><span data-stu-id="cfe15-163">To configure the SqlDataSource, click on the Configure Data Source link from the SqlDataSource s smart tag.</span></span>


![をクリックして、SqlDataSource s のスマート タグからのデータ ソースのリンクを構成します。](querying-data-with-the-sqldatasource-control-vb/_static/image8.gif)

<span data-ttu-id="cfe15-165">**図 6**: をクリックして、SqlDataSource s のスマート タグからのデータ ソースのリンクを構成します。</span><span class="sxs-lookup"><span data-stu-id="cfe15-165">**Figure 6**: Click on the Configure Data Source Link from the SqlDataSource s Smart Tag</span></span>


<span data-ttu-id="cfe15-166">SqlDataSource コントロールのデータ ソース構成ウィザードが表示されます。</span><span class="sxs-lookup"><span data-stu-id="cfe15-166">This brings up the SqlDataSource control s Configure Data Source wizard.</span></span> <span data-ttu-id="cfe15-167">ウィザードの手順は、ObjectDataSource コントロール s と異なる場合、終了な目標を取得、挿入、更新、およびデータ ソースを使用してデータを削除する方法の詳細を提供する、同じです。</span><span class="sxs-lookup"><span data-stu-id="cfe15-167">While the wizard s steps differ from the ObjectDataSource control s, the end goal is the same to provide the details on how to retrieve, insert, update, and delete data through the data source.</span></span> <span data-ttu-id="cfe15-168">SqlDataSource 用には、基になるデータベースを使用するを指定して、アドホック SQL ステートメントまたはストアド プロシージャを提供する必要があります。</span><span class="sxs-lookup"><span data-stu-id="cfe15-168">For the SqlDataSource this entails specifying the underlying database to use and providing the ad-hoc SQL statements or stored procedures.</span></span>

<span data-ttu-id="cfe15-169">ウィザードの最初の手順では、データベースに、私たちを求めます。</span><span class="sxs-lookup"><span data-stu-id="cfe15-169">The first wizard step prompts us for the database.</span></span> <span data-ttu-id="cfe15-170">ドロップダウン リストには、これらのデータベースについては、web アプリケーションの s が含まれています。`App_Data`フォルダーおよびサーバー エクスプ ローラーでデータ接続 ノードに追加されたものです。</span><span class="sxs-lookup"><span data-stu-id="cfe15-170">The drop-down list includes those databases found in the web application s `App_Data` folder and those that have been added to the Data Connections node in the Server Explorer.</span></span> <span data-ttu-id="cfe15-171">以降お ve は既に追加の接続文字列、`NORTHWIND.MDF`データベースに格納されて、 `App_Data` s プロジェクトにフォルダー`Web.config`ファイル、ドロップダウン リストには、その接続文字列への参照が含まれています。`NORTHWINDConnectionString`です。</span><span class="sxs-lookup"><span data-stu-id="cfe15-171">Since we ve already added a connection string for the `NORTHWIND.MDF` database in the `App_Data` folder to our project s `Web.config` file, the drop-down list includes a reference to that connection string, `NORTHWINDConnectionString`.</span></span> <span data-ttu-id="cfe15-172">ドロップダウン リストからこの項目を選択し、[次へ] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="cfe15-172">Choose this item from the drop-down list and click Next.</span></span>


![ドロップダウン リストから、NORTHWINDConnectionString を選択します。](querying-data-with-the-sqldatasource-control-vb/_static/image9.gif)

<span data-ttu-id="cfe15-174">**図 7**: 選択、`NORTHWINDConnectionString`ドロップダウン リストから</span><span class="sxs-lookup"><span data-stu-id="cfe15-174">**Figure 7**: Choose the `NORTHWINDConnectionString` from the Drop-Down List</span></span>


<span data-ttu-id="cfe15-175">データベースを選択すると、ウィザードはデータを返すクエリを要求します。</span><span class="sxs-lookup"><span data-stu-id="cfe15-175">After choosing the database, the wizard asks for the query to return data.</span></span> <span data-ttu-id="cfe15-176">列のテーブルまたはビューを返すまたはカスタム SQL ステートメントを入力したり、ストアド プロシージャを指定するかを指定できます。</span><span class="sxs-lookup"><span data-stu-id="cfe15-176">We can either specify the columns of a table or view to return or can enter a custom SQL statement or specify a stored procedure.</span></span> <span data-ttu-id="cfe15-177">この選択の指定を行う間を切り替える、カスタム SQL ステートメントまたはストアド プロシージャとテーブルから列を指定したり、オプション ボタンを表示できます。</span><span class="sxs-lookup"><span data-stu-id="cfe15-177">You can toggle between this choice through the Specify a custom SQL statement or stored procedure and Specify columns from a table or view radio buttons.</span></span>

> [!NOTE]
> <span data-ttu-id="cfe15-178">この最初の例テーブルまたはビューのオプションからを指定する列を使用して s を使用できます。</span><span class="sxs-lookup"><span data-stu-id="cfe15-178">For this first example, let s use the Specify columns from a table or view option.</span></span> <span data-ttu-id="cfe15-179">このチュートリアルの後半で、ウィザードに戻り、カスタム SQL ステートメントまたはストアド プロシージャ オプションの指定を調査します。</span><span class="sxs-lookup"><span data-stu-id="cfe15-179">We'll return to the wizard later in this tutorial and explore the Specify a custom SQL statement or stored procedure option.</span></span>


<span data-ttu-id="cfe15-180">図 8 画面を示しています、構成の Select ステートメントを選択するテーブルまたはビューのオプション ボタンから列を指定します。</span><span class="sxs-lookup"><span data-stu-id="cfe15-180">Figure 8 shows the Configure the Select Statement screen when the Specify columns from a table or view radio button is selected.</span></span> <span data-ttu-id="cfe15-181">ドロップダウン リストには、選択したテーブルまたはビューの列の下のチェック ボックスの一覧に表示されると、Northwind データベースのテーブルおよびビューのセットが含まれています。</span><span class="sxs-lookup"><span data-stu-id="cfe15-181">The drop-down list contains the set of tables and views in the Northwind database, with the selected table or view s columns displayed in the checkbox list below.</span></span> <span data-ttu-id="cfe15-182">この例では、let s を返す、 `ProductID`、 `ProductName`、および`UnitPrice`から列、`Products`テーブル。</span><span class="sxs-lookup"><span data-stu-id="cfe15-182">For this example, let s return the `ProductID`, `ProductName`, and `UnitPrice` columns from the `Products` table.</span></span> <span data-ttu-id="cfe15-183">図 8 に示す結果の SQL ステートメントが表示されたら、ウィザードでこれらの選択を行う`SELECT [ProductID], [ProductName], [UnitPrice] FROM [Products]`です。</span><span class="sxs-lookup"><span data-stu-id="cfe15-183">As Figure 8 shows, after making these selections the wizard shows the resulting SQL statement `SELECT [ProductID], [ProductName], [UnitPrice] FROM [Products]`.</span></span>


![Products テーブルからデータを返す](querying-data-with-the-sqldatasource-control-vb/_static/image10.gif)

<span data-ttu-id="cfe15-185">**図 8**: からデータを返す、`Products`テーブル</span><span class="sxs-lookup"><span data-stu-id="cfe15-185">**Figure 8**: Return Data from the `Products` Table</span></span>


<span data-ttu-id="cfe15-186">返す、ウィザードを構成した後、 `ProductID`、 `ProductName`、および`UnitPrice`からの列、`Products`テーブルで、[次へ] ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="cfe15-186">Once you have configured the wizard to return the `ProductID`, `ProductName`, and `UnitPrice` columns from the `Products` table, click the Next button.</span></span> <span data-ttu-id="cfe15-187">この最終画面では、前の手順から構成されているクエリの結果を確認する機会を提供します。</span><span class="sxs-lookup"><span data-stu-id="cfe15-187">This final screen provides an opportunity to examine the results of the query configured from the previous step.</span></span> <span data-ttu-id="cfe15-188">構成されたクエリのテスト ボタンをクリックすると実行`SELECT`ステートメントと、結果をグリッドに表示されます。</span><span class="sxs-lookup"><span data-stu-id="cfe15-188">Clicking the Test Query button executes the configured `SELECT` statement and displays the results in a grid.</span></span>


![SELECT クエリを確認するテスト クエリ ボタンをクリックします。](querying-data-with-the-sqldatasource-control-vb/_static/image11.gif)

<span data-ttu-id="cfe15-190">**図 9**: レビュー テスト クエリ ボタンをクリックして`SELECT`クエリ</span><span class="sxs-lookup"><span data-stu-id="cfe15-190">**Figure 9**: Click the Test Query Button to Review Your `SELECT` Query</span></span>


<span data-ttu-id="cfe15-191">ウィザードを完了するには、[完了] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="cfe15-191">To complete the wizard, click Finish.</span></span>

<span data-ttu-id="cfe15-192">ObjectDataSource を SqlDataSource のウィザードだけを実行値プロパティに割り当てられる、コントロール s、つまりと同じように、 [ `ConnectionString` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.connectionstring.aspx)と[ `SelectCommand` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.selectcommand.aspx)プロパティです。</span><span class="sxs-lookup"><span data-stu-id="cfe15-192">Like with the ObjectDataSource, the SqlDataSource s wizard merely assigns values to the control s properties, namely the [`ConnectionString`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.connectionstring.aspx) and [`SelectCommand`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.selectcommand.aspx) properties.</span></span> <span data-ttu-id="cfe15-193">ウィザードを完了すると、SqlDataSource コントロール s 宣言型マークアップを次のようになります。</span><span class="sxs-lookup"><span data-stu-id="cfe15-193">After completing the wizard, your SqlDataSource control s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](querying-data-with-the-sqldatasource-control-vb/samples/sample2.aspx)]

<span data-ttu-id="cfe15-194">`ConnectionString`プロパティは、データベースに接続する方法に関する情報を提供します。</span><span class="sxs-lookup"><span data-stu-id="cfe15-194">The `ConnectionString` property provides information on how to connect to the database.</span></span> <span data-ttu-id="cfe15-195">このプロパティは、完全なハード コーディングされた接続文字列の値を割り当てることができるか、内の接続文字列を指すことができます`Web.config`です。</span><span class="sxs-lookup"><span data-stu-id="cfe15-195">This property can be assigned a complete, hard-coded connection string value or can point to a connection string in `Web.config`.</span></span> <span data-ttu-id="cfe15-196">Web.config で接続文字列の値を参照する構文を使用`<%$ expressionPrefix:expressionValue %>`です。</span><span class="sxs-lookup"><span data-stu-id="cfe15-196">To reference a connection string value in Web.config, use the syntax `<%$ expressionPrefix:expressionValue %>`.</span></span> <span data-ttu-id="cfe15-197">通常、*されて*は ConnectionStrings および*expressionValue* 、接続文字列での名前を指定、 `Web.config` [ `<connectionStrings>`セクション](https://msdn.microsoft.com/library/bf7sd233.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="cfe15-197">Typically, *expressionPrefix* is ConnectionStrings and *expressionValue* is the name of the connect string in the `Web.config` [`<connectionStrings>` section](https://msdn.microsoft.com/library/bf7sd233.aspx).</span></span> <span data-ttu-id="cfe15-198">ただし、構文を使用することができますを参照する`<appSettings>`要素またはリソース ファイルからのコンテンツ。</span><span class="sxs-lookup"><span data-stu-id="cfe15-198">However, the syntax can be used to reference `<appSettings>` elements or content from resource files.</span></span> <span data-ttu-id="cfe15-199">参照してください[ASP.NET 式の概要](https://msdn.microsoft.com/library/d5bd1tad.aspx)詳細構文を使用します。</span><span class="sxs-lookup"><span data-stu-id="cfe15-199">See [ASP.NET Expressions Overview](https://msdn.microsoft.com/library/d5bd1tad.aspx) for more on this syntax.</span></span>

<span data-ttu-id="cfe15-200">`SelectCommand`プロパティは、アドホック SQL ステートメントまたはデータを返すに実行するストアド プロシージャを指定します。</span><span class="sxs-lookup"><span data-stu-id="cfe15-200">The `SelectCommand` property specifies the ad-hoc SQL statement or stored procedure to execute to return the data.</span></span>

## <a name="step-3-adding-a-data-web-control-and-binding-it-to-the-sqldatasource"></a><span data-ttu-id="cfe15-201">手順 3: データ Web コントロールの追加と SqlDataSource へのバインド</span><span class="sxs-lookup"><span data-stu-id="cfe15-201">Step 3: Adding a Data Web Control and Binding it to the SqlDataSource</span></span>

<span data-ttu-id="cfe15-202">SqlDataSource が構成されるは、データ、GridView または DetailsView などの Web コントロールにバインドできます。</span><span class="sxs-lookup"><span data-stu-id="cfe15-202">Once the SqlDataSource has been configured, it can be bound to a data Web control, such as a GridView or DetailsView.</span></span> <span data-ttu-id="cfe15-203">このチュートリアルでは、s、GridView にデータを表示を使用できます。</span><span class="sxs-lookup"><span data-stu-id="cfe15-203">For this tutorial, let s display the data in a GridView.</span></span> <span data-ttu-id="cfe15-204">ツールボックスから、ページにドラッグ、GridView とにバインド、 `ProductsDataSource` SqlDataSource GridView s のスマート タグのドロップ ダウン リストから、データ ソースを選択しています。</span><span class="sxs-lookup"><span data-stu-id="cfe15-204">From the Toolbox, drag a GridView onto the page and bind it to the `ProductsDataSource` SqlDataSource by choosing the data source from the drop-down list in the GridView s smart tag.</span></span>


<span data-ttu-id="cfe15-205">[![GridView を追加し、SqlDataSource コントロールにバインド](querying-data-with-the-sqldatasource-control-vb/_static/image13.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image12.gif)</span><span class="sxs-lookup"><span data-stu-id="cfe15-205">[![Add a GridView and Bind it to the SqlDataSource Control](querying-data-with-the-sqldatasource-control-vb/_static/image13.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image12.gif)</span></span>

<span data-ttu-id="cfe15-206">**図 10**: GridView を追加し、SqlDataSource コントロールにバインド ([フルサイズのイメージを表示するをクリックして](querying-data-with-the-sqldatasource-control-vb/_static/image14.gif))</span><span class="sxs-lookup"><span data-stu-id="cfe15-206">**Figure 10**: Add a GridView and Bind it to the SqlDataSource Control ([Click to view full-size image](querying-data-with-the-sqldatasource-control-vb/_static/image14.gif))</span></span>


<span data-ttu-id="cfe15-207">GridView s のスマート タグのドロップダウン リストにしているが SqlDataSource コントロールを選択すると、Visual Studio が自動的に追加 BoundField または CheckBoxField GridView にデータ ソース コントロールによって返される列の各します。</span><span class="sxs-lookup"><span data-stu-id="cfe15-207">Once you ve selected the SqlDataSource control from the drop-down list in the GridView s smart tag, Visual Studio will automatically add a BoundField or CheckBoxField to the GridView for each of the columns returned by the data source control.</span></span> <span data-ttu-id="cfe15-208">SqlDataSource が 3 つのデータベースの列を返すので`ProductID`、 `ProductName`、および`UnitPrice`GridView に 3 つのフィールドがあります。</span><span class="sxs-lookup"><span data-stu-id="cfe15-208">Since the SqlDataSource returns three database columns `ProductID`, `ProductName`, and `UnitPrice` there are three fields in the GridView.</span></span>

<span data-ttu-id="cfe15-209">GridView の 3 を構成するのにはしばらく時間かかる BoundFields です。</span><span class="sxs-lookup"><span data-stu-id="cfe15-209">Take a moment to configure the GridView s three BoundFields.</span></span> <span data-ttu-id="cfe15-210">変更、`ProductName`フィールド s`HeaderText`プロパティを製品名、`UnitPrice`フィールドの価格にします。</span><span class="sxs-lookup"><span data-stu-id="cfe15-210">Change the `ProductName` field s `HeaderText` property to Product Name and the `UnitPrice` field s to Price.</span></span> <span data-ttu-id="cfe15-211">書式設定も、`UnitPrice`通貨としてフィールドです。</span><span class="sxs-lookup"><span data-stu-id="cfe15-211">Also format the `UnitPrice` field as a currency.</span></span> <span data-ttu-id="cfe15-212">このような変更を加えたら、GridView s の宣言型マークアップを次のようになります。</span><span class="sxs-lookup"><span data-stu-id="cfe15-212">After making these modifications, your GridView s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](querying-data-with-the-sqldatasource-control-vb/samples/sample3.aspx)]

<span data-ttu-id="cfe15-213">ブラウザーからこのページを参照してください。</span><span class="sxs-lookup"><span data-stu-id="cfe15-213">Visit this page through a browser.</span></span> <span data-ttu-id="cfe15-214">GridView に秒の各製品が一覧表示図 11 に示す`ProductID`、 `ProductName`、および`UnitPrice`値。</span><span class="sxs-lookup"><span data-stu-id="cfe15-214">As Figure 11 shows, the GridView lists each product s `ProductID`, `ProductName`, and `UnitPrice` values.</span></span>


<span data-ttu-id="cfe15-215">[![GridView は、各製品の ProductID、ProductName、および UnitPrice の値が表示されます。](querying-data-with-the-sqldatasource-control-vb/_static/image16.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image15.gif)</span><span class="sxs-lookup"><span data-stu-id="cfe15-215">[![The GridView Displays Each Product s ProductID, ProductName, and UnitPrice Values](querying-data-with-the-sqldatasource-control-vb/_static/image16.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image15.gif)</span></span>

<span data-ttu-id="cfe15-216">**図 11**:「GridView 表示各製品の s `ProductID`、 `ProductName`、および`UnitPrice`値 ([フルサイズ イメージを表示するに、をクリックして](querying-data-with-the-sqldatasource-control-vb/_static/image17.gif))</span><span class="sxs-lookup"><span data-stu-id="cfe15-216">**Figure 11**: The GridView Displays Each Product s `ProductID`, `ProductName`, and `UnitPrice` Values ([Click to view full-size image](querying-data-with-the-sqldatasource-control-vb/_static/image17.gif))</span></span>


<span data-ttu-id="cfe15-217">GridView がそのデータ ソース コントロール s を呼び出すページにアクセスするときに`Select()`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="cfe15-217">When the page is visited the GridView invokes its data source control s `Select()` method.</span></span> <span data-ttu-id="cfe15-218">ObjectDataSource コントロールを使用していた私たちは、ときにこれを呼び出す、`ProductsBLL`クラスの`GetProducts()`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="cfe15-218">When we were using the ObjectDataSource control, this called the `ProductsBLL` class s `GetProducts()` method.</span></span> <span data-ttu-id="cfe15-219">ただし、SqlDataSource による、`Select()`メソッドが、指定されたデータベースと問題への接続を確立、 `SelectCommand` (`SELECT [ProductID], [ProductName], [UnitPrice] FROM [Products]`、この例では)。</span><span class="sxs-lookup"><span data-stu-id="cfe15-219">With the SqlDataSource, however, the `Select()` method establishes a connection to the specified database and issues the `SelectCommand` (`SELECT [ProductID], [ProductName], [UnitPrice] FROM [Products]`, in this example).</span></span> <span data-ttu-id="cfe15-220">SqlDataSource では、GridView しを列挙する、返されるデータベースのレコードを GridView の行を作成する結果を返します。</span><span class="sxs-lookup"><span data-stu-id="cfe15-220">The SqlDataSource returns its results which the GridView then enumerates, creating a row in the GridView for each database record returned.</span></span>

## <a name="the-built-in-data-web-control-features-and-the-sqldatasource-control"></a><span data-ttu-id="cfe15-221">組み込みのデータの Web コントロールの機能と、SqlDataSource コントロール</span><span class="sxs-lookup"><span data-stu-id="cfe15-221">The Built-In Data Web Control Features and the SqlDataSource Control</span></span>

<span data-ttu-id="cfe15-222">一般に、Web コントロールのページング、並べ替え、編集、データに固有の機能データ Web コントロールに固有の削除、挿入、およびなどとは、データ ソース コントロールの使用に依存しません。</span><span class="sxs-lookup"><span data-stu-id="cfe15-222">In general, the features inherent to the data Web controls paging, sorting, editing, deleting, inserting, and so on are specific to the data Web control and are not dependent on the data source control used.</span></span> <span data-ttu-id="cfe15-223">つまり、GridView は、ページング、並べ替え、編集、および、ObjectDataSource または、SqlDataSource にバインドされているかどうかを削除すると、その組み込みを利用できます。</span><span class="sxs-lookup"><span data-stu-id="cfe15-223">That is, the GridView can utilize its built-in paging, sorting, editing, and deleting whether it is bound to an ObjectDataSource or a SqlDataSource.</span></span> <span data-ttu-id="cfe15-224">ただし、Web コントロールの機能は、特定のデータは、データ ソース コントロールの構成または使用されているデータ ソース コントロールに機密性の高いです。</span><span class="sxs-lookup"><span data-stu-id="cfe15-224">However, certain data Web control features are sensitive to the data source control being used or to the data source control s configuration.</span></span>

<span data-ttu-id="cfe15-225">たとえば、[効率的にから大規模な量のデータのページング](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-vb.md)、既定では、Web データのページングのロジックを制御する方法単純返しますに説明したチュートリアル*すべて*から基になるレコードデータ ソースし、データの現在のページ インデックスと 1 ページに表示するレコードの数を指定されたレコードの適切なサブセットのみが表示されます。</span><span class="sxs-lookup"><span data-stu-id="cfe15-225">For example, in the [Efficiently Paging Through Large Amounts of Data](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-vb.md) tutorial we discussed how, by default, the paging logic for the data Web controls naively returns *all* records from the underlying data source and then displays only the appropriate subset of records given the current page index and the number of records to display per page.</span></span> <span data-ttu-id="cfe15-226">十分に大きな結果セットをページングするとき、このモデルは非常に効率的ではありません。</span><span class="sxs-lookup"><span data-stu-id="cfe15-226">This model is highly inefficient when paging through sufficiently large result sets.</span></span> <span data-ttu-id="cfe15-227">さいわい、表示するレコードの正確なサブセットのみを返す、カスタム ページングをサポートするために、ObjectDataSource を構成できます。</span><span class="sxs-lookup"><span data-stu-id="cfe15-227">Fortunately, the ObjectDataSource can be configured to support custom paging, which returns only the precise subset of records to display.</span></span> <span data-ttu-id="cfe15-228">ただし、SqlDataSource コントロールには、カスタム ページングを実装するためのプロパティが不足しています。</span><span class="sxs-lookup"><span data-stu-id="cfe15-228">The SqlDataSource control, however, lacks the properties for implementing custom paging.</span></span>

<span data-ttu-id="cfe15-229">ページングや並べ替えを他の注意は、SqlDataSource で発生します。</span><span class="sxs-lookup"><span data-stu-id="cfe15-229">Another subtlety with paging and sorting arises with the SqlDataSource.</span></span> <span data-ttu-id="cfe15-230">既定では、SqlDataSource から返されたデータ ページしたり GridView で並べ替えられます。</span><span class="sxs-lookup"><span data-stu-id="cfe15-230">By default, the data returned from a SqlDataSource can be paged or sorted through the GridView.</span></span> <span data-ttu-id="cfe15-231">これを示すためには、GridView s スマート タグでページングを有効にして、並べ替えを有効にするオプションを確認して`Querying.aspx`これは予想どおりことを確認してください。</span><span class="sxs-lookup"><span data-stu-id="cfe15-231">To demonstrate this, check the Enable Paging and Enable Sorting options in the GridView s smart tag in `Querying.aspx` and verify that this works as expected.</span></span>

<span data-ttu-id="cfe15-232">並べ替えとページングは、SqlDataSource 疎に型指定されたデータセットに、データベースのデータを取得するためには機能します。</span><span class="sxs-lookup"><span data-stu-id="cfe15-232">Sorting and paging works because the SqlDataSource retrieves the database data into a loosely-typed DataSet.</span></span> <span data-ttu-id="cfe15-233">クエリによって返される、重要な側面にページングを実装するレコードの合計数は、データセットから確認できます。</span><span class="sxs-lookup"><span data-stu-id="cfe15-233">The total number of records returned by the query an essential aspect to implementing paging can be ascertained from the DataSet.</span></span> <span data-ttu-id="cfe15-234">さらに、データセットの結果は、DataView を並べ替えることができます。</span><span class="sxs-lookup"><span data-stu-id="cfe15-234">Additionally, the DataSet s results can be sorted through a DataView.</span></span> <span data-ttu-id="cfe15-235">これらの機能は、GridView 要求ページまたはデータを並べ替えるときに自動的に SqlDataSource によって使用されます。</span><span class="sxs-lookup"><span data-stu-id="cfe15-235">These capabilities are automatically used by the SqlDataSource when the GridView requests paged or sorted data.</span></span>

<span data-ttu-id="cfe15-236">変更することによって、データセットではなく DataReader を返す、SqlDataSource を構成することができます、 [ `DataSourceMode`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.datasourcemode.aspx)から`DataSet`(既定) に`DataReader`です。</span><span class="sxs-lookup"><span data-stu-id="cfe15-236">The SqlDataSource can be configured to return a DataReader instead of a DataSet by changing its [`DataSourceMode` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.datasourcemode.aspx) from `DataSet` (the default) to `DataReader`.</span></span> <span data-ttu-id="cfe15-237">SqlDataSource の結果を DataReader を期待している既存のコードに渡すときの状況で DataReader を使用してを優先可能性があります。</span><span class="sxs-lookup"><span data-stu-id="cfe15-237">Using a DataReader might be preferred in situations when passing the SqlDataSource s results to existing code that expects a DataReader.</span></span> <span data-ttu-id="cfe15-238">さらに、Datareader がデータセットよりもはるかに単純なオブジェクトであるため、優れたパフォーマンスを提供します。</span><span class="sxs-lookup"><span data-stu-id="cfe15-238">Furthermore, since DataReaders are considerably simpler objects than DataSets, they offer better performance.</span></span> <span data-ttu-id="cfe15-239">この変更を行うと、ただし、データ Web コントロールを並べ替えることができますもでない場合は、SqlDataSource、クエリによって返されるレコードの数を確認することはできませんまたは DataReader からのページが返されるデータを並べ替えるためのすべての手法を提供します。</span><span class="sxs-lookup"><span data-stu-id="cfe15-239">If you make this change, however, the data Web control can neither sort nor page since the SqlDataSource cannot ascertain how many records are returned by the query, nor does the DataReader offer any techniques for sorting the returned data.</span></span>

## <a name="step-4-using-a-custom-sql-statement-or-stored-procedure"></a><span data-ttu-id="cfe15-240">手順 4: カスタム SQL ステートメントを使用してストアド プロシージャまたは</span><span class="sxs-lookup"><span data-stu-id="cfe15-240">Step 4: Using a Custom SQL Statement or Stored Procedure</span></span>

<span data-ttu-id="cfe15-241">SqlDataSource コントロールを構成するときに、カスタム SQL ステートメントまたはストアド プロシージャ、または既存のテーブルまたはビューから列としてデータを返すために使用するクエリは 2 つの方法のいずれかで指定できます。</span><span class="sxs-lookup"><span data-stu-id="cfe15-241">When configuring the SqlDataSource control, the query used to return data can be specified in one of two approaches as a custom SQL statement or stored procedure, or as columns from an existing table or view.</span></span> <span data-ttu-id="cfe15-242">手順 2. を調べることでから列を選択、`Products`テーブル。</span><span class="sxs-lookup"><span data-stu-id="cfe15-242">In Step 2 we examined selecting columns from the `Products` table.</span></span> <span data-ttu-id="cfe15-243">カスタム SQL ステートメントを使用して見て s を使用できます。</span><span class="sxs-lookup"><span data-stu-id="cfe15-243">Let s look at using a custom SQL statement.</span></span>

<span data-ttu-id="cfe15-244">別の GridView コントロールの追加、`Querying.aspx`ページし、スマート タグのドロップダウン リストから新しいデータ ソースを作成します。</span><span class="sxs-lookup"><span data-stu-id="cfe15-244">Add another GridView control to the `Querying.aspx` page and choose to create a new data source from the drop-down list in the smart tag.</span></span> <span data-ttu-id="cfe15-245">次に、指定するデータ プルされ、データベースからこの新しい SqlDataSource コントロールを作成します。</span><span class="sxs-lookup"><span data-stu-id="cfe15-245">Next, indicate that the data will be pulled from a database this will create a new SqlDataSource control.</span></span> <span data-ttu-id="cfe15-246">コントロールの名前を付けます`ProductsWithCategoryInfoDataSource`です。</span><span class="sxs-lookup"><span data-stu-id="cfe15-246">Name the control `ProductsWithCategoryInfoDataSource`.</span></span>


![ProductsWithCategoryInfoDataSource をという名前の新しい SqlDataSource コントロールを作成します。](querying-data-with-the-sqldatasource-control-vb/_static/image18.gif)

<span data-ttu-id="cfe15-248">**図 12**: という名前の新しい SqlDataSource コントロールを作成します。 `ProductsWithCategoryInfoDataSource`</span><span class="sxs-lookup"><span data-stu-id="cfe15-248">**Figure 12**: Create a New SqlDataSource Control Named `ProductsWithCategoryInfoDataSource`</span></span>


<span data-ttu-id="cfe15-249">次の画面を使用して、データベースを指定するよう求められます。</span><span class="sxs-lookup"><span data-stu-id="cfe15-249">The next screen asks us to specify the database.</span></span> <span data-ttu-id="cfe15-250">図 7 に戻ると、選択、`NORTHWINDConnectionString`ドロップダウン リストからを一覧表示し、[次へ] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="cfe15-250">As we did back in Figure 7, select the `NORTHWINDConnectionString` from the drop-down list and click Next.</span></span> <span data-ttu-id="cfe15-251">ステートメントの選択 画面の構成 では、カスタム SQL ステートメントまたはストアド プロシージャのオプション ボタンを指定してくださいを選択し、次へ をクリックします。</span><span class="sxs-lookup"><span data-stu-id="cfe15-251">In the Configure the Select Statement screen, choose the Specify a custom SQL statement or stored procedure radio button and click Next.</span></span> <span data-ttu-id="cfe15-252">SELECT、UPDATE、INSERT、および DELETE というラベルの付いたタブを提供する、定義のカスタム ステートメントまたはストアド プロシージャ画面が表示されます。</span><span class="sxs-lookup"><span data-stu-id="cfe15-252">This will bring up the Define Custom Statements or Stored Procedures screen, which offers tabs labeled SELECT, UPDATE, INSERT, and DELETE.</span></span> <span data-ttu-id="cfe15-253">各タブで、テキスト ボックスに、カスタムの SQL ステートメントを入力したり、ストアド プロシージャをドロップダウン リストから選択できます。</span><span class="sxs-lookup"><span data-stu-id="cfe15-253">In each tab you can enter a custom SQL statement into the textbox or choose a stored procedure from the drop-down list.</span></span> <span data-ttu-id="cfe15-254">このチュートリアルで見ていきます。 カスタム SQL ステートメントを入力します。次のチュートリアルには、ストアド プロシージャを使用する例が含まれています。</span><span class="sxs-lookup"><span data-stu-id="cfe15-254">In this tutorial we will look at entering a custom SQL statement; the next tutorial includes an example that uses a stored procedure.</span></span>


![カスタム SQL ステートメントを入力するか、ストアド プロシージャを選択](querying-data-with-the-sqldatasource-control-vb/_static/image19.gif)

<span data-ttu-id="cfe15-256">**図 13**: カスタム SQL ステートメントを入力するか、ストアド プロシージャを選択</span><span class="sxs-lookup"><span data-stu-id="cfe15-256">**Figure 13**: Enter a Custom SQL Statement or Pick a Stored Procedure</span></span>


<span data-ttu-id="cfe15-257">カスタムの SQL ステートメントは、textbox に手動で入力できますか、クエリ ビルダー ボタンをクリックしてグラフィカルに作成できます。</span><span class="sxs-lookup"><span data-stu-id="cfe15-257">The custom SQL statement can be entered by hand into the textbox or can be constructed graphically by clicking the Query Builder button.</span></span> <span data-ttu-id="cfe15-258">クエリ ビルダーは、またはテキスト ボックスで、次のクエリを使用して返す、`ProductID`と`ProductName`からのフィールド、`Products`テーブルを使用して、 `JOIN` s 製品を取得する`CategoryName`から、`Categories`テーブル。</span><span class="sxs-lookup"><span data-stu-id="cfe15-258">From either the Query Builder or the textbox, use the following query to return the `ProductID` and `ProductName` fields from the `Products` table using a `JOIN` to retrieve the product s `CategoryName` from the `Categories` table:</span></span>


[!code-sql[Main](querying-data-with-the-sqldatasource-control-vb/samples/sample4.sql)]


![視覚的に、クエリを使用して作成、クエリ ビルダー](querying-data-with-the-sqldatasource-control-vb/_static/image20.gif)

<span data-ttu-id="cfe15-260">**図 14**: できます視覚的に構築、クエリ ビルダーを使用して、クエリ</span><span class="sxs-lookup"><span data-stu-id="cfe15-260">**Figure 14**: You can Graphically Construct the Query Using the Query Builder</span></span>


<span data-ttu-id="cfe15-261">クエリを指定すると、クエリのテストの画面に進むには、[次へ] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="cfe15-261">After specifying the query, click Next to proceed to the Test Query screen.</span></span> <span data-ttu-id="cfe15-262">SqlDataSource ウィザードを完了するには、[完了] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="cfe15-262">Click Finish to complete the SqlDataSource wizard.</span></span>

<span data-ttu-id="cfe15-263">ウィザードを完了すると、GridView が追加表示する次の 3 つの BoundFields、 `ProductID`、 `ProductName`、および`CategoryName`クエリから返され、結果の次の宣言型マークアップ内の列。</span><span class="sxs-lookup"><span data-stu-id="cfe15-263">After completing the wizard, the GridView will have three BoundFields added to it displaying the `ProductID`, `ProductName`, and `CategoryName` columns returned from the query and resulting in the following declarative markup:</span></span>


[!code-aspx[Main](querying-data-with-the-sqldatasource-control-vb/samples/sample5.aspx)]


<span data-ttu-id="cfe15-264">[![GridView は、各製品の ID、名前と、関連付けられているカテゴリの名前を示しています。](querying-data-with-the-sqldatasource-control-vb/_static/image22.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image21.gif)</span><span class="sxs-lookup"><span data-stu-id="cfe15-264">[![The GridView Shows Each Product s ID, Name, and Associated Category Name](querying-data-with-the-sqldatasource-control-vb/_static/image22.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image21.gif)</span></span>

<span data-ttu-id="cfe15-265">**図 15**:「GridView 示します各製品の s ID、名、および関連付けられているカテゴリの名前 ([フルサイズ イメージを表示するに、をクリックして](querying-data-with-the-sqldatasource-control-vb/_static/image23.gif))</span><span class="sxs-lookup"><span data-stu-id="cfe15-265">**Figure 15**: The GridView Shows Each Product s ID, Name, and Associated Category Name ([Click to view full-size image](querying-data-with-the-sqldatasource-control-vb/_static/image23.gif))</span></span>


## <a name="summary"></a><span data-ttu-id="cfe15-266">まとめ</span><span class="sxs-lookup"><span data-stu-id="cfe15-266">Summary</span></span>

<span data-ttu-id="cfe15-267">このチュートリアルでは、クエリおよび SqlDataSource コントロールを使用してデータを表示する方法を説明しました。</span><span class="sxs-lookup"><span data-stu-id="cfe15-267">In this tutorial we saw how to query and display data using the SqlDataSource control.</span></span> <span data-ttu-id="cfe15-268">ObjectDataSource と同様に、SqlDataSource は宣言型のデータへのアクセス方法を提供する、プロキシとして機能します。</span><span class="sxs-lookup"><span data-stu-id="cfe15-268">Like the ObjectDataSource, the SqlDataSource serves as a proxy, providing a declarative approach to accessing data.</span></span> <span data-ttu-id="cfe15-269">そのプロパティを指定データベースに接続して、SQL`SELECT`を実行するクエリには、[プロパティ] ウィンドウやデータ ソースの構成ウィザードを使用して、指定することができます。</span><span class="sxs-lookup"><span data-stu-id="cfe15-269">Its properties specify the database to connect to and the SQL `SELECT` query to execute; they can be specified through the Properties window or by using the Configure DataSource wizard.</span></span>

<span data-ttu-id="cfe15-270">`SELECT`クエリ例のこのチュートリアルで調べることが、指定されたクエリから返さのすべてのレコードです。</span><span class="sxs-lookup"><span data-stu-id="cfe15-270">The `SELECT` query examples we examined in this tutorial returned all of the records from the specified query.</span></span> <span data-ttu-id="cfe15-271">ただし、SqlDataSource コントロールを含めることができます、`WHERE`パラメーターの値を持つプログラムによって割り当てられたまたは自動的に指定されたソースからプルされなくを含む句。</span><span class="sxs-lookup"><span data-stu-id="cfe15-271">The SqlDataSource control, however, can include a `WHERE` clause with parameters whose values are assigned programmatically or are automatically pulled from a specified source.</span></span> <span data-ttu-id="cfe15-272">作成して、次のチュートリアルではパラメーター化クエリを使用する方法について確認します。</span><span class="sxs-lookup"><span data-stu-id="cfe15-272">We'll examine how to create and use parameterized queries in the next tutorial!</span></span>

<span data-ttu-id="cfe15-273">満足プログラミング!</span><span class="sxs-lookup"><span data-stu-id="cfe15-273">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="cfe15-274">関連項目</span><span class="sxs-lookup"><span data-stu-id="cfe15-274">Further Reading</span></span>

<span data-ttu-id="cfe15-275">このチュートリアルで説明したトピックの詳細については、次の情報を参照してください。</span><span class="sxs-lookup"><span data-stu-id="cfe15-275">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="cfe15-276">リレーショナル データベースのデータにアクセスします。</span><span class="sxs-lookup"><span data-stu-id="cfe15-276">Accessing Relational Database Data</span></span>](http://aspnet.4guysfromrolla.com/articles/022206-1.aspx)
- [<span data-ttu-id="cfe15-277">SqlDataSource コントロールの概要</span><span class="sxs-lookup"><span data-stu-id="cfe15-277">SqlDataSource Control Overview</span></span>](https://msdn.microsoft.com/library/dz12d98w.aspx)
- [<span data-ttu-id="cfe15-278">ASP.NET のクイック スタート チュートリアル: SqlDataSource コントロール</span><span class="sxs-lookup"><span data-stu-id="cfe15-278">ASP.NET Quickstart Tutorials: The SqlDataSource Control</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/data/sqldatasource.aspx)
- [<span data-ttu-id="cfe15-279">Web.config`<connectionStrings>`要素</span><span class="sxs-lookup"><span data-stu-id="cfe15-279">The Web.config `<connectionStrings>` Element</span></span>](https://msdn.microsoft.com/library/bf7sd233.aspx)
- [<span data-ttu-id="cfe15-280">データベース接続文字列の参照</span><span class="sxs-lookup"><span data-stu-id="cfe15-280">Database Connection String Reference</span></span>](http://www.connectionstrings.com/)

## <a name="about-the-author"></a><span data-ttu-id="cfe15-281">作成者について</span><span class="sxs-lookup"><span data-stu-id="cfe15-281">About the Author</span></span>

<span data-ttu-id="cfe15-282">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)、7 つ受け取りますブックとの創設者の作成者[4GuysFromRolla.com](http://www.4guysfromrolla.com)、1998 年からマイクロソフトの Web テクノロジで取り組んできました。</span><span class="sxs-lookup"><span data-stu-id="cfe15-282">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="cfe15-283">Scott は、コンサルタント、トレーナー、ライターとして機能します。</span><span class="sxs-lookup"><span data-stu-id="cfe15-283">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="cfe15-284">最新の著書[ *Sam 学べる自分で ASP.NET 2.0 が 24 時間以内に*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)です。</span><span class="sxs-lookup"><span data-stu-id="cfe15-284">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="cfe15-285">彼に到達できる[ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)彼のブログを使用して含まれているのか[ http://ScottOnWriting.NET](http://ScottOnWriting.NET)です。</span><span class="sxs-lookup"><span data-stu-id="cfe15-285">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="cfe15-286">感謝の特別な</span><span class="sxs-lookup"><span data-stu-id="cfe15-286">Special Thanks To</span></span>

<span data-ttu-id="cfe15-287">このチュートリアルの系列は既に多くの便利なレビュー担当者によって確認済みです。</span><span class="sxs-lookup"><span data-stu-id="cfe15-287">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="cfe15-288">このチュートリアルの潜在顧客レビュー担当者は、Susan Connery、「社長補佐 Leigh および David Suru でした。</span><span class="sxs-lookup"><span data-stu-id="cfe15-288">Lead reviewers for this tutorial were Susan Connery, Bernadette Leigh, and David Suru.</span></span> <span data-ttu-id="cfe15-289">今後、MSDN の記事を確認することに関心のあるですか。</span><span class="sxs-lookup"><span data-stu-id="cfe15-289">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="cfe15-290">場合は、ドロップ me 一度に 1 行ずつ[mitchell@4GuysFromRolla.comです。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="cfe15-290">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="cfe15-291">[前へ](implementing-optimistic-concurrency-with-the-sqldatasource-cs.md)
> [次へ](using-parameterized-queries-with-the-sqldatasource-vb.md)</span><span class="sxs-lookup"><span data-stu-id="cfe15-291">[Previous](implementing-optimistic-concurrency-with-the-sqldatasource-cs.md)
[Next](using-parameterized-queries-with-the-sqldatasource-vb.md)</span></span>
