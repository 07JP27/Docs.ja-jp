---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/adding-additional-datatable-columns-vb
title: その他のデータ テーブルの列 (VB) を追加する |Microsoft ドキュメント
author: rick-anderson
description: TableAdapter ウィザードを使用して、型指定されたデータセットを作成する、対応するデータ テーブルには、主なデータベース クエリによって返される列が含まれています。 しかし、.
ms.author: aspnetcontent
manager: wpickett
ms.date: 07/18/2007
ms.topic: article
ms.assetid: 1e8e65f9-fe3e-4250-810b-c90227786bed
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/adding-additional-datatable-columns-vb
msc.type: authoredcontent
ms.openlocfilehash: b51089057ad1e14901cb09589534d6e575261c3e
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/06/2018
---
<a name="adding-additional-datatable-columns-vb"></a><span data-ttu-id="19db0-104">その他のデータ テーブルの列 (VB) を追加します。</span><span class="sxs-lookup"><span data-stu-id="19db0-104">Adding Additional DataTable Columns (VB)</span></span>
====================
<span data-ttu-id="19db0-105">によって[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="19db0-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="19db0-106">[コードをダウンロードする](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_70_VB.zip)または[PDF のダウンロード](adding-additional-datatable-columns-vb/_static/datatutorial70vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="19db0-106">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_70_VB.zip) or [Download PDF](adding-additional-datatable-columns-vb/_static/datatutorial70vb1.pdf)</span></span>

> <span data-ttu-id="19db0-107">TableAdapter ウィザードを使用して、型指定されたデータセットを作成する、対応するデータ テーブルには、主なデータベース クエリによって返される列が含まれています。</span><span class="sxs-lookup"><span data-stu-id="19db0-107">When using the TableAdapter Wizard to create a Typed DataSet, the corresponding DataTable contains the columns returned by the main database query.</span></span> <span data-ttu-id="19db0-108">DataTable の追加列を含める必要がある場合に必要です。</span><span class="sxs-lookup"><span data-stu-id="19db0-108">But there are occasions when the DataTable needs to include additional columns.</span></span> <span data-ttu-id="19db0-109">このチュートリアルでは、追加のデータ テーブルの列が必要なときにストアド プロシージャを推奨する理由は学習します。</span><span class="sxs-lookup"><span data-stu-id="19db0-109">In this tutorial we learn why stored procedures are recommended when we need additional DataTable columns.</span></span>


## <a name="introduction"></a><span data-ttu-id="19db0-110">はじめに</span><span class="sxs-lookup"><span data-stu-id="19db0-110">Introduction</span></span>

<span data-ttu-id="19db0-111">に型指定されたデータセットを TableAdapter を追加するときに、対応する DataTable のスキーマは、TableAdapter のメイン クエリによって決まります。</span><span class="sxs-lookup"><span data-stu-id="19db0-111">When adding a TableAdapter to a Typed DataSet, the corresponding DataTable s schema is determined by the TableAdapter s main query.</span></span> <span data-ttu-id="19db0-112">たとえば、メインのクエリがデータ フィールドを返します*A*、 *B*、および*C*、DataTable はという 3 つの対応する列が*A*、*B*、および*C*です。メインのクエリだけでなく、TableAdapter は、おそらく、いくつかのパラメーターに基づくデータのサブセットを返す他のクエリを含めることができます。</span><span class="sxs-lookup"><span data-stu-id="19db0-112">For example, if the main query returns data fields *A*, *B*, and *C*, the DataTable will have three corresponding columns named *A*, *B*, and *C*. In addition to its main query, a TableAdapter can include additional queries that return, perhaps, a subset of the data based on some parameter.</span></span> <span data-ttu-id="19db0-113">インスタンスに加え、`ProductsTableAdapter`すべての製品に関する情報を返します、s メイン クエリも含まれますなどのメソッド`GetProductsByCategoryID(categoryID)`と`GetProductByProductID(productID)`、指定されたパラメーターに基づいて特定の製品情報を返します。</span><span class="sxs-lookup"><span data-stu-id="19db0-113">For instance, in addition to the `ProductsTableAdapter` s main query, which returns information about all products, it also contains methods like `GetProductsByCategoryID(categoryID)` and `GetProductByProductID(productID)`, which return specific product information based on a supplied parameter.</span></span>

<span data-ttu-id="19db0-114">TableAdapter のメインのクエリを反映 DataTable のスキーマを持つのモデルは、同じか、またはメイン クエリで指定されているよりも少ないデータ フィールドを返す TableAdapter のメソッドの場合はうまく機能します。</span><span class="sxs-lookup"><span data-stu-id="19db0-114">The model of having the DataTable s schema reflect the TableAdapter s main query works well if all of the TableAdapter s methods return the same or fewer data fields than those specified in the main query.</span></span> <span data-ttu-id="19db0-115">TableAdapter メソッドは、追加のデータ フィールドを返す必要があるを場合しおを展開する DataTable のスキーマに応じて。</span><span class="sxs-lookup"><span data-stu-id="19db0-115">If a TableAdapter method needs to return additional data fields, then we should expand the DataTable s schema accordingly.</span></span> <span data-ttu-id="19db0-116">[マスター/詳細レコードを使用して、箇条書きリストのマスター詳細 DataList で](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md)チュートリアルにメソッドを追加しました、`CategoriesTableAdapter`返される、 `CategoryID`、 `CategoryName`、および`Description`で定義されているデータ フィールドプラスのメイン クエリ`NumberOfProducts`、各カテゴリに関連付けられている製品の数を報告する追加のデータ フィールドです。</span><span class="sxs-lookup"><span data-stu-id="19db0-116">In the [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) tutorial we added a method to the `CategoriesTableAdapter` that returned the `CategoryID`, `CategoryName`, and `Description` data fields defined in the main query plus `NumberOfProducts`, an additional data field that reported the number of products associated with each category.</span></span> <span data-ttu-id="19db0-117">新しい列を手動で追加して、`CategoriesDataTable`をキャプチャするために、`NumberOfProducts`データ フィールドの値この新しいメソッドからです。</span><span class="sxs-lookup"><span data-stu-id="19db0-117">We manually added a new column to the `CategoriesDataTable` in order to capture the `NumberOfProducts` data field value from this new method.</span></span>

<span data-ttu-id="19db0-118">説明したように、[ファイルのアップロード](../working-with-binary-files/uploading-files-vb.md)チュートリアル、優れたは注意が必要、アドホック SQL ステートメントを使用する、その結果、データ フィールドは、メインのクエリを正確に一致しないメソッドが Tableadapter にします。</span><span class="sxs-lookup"><span data-stu-id="19db0-118">As discussed in the [Uploading Files](../working-with-binary-files/uploading-files-vb.md) tutorial, great care must be taken with TableAdapters that use ad-hoc SQL statements and have methods whose data fields do not precisely match the main query.</span></span> <span data-ttu-id="19db0-119">場合は、TableAdapter 構成ウィザードを再実行、更新されます TableAdapter のメソッドのすべてのデータ フィールドの一覧が、メインのクエリと一致するようにします。</span><span class="sxs-lookup"><span data-stu-id="19db0-119">If the TableAdapter Configuration wizard is re-run, it will update all of the TableAdapter s methods so that their data field list matches the main query.</span></span> <span data-ttu-id="19db0-120">その結果、カスタマイズされた列リストを持つ任意のメソッドは、メイン クエリの列リストに戻すし、予期されたデータは返されません。</span><span class="sxs-lookup"><span data-stu-id="19db0-120">Consequently, any methods with customized column lists will revert to the main query s column list and not return the expected data.</span></span> <span data-ttu-id="19db0-121">ストアド プロシージャを使用する場合、この問題は発生しません。</span><span class="sxs-lookup"><span data-stu-id="19db0-121">This issue does not arise when using stored procedures.</span></span>

<span data-ttu-id="19db0-122">このチュートリアルでは、追加の列を含める DataTable のスキーマを拡張する方法について取り上げます。</span><span class="sxs-lookup"><span data-stu-id="19db0-122">In this tutorial we will look at how to extend a DataTable s schema to include additional columns.</span></span> <span data-ttu-id="19db0-123">このチュートリアルでは、アドホック SQL ステートメントを使用する場合、TableAdapter の脆弱性、によりストアド プロシージャを使用します。</span><span class="sxs-lookup"><span data-stu-id="19db0-123">Due to the brittleness of the TableAdapter when using ad-hoc SQL statements, in this tutorial we will use stored procedures.</span></span> <span data-ttu-id="19db0-124">参照してください、[を作成する新しいストアド プロシージャを型指定されたデータセットの Tableadapter](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)と[を使用して既存のストアド プロシージャを型指定されたデータセットの Tableadapter](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)についてのチュートリアルストアド プロシージャを使用して TableAdapter を構成します。</span><span class="sxs-lookup"><span data-stu-id="19db0-124">Refer to the [Creating New Stored Procedures for the Typed DataSet s TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) and [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorials for more information on configuring a TableAdapter to use stored procedures.</span></span>

## <a name="step-1-adding-apricequartilecolumn-to-theproductsdatatable"></a><span data-ttu-id="19db0-125">手順 1: 追加、`PriceQuartile`列を`ProductsDataTable`</span><span class="sxs-lookup"><span data-stu-id="19db0-125">Step 1: Adding a`PriceQuartile`Column to the`ProductsDataTable`</span></span>

<span data-ttu-id="19db0-126">*を作成する新しいストアド プロシージャを型指定されたデータセットの Tableadapter*という名前の型指定されたデータセットを作成したチュートリアル`NorthwindWithSprocs`です。</span><span class="sxs-lookup"><span data-stu-id="19db0-126">In the *Creating New Stored Procedures for the Typed DataSet s TableAdapters* tutorial we created a Typed DataSet named `NorthwindWithSprocs`.</span></span> <span data-ttu-id="19db0-127">このデータセットには現在 2 つのデータ テーブルが含まれています:`ProductsDataTable`と`EmployeesDataTable`です。</span><span class="sxs-lookup"><span data-stu-id="19db0-127">This DataSet currently contains two DataTables: `ProductsDataTable` and `EmployeesDataTable`.</span></span> <span data-ttu-id="19db0-128">`ProductsTableAdapter`次の 3 つの方法があります。</span><span class="sxs-lookup"><span data-stu-id="19db0-128">The `ProductsTableAdapter` has the following three methods:</span></span>

- <span data-ttu-id="19db0-129">`GetProducts` メインのクエリは、すべてのレコードを返します、`Products`テーブル</span><span class="sxs-lookup"><span data-stu-id="19db0-129">`GetProducts` - the main query, which returns all records from the `Products` table</span></span>
- <span data-ttu-id="19db0-130">`GetProductsByCategoryID(categoryID)` -指定したすべての製品を返します*categoryID*です。</span><span class="sxs-lookup"><span data-stu-id="19db0-130">`GetProductsByCategoryID(categoryID)` - returns all products with the specified *categoryID*.</span></span>
- <span data-ttu-id="19db0-131">`GetProductByProductID(productID)` -指定した特定の製品を返します*productID*です。</span><span class="sxs-lookup"><span data-stu-id="19db0-131">`GetProductByProductID(productID)` - returns the particular product with the specified *productID*.</span></span>

<span data-ttu-id="19db0-132">メインのクエリと 2 つの追加のメソッドは、つまりすべての列のデータ フィールドの同じセットを返す、`Products`テーブル。</span><span class="sxs-lookup"><span data-stu-id="19db0-132">The main query and the two additional methods all return the same set of data fields, namely all of the columns from the `Products` table.</span></span> <span data-ttu-id="19db0-133">相関サブクエリがないか`JOIN`s 関連データを抽出、`Categories`または`Suppliers`テーブル。</span><span class="sxs-lookup"><span data-stu-id="19db0-133">There are no correlated subqueries or `JOIN` s pulling related data from the `Categories` or `Suppliers` tables.</span></span> <span data-ttu-id="19db0-134">したがって、`ProductsDataTable`の各フィールドの対応する列を持つ、`Products`テーブル。</span><span class="sxs-lookup"><span data-stu-id="19db0-134">Therefore, the `ProductsDataTable` has a corresponding column for each field in the `Products` table.</span></span>

<span data-ttu-id="19db0-135">このチュートリアルでは、let s メソッドを追加する、`ProductsTableAdapter`という`GetProductsWithPriceQuartile`を返すすべての製品です。</span><span class="sxs-lookup"><span data-stu-id="19db0-135">For this tutorial, let s add a method to the `ProductsTableAdapter` named `GetProductsWithPriceQuartile` that returns all of the products.</span></span> <span data-ttu-id="19db0-136">フィールドだけでなく、標準の製品データ、`GetProductsWithPriceQuartile`も含まれる、`PriceQuartile`どの四分位数の下の製品の価格があることを示します。 データ フィールドです。</span><span class="sxs-lookup"><span data-stu-id="19db0-136">In addition to the standard product data fields, `GetProductsWithPriceQuartile` will also include a `PriceQuartile` data field that indicates under which quartile the product s price falls.</span></span> <span data-ttu-id="19db0-137">たとえば、価格が最も高コストの 25% ではこれらの製品がある、`PriceQuartile`値 1 を下の 25% で価格が含まれている 4 の値が使用されます。</span><span class="sxs-lookup"><span data-stu-id="19db0-137">For example, those products whose prices are in the most expensive 25% will have a `PriceQuartile` value of 1, while those whose prices fall in the bottom 25% will have a value of 4.</span></span> <span data-ttu-id="19db0-138">前に、この情報を返すストアド プロシージャを作成する心配し、ただし、まず必要がありますを更新する、`ProductsDataTable`を保持する列を含めるように、`PriceQuartile`結果ときに、`GetProductsWithPriceQuartile`メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="19db0-138">Before we worry about creating the stored procedure to return this information, however, we first need to update the `ProductsDataTable` to include a column to hold the `PriceQuartile` results when the `GetProductsWithPriceQuartile` method is used.</span></span>

<span data-ttu-id="19db0-139">開く、`NorthwindWithSprocs`データセットを右クリックし、`ProductsDataTable`です。</span><span class="sxs-lookup"><span data-stu-id="19db0-139">Open the `NorthwindWithSprocs` DataSet and right-click on the `ProductsDataTable`.</span></span> <span data-ttu-id="19db0-140">コンテキスト メニューから追加] をクリックし、[列を選択します。</span><span class="sxs-lookup"><span data-stu-id="19db0-140">Choose Add from the context-menu and then pick Column.</span></span>


<span data-ttu-id="19db0-141">[![ProductsDataTable に新しい列を追加します。](adding-additional-datatable-columns-vb/_static/image2.png)](adding-additional-datatable-columns-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="19db0-141">[![Add a New Column to the ProductsDataTable](adding-additional-datatable-columns-vb/_static/image2.png)](adding-additional-datatable-columns-vb/_static/image1.png)</span></span>

<span data-ttu-id="19db0-142">**図 1**: 新しい列を追加、 `ProductsDataTable` ([フルサイズのイメージを表示するをクリックして](adding-additional-datatable-columns-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="19db0-142">**Figure 1**: Add a New Column to the `ProductsDataTable` ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image3.png))</span></span>


<span data-ttu-id="19db0-143">これには、型の Column1 のという DataTable に新しい列が追加`System.String`です。</span><span class="sxs-lookup"><span data-stu-id="19db0-143">This will add a new column to the DataTable named Column1 of type `System.String`.</span></span> <span data-ttu-id="19db0-144">PriceQuartile とその型にするこの列の名前を更新する必要があります`System.Int32`ので、これは 1 ~ 4 の数値を保持するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="19db0-144">We need to update this column s name to PriceQuartile and its type to `System.Int32` since it will be used to hold a number between 1 and 4.</span></span> <span data-ttu-id="19db0-145">新しく追加された列を選択、`ProductsDataTable`し、[プロパティ] ウィンドウから次のように設定します。、 `Name` PriceQuartile プロパティおよび`DataType`プロパティを`System.Int32`です。</span><span class="sxs-lookup"><span data-stu-id="19db0-145">Select the newly-added column in the `ProductsDataTable` and, from the Properties window, set the `Name` property to PriceQuartile and the `DataType` property to `System.Int32`.</span></span>


<span data-ttu-id="19db0-146">[![新しい列の名前とデータ型のプロパティを設定します。](adding-additional-datatable-columns-vb/_static/image5.png)](adding-additional-datatable-columns-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="19db0-146">[![Set the New Column s Name and DataType Properties](adding-additional-datatable-columns-vb/_static/image5.png)](adding-additional-datatable-columns-vb/_static/image4.png)</span></span>

<span data-ttu-id="19db0-147">**図 2**: 新しい列 s を設定`Name`と`DataType`プロパティ ([フルサイズのイメージを表示するをクリックして](adding-additional-datatable-columns-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="19db0-147">**Figure 2**: Set the New Column s `Name` and `DataType` Properties ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image6.png))</span></span>


<span data-ttu-id="19db0-148">図 2 に示すかどうか、列の値が、列が自動増分列の場合は、一意にする必要がありますなど、設定できる追加のプロパティがある、かどうか、データベース`NULL`値が許可されなどです。</span><span class="sxs-lookup"><span data-stu-id="19db0-148">As Figure 2 shows, there are additional properties that can be set, such as whether the values in the column must be unique, if the column is an auto-increment column, whether or not database `NULL` values are allowed, and so on.</span></span> <span data-ttu-id="19db0-149">既定値にこれらの値のままにします。</span><span class="sxs-lookup"><span data-stu-id="19db0-149">Leave these values set to their defaults.</span></span>

## <a name="step-2-creating-thegetproductswithpricequartilemethod"></a><span data-ttu-id="19db0-150">手順 2: 作成、`GetProductsWithPriceQuartile`メソッド</span><span class="sxs-lookup"><span data-stu-id="19db0-150">Step 2: Creating the`GetProductsWithPriceQuartile`Method</span></span>

<span data-ttu-id="19db0-151">これで、`ProductsDataTable`に含める更新されました、`PriceQuartile`を作成する準備ができました 列、`GetProductsWithPriceQuartile`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="19db0-151">Now that the `ProductsDataTable` has been updated to include the `PriceQuartile` column, we are ready to create the `GetProductsWithPriceQuartile` method.</span></span> <span data-ttu-id="19db0-152">TableAdapter を右クリックして、コンテキスト メニューから [クエリの追加] を選択して開始します。</span><span class="sxs-lookup"><span data-stu-id="19db0-152">Start by right-clicking on the TableAdapter and choosing Add Query from the context-menu.</span></span> <span data-ttu-id="19db0-153">まず us、アドホック SQL ステートメントまたは新規または既存のストアド プロシージャを使用するかどうかに関する入力を求められる TableAdapter クエリの構成ウィザードが表示されます。</span><span class="sxs-lookup"><span data-stu-id="19db0-153">This brings up the TableAdapter Query Configuration wizard, which first prompts us as to whether we want to use ad-hoc SQL statements or a new or existing stored procedure.</span></span> <span data-ttu-id="19db0-154">ないお価格の四分位数のデータを返すストアド プロシージャがあるため、ご利用の米国このストアド プロシージャを作成する TableAdapter を許可する秒を使用できます。</span><span class="sxs-lookup"><span data-stu-id="19db0-154">Since we don t yet have a stored procedure that returns the price quartile data, let s allow the TableAdapter to create this stored procedure for us.</span></span> <span data-ttu-id="19db0-155">新しいストアド プロシージャの作成 オプションを選択し、次へ をクリックします。</span><span class="sxs-lookup"><span data-stu-id="19db0-155">Select the Create new stored procedure option and click Next.</span></span>


<span data-ttu-id="19db0-156">[![TableAdapter ウィザードでご利用の米国ストアド プロシージャを作成するように指示します。](adding-additional-datatable-columns-vb/_static/image8.png)](adding-additional-datatable-columns-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="19db0-156">[![Instruct the TableAdapter Wizard to Create the Stored Procedure For Us](adding-additional-datatable-columns-vb/_static/image8.png)](adding-additional-datatable-columns-vb/_static/image7.png)</span></span>

<span data-ttu-id="19db0-157">**図 3**: TableAdapter ウィザードで、ストアド プロシージャの意見を作成するように指示 ([フルサイズのイメージを表示するをクリックして](adding-additional-datatable-columns-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="19db0-157">**Figure 3**: Instruct the TableAdapter Wizard to Create the Stored Procedure For Us ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image9.png))</span></span>


<span data-ttu-id="19db0-158">後続の画面では、図 4 に示すように、ウィザード要求することを追加するクエリの種類。</span><span class="sxs-lookup"><span data-stu-id="19db0-158">In the subsequent screen, shown in Figure 4, the wizard asks us what type of query to add.</span></span> <span data-ttu-id="19db0-159">以降、`GetProductsWithPriceQuartile`メソッドは、すべての列とからレコードを返します、`Products`テーブル、行のオプションと 次へ をクリックする を選択します。</span><span class="sxs-lookup"><span data-stu-id="19db0-159">Since the `GetProductsWithPriceQuartile` method will return all columns and records from the `Products` table, select the SELECT which returns rows option and click Next.</span></span>


<span data-ttu-id="19db0-160">[![このクエリは SELECT ステートメントを複数行を返しますになります](adding-additional-datatable-columns-vb/_static/image11.png)](adding-additional-datatable-columns-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="19db0-160">[![Our Query will be a SELECT Statement that Returns Multiple Rows](adding-additional-datatable-columns-vb/_static/image11.png)](adding-additional-datatable-columns-vb/_static/image10.png)</span></span>

<span data-ttu-id="19db0-161">**図 4**: Our クエリになります、`SELECT`ステートメントを複数行を返します ([フルサイズのイメージを表示するをクリックして](adding-additional-datatable-columns-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="19db0-161">**Figure 4**: Our Query will be a `SELECT` Statement that Returns Multiple Rows ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image12.png))</span></span>


<span data-ttu-id="19db0-162">次のよう求められます、`SELECT`クエリ。</span><span class="sxs-lookup"><span data-stu-id="19db0-162">Next we are prompted for the `SELECT` query.</span></span> <span data-ttu-id="19db0-163">ウィザードには、次のクエリを入力します。</span><span class="sxs-lookup"><span data-stu-id="19db0-163">Enter the following query into the wizard:</span></span>


[!code-sql[Main](adding-additional-datatable-columns-vb/samples/sample1.sql)]

<span data-ttu-id="19db0-164">上記のクエリでは SQL Server 2005 s の新しい[`NTILE`関数](https://msdn.microsoft.com/library/ms175126.aspx)によって、グループを決定する、4 つのグループに結果を分割する、`UnitPrice`値の降順で並べ替えられます。</span><span class="sxs-lookup"><span data-stu-id="19db0-164">The above query uses SQL Server 2005 s new [`NTILE` function](https://msdn.microsoft.com/library/ms175126.aspx) to divide the results into four groups where the groups are determined by the `UnitPrice` values sorted in descending order.</span></span>

<span data-ttu-id="19db0-165">残念ながら、クエリ ビルダーに解析する方法を識別できない、`OVER`キーワードと、上記のクエリの解析中にエラーが表示されます。</span><span class="sxs-lookup"><span data-stu-id="19db0-165">Unfortunately, the Query Builder does not know how to parse the `OVER` keyword and will display an error when parsing the above query.</span></span> <span data-ttu-id="19db0-166">そのため、クエリ ビルダーを使用せず、ウィザードで、テキスト ボックス内で直接上記のクエリを入力します。</span><span class="sxs-lookup"><span data-stu-id="19db0-166">Therefore, enter the above query directly in the textbox in the wizard without using the Query Builder.</span></span>

> [!NOTE]
> <span data-ttu-id="19db0-167">その他の順位付け関数を参照してください NTILE の SQL Server 2005 の詳細については[Microsoft SQL Server 2005 で順位付けされた結果を返す](http://www.4guysfromrolla.com/webtech/010406-1.shtml)と[」の「順位付け関数](https://msdn.microsoft.com/library/ms189798.aspx)から、 [SQLServer 2005 Books Online](https://msdn.microsoft.com/library/ms189798.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="19db0-167">For more information on NTILE and SQL Server 2005 s other ranking functions, see [Returning Ranked Results with Microsoft SQL Server 2005](http://www.4guysfromrolla.com/webtech/010406-1.shtml) and the [Ranking Functions section](https://msdn.microsoft.com/library/ms189798.aspx) from the [SQL Server 2005 Books Online](https://msdn.microsoft.com/library/ms189798.aspx).</span></span>


<span data-ttu-id="19db0-168">入力した後に、`SELECT`クエリ、[次へ] をクリックして、ウィザードが自動的に作成するストアド プロシージャの名前を指定することです。</span><span class="sxs-lookup"><span data-stu-id="19db0-168">After entering the `SELECT` query and clicking Next, the wizard asks us to provide a name for the stored procedure it will create.</span></span> <span data-ttu-id="19db0-169">新しいストアド プロシージャの名前を付けます`Products_SelectWithPriceQuartile`[次へ] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="19db0-169">Name the new stored procedure `Products_SelectWithPriceQuartile` and click Next.</span></span>


<span data-ttu-id="19db0-170">[![名前のストアド プロシージャ Products_SelectWithPriceQuartile](adding-additional-datatable-columns-vb/_static/image14.png)](adding-additional-datatable-columns-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="19db0-170">[![Name the Stored Procedure Products_SelectWithPriceQuartile](adding-additional-datatable-columns-vb/_static/image14.png)](adding-additional-datatable-columns-vb/_static/image13.png)</span></span>

<span data-ttu-id="19db0-171">**図 5**: ストアド プロシージャの名前を付けます`Products_SelectWithPriceQuartile`([フルサイズのイメージを表示するをクリックして](adding-additional-datatable-columns-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="19db0-171">**Figure 5**: Name the Stored Procedure `Products_SelectWithPriceQuartile` ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image15.png))</span></span>


<span data-ttu-id="19db0-172">最後に、TableAdapter のメソッドの名前を付けるように求められます。</span><span class="sxs-lookup"><span data-stu-id="19db0-172">Lastly, we are prompted to name the TableAdapter methods.</span></span> <span data-ttu-id="19db0-173">DataTable、両方の塗りつぶしのままにし、データ テーブルのチェック ボックスがオンになって、名メソッド`FillWithPriceQuartile`と`GetProductsWithPriceQuartile`です。</span><span class="sxs-lookup"><span data-stu-id="19db0-173">Leave both the Fill a DataTable and Return a DataTable checkboxes checked and name the methods `FillWithPriceQuartile` and `GetProductsWithPriceQuartile`.</span></span>


<span data-ttu-id="19db0-174">[![名前、tableadapter のメソッドとをクリックして終了します。](adding-additional-datatable-columns-vb/_static/image17.png)](adding-additional-datatable-columns-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="19db0-174">[![Name the TableAdapter s Methods and Click Finish](adding-additional-datatable-columns-vb/_static/image17.png)](adding-additional-datatable-columns-vb/_static/image16.png)</span></span>

<span data-ttu-id="19db0-175">**図 6**: TableAdapter のメソッドとは [完了] の名前を付けます ([フルサイズのイメージを表示するをクリックして](adding-additional-datatable-columns-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="19db0-175">**Figure 6**: Name the TableAdapter s Methods and Click Finish ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image18.png))</span></span>


<span data-ttu-id="19db0-176">`SELECT`クエリを指定し、ストアド プロシージャとという名前の TableAdapter メソッドは、ウィザードを完了するの完了 をクリックします。</span><span class="sxs-lookup"><span data-stu-id="19db0-176">With the `SELECT` query specified and the stored procedure and TableAdapter methods named, click Finish to complete the wizard.</span></span> <span data-ttu-id="19db0-177">この時点で受け取ることがあります、警告またはことを示すウィザードから 2 つ、 `OVER` SQL コンストラクトまたはステートメントはサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="19db0-177">At this point you may get a warning or two from the wizard saying that The `OVER` SQL construct or statement is not supported.</span></span> <span data-ttu-id="19db0-178">これらの警告を無視できます。</span><span class="sxs-lookup"><span data-stu-id="19db0-178">These warnings can be ignored.</span></span>

<span data-ttu-id="19db0-179">ウィザードを完了すると、TableAdapter を含める必要があります、`FillWithPriceQuartile`と`GetProductsWithPriceQuartile`メソッドと、データベースは、という名前のストアド プロシージャを含める必要があります`Products_SelectWithPriceQuartile`です。</span><span class="sxs-lookup"><span data-stu-id="19db0-179">After completing the wizard, the TableAdapter should include the `FillWithPriceQuartile` and `GetProductsWithPriceQuartile` methods and the database should include a stored procedure named `Products_SelectWithPriceQuartile`.</span></span> <span data-ttu-id="19db0-180">すぐに TableAdapter がこの新しいメソッドを含む実際に、ストアド プロシージャがデータベースに正しく追加されていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="19db0-180">Take a moment to verify that the TableAdapter does indeed contain this new method and that the stored procedure has been correctly added to the database.</span></span> <span data-ttu-id="19db0-181">Stored Procedures フォルダーを右クリックしてお試しをストアド プロシージャおよび更新 をクリックして表示されない場合は、データベースを確認して ときに。</span><span class="sxs-lookup"><span data-stu-id="19db0-181">When checking the database, if you do not see the stored procedure try right-clicking on the Stored Procedures folder and choosing Refresh.</span></span>


![新しいメソッドが TableAdapter に追加されたことを確認してください。](adding-additional-datatable-columns-vb/_static/image19.png)

<span data-ttu-id="19db0-183">**図 7**: 新しいメソッドが TableAdapter に追加されたことを確認してください。</span><span class="sxs-lookup"><span data-stu-id="19db0-183">**Figure 7**: Verify that a New Method Has Been Added to the TableAdapter</span></span>


<span data-ttu-id="19db0-184">[![データベースが、Products_SelectWithPriceQuartile が含まれていることを確認ストアド プロシージャ](adding-additional-datatable-columns-vb/_static/image21.png)](adding-additional-datatable-columns-vb/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="19db0-184">[![Ensure that the Database Contains the Products_SelectWithPriceQuartile Stored Procedure](adding-additional-datatable-columns-vb/_static/image21.png)](adding-additional-datatable-columns-vb/_static/image20.png)</span></span>

<span data-ttu-id="19db0-185">**図 8**: データベース含まれていることを確認、`Products_SelectWithPriceQuartile`ストアド プロシージャ ([フルサイズのイメージを表示するをクリックして](adding-additional-datatable-columns-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="19db0-185">**Figure 8**: Ensure that the Database Contains the `Products_SelectWithPriceQuartile` Stored Procedure ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image22.png))</span></span>


> [!NOTE]
> <span data-ttu-id="19db0-186">アドホック SQL ステートメントの代わりにストアド プロシージャを使用する利点の 1 つは、TableAdapter 構成ウィザードを再実行は変更されませんストアド プロシージャの列リストです。</span><span class="sxs-lookup"><span data-stu-id="19db0-186">One of the benefits of using stored procedures instead of ad-hoc SQL statements is that re-running the TableAdapter Configuration wizard will not modify the stored procedures column lists.</span></span> <span data-ttu-id="19db0-187">TableAdapter を右クリックして、ウィザードを起動するコンテキスト メニューから構成オプションを選択し、完了するには、[完了] をクリックし、これを確認します。</span><span class="sxs-lookup"><span data-stu-id="19db0-187">Verify this by right-clicking on the TableAdapter, choosing the Configure option from the context-menu to start the wizard, and then clicking Finish to complete it.</span></span> <span data-ttu-id="19db0-188">次に、データベース、ビューにアクセスして、`Products_SelectWithPriceQuartile`ストアド プロシージャです。</span><span class="sxs-lookup"><span data-stu-id="19db0-188">Next, go to the database and view the `Products_SelectWithPriceQuartile` stored procedure.</span></span> <span data-ttu-id="19db0-189">その列リストが変更されていないことに注意してください。</span><span class="sxs-lookup"><span data-stu-id="19db0-189">Note that its column list has not been modified.</span></span> <span data-ttu-id="19db0-190">ここで使用されていた、アドホック SQL ステートメント、TableAdapter 構成ウィザードを再実行は元に戻さ NTILE ステートメントで使用されるクエリから削除、メインのクエリ列リストに一致するこのクエリの列リスト、`GetProductsWithPriceQuartile`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="19db0-190">Had we been using ad-hoc SQL statements, re-running the TableAdapter Configuration wizard would have reverted this query s column list to match the main query column list, thereby removing the NTILE statement from the query used by the `GetProductsWithPriceQuartile` method.</span></span>


<span data-ttu-id="19db0-191">ときに、データ アクセス層 s`GetProductsWithPriceQuartile`メソッドが呼び出され、TableAdapter の実行、`Products_SelectWithPriceQuartile`ストアド プロシージャと、行を追加、`ProductsDataTable`返されたレコードのです。</span><span class="sxs-lookup"><span data-stu-id="19db0-191">When the Data Access Layer s `GetProductsWithPriceQuartile` method is invoked, the TableAdapter executes the `Products_SelectWithPriceQuartile` stored procedure and adds a row to the `ProductsDataTable` for each returned record.</span></span> <span data-ttu-id="19db0-192">ストアド プロシージャによって返されるデータ フィールドのマップを`ProductsDataTable`の列です。</span><span class="sxs-lookup"><span data-stu-id="19db0-192">The data fields returned by the stored procedure are mapped to the `ProductsDataTable` s columns.</span></span> <span data-ttu-id="19db0-193">存在しないため、`PriceQuartile`その値は、ストアド プロシージャから返されたデータ フィールドに割り当てられて、 `ProductsDataTable` s`PriceQuartile`列です。</span><span class="sxs-lookup"><span data-stu-id="19db0-193">Since there is a `PriceQuartile` data field returned from the stored procedure, its value is assigned to the `ProductsDataTable` s `PriceQuartile` column.</span></span>

<span data-ttu-id="19db0-194">クエリでそのを返さない TableAdapter メソッド、`PriceQuartile`データ フィールド、 `PriceQuartile` s の列の値によって指定された値は、その`DefaultValue`プロパティです。</span><span class="sxs-lookup"><span data-stu-id="19db0-194">For those TableAdapter methods whose queries do not return a `PriceQuartile` data field, the `PriceQuartile` column s value is the value specified by its `DefaultValue` property.</span></span> <span data-ttu-id="19db0-195">図 2 では、この設定は`DBNull`、既定値です。</span><span class="sxs-lookup"><span data-stu-id="19db0-195">As Figure 2 shows, this value is set to `DBNull`, the default.</span></span> <span data-ttu-id="19db0-196">別の既定値を使用する場合場合、設定するだけ、`DefaultValue`プロパティに応じて。</span><span class="sxs-lookup"><span data-stu-id="19db0-196">If you would prefer a different default value, simply set the `DefaultValue` property accordingly.</span></span> <span data-ttu-id="19db0-197">同じことを確認、`DefaultValue`値が有効では、[s] 列を指定`DataType`(つまり、`System.Int32`の`PriceQuartile`列)。</span><span class="sxs-lookup"><span data-stu-id="19db0-197">Just make sure that the `DefaultValue` value is valid given the column s `DataType` (i.e., `System.Int32` for the `PriceQuartile` column).</span></span>

<span data-ttu-id="19db0-198">この時点で、必要な手順を実行おの列を DataTable に追加します。</span><span class="sxs-lookup"><span data-stu-id="19db0-198">At this point we have performed the necessary steps for adding an additional column to a DataTable.</span></span> <span data-ttu-id="19db0-199">この追加の列が期待どおりに動作することを確認するには、秒の各製品の名前、価格、および価格の四分位数を表示するための ASP.NET ページを作成することができます。</span><span class="sxs-lookup"><span data-stu-id="19db0-199">To verify that this additional column works as expected, let s create an ASP.NET page that displays each product s name, price, and price quartile.</span></span> <span data-ttu-id="19db0-200">その前に、まず必要がありますをに、DAL s が呼び出すメソッドを含めるビジネス ロジック層を更新する`GetProductsWithPriceQuartile`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="19db0-200">Before we do that, though, we first need to update the Business Logic Layer to include a method that calls down to the DAL s `GetProductsWithPriceQuartile` method.</span></span> <span data-ttu-id="19db0-201">おによりが手順 3 で BLL を次に、更新され、手順 4. で、ASP.NET ページを作成します。</span><span class="sxs-lookup"><span data-stu-id="19db0-201">We will update the BLL next, in Step 3, and then create the ASP.NET page in Step 4.</span></span>

## <a name="step-3-augmenting-the-business-logic-layer"></a><span data-ttu-id="19db0-202">手順 3: ビジネス ロジック層の拡張</span><span class="sxs-lookup"><span data-stu-id="19db0-202">Step 3: Augmenting the Business Logic Layer</span></span>

<span data-ttu-id="19db0-203">新しいを使用する前に`GetProductsWithPriceQuartile`メソッド プレゼンテーション層から必要がありますまず対応するメソッドに追加 BLL です。</span><span class="sxs-lookup"><span data-stu-id="19db0-203">Before we use the new `GetProductsWithPriceQuartile` method from the Presentation Layer, we should first add a corresponding method to the BLL.</span></span> <span data-ttu-id="19db0-204">開く、`ProductsBLLWithSprocs`クラス ファイルと、次のコードを追加します。</span><span class="sxs-lookup"><span data-stu-id="19db0-204">Open the `ProductsBLLWithSprocs` class file and add the following code:</span></span>


[!code-vb[Main](adding-additional-datatable-columns-vb/samples/sample2.vb)]

<span data-ttu-id="19db0-205">その他のデータの取得のメソッドと同様`ProductsBLLWithSprocs`、`GetProductsWithPriceQuartile`メソッドは、DAL を呼び出すだけ s が対応する`GetProductsWithPriceQuartile`メソッドし、その結果を返します。</span><span class="sxs-lookup"><span data-stu-id="19db0-205">Like the other data retrieval methods in `ProductsBLLWithSprocs`, the `GetProductsWithPriceQuartile` method simply calls the DAL s corresponding `GetProductsWithPriceQuartile` method and returns its results.</span></span>

## <a name="step-4-displaying-the-price-quartile-information-in-an-aspnet-web-page"></a><span data-ttu-id="19db0-206">手順 4: ASP.NET Web ページの価格の四分位数情報を表示します。</span><span class="sxs-lookup"><span data-stu-id="19db0-206">Step 4: Displaying the Price Quartile Information in an ASP.NET Web Page</span></span>

<span data-ttu-id="19db0-207">追加すると、BLL には、各製品の価格の四分位数を表示する ASP.NET ページを作成する準備ができたらおを完了します。</span><span class="sxs-lookup"><span data-stu-id="19db0-207">With the BLL addition complete we re ready to create an ASP.NET page that shows the price quartile for each product.</span></span> <span data-ttu-id="19db0-208">開く、 `AddingColumns.aspx`  ページで、`AdvancedDAL`フォルダーと、デザイナーの設定には、ツールボックスからドラッグ、GridView、`ID`プロパティを`Products`です。</span><span class="sxs-lookup"><span data-stu-id="19db0-208">Open the `AddingColumns.aspx` page in the `AdvancedDAL` folder and drag a GridView from the Toolbox onto the Designer, setting its `ID` property to `Products`.</span></span> <span data-ttu-id="19db0-209">GridView s のスマート タグからにバインドして、という名前の新しい ObjectDataSource`ProductsDataSource`です。</span><span class="sxs-lookup"><span data-stu-id="19db0-209">From the GridView s smart tag, bind it to a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="19db0-210">構成を使用する ObjectDataSource、`ProductsBLLWithSprocs`クラスの`GetProductsWithPriceQuartile`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="19db0-210">Configure the ObjectDataSource to use the `ProductsBLLWithSprocs` class s `GetProductsWithPriceQuartile` method.</span></span> <span data-ttu-id="19db0-211">これは読み取り専用グリッドになる、ため、更新、挿入でドロップダウン リストを設定し、(なし) にタブを削除します。</span><span class="sxs-lookup"><span data-stu-id="19db0-211">Since this will be a read-only grid, set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) .</span></span>


<span data-ttu-id="19db0-212">[![構成、ObjectDataSource ProductsBLLWithSprocs クラスを使用するには](adding-additional-datatable-columns-vb/_static/image24.png)](adding-additional-datatable-columns-vb/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="19db0-212">[![Configure the ObjectDataSource to Use the ProductsBLLWithSprocs Class](adding-additional-datatable-columns-vb/_static/image24.png)](adding-additional-datatable-columns-vb/_static/image23.png)</span></span>

<span data-ttu-id="19db0-213">**図 9**: 構成を使用する ObjectDataSource、`ProductsBLLWithSprocs`クラス ([フルサイズのイメージを表示するをクリックして](adding-additional-datatable-columns-vb/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="19db0-213">**Figure 9**: Configure the ObjectDataSource to Use the `ProductsBLLWithSprocs` Class ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image25.png))</span></span>


<span data-ttu-id="19db0-214">[![GetProductsWithPriceQuartile メソッドから製品情報を取得します。](adding-additional-datatable-columns-vb/_static/image27.png)](adding-additional-datatable-columns-vb/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="19db0-214">[![Retrieve Product Information from the GetProductsWithPriceQuartile Method](adding-additional-datatable-columns-vb/_static/image27.png)](adding-additional-datatable-columns-vb/_static/image26.png)</span></span>

<span data-ttu-id="19db0-215">**図 10**: 製品情報を取得、`GetProductsWithPriceQuartile`メソッド ([フルサイズのイメージを表示するをクリックして](adding-additional-datatable-columns-vb/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="19db0-215">**Figure 10**: Retrieve Product Information from the `GetProductsWithPriceQuartile` Method ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image28.png))</span></span>


<span data-ttu-id="19db0-216">データ ソース構成ウィザードを完了すると、Visual Studio が自動的に追加 BoundField または CheckBoxField GridView の各メソッドによって返されるデータ フィールドのです。</span><span class="sxs-lookup"><span data-stu-id="19db0-216">After completing the Configure Data Source wizard, Visual Studio will automatically add a BoundField or CheckBoxField to the GridView for each of the data fields returned by the method.</span></span> <span data-ttu-id="19db0-217">これらのデータ フィールドの 1 つは`PriceQuartile`に追加した列は、`ProductsDataTable`手順 1. でします。</span><span class="sxs-lookup"><span data-stu-id="19db0-217">One of these data fields is `PriceQuartile`, which is the column we added to the `ProductsDataTable` in Step 1.</span></span>

<span data-ttu-id="19db0-218">削除する GridView s のフィールドを編集以外のすべての`ProductName`、 `UnitPrice`、および`PriceQuartile`BoundFields です。</span><span class="sxs-lookup"><span data-stu-id="19db0-218">Edit the GridView s fields, removing all but the `ProductName`, `UnitPrice`, and `PriceQuartile` BoundFields.</span></span> <span data-ttu-id="19db0-219">構成、 `UnitPrice` BoundField を通貨としてその値の書式を設定し、`UnitPrice`と`PriceQuartile`BoundFields 右揃え、中央揃え、それぞれします。</span><span class="sxs-lookup"><span data-stu-id="19db0-219">Configure the `UnitPrice` BoundField to format its value as a currency and have the `UnitPrice` and `PriceQuartile` BoundFields right- and center-aligned, respectively.</span></span> <span data-ttu-id="19db0-220">最後に、残りの BoundFields を更新`HeaderText`プロパティを製品、価格、およびコストの 25%、それぞれします。</span><span class="sxs-lookup"><span data-stu-id="19db0-220">Finally, update the remaining BoundFields `HeaderText` properties to Product, Price, and Price Quartile, respectively.</span></span> <span data-ttu-id="19db0-221">また、GridView s のスマート タグからの並べ替えを有効にするチェック ボックスを確認します。</span><span class="sxs-lookup"><span data-stu-id="19db0-221">Also, check the Enable Sorting checkbox from the GridView s smart tag.</span></span>

<span data-ttu-id="19db0-222">これらの変更後は、GridView と ObjectDataSource s の宣言型マークアップを次のようになります。</span><span class="sxs-lookup"><span data-stu-id="19db0-222">After these modifications, the GridView and ObjectDataSource s declarative markup should look like the following:</span></span>


[!code-aspx[Main](adding-additional-datatable-columns-vb/samples/sample3.aspx)]

<span data-ttu-id="19db0-223">図 11 は、ブラウザーからアクセスすると、このページを示します。</span><span class="sxs-lookup"><span data-stu-id="19db0-223">Figure 11 shows this page when visited through a browser.</span></span> <span data-ttu-id="19db0-224">最初に、製品順に適切な割り当てられている各 product に降順での価格に注意してください`PriceQuartile`値。</span><span class="sxs-lookup"><span data-stu-id="19db0-224">Note that, initially, the products are ordered by their price in descending order with each product assigned an appropriate `PriceQuartile` value.</span></span> <span data-ttu-id="19db0-225">もちろんこのデータを並べ替えるその他の条件によって価格に関して、製品の順位付けをまだ反映価格の四分位数の列値を持つ (図 12 を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="19db0-225">Of course this data can be sorted by other criteria with the Price Quartile column value still reflecting the product s ranking with respect to price (see Figure 12).</span></span>


<span data-ttu-id="19db0-226">[![製品はその価格順に並べ替えられます。](adding-additional-datatable-columns-vb/_static/image30.png)](adding-additional-datatable-columns-vb/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="19db0-226">[![The Products are Ordered by their Prices](adding-additional-datatable-columns-vb/_static/image30.png)](adding-additional-datatable-columns-vb/_static/image29.png)</span></span>

<span data-ttu-id="19db0-227">**図 11**: この製品はその価格順に並べ替えられます ([フルサイズのイメージを表示するには、をクリックして](adding-additional-datatable-columns-vb/_static/image31.png))。</span><span class="sxs-lookup"><span data-stu-id="19db0-227">**Figure 11**: The Products are Ordered by their Prices ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image31.png))</span></span>


<span data-ttu-id="19db0-228">[![製品は、名前順に並べ替えられます。](adding-additional-datatable-columns-vb/_static/image33.png)](adding-additional-datatable-columns-vb/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="19db0-228">[![The Products are Ordered by their Names](adding-additional-datatable-columns-vb/_static/image33.png)](adding-additional-datatable-columns-vb/_static/image32.png)</span></span>

<span data-ttu-id="19db0-229">**図 12**: この製品は、名前順に並べ替えられます ([フルサイズのイメージを表示するには、をクリックして](adding-additional-datatable-columns-vb/_static/image34.png))。</span><span class="sxs-lookup"><span data-stu-id="19db0-229">**Figure 12**: The Products are Ordered by their Names ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image34.png))</span></span>


> [!NOTE]
> <span data-ttu-id="19db0-230">基にして製品の行を色分けするよう、いくつかの行のコードで GridView を補強おでした、`PriceQuartile`値。</span><span class="sxs-lookup"><span data-stu-id="19db0-230">With a few lines of code we could augment the GridView so that it colored the product rows based on their `PriceQuartile` value.</span></span> <span data-ttu-id="19db0-231">最初の四分位数、2 番目の四分位数、明るい黄色で明るい緑でこれらの製品を色やなどお可能性があります。</span><span class="sxs-lookup"><span data-stu-id="19db0-231">We might color those products in the first quartile a light green, those in the second quartile a light yellow, and so forth.</span></span> <span data-ttu-id="19db0-232">ぜひ、この機能を追加します。</span><span class="sxs-lookup"><span data-stu-id="19db0-232">I encourage you to take a moment to add this functionality.</span></span> <span data-ttu-id="19db0-233">GridView の書式設定の更新を必要がある場合を参照してください、[カスタム書式指定ベース時にデータ](../custom-formatting/custom-formatting-based-upon-data-vb.md)チュートリアルです。</span><span class="sxs-lookup"><span data-stu-id="19db0-233">If you need a refresher on formatting a GridView, consult the [Custom Formatting Based Upon Data](../custom-formatting/custom-formatting-based-upon-data-vb.md) tutorial.</span></span>


## <a name="an-alternative-approach---creating-another-tableadapter"></a><span data-ttu-id="19db0-234">その他の方法のもう 1 つの TableAdapter を作成します。</span><span class="sxs-lookup"><span data-stu-id="19db0-234">An Alternative Approach - Creating Another TableAdapter</span></span>

<span data-ttu-id="19db0-235">見たようこのチュートリアルでは、メインのクエリによって略さず以外のデータ フィールドを返す TableAdapter にメソッドを追加するときに、対応する列には、DataTable に追加できます。</span><span class="sxs-lookup"><span data-stu-id="19db0-235">As we saw in this tutorial, when adding a method to a TableAdapter that returns data fields other than those spelled out by the main query, we can add corresponding columns to the DataTable.</span></span> <span data-ttu-id="19db0-236">このようなアプローチにより、ただしを別のデータ フィールドを返す、TableAdapter のメソッドの数が少ないがある場合にのみ、およびそれらの代替データ フィールドが、メイン クエリから大きく変化しない場合に効果的に機能します。</span><span class="sxs-lookup"><span data-stu-id="19db0-236">Such an approach, however, works well only if there are a small number of methods in the TableAdapter that return different data fields and if those alternate data fields do not vary too much from the main query.</span></span>

<span data-ttu-id="19db0-237">列を DataTable に追加するではなく別のデータ フィールドを取得する最初の TableAdapter のメソッドを含むデータセットを代わりに別の TableAdapter を追加できます。</span><span class="sxs-lookup"><span data-stu-id="19db0-237">Rather than adding columns to the DataTable, you can instead add another TableAdapter to the DataSet that contains the methods from the first TableAdapter that return different data fields.</span></span> <span data-ttu-id="19db0-238">このチュートリアルでは、追加するのではなく、`PriceQuartile`列を`ProductsDataTable`(使用されている場所だけで、`GetProductsWithPriceQuartile`メソッド)、という名前のデータセットに追加の TableAdapter を追加おでした`ProductsWithPriceQuartileTableAdapter`ために使用される、`Products_SelectWithPriceQuartile`格納されています。そのメイン クエリとしてプロシージャです。</span><span class="sxs-lookup"><span data-stu-id="19db0-238">For this tutorial, rather than add the `PriceQuartile` column to the `ProductsDataTable` (where it is only used by the `GetProductsWithPriceQuartile` method), we could have added an additional TableAdapter to the DataSet named `ProductsWithPriceQuartileTableAdapter` that used the `Products_SelectWithPriceQuartile` stored procedure as its main query.</span></span> <span data-ttu-id="19db0-239">価格の四分位数で製品情報を取得するために必要な ASP.NET ページを使用、`ProductsWithPriceQuartileTableAdapter`を使用し続けることがしなかったものになる一方で、`ProductsTableAdapter`です。</span><span class="sxs-lookup"><span data-stu-id="19db0-239">ASP.NET pages that needed to get product information with the price quartile would use the `ProductsWithPriceQuartileTableAdapter`, while those that did not could continue to use the `ProductsTableAdapter`.</span></span>

<span data-ttu-id="19db0-240">新しい TableAdapter を追加すると、データ テーブルが untarnished ままになり、列は、TableAdapter のメソッドによって返されるデータ フィールドを正確にミラー化します。</span><span class="sxs-lookup"><span data-stu-id="19db0-240">By adding a new TableAdapter, the DataTables remain untarnished and their columns precisely mirror the data fields returned by their TableAdapter s methods.</span></span> <span data-ttu-id="19db0-241">ただし、追加の Tableadapter には、反復的なタスクと機能を導入できます。</span><span class="sxs-lookup"><span data-stu-id="19db0-241">However, additional TableAdapters can introduce repetitive tasks and functionality.</span></span> <span data-ttu-id="19db0-242">たとえば、これら ASP.NET ページを表示、`PriceQuartile`列もために必要なため、挿入、更新、および削除のサポート、`ProductsWithPriceQuartileTableAdapter`必要とするその`InsertCommand`、 `UpdateCommand`、および`DeleteCommand`プロパティ正しく構成されています。</span><span class="sxs-lookup"><span data-stu-id="19db0-242">For example, if those ASP.NET pages that displayed the `PriceQuartile` column also needed to provide insert, update, and delete support, the `ProductsWithPriceQuartileTableAdapter` would need to have its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties properly configured.</span></span> <span data-ttu-id="19db0-243">これらのプロパティはミラー化中に、 `ProductsTableAdapter` s、この構成、余分なステップが導入されています。</span><span class="sxs-lookup"><span data-stu-id="19db0-243">While these properties would mirror the `ProductsTableAdapter` s, this configuration introduces an extra step.</span></span> <span data-ttu-id="19db0-244">さらはこれで、更新するには 2 つの方法は、削除、または経由のデータベースに製品を追加、`ProductsTableAdapter`と`ProductsWithPriceQuartileTableAdapter`クラスです。</span><span class="sxs-lookup"><span data-stu-id="19db0-244">Moreover, there are now two ways to update, delete, or add a product to the database - through the `ProductsTableAdapter` and `ProductsWithPriceQuartileTableAdapter` classes.</span></span>

<span data-ttu-id="19db0-245">このチュートリアルでのダウンロードに含まれています、`ProductsWithPriceQuartileTableAdapter`クラス内で、`NorthwindWithSprocs`データセットをこの方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="19db0-245">The download for this tutorial includes a `ProductsWithPriceQuartileTableAdapter` class in the `NorthwindWithSprocs` DataSet that illustrates this alternative approach.</span></span>

## <a name="summary"></a><span data-ttu-id="19db0-246">まとめ</span><span class="sxs-lookup"><span data-stu-id="19db0-246">Summary</span></span>

<span data-ttu-id="19db0-247">ほとんどのシナリオでデータ フィールドの同じセットを返すすべての TableAdapter のメソッドが特定のメソッドまたは 2 つの追加フィールドを返す必要があります。</span><span class="sxs-lookup"><span data-stu-id="19db0-247">In most scenarios, all of the methods in a TableAdapter will return the same set of data fields, but there are times when a particular method or two may need to return an additional field.</span></span> <span data-ttu-id="19db0-248">たとえば、[マスター/詳細 DataList でマスター レコードの箇条書きリストの使用について詳しく説明](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md)チュートリアルにメソッドを追加しました、 `CategoriesTableAdapter` s のメイン クエリのデータ フィールドが返されるだけでなくを`NumberOfProducts`フィールド各カテゴリに関連付けられている製品の数を報告します。</span><span class="sxs-lookup"><span data-stu-id="19db0-248">For example, in the [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) tutorial we added a method to the `CategoriesTableAdapter` that, in addition to the main query s data fields, returned a `NumberOfProducts` field that reported the number of products associated with each category.</span></span> <span data-ttu-id="19db0-249">このチュートリアルでは見てでメソッドを追加する、`ProductsTableAdapter`返される、`PriceQuartile`メイン クエリのデータ フィールドだけでなくフィールドです。</span><span class="sxs-lookup"><span data-stu-id="19db0-249">In this tutorial we looked at adding a method in the `ProductsTableAdapter` that returned a `PriceQuartile` field in addition to the main query s data fields.</span></span> <span data-ttu-id="19db0-250">追加のデータをキャプチャするには、は、フィールドは DataTable に対応する列を追加する必要があります TableAdapter のメソッドによって返されます。</span><span class="sxs-lookup"><span data-stu-id="19db0-250">To capture additional data fields returned by the TableAdapter s methods we need to add corresponding columns to the DataTable.</span></span>

<span data-ttu-id="19db0-251">DataTable に列を手動で追加する場合は、TableAdapter がストアド プロシージャを使用することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="19db0-251">If you plan on manually adding columns to the DataTable, it is recommended that the TableAdapter use stored procedures.</span></span> <span data-ttu-id="19db0-252">TableAdapter は、アドホック SQL ステートメントを使用して、いつでも、TableAdapter 構成ウィザード実行のメインのクエリによって返されるデータ フィールドにデータ フィールドのリストを元に戻す方法はすべてされます。</span><span class="sxs-lookup"><span data-stu-id="19db0-252">If the TableAdapter uses ad-hoc SQL statements, any time the TableAdapter Configuration wizard is run all of the methods data field lists revert to the data fields returned by the main query.</span></span> <span data-ttu-id="19db0-253">この問題には拡張されませんストアド プロシージャは、これが推奨される、このチュートリアルで使用されていた理由。</span><span class="sxs-lookup"><span data-stu-id="19db0-253">This problem does not extend to stored procedures, which is why they are recommended and were used in this tutorial.</span></span>

<span data-ttu-id="19db0-254">満足プログラミング!</span><span class="sxs-lookup"><span data-stu-id="19db0-254">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="19db0-255">作成者について</span><span class="sxs-lookup"><span data-stu-id="19db0-255">About the Author</span></span>

<span data-ttu-id="19db0-256">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)、7 つ受け取りますブックとの創設者の作成者[4GuysFromRolla.com](http://www.4guysfromrolla.com)、1998 年からマイクロソフトの Web テクノロジで取り組んできました。</span><span class="sxs-lookup"><span data-stu-id="19db0-256">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="19db0-257">Scott は、コンサルタント、トレーナー、ライターとして機能します。</span><span class="sxs-lookup"><span data-stu-id="19db0-257">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="19db0-258">最新の著書[ *Sam 学べる自分で ASP.NET 2.0 が 24 時間以内に*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)です。</span><span class="sxs-lookup"><span data-stu-id="19db0-258">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="19db0-259">彼に到達できる[ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)彼のブログを使用して含まれているのか[ http://ScottOnWriting.NET](http://ScottOnWriting.NET)です。</span><span class="sxs-lookup"><span data-stu-id="19db0-259">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="19db0-260">感謝の特別な</span><span class="sxs-lookup"><span data-stu-id="19db0-260">Special Thanks To</span></span>

<span data-ttu-id="19db0-261">このチュートリアルの系列は既に多くの便利なレビュー担当者によって確認済みです。</span><span class="sxs-lookup"><span data-stu-id="19db0-261">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="19db0-262">このチュートリアルの潜在顧客レビュー担当者は、ものです。 Schmidt、武島 Goor、「社長補佐 Leigh および Hilton Giesenow でした。</span><span class="sxs-lookup"><span data-stu-id="19db0-262">Lead reviewers for this tutorial were Randy Schmidt, Jacky Goor, Bernadette Leigh, and Hilton Giesenow.</span></span> <span data-ttu-id="19db0-263">今後、MSDN の記事を確認することに関心のあるですか。</span><span class="sxs-lookup"><span data-stu-id="19db0-263">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="19db0-264">場合は、ドロップ me 一度に 1 行ずつ[mitchell@4GuysFromRolla.comです。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="19db0-264">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="19db0-265">[前へ](updating-the-tableadapter-to-use-joins-vb.md)
> [次へ](working-with-computed-columns-vb.md)</span><span class="sxs-lookup"><span data-stu-id="19db0-265">[Previous](updating-the-tableadapter-to-use-joins-vb.md)
[Next](working-with-computed-columns-vb.md)</span></span>
