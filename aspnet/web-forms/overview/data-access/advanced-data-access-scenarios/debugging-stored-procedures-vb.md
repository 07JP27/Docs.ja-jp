---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/debugging-stored-procedures-vb
title: "ストアド プロシージャ (VB) のデバッグ |Microsoft ドキュメント"
author: rick-anderson
description: "Visual Studio Professional edition および Team System edition を使用すると、ブレークポイントを設定し、SQL Server のストアド プロシージャにステップで、格納されているにデバッグする."
ms.author: aspnetcontent
manager: wpickett
ms.date: 08/03/2007
ms.topic: article
ms.assetid: 9ed8ccb5-5f31-4eb4-976d-cabf4b45ca09
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/debugging-stored-procedures-vb
msc.type: authoredcontent
ms.openlocfilehash: ad09847d828d02019a72e3022d035a8fbe921568
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/24/2018
---
<a name="debugging-stored-procedures-vb"></a><span data-ttu-id="f631c-103">ストアド プロシージャ (VB) のデバッグ</span><span class="sxs-lookup"><span data-stu-id="f631c-103">Debugging Stored Procedures (VB)</span></span>
====================
<span data-ttu-id="f631c-104">によって[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="f631c-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="f631c-105">[コードをダウンロードする](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_74_VB.zip)または[PDF のダウンロード](debugging-stored-procedures-vb/_static/datatutorial74vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="f631c-105">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_74_VB.zip) or [Download PDF](debugging-stored-procedures-vb/_static/datatutorial74vb1.pdf)</span></span>

> <span data-ttu-id="f631c-106">Visual Studio Professional edition および Team System edition を使用すると、ブレークポイントを設定し、SQL Server のストアド プロシージャにステップで、アプリケーション コードのデバッグと同じくらい簡単ストアド プロシージャのデバッグを作成できます。</span><span class="sxs-lookup"><span data-stu-id="f631c-106">Visual Studio Professional and Team System editions allow you to set breakpoints and step in to stored procedures within SQL Server, making debugging stored procedures as easy as debugging application code.</span></span> <span data-ttu-id="f631c-107">このチュートリアルでは、ダイレクト データベース デバッグと、アプリケーションは、ストアド プロシージャのデバッグについて説明します。</span><span class="sxs-lookup"><span data-stu-id="f631c-107">This tutorial demonstrates direct database debugging and application debugging of stored procedures.</span></span>


## <a name="introduction"></a><span data-ttu-id="f631c-108">はじめに</span><span class="sxs-lookup"><span data-stu-id="f631c-108">Introduction</span></span>

<span data-ttu-id="f631c-109">Visual Studio には、豊富なデバッグ機能が用意されています。</span><span class="sxs-lookup"><span data-stu-id="f631c-109">Visual Studio provides a rich debugging experience.</span></span> <span data-ttu-id="f631c-110">いくつかのキー ストロークやマウスのクリックで、ブレークポイントを使用して、プログラムの実行を停止し、その状態と制御フローを確認することが可能です。</span><span class="sxs-lookup"><span data-stu-id="f631c-110">With a few keystrokes or clicks of the mouse, it s possible to use breakpoints to stop execution of a program and examine its state and control flow.</span></span> <span data-ttu-id="f631c-111">アプリケーション コードをデバッグするとは、Visual Studio は、SQL Server 内からのストアド プロシージャのデバッグのサポートを提供します。</span><span class="sxs-lookup"><span data-stu-id="f631c-111">Along with debugging application code, Visual Studio offers support for debugging stored procedures from within SQL Server.</span></span> <span data-ttu-id="f631c-112">ASP.NET 分離コード クラスまたはビジネス ロジック層クラスのコード内でブレークポイントを設定するのと同じように、すぎることができますに配置するストアド プロシージャ内で。</span><span class="sxs-lookup"><span data-stu-id="f631c-112">Just like breakpoints can be set within the code of an ASP.NET code-behind class or Business Logic Layer class, so too can they be placed within stored procedures.</span></span>

<span data-ttu-id="f631c-113">このチュートリアルでを見てみましょうにステップ イン ストアド プロシージャから Visual Studio 内でサーバー エクスプ ローラーにもヒットしたブレークポイントを設定するストアド プロシージャが呼び出されたとき、実行中の ASP.NET アプリケーションからどのようにします。</span><span class="sxs-lookup"><span data-stu-id="f631c-113">In this tutorial we will look at stepping into stored procedures from the Server Explorer within Visual Studio as well as how to set breakpoints that are hit when the stored procedure is called from the running ASP.NET application.</span></span>

> [!NOTE]
> <span data-ttu-id="f631c-114">残念ながら、ストアド プロシージャのみにステップ インして、Visual Studio のバージョンの Professional とチームのシステム バージョンをデバッグします。</span><span class="sxs-lookup"><span data-stu-id="f631c-114">Unfortunately, stored procedures can only be stepped into and debugged through the Professional and Team Systems versions of Visual Studio.</span></span> <span data-ttu-id="f631c-115">Visual Web Developer または標準のバージョンの Visual Studio を使用している場合は、ストアド プロシージャをデバッグするための手順を進めながら、コンピューターでこれらの手順をレプリケートすることはできません、に沿って読み取りへようこそ。</span><span class="sxs-lookup"><span data-stu-id="f631c-115">If you are using Visual Web Developer or the standard version of Visual Studio, you are welcome to read along as we walk through the steps necessary to debug stored procedures, but you will not be able to replicate these steps on your machine.</span></span>


## <a name="sql-server-debugging-concepts"></a><span data-ttu-id="f631c-116">SQL Server デバッグの概念</span><span class="sxs-lookup"><span data-stu-id="f631c-116">SQL Server Debugging Concepts</span></span>

<span data-ttu-id="f631c-117">Microsoft SQL Server 2005 の設計との統合環境を[共通言語ランタイム (CLR)](https://msdn.microsoft.com/netframework/aa497266.aspx)、これは、すべての .NET アセンブリで使用されるランタイム。</span><span class="sxs-lookup"><span data-stu-id="f631c-117">Microsoft SQL Server 2005 was designed to provide integration with the [Common Language Runtime (CLR)](https://msdn.microsoft.com/netframework/aa497266.aspx), which is the runtime used by all .NET assemblies.</span></span> <span data-ttu-id="f631c-118">その結果、SQL Server 2005 では、マネージ データベース オブジェクトをサポートしています。</span><span class="sxs-lookup"><span data-stu-id="f631c-118">Consequently, SQL Server 2005 supports managed database objects.</span></span> <span data-ttu-id="f631c-119">つまり、Visual Basic のクラスのメソッドとして、ストアド プロシージャおよびユーザー定義関数 (Udf) のようなデータベース オブジェクトを作成できます。</span><span class="sxs-lookup"><span data-stu-id="f631c-119">That is, you can create database objects like stored procedures and User-Defined Functions (UDFs) as methods in a Visual Basic class.</span></span> <span data-ttu-id="f631c-120">これにより、これらのストアド プロシージャおよび Udf を .NET Framework では、独自のカスタム クラスからの機能を利用できます。</span><span class="sxs-lookup"><span data-stu-id="f631c-120">This enables these stored procedures and UDFs to utilize functionality in the .NET Framework and from your own custom classes.</span></span> <span data-ttu-id="f631c-121">もちろん、SQL Server 2005 は、T-SQL でデータベース オブジェクトに対するサポートも提供しています。</span><span class="sxs-lookup"><span data-stu-id="f631c-121">Of course, SQL Server 2005 also provides support for T-SQL database objects.</span></span>

<span data-ttu-id="f631c-122">SQL Server 2005 では、T-SQL とマネージ データベース オブジェクトの両方に対するデバッグのサポートを提供します。</span><span class="sxs-lookup"><span data-stu-id="f631c-122">SQL Server 2005 offers debugging support for both T-SQL and managed database objects.</span></span> <span data-ttu-id="f631c-123">ただし、これらのオブジェクトは、Visual Studio 2005 Professional とチームのシステムのエディションでのみデバッグできます。</span><span class="sxs-lookup"><span data-stu-id="f631c-123">However, these objects can only be debugged through Visual Studio 2005 Professional and Team Systems editions.</span></span> <span data-ttu-id="f631c-124">このチュートリアルでは、デバッグの T-SQL でデータベース オブジェクトについて調べます。</span><span class="sxs-lookup"><span data-stu-id="f631c-124">In this tutorial we will examine debugging T-SQL database objects.</span></span> <span data-ttu-id="f631c-125">以降のチュートリアルは、マネージ データベース オブジェクトのデバッグで検索します。</span><span class="sxs-lookup"><span data-stu-id="f631c-125">The subsequent tutorial looks at debugging managed database objects.</span></span>

<span data-ttu-id="f631c-126">[概要の T-SQL と CLR の SQL Server 2005 でデバッグ](https://blogs.msdn.com/sqlclr/archive/2006/06/29/651644.aspx)からブログ エントリ、 [SQL Server 2005 の CLR 統合のチーム](https://blogs.msdn.com/sqlclr/default.aspx)Visual Studio から SQL Server 2005 のオブジェクトをデバッグする 3 つの方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="f631c-126">The [Overview of T-SQL and CLR Debugging in SQL Server 2005](https://blogs.msdn.com/sqlclr/archive/2006/06/29/651644.aspx) blog entry from the [SQL Server 2005 CLR Integration team](https://blogs.msdn.com/sqlclr/default.aspx) highlights the three ways to debug SQL Server 2005 objects from Visual Studio:</span></span>

- <span data-ttu-id="f631c-127">**データベースのデバッグ (DDD) を直接**- サーバー エクスプ ローラーのストアド プロシージャおよび Udf など、すべての T-SQL でデータベース オブジェクトにはステップ インできます。</span><span class="sxs-lookup"><span data-stu-id="f631c-127">**Direct Database Debugging (DDD)** - from Server Explorer we can step into any T-SQL database object, such as stored procedures and UDFs.</span></span> <span data-ttu-id="f631c-128">手順 1. で DDD を見ていきます。</span><span class="sxs-lookup"><span data-stu-id="f631c-128">We will examine DDD in Step 1.</span></span>
- <span data-ttu-id="f631c-129">**アプリケーションのデバッグ**-データベース オブジェクト内のブレークポイントを設定したり、ASP.NET アプリケーションを実行できます。</span><span class="sxs-lookup"><span data-stu-id="f631c-129">**Application Debugging** - we can set breakpoints within a database object and then run our ASP.NET application.</span></span> <span data-ttu-id="f631c-130">データベース オブジェクトを実行すると、ブレークポイントにヒットして、コントロールがデバッガーに引き継がです。</span><span class="sxs-lookup"><span data-stu-id="f631c-130">When the database object is executed, the breakpoint will be hit and control turned over to the debugger.</span></span> <span data-ttu-id="f631c-131">アプリケーションのデバッグとおできませんステップをデータベース オブジェクトにアプリケーション コードからに注意してください。</span><span class="sxs-lookup"><span data-stu-id="f631c-131">Note that with application debugging we cannot step into a database object from application code.</span></span> <span data-ttu-id="f631c-132">お必要があります明示的にブレークポイントを設定でこれらのストアド プロシージャまたは Udf デバッガーを停止します。</span><span class="sxs-lookup"><span data-stu-id="f631c-132">We must explicitly set breakpoints in those stored procedures or UDFs where we want the debugger to stop.</span></span> <span data-ttu-id="f631c-133">アプリケーションのデバッグが検査手順 2. で開始されます。</span><span class="sxs-lookup"><span data-stu-id="f631c-133">Application debugging is examined starting in Step 2.</span></span>
- <span data-ttu-id="f631c-134">**SQL Server プロジェクトからデバッグを**-Visual Studio Professional とチームのシステムのエディションにはマネージ データベース オブジェクトの作成によく使用される SQL Server のプロジェクトの種類が含まれます。</span><span class="sxs-lookup"><span data-stu-id="f631c-134">**Debugging from a SQL Server Project** - Visual Studio Professional and Team Systems editions include a SQL Server Project type that is commonly used to create managed database objects.</span></span> <span data-ttu-id="f631c-135">SQL Server のプロジェクトを使用してを見ていきますとその内容を次のチュートリアルでデバッグします。</span><span class="sxs-lookup"><span data-stu-id="f631c-135">We will examine using SQL Server Projects and debugging their contents in the next tutorial.</span></span>

<span data-ttu-id="f631c-136">Visual Studio では、ローカルおよびリモートの SQL Server インスタンス上のストアド プロシージャをデバッグできます。</span><span class="sxs-lookup"><span data-stu-id="f631c-136">Visual Studio can debug stored procedures on local and remote SQL Server instances.</span></span> <span data-ttu-id="f631c-137">ローカルの SQL Server インスタンスとは、Visual Studio と同じコンピューターにインストールされているです。</span><span class="sxs-lookup"><span data-stu-id="f631c-137">A local SQL Server instance is one that is installed on the same machine as Visual Studio.</span></span> <span data-ttu-id="f631c-138">使用している SQL Server データベースが開発用コンピューターにない場合は、リモート インスタンスを見なされます。</span><span class="sxs-lookup"><span data-stu-id="f631c-138">If the SQL Server database you are using is not located on your development machine, then it is considered a remote instance.</span></span> <span data-ttu-id="f631c-139">これらのチュートリアルの使用していたローカルの SQL Server インスタンス。</span><span class="sxs-lookup"><span data-stu-id="f631c-139">For these tutorials we have been using local SQL Server instances.</span></span> <span data-ttu-id="f631c-140">リモート SQL server インスタンス上のストアド プロシージャをデバッグするには、ローカル インスタンス上のストアド プロシージャのデバッグよりも多くの構成手順が必要です。</span><span class="sxs-lookup"><span data-stu-id="f631c-140">Debugging stored procedures on a remote SQL server instance requires more configuration steps than when debugging stored procedures on a local instance.</span></span>

<span data-ttu-id="f631c-141">ローカル SQL Server インスタンスを使用している場合は、手順 1 から始まります。 と末尾には、このチュートリアルです。</span><span class="sxs-lookup"><span data-stu-id="f631c-141">If you are using a local SQL Server instance, you can start with Step 1 and work through this tutorial to the end.</span></span> <span data-ttu-id="f631c-142">リモートの SQL Server インスタンスを使用している場合が表示されます、開発用コンピューターをリモート インスタンスで SQL Server ログインを持つ Windows ユーザー アカウントを使用することを確認するをデバッグするときに最初の必要性がログに記録されます。</span><span class="sxs-lookup"><span data-stu-id="f631c-142">If you are using a remote SQL Server instance, however, you will first need to ensure that when debugging you are logged to your development machine with a Windows user account that has a SQL Server login on the remote instance.</span></span> <span data-ttu-id="f631c-143">Moveover、このデータベースのログインと、実行中の ASP.NET アプリケーションからデータベースへの接続に使用するデータベース ログインの両方のメンバーである必要があります、`sysadmin`ロール。</span><span class="sxs-lookup"><span data-stu-id="f631c-143">Moveover, both this database login and the database login used to connect to the database from the running ASP.NET application must be members of the `sysadmin` role.</span></span> <span data-ttu-id="f631c-144">リモート インスタンスをデバッグするには、Visual Studio および SQL Server の構成の詳細については、このチュートリアルの最後に、リモート インスタンスのセクションで、デバッグの T-SQL でデータベース オブジェクトを参照してください。</span><span class="sxs-lookup"><span data-stu-id="f631c-144">See the Debugging T-SQL Database Objects on Remote Instances section at the end of this tutorial for more information on configuring Visual Studio and SQL Server to debug a remote instance.</span></span>

<span data-ttu-id="f631c-145">最後に、T-SQL でデータベース オブジェクトのデバッグをサポートされている .NET アプリケーションのデバッグをサポートと豊富な機能としてを理解します。</span><span class="sxs-lookup"><span data-stu-id="f631c-145">Finally, understand that debugging support for T-SQL database objects is not as feature rich as debugging support for .NET applications.</span></span> <span data-ttu-id="f631c-146">たとえば、ブレークポイントの条件およびフィルターはサポートされていません、のみ、デバッグ ウィンドウのサブセットが使用可能なエディット コンティニュを使用することはできません、役に立たないなど、イミディ エイト ウィンドウが表示されます。</span><span class="sxs-lookup"><span data-stu-id="f631c-146">For example, breakpoint conditions and filters are not supported, only a subset of the debugging windows are available, you cannot use Edit and Continue, the Immediate window is rendered useless, and so forth.</span></span> <span data-ttu-id="f631c-147">参照してください[デバッガー コマンドおよび機能に関する制限事項](https://msdn.microsoft.com/library/ms165035(VS.80).aspx)詳細についてはします。</span><span class="sxs-lookup"><span data-stu-id="f631c-147">See [Limitations on Debugger Commands and Features](https://msdn.microsoft.com/library/ms165035(VS.80).aspx) for more information.</span></span>

## <a name="step-1-directly-stepping-into-a-stored-procedure"></a><span data-ttu-id="f631c-148">手順 1: は、ストアド プロシージャに直接ステップ イン</span><span class="sxs-lookup"><span data-stu-id="f631c-148">Step 1: Directly Stepping Into a Stored Procedure</span></span>

<span data-ttu-id="f631c-149">Visual Studio では、データベース オブジェクトを直接デバッグが容易にします。</span><span class="sxs-lookup"><span data-stu-id="f631c-149">Visual Studio makes it easy to directly debug a database object.</span></span> <span data-ttu-id="f631c-150">S、ダイレクト データベース デバッグ (DDD) 機能を使用して、ステップ インする方法を確認できるように、`Products_SelectByCategoryID`ストアド プロシージャを Northwind データベースでします。</span><span class="sxs-lookup"><span data-stu-id="f631c-150">Let s look at how to use the Direct Database Debugging (DDD) feature to step into the `Products_SelectByCategoryID` stored procedure in the Northwind database.</span></span> <span data-ttu-id="f631c-151">その名前からわかるように、`Products_SelectByCategoryID`が特定のカテゴリの製品情報を返しますで作成されて、[を使用して既存のストアド プロシージャを型指定されたデータセットの Tableadapter](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)チュートリアルです。</span><span class="sxs-lookup"><span data-stu-id="f631c-151">As its name implies, `Products_SelectByCategoryID` returns product information for a particular category; it was created in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span></span> <span data-ttu-id="f631c-152">サーバー エクスプ ローラーに移動して起動し、Northwind データベース ノードを展開します。</span><span class="sxs-lookup"><span data-stu-id="f631c-152">Start by going to the Server Explorer and expand the Northwind database node.</span></span> <span data-ttu-id="f631c-153">次に、ストアド プロシージャ フォルダーにドリル ダウンを右クリックし、`Products_SelectByCategoryID`ストアド プロシージャ、およびコンテキスト メニューからストアド プロシージャにステップ イン オプションを選択します。</span><span class="sxs-lookup"><span data-stu-id="f631c-153">Next, drill down into the Stored Procedures folder, right-click on the `Products_SelectByCategoryID` stored procedure, and choose the Step Into Stored Procedure option from the context menu.</span></span> <span data-ttu-id="f631c-154">これにより、デバッガーが開始されます。</span><span class="sxs-lookup"><span data-stu-id="f631c-154">This will start the debugger.</span></span>

<span data-ttu-id="f631c-155">`Products_SelectByCategoryID`ストアド プロシージャが必要ですが、`@CategoryID`入力パラメーターは、この値を指定する求められます。</span><span class="sxs-lookup"><span data-stu-id="f631c-155">Since the `Products_SelectByCategoryID` stored procedure expects a `@CategoryID` input parameter, we are asked to provide this value.</span></span> <span data-ttu-id="f631c-156">これにより、飲み物に関する情報が返されます 1 を入力します。</span><span class="sxs-lookup"><span data-stu-id="f631c-156">Enter 1, which will return information about the beverages.</span></span>


![値 1 を使用して、@CategoryIDパラメーター](debugging-stored-procedures-vb/_static/image1.png)

<span data-ttu-id="f631c-158">**図 1**: の値 1 を使用して、`@CategoryID`パラメーター</span><span class="sxs-lookup"><span data-stu-id="f631c-158">**Figure 1**: Use the Value 1 for the `@CategoryID` Parameter</span></span>


<span data-ttu-id="f631c-159">値を提供した後、`@CategoryID`パラメーター、ストアド プロシージャを実行します。</span><span class="sxs-lookup"><span data-stu-id="f631c-159">After supplying the value for the `@CategoryID` parameter, the stored procedure is executed.</span></span> <span data-ttu-id="f631c-160">を完了するまで実行しているのではなく、デバッガーが停止の最初のステートメントを実行します。</span><span class="sxs-lookup"><span data-stu-id="f631c-160">Rather than running to completion, though, the debugger halts execution on the first statement.</span></span> <span data-ttu-id="f631c-161">ストアド プロシージャの現在の位置を示す、余白の黄色の矢印に注意してください。</span><span class="sxs-lookup"><span data-stu-id="f631c-161">Note the yellow arrow in the margin, indicating the current location in the stored procedure.</span></span> <span data-ttu-id="f631c-162">表示して、[ウォッチ] ウィンドウ、またはストアド プロシージャでパラメーター名の上にマウスでパラメーター値を編集します。</span><span class="sxs-lookup"><span data-stu-id="f631c-162">You can view and edit parameter values through the Watch window or by hovering over the parameter name in the stored procedure.</span></span>


<span data-ttu-id="f631c-163">[![ストアド プロシージャの最初のステートメントでデバッガーが停止しました](debugging-stored-procedures-vb/_static/image3.png)](debugging-stored-procedures-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="f631c-163">[![The Debugger has Halted on the First Statement of the Stored Procedure](debugging-stored-procedures-vb/_static/image3.png)](debugging-stored-procedures-vb/_static/image2.png)</span></span>

<span data-ttu-id="f631c-164">**図 2**: ストアド プロシージャの最初のステートメントでデバッガーが停止しました ([フルサイズのイメージを表示するをクリックして](debugging-stored-procedures-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="f631c-164">**Figure 2**: The Debugger has Halted on the First Statement of the Stored Procedure ([Click to view full-size image](debugging-stored-procedures-vb/_static/image4.png))</span></span>


<span data-ttu-id="f631c-165">一度に 1 つのストアド プロシージャのステートメントをステップ、ツールバーのステップ オーバー ボタンをクリックしてまたは F10 キーを押すとします。</span><span class="sxs-lookup"><span data-stu-id="f631c-165">To step through the stored procedure one statement at a time, click the Step Over button in the Toolbar or hit the F10 key.</span></span> <span data-ttu-id="f631c-166">`Products_SelectByCategoryID`ストアド プロシージャには、1 つが含まれています。`SELECT`ステートメントでは、1 つのステートメントにステップ オーバーし、ストアド プロシージャの実行が完了されます f10 キーを押すようにします。</span><span class="sxs-lookup"><span data-stu-id="f631c-166">The `Products_SelectByCategoryID` stored procedure contains a single `SELECT` statement, so hitting F10 will step over the single statement and complete the execution of the stored procedure.</span></span> <span data-ttu-id="f631c-167">ストアド プロシージャが完了すると、その出力は、出力ウィンドウに表示されます、デバッガーが終了します。</span><span class="sxs-lookup"><span data-stu-id="f631c-167">After the stored procedure has completed, its output will appear in the Output window and the debugger will terminate.</span></span>

> [!NOTE]
> <span data-ttu-id="f631c-168">ステートメント レベルで発生する T-SQL デバッグステップ インすることはできません、`SELECT`ステートメントです。</span><span class="sxs-lookup"><span data-stu-id="f631c-168">T-SQL debugging occurs at the statement level; you cannot step into a `SELECT` statement.</span></span>


## <a name="step-2-configuring-the-website-for-application-debugging"></a><span data-ttu-id="f631c-169">手順 2: アプリケーションのデバッグの web サイトを構成します。</span><span class="sxs-lookup"><span data-stu-id="f631c-169">Step 2: Configuring the Website for Application Debugging</span></span>

<span data-ttu-id="f631c-170">サーバー エクスプ ローラーから直接ストアド プロシージャのデバッグは便利ですが、多くのシナリオで興味のあるより ASP.NET アプリケーションから呼び出された場合、ストアド プロシージャをデバッグします。</span><span class="sxs-lookup"><span data-stu-id="f631c-170">While debugging a stored procedure directly from the Server Explorer is handy, in many scenarios we are more interested in debugging the stored procedure when it is called from our ASP.NET application.</span></span> <span data-ttu-id="f631c-171">Visual Studio 内からのストアド プロシージャにブレークポイントを追加したり、ASP.NET アプリケーションのデバッグを開始してできます。</span><span class="sxs-lookup"><span data-stu-id="f631c-171">We can add breakpoints to a stored procedure from within Visual Studio and then start debugging the ASP.NET application.</span></span> <span data-ttu-id="f631c-172">アプリケーションからのブレークポイントを持つストアド プロシージャが呼び出されると、実行がブレークポイントで停止しますおできます表示およびとストアド プロシージャのパラメーター値の変更手順 1 で行ったのと同じように、そのステートメントをステップします。</span><span class="sxs-lookup"><span data-stu-id="f631c-172">When a stored procedure with breakpoints is invoked from the application, execution will halt at the breakpoint and we can view and change the stored procedure s parameter values and step through its statements, just like we did in Step 1.</span></span>

<span data-ttu-id="f631c-173">アプリケーションから呼び出されたストアド プロシージャのデバッグを始めることができます、前にデバッガーでは、SQL Server を統合する ASP.NET web アプリケーションに指示する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f631c-173">Before we can start debugging stored procedures called from the application, we need to instruct the ASP.NET web application to integrate with the SQL Server debugger.</span></span> <span data-ttu-id="f631c-174">ソリューション エクスプ ローラーで web サイト名を右クリックして開始 (`ASPNET_Data_Tutorial_74_VB`)。</span><span class="sxs-lookup"><span data-stu-id="f631c-174">Start by right-clicking on the website name in the Solution Explorer (`ASPNET_Data_Tutorial_74_VB`).</span></span> <span data-ttu-id="f631c-175">コンテキスト メニューからプロパティ ページのオプションを選択し、左側の 開始オプション項目を選択し、デバッガー セクションで SQL Server のチェック ボックスをオン (図 3 を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="f631c-175">Choose the Property Pages option from the context menu, select the Start Options item on the left, and check the SQL Server checkbox in the Debuggers section (see Figure 3).</span></span>


<span data-ttu-id="f631c-176">[![アプリケーションのプロパティ ページで、SQL Server のチェック ボックスをオンします。](debugging-stored-procedures-vb/_static/image6.png)](debugging-stored-procedures-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="f631c-176">[![Check the SQL Server Checkbox in the Application s Property Pages](debugging-stored-procedures-vb/_static/image6.png)](debugging-stored-procedures-vb/_static/image5.png)</span></span>

<span data-ttu-id="f631c-177">**図 3**: アプリケーションのプロパティ ページで SQL Server のチェック ボックスをオン ([フルサイズのイメージを表示するをクリックして](debugging-stored-procedures-vb/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="f631c-177">**Figure 3**: Check the SQL Server Checkbox in the Application s Property Pages ([Click to view full-size image](debugging-stored-procedures-vb/_static/image7.png))</span></span>


<span data-ttu-id="f631c-178">さらに、接続プールを無効にするように、アプリケーションで使用されるデータベース接続文字列を更新する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f631c-178">Additionally, we need to update the database connection string used by the application so that connection pooling is disabled.</span></span> <span data-ttu-id="f631c-179">データベースへの接続が閉じられたときに、対応する`SqlConnection`オブジェクトが使用可能な接続のプールに配置されます。</span><span class="sxs-lookup"><span data-stu-id="f631c-179">When a connection to a database is closed, the corresponding `SqlConnection` object is placed in a pool of available connections.</span></span> <span data-ttu-id="f631c-180">データベースへの接続を確立するときに使用可能な接続オブジェクトこのプールから取得できるではなくを作成し、新しい接続を確立することです。</span><span class="sxs-lookup"><span data-stu-id="f631c-180">When establishing a connection to a database, an available connection object can be retrieved from this pool rather than having to create and establish a new connection.</span></span> <span data-ttu-id="f631c-181">このプールの接続オブジェクトのパフォーマンスが向上し、既定で有効にします。</span><span class="sxs-lookup"><span data-stu-id="f631c-181">This pooling of connection objects is a performance enhancement and is enabled by default.</span></span> <span data-ttu-id="f631c-182">ただし、デバッグするときにデバッグ インフラストラクチャがない正しく再確立しましたがプールから作成された接続を使用する場合、接続がプールをオフにします。</span><span class="sxs-lookup"><span data-stu-id="f631c-182">However, when debugging we want to turn off connection pooling because the debugging infrastructure is not correctly reestablished when working with a connection that was taken from the pool.</span></span>

<span data-ttu-id="f631c-183">無効になっている接続プールを更新、`NORTHWNDConnectionString`で`Web.config`設定が含まれるように`Pooling=false`です。</span><span class="sxs-lookup"><span data-stu-id="f631c-183">To disabled connection pooling, update the `NORTHWNDConnectionString` in `Web.config` so that it includes the setting `Pooling=false` .</span></span>


[!code-xml[Main](debugging-stored-procedures-vb/samples/sample1.xml)]

> [!NOTE]
> <span data-ttu-id="f631c-184">終了したら、ASP.NET アプリケーションを使用して SQL Server、デバッグを必ず接続プールを削除することで元に戻す、`Pooling`接続文字列から設定 (または設定することによって`Pooling=true`)。</span><span class="sxs-lookup"><span data-stu-id="f631c-184">Once you have finished debugging SQL Server through the ASP.NET application be sure to reinstate connection pooling by removing the `Pooling` setting from the connection string (or by setting it to `Pooling=true` ).</span></span>


<span data-ttu-id="f631c-185">この時点で、ASP.NET アプリケーションされている Visual Studio での web アプリケーションから呼び出されたときに、SQL Server データベース オブジェクトをデバッグするようにします。</span><span class="sxs-lookup"><span data-stu-id="f631c-185">At this point the ASP.NET application has been configured to allow Visual Studio to debug SQL Server database objects when invoked through the web application.</span></span> <span data-ttu-id="f631c-186">ストアド プロシージャにブレークポイントを追加し、デバッグを開始するようになりましたの残りのすべてが!</span><span class="sxs-lookup"><span data-stu-id="f631c-186">All that remains now is to add a breakpoint to a stored procedure and start debugging!</span></span>

## <a name="step-3-adding-a-breakpoint-and-debugging"></a><span data-ttu-id="f631c-187">手順 3: ブレークポイントを追加して、デバッグ</span><span class="sxs-lookup"><span data-stu-id="f631c-187">Step 3: Adding a Breakpoint and Debugging</span></span>

<span data-ttu-id="f631c-188">開く、`Products_SelectByCategoryID`ストアド プロシージャとの先頭にブレークポイントを設定、`SELECT`ステートメントの適切な場所にある余白をクリックして、またはの開始時にカーソルを配置することによって、`SELECT`ステートメントと f9 キーを押します。</span><span class="sxs-lookup"><span data-stu-id="f631c-188">Open the `Products_SelectByCategoryID` stored procedure and set a breakpoint at the start of the `SELECT` statement by clicking in the margin at the appropriate place or by placing your cursor at the start of the `SELECT` statement and hitting F9.</span></span> <span data-ttu-id="f631c-189">図 4 に示すように、ブレークポイントが余白に赤い円として表示されます。</span><span class="sxs-lookup"><span data-stu-id="f631c-189">As Figure 4 illustrates, the breakpoint appears as a red circle in the margin.</span></span>


<span data-ttu-id="f631c-190">[![ブレークポイントを設定、Products_SelectByCategoryID でストアド プロシージャ](debugging-stored-procedures-vb/_static/image9.png)](debugging-stored-procedures-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="f631c-190">[![Set a Breakpoint in the Products_SelectByCategoryID Stored Procedure](debugging-stored-procedures-vb/_static/image9.png)](debugging-stored-procedures-vb/_static/image8.png)</span></span>

<span data-ttu-id="f631c-191">**図 4**: にブレークポイントを設定、`Products_SelectByCategoryID`ストアド プロシージャ ([フルサイズのイメージを表示するをクリックして](debugging-stored-procedures-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="f631c-191">**Figure 4**: Set a Breakpoint in the `Products_SelectByCategoryID` Stored Procedure ([Click to view full-size image](debugging-stored-procedures-vb/_static/image10.png))</span></span>


<span data-ttu-id="f631c-192">SQL データベース オブジェクトをクライアント アプリケーションをデバッグするためには、アプリケーションのデバッグをサポートするために、データベースを構成することが不可欠です。</span><span class="sxs-lookup"><span data-stu-id="f631c-192">In order for a SQL database object to be debugged through a client application, it is imperative that the database be configured to support application debugging.</span></span> <span data-ttu-id="f631c-193">最初にブレークポイントを設定すると、この設定は、自動的に切り替える必要がありますを再確認することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="f631c-193">When you first set a breakpoint, this setting should automatically be switched on, but it is prudent to double-check.</span></span> <span data-ttu-id="f631c-194">右クリックし、`NORTHWND.MDF`サーバー エクスプ ローラー内のノードです。</span><span class="sxs-lookup"><span data-stu-id="f631c-194">Right-click on the `NORTHWND.MDF` node in the Server Explorer.</span></span> <span data-ttu-id="f631c-195">コンテキスト メニューには、checked というメニュー項目アプリケーションのデバッグを含める必要があります。</span><span class="sxs-lookup"><span data-stu-id="f631c-195">The context menu should include a checked menu item named Application Debugging .</span></span>


![アプリケーションのデバッグ オプションが有効になっていることを確認してください。](debugging-stored-procedures-vb/_static/image11.png)

<span data-ttu-id="f631c-197">**図 5**: アプリケーションのデバッグ オプションが有効になっていることを確認してください。</span><span class="sxs-lookup"><span data-stu-id="f631c-197">**Figure 5**: Ensure that the Application Debugging Option is Enabled</span></span>


<span data-ttu-id="f631c-198">ブレークポイントを設定およびアプリケーションのデバッグ オプションを有効に、ASP.NET アプリケーションから呼び出された場合は、ストアド プロシージャをデバッグする準備が整いました。</span><span class="sxs-lookup"><span data-stu-id="f631c-198">With the breakpoint set and the Application Debugging option enabled, we are ready to debug the stored procedure when called from the ASP.NET application.</span></span> <span data-ttu-id="f631c-199">デバッグ メニューに移動してデバッガーを起動し、ツールバーでの再生 アイコンの f5 キーを押すか、緑をクリックして、デバッグの開始 を選択します。</span><span class="sxs-lookup"><span data-stu-id="f631c-199">Start the debugger by going to the Debug menu and choosing Start Debugging, by hitting F5, or by clicking the green play icon in the Toolbar.</span></span> <span data-ttu-id="f631c-200">デバッガーを起動され、web サイトを起動します。</span><span class="sxs-lookup"><span data-stu-id="f631c-200">This will start the debugger and launch the website.</span></span>

<span data-ttu-id="f631c-201">`Products_SelectByCategoryID`でストアド プロシージャが作成された、[を使用して既存のストアド プロシージャを型指定されたデータセットの Tableadapter](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)チュートリアルです。</span><span class="sxs-lookup"><span data-stu-id="f631c-201">The `Products_SelectByCategoryID` stored procedure was created in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span></span> <span data-ttu-id="f631c-202">対応する web ページ (`~/AdvancedDAL/ExistingSprocs.aspx`) このストアド プロシージャによって返される結果を表示する GridView が含まれています。</span><span class="sxs-lookup"><span data-stu-id="f631c-202">Its corresponding web page (`~/AdvancedDAL/ExistingSprocs.aspx`) contains a GridView that displays the results returned by this stored procedure.</span></span> <span data-ttu-id="f631c-203">ブラウザーからこのページを参照してください。</span><span class="sxs-lookup"><span data-stu-id="f631c-203">Visit this page through the browser.</span></span> <span data-ttu-id="f631c-204">ページ内のブレークポイントに達すると、`Products_SelectByCategoryID`ストアド プロシージャにヒットして、Visual Studio に制御が返されます。</span><span class="sxs-lookup"><span data-stu-id="f631c-204">Upon reaching the page, the breakpoint in the `Products_SelectByCategoryID` stored procedure will be hit and control returned to Visual Studio.</span></span> <span data-ttu-id="f631c-205">同じように手順 1 で、ビュー、ストアド プロシージャのステートメントをステップできパラメーターの値を変更できます。</span><span class="sxs-lookup"><span data-stu-id="f631c-205">Just like in Step 1, you can step through the stored procedure s statements and view and modify the parameter values.</span></span>


<span data-ttu-id="f631c-206">[![ExistingSprocs.aspx ページ、飲み物を最初に表示します。](debugging-stored-procedures-vb/_static/image13.png)](debugging-stored-procedures-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="f631c-206">[![The ExistingSprocs.aspx Page Initially Displays the Beverages](debugging-stored-procedures-vb/_static/image13.png)](debugging-stored-procedures-vb/_static/image12.png)</span></span>

<span data-ttu-id="f631c-207">**図 6**:`ExistingSprocs.aspx`ページ、飲み物を最初に表示されます ([フルサイズのイメージを表示するをクリックして](debugging-stored-procedures-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="f631c-207">**Figure 6**: The `ExistingSprocs.aspx` Page Initially Displays the Beverages ([Click to view full-size image](debugging-stored-procedures-vb/_static/image14.png))</span></span>


<span data-ttu-id="f631c-208">[![ストアド プロシージャの s ブレークポイントに到達しました](debugging-stored-procedures-vb/_static/image16.png)](debugging-stored-procedures-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="f631c-208">[![The Stored Procedure s Breakpoint has been Reached](debugging-stored-procedures-vb/_static/image16.png)](debugging-stored-procedures-vb/_static/image15.png)</span></span>

<span data-ttu-id="f631c-209">**図 7**: ストアド プロシージャの s がブレークポイントに達した ([フルサイズのイメージを表示するをクリックして](debugging-stored-procedures-vb/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="f631c-209">**Figure 7**: The Stored Procedure s Breakpoint has been Reached ([Click to view full-size image](debugging-stored-procedures-vb/_static/image17.png))</span></span>


<span data-ttu-id="f631c-210">図 7 に示すの値のウォッチ ウィンドウとして、`@CategoryID`パラメーターは 1 です。</span><span class="sxs-lookup"><span data-stu-id="f631c-210">As the Watch window in Figure 7 shows, the value of the `@CategoryID` parameter is 1.</span></span> <span data-ttu-id="f631c-211">これは、ため、`ExistingSprocs.aspx`ページが最初が飲料カテゴリで製品を表示、 `CategoryID` 1 の値。</span><span class="sxs-lookup"><span data-stu-id="f631c-211">This is because the `ExistingSprocs.aspx` page initially displays products in the beverages category, which has a `CategoryID` value of 1.</span></span> <span data-ttu-id="f631c-212">ドロップダウン リストから別のカテゴリを選択します。</span><span class="sxs-lookup"><span data-stu-id="f631c-212">Choose a different category from the drop-down list.</span></span> <span data-ttu-id="f631c-213">そうポストバックを発生させるし、再実行、`Products_SelectByCategoryID`ストアド プロシージャです。</span><span class="sxs-lookup"><span data-stu-id="f631c-213">Doing so causes a postback and re-executes the `Products_SelectByCategoryID` stored procedure.</span></span> <span data-ttu-id="f631c-214">再び、今度は、ブレークポイントがヒットしたら、`@CategoryID`パラメーター s の値がドロップダウン リストを選択したアイテムを反映して`CategoryID`です。</span><span class="sxs-lookup"><span data-stu-id="f631c-214">The breakpoint is hit again, but this time the `@CategoryID` parameter s value reflects the selected drop-down list item s `CategoryID`.</span></span>


<span data-ttu-id="f631c-215">[![ドロップダウン リストから別のカテゴリを選択します。](debugging-stored-procedures-vb/_static/image19.png)](debugging-stored-procedures-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="f631c-215">[![Choose a Different Category from the Drop-Down List](debugging-stored-procedures-vb/_static/image19.png)](debugging-stored-procedures-vb/_static/image18.png)</span></span>

<span data-ttu-id="f631c-216">**図 8**: ドロップダウン リストから別のカテゴリを選択 ([フルサイズのイメージを表示するをクリックして](debugging-stored-procedures-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="f631c-216">**Figure 8**: Choose a Different Category from the Drop-Down List ([Click to view full-size image](debugging-stored-procedures-vb/_static/image20.png))</span></span>


<span data-ttu-id="f631c-217">[![@CategoryIDパラメーターは、Web ページから選択したカテゴリを反映](debugging-stored-procedures-vb/_static/image22.png)](debugging-stored-procedures-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="f631c-217">[![The @CategoryID Parameter Reflects the Category Selected from the Web Page](debugging-stored-procedures-vb/_static/image22.png)](debugging-stored-procedures-vb/_static/image21.png)</span></span>

<span data-ttu-id="f631c-218">**図 9**:`@CategoryID`パラメーターは、Web ページからカテゴリを選択を反映 ([フルサイズのイメージを表示するをクリックして](debugging-stored-procedures-vb/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="f631c-218">**Figure 9**: The `@CategoryID` Parameter Reflects the Category Selected from the Web Page ([Click to view full-size image](debugging-stored-procedures-vb/_static/image23.png))</span></span>


> [!NOTE]
> <span data-ttu-id="f631c-219">場合内のブレークポイント、`Products_SelectByCategoryID`にアクセスすると、ストアド プロシージャはヒットしませんが、 `ExistingSprocs.aspx`  ページで、ASP.NET アプリケーションのプロパティ ページの デバッガー セクションで、SQL Server のチェック ボックスがチェックされたこと、接続プールされていることを確認してください無効な場合、およびデータベースのオプションのアプリケーションのデバッグが有効になっています。</span><span class="sxs-lookup"><span data-stu-id="f631c-219">If the breakpoint in the `Products_SelectByCategoryID` stored procedure is not hit when visiting the `ExistingSprocs.aspx` page, make sure that the SQL Server checkbox has been checked in the Debuggers section of the ASP.NET application s Properties Page, that connection pooling has been disabled, and that the database s Application Debugging option is enabled.</span></span> <span data-ttu-id="f631c-220">Re それでも問題が発生が Visual Studio を再起動し、もう一度やり直してください。</span><span class="sxs-lookup"><span data-stu-id="f631c-220">If you re still having problems, restart Visual Studio and try again.</span></span>


## <a name="debugging-t-sql-database-objects-on-remote-instances"></a><span data-ttu-id="f631c-221">リモート インスタンス上の T-SQL でデータベース オブジェクトのデバッグ</span><span class="sxs-lookup"><span data-stu-id="f631c-221">Debugging T-SQL Database Objects on Remote Instances</span></span>

<span data-ttu-id="f631c-222">SQL Server データベース インスタンスが Visual Studio と同じコンピューターに、Visual Studio でのデータベース オブジェクトのデバッグはきわめて簡単です。</span><span class="sxs-lookup"><span data-stu-id="f631c-222">Debugging database objects through Visual Studio is fairly straightforward when the SQL Server database instance is on the same machine as Visual Studio.</span></span> <span data-ttu-id="f631c-223">ただし、SQL Server および Visual Studio は、異なるコンピューター上に存在する場合、いくつか慎重に構成が必要に正常に動作してコンポーネントをすべて入手です。</span><span class="sxs-lookup"><span data-stu-id="f631c-223">However, if SQL Server and Visual Studio reside on different machines then some careful configuration is required to get everything working properly.</span></span> <span data-ttu-id="f631c-224">直面してお 2 つの主要なタスクがあります。</span><span class="sxs-lookup"><span data-stu-id="f631c-224">There are two core tasks we are faced with:</span></span>

- <span data-ttu-id="f631c-225">ADO.NET を使用してデータベースへの接続に使用するログインに属していることを確認してください、`sysadmin`ロール。</span><span class="sxs-lookup"><span data-stu-id="f631c-225">Ensure that the login used to connect to the database via ADO.NET belongs to the `sysadmin` role.</span></span>
- <span data-ttu-id="f631c-226">Visual Studio によって開発用コンピューターで使用する Windows ユーザー アカウントが有効な SQL Server ログイン アカウントに属しているであることを確認、`sysadmin`ロール。</span><span class="sxs-lookup"><span data-stu-id="f631c-226">Ensure that the Windows user account used by Visual Studio on the development machine is a valid SQL Server login account that belongs to the `sysadmin` role.</span></span>

<span data-ttu-id="f631c-227">最初の手順では、比較的簡単です。</span><span class="sxs-lookup"><span data-stu-id="f631c-227">The first step is relatively straightforward.</span></span> <span data-ttu-id="f631c-228">最初に、ASP.NET アプリケーションからデータベースに接続し、次に、SQL Server Management Studio からそのログイン アカウントを追加するために使用するユーザー アカウントを特定、`sysadmin`ロール。</span><span class="sxs-lookup"><span data-stu-id="f631c-228">First, identify the user account used to connect to the database from the ASP.NET application and then, from SQL Server Management Studio, add that login account to the `sysadmin` role.</span></span>

<span data-ttu-id="f631c-229">2 番目のタスクでは、アプリケーションのデバッグを使用する Windows ユーザー アカウントがリモート データベースで有効なログインである必要があります。</span><span class="sxs-lookup"><span data-stu-id="f631c-229">The second task requires that the Windows user account you use to debug the application be a valid login on the remote database.</span></span> <span data-ttu-id="f631c-230">ただしでワークステーションにログオンした Windows アカウントが SQL Server 上の有効なログインが高くなります。</span><span class="sxs-lookup"><span data-stu-id="f631c-230">However, chances are the Windows account you logged on to your workstation with is not a valid login on SQL Server.</span></span> <span data-ttu-id="f631c-231">SQL Server に、特定のログイン アカウントを追加するのではなく、SQL Server デバッグ アカウントとしてその Windows ユーザー アカウントを指定する方が適切になります。</span><span class="sxs-lookup"><span data-stu-id="f631c-231">Rather than adding your particular login account to SQL Server, a better choice would be to designate some Windows user account as the SQL Server debugging account.</span></span> <span data-ttu-id="f631c-232">次に、リモートの SQL Server インスタンスのデータベース オブジェクトをデバッグするには、その Windows ログイン アカウントの資格情報を使用して Visual Studio を実行します。</span><span class="sxs-lookup"><span data-stu-id="f631c-232">Then, to debug the database objects of a remote SQL Server instance, you would run Visual Studio using that Windows login account s credentials.</span></span>

<span data-ttu-id="f631c-233">例は、点をわかりやすくなります。</span><span class="sxs-lookup"><span data-stu-id="f631c-233">An example should help clarify things.</span></span> <span data-ttu-id="f631c-234">という名前の Windows アカウントがあることを想像`SQLDebug`Windows ドメイン内で。</span><span class="sxs-lookup"><span data-stu-id="f631c-234">Imagine that there is a Windows account named `SQLDebug` within the Windows domain.</span></span> <span data-ttu-id="f631c-235">このアカウントは有効なログインおよびのメンバーとして、リモートの SQL Server インスタンスに追加する必要があります、`sysadmin`ロール。</span><span class="sxs-lookup"><span data-stu-id="f631c-235">This account would need to be added to the remote SQL Server instance as a valid login and as a member of the `sysadmin` role.</span></span> <span data-ttu-id="f631c-236">次に、Visual Studio からリモートの SQL Server インスタンスをデバッグするには必要がありますとして Visual Studio を実行する、`SQLDebug`ユーザー。</span><span class="sxs-lookup"><span data-stu-id="f631c-236">Then, to debug the remote SQL Server instance from Visual Studio, we would need to run Visual Studio as the `SQLDebug` user.</span></span> <span data-ttu-id="f631c-237">これは、弊社のワークステーションからログに記録としてのログ バックアップで行うことが`SQLDebug`、独自の資格情報を使用して、ワークステーションにログインし、使用することが、Visual Studio で、簡単な方法を起動および`runas.exe`として Visual Studio を起動する、`SQLDebug`ユーザー。</span><span class="sxs-lookup"><span data-stu-id="f631c-237">This could be done by logging out of our workstation, logging back in as `SQLDebug`, and then launching Visual Studio, but a simpler approach would be to login to our workstation using our own credentials and then use `runas.exe` to launch Visual Studio as the `SQLDebug` user.</span></span> <span data-ttu-id="f631c-238">`runas.exe`別のユーザー アカウントの装ってで実行される特定のアプリケーションを許可します。</span><span class="sxs-lookup"><span data-stu-id="f631c-238">`runas.exe` allows a particular application to be executed under the guise of a different user account.</span></span> <span data-ttu-id="f631c-239">Visual Studio を起動する`SQLDebug`コマンドラインで次のステートメントを入力する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="f631c-239">To launch Visual Studio as `SQLDebug`, you could enter the following statement at the command line:</span></span>


[!code-console[Main](debugging-stored-procedures-vb/samples/sample2.cmd)]

<span data-ttu-id="f631c-240">このプロセスの詳細については、次を参照してください[William R. Vaughn](http://betav.com/BLOG/billva/) s *Hitchhiker s Visual Studio と SQL Server, エディションの 7 番目のガイド*だけでなく[操作方法: SQL Server のアクセス許可の設定。デバッグ用](https://msdn.microsoft.com/library/w1bhybwz(VS.80).aspx)です。</span><span class="sxs-lookup"><span data-stu-id="f631c-240">For a more detailed explanation on this process, see [William R. Vaughn](http://betav.com/BLOG/billva/) s *Hitchhiker s Guide to Visual Studio and SQL Server, Seventh Edition* as well as [How To: Set SQL Server Permissions for Debugging](https://msdn.microsoft.com/library/w1bhybwz(VS.80).aspx).</span></span>

> [!NOTE]
> <span data-ttu-id="f631c-241">開発用コンピューターには、Windows XP Service Pack 2 が実行されている場合は、リモート デバッグを行うためのインターネット接続ファイアウォールを構成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f631c-241">If your development machine is running Windows XP Service Pack 2 you will need to configure the Internet Connection Firewall to allow remote debugging.</span></span> <span data-ttu-id="f631c-242">[方法を: SQL Server 2005 のデバッグを有効にする](https://msdn.microsoft.com/library/s0fk6z6e(VS.80).aspx)資料がこれには 2 つの手順を示します: (a)、Visual Studio ホスト コンピューターに、追加する必要があります`Devenv.exe`例外の一覧と、TCP 135 ポートを開くと (b) にリモート (SQL) コンピューターには、開く必要がありますTCP 135 ポートを追加`sqlservr.exe`例外の一覧にします。</span><span class="sxs-lookup"><span data-stu-id="f631c-242">[The How To: Enable SQL Server 2005 Debugging](https://msdn.microsoft.com/library/s0fk6z6e(VS.80).aspx) article notes that this involves two steps: (a) On the Visual Studio host machine, you must add `Devenv.exe` to the Exceptions list and open the TCP 135 port; and (b) On the remote (SQL) machine, you must open the TCP 135 port and add `sqlservr.exe` to the Exceptions list.</span></span> <span data-ttu-id="f631c-243">ドメイン ポリシーでは、ネットワーク通信を IPSec を使用して行う必要がある場合、UDP 4500 と UDP 500 のポートを開く必要があります。</span><span class="sxs-lookup"><span data-stu-id="f631c-243">If your domain policy requires network communication to be done through IPSec, you must open the UDP 4500 and UDP 500 ports.</span></span>


## <a name="summary"></a><span data-ttu-id="f631c-244">まとめ</span><span class="sxs-lookup"><span data-stu-id="f631c-244">Summary</span></span>

<span data-ttu-id="f631c-245">Visual Studio は、.NET アプリケーションのコードのデバッグのサポートを提供するだけでなく、さまざまな SQL Server 2005 のデバッグ オプションも提供します。</span><span class="sxs-lookup"><span data-stu-id="f631c-245">In addition to providing debugging support for .NET application code, Visual Studio also provides a variety of debugging options for SQL Server 2005.</span></span> <span data-ttu-id="f631c-246">このチュートリアルではこれらのオプションの 2 つに考えた: ダイレクト データベース デバッグと、アプリケーションのデバッグします。</span><span class="sxs-lookup"><span data-stu-id="f631c-246">In this tutorial we looked at two of those options: Direct Database Debugging and application debugging.</span></span> <span data-ttu-id="f631c-247">T-SQL は、データベース オブジェクトを直接デバッグするには、サーバー エクスプ ローラーからオブジェクトを検索し、右クリックし、ステップ インします。</span><span class="sxs-lookup"><span data-stu-id="f631c-247">To directly debug a T-SQL database object, locate the object through the Server Explorer then right-click on it and choose Step Into.</span></span> <span data-ttu-id="f631c-248">これにより、デバッガーを起動し、この時点でオブジェクトのステートメントとビューをステップし、パラメーター値の変更は、データベース オブジェクトに最初のステートメントで停止します。</span><span class="sxs-lookup"><span data-stu-id="f631c-248">This starts the debugger and halts on the first statement in the database object, at which point you can step through the object s statements and view and modify parameter values.</span></span> <span data-ttu-id="f631c-249">手順 1. で使用して、このアプローチにステップ イン、`Products_SelectByCategoryID`ストアド プロシージャです。</span><span class="sxs-lookup"><span data-stu-id="f631c-249">In Step 1 we used this approach to step into the `Products_SelectByCategoryID` stored procedure.</span></span>

<span data-ttu-id="f631c-250">アプリケーションのデバッグと、ブレークポイントのデータベース オブジェクト内で直接設定できます。</span><span class="sxs-lookup"><span data-stu-id="f631c-250">Application debugging allows breakpoints to be set directly within the database objects.</span></span> <span data-ttu-id="f631c-251">(ASP.NET web アプリケーションの場合) などのクライアント アプリケーションからのブレークポイントを使用して、データベース オブジェクトが呼び出されると、デバッガーは、プログラムが停止します。</span><span class="sxs-lookup"><span data-stu-id="f631c-251">When a database object with breakpoints is invoked from a client application (such as an ASP.NET web application), the program halts as the debugger takes over.</span></span> <span data-ttu-id="f631c-252">アプリケーションのデバッグは、どのようなアプリケーション アクションが呼び出される特定のデータベース オブジェクトがより明確に表示されるために役立ちます。</span><span class="sxs-lookup"><span data-stu-id="f631c-252">Application debugging is useful because it more clearly shows what application action causes a particular database object to be invoked.</span></span> <span data-ttu-id="f631c-253">ただし、少しの構成とダイレクト データベース デバッグよりもセットアップが必要です。</span><span class="sxs-lookup"><span data-stu-id="f631c-253">However, it requires a bit more configuration and setup than Direct Database Debugging.</span></span>

<span data-ttu-id="f631c-254">データベース オブジェクトは、SQL Server のプロジェクトをデバッグできます。</span><span class="sxs-lookup"><span data-stu-id="f631c-254">Database objects can also be debugged through SQL Server Projects.</span></span> <span data-ttu-id="f631c-255">SQL Server のプロジェクトを使用して見ていき、次のチュートリアルでのマネージ データベース オブジェクトを使用して作成およびデバッグする方法です。</span><span class="sxs-lookup"><span data-stu-id="f631c-255">We will look at using SQL Server Projects and how to use them to create and debug managed database objects in the next tutorial.</span></span>

<span data-ttu-id="f631c-256">満足プログラミング!</span><span class="sxs-lookup"><span data-stu-id="f631c-256">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="f631c-257">作成者について</span><span class="sxs-lookup"><span data-stu-id="f631c-257">About the Author</span></span>

<span data-ttu-id="f631c-258">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)、7 つ受け取りますブックとの創設者の作成者[4GuysFromRolla.com](http://www.4guysfromrolla.com)、1998 年からマイクロソフトの Web テクノロジで取り組んできました。</span><span class="sxs-lookup"><span data-stu-id="f631c-258">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="f631c-259">Scott は、コンサルタント、トレーナー、ライターとして機能します。</span><span class="sxs-lookup"><span data-stu-id="f631c-259">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="f631c-260">最新の著書[ *Sam 学べる自分で ASP.NET 2.0 が 24 時間以内に*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)です。</span><span class="sxs-lookup"><span data-stu-id="f631c-260">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="f631c-261">彼に到達できる[ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)彼のブログを使用して含まれているのか[http://ScottOnWriting.NET](http://ScottOnWriting.NET)です。</span><span class="sxs-lookup"><span data-stu-id="f631c-261">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="f631c-262">[前へ](protecting-connection-strings-and-other-configuration-information-vb.md)
[次へ](creating-stored-procedures-and-user-defined-functions-with-managed-code-vb.md)</span><span class="sxs-lookup"><span data-stu-id="f631c-262">[Previous](protecting-connection-strings-and-other-configuration-information-vb.md)
[Next](creating-stored-procedures-and-user-defined-functions-with-managed-code-vb.md)</span></span>
