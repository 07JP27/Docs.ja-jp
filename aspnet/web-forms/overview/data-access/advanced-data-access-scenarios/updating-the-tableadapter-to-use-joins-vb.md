---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/updating-the-tableadapter-to-use-joins-vb
title: (VB) を結合に使用する TableAdapter の更新 |Microsoft ドキュメント
author: rick-anderson
description: データベースを使用する場合は、複数のテーブルに分散される要求のデータに共通します。 2 つの異なるテーブルからデータを取得するにはいずれかを使用しています.
ms.author: aspnetcontent
manager: wpickett
ms.date: 07/18/2007
ms.topic: article
ms.assetid: e624a3e0-061b-4efc-8b0e-5877f9ff6714
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/updating-the-tableadapter-to-use-joins-vb
msc.type: authoredcontent
ms.openlocfilehash: 91d700f3de02dc78692e933644e221e2ac8175a1
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/06/2018
---
<a name="updating-the-tableadapter-to-use-joins-vb"></a><span data-ttu-id="5e698-104">(VB) を結合に使用する TableAdapter の更新</span><span class="sxs-lookup"><span data-stu-id="5e698-104">Updating the TableAdapter to Use JOINs (VB)</span></span>
====================
<span data-ttu-id="5e698-105">によって[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="5e698-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="5e698-106">[コードをダウンロードする](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_69_VB.zip)または[PDF のダウンロード](updating-the-tableadapter-to-use-joins-vb/_static/datatutorial69vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="5e698-106">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_69_VB.zip) or [Download PDF](updating-the-tableadapter-to-use-joins-vb/_static/datatutorial69vb1.pdf)</span></span>

> <span data-ttu-id="5e698-107">データベースを使用する場合は、複数のテーブルに分散される要求のデータに共通します。</span><span class="sxs-lookup"><span data-stu-id="5e698-107">When working with a database it is common to request data that is spread across multiple tables.</span></span> <span data-ttu-id="5e698-108">2 つの異なるテーブルからデータを取得するには、ことができます、相関サブクエリや結合操作のいずれかを使用します。</span><span class="sxs-lookup"><span data-stu-id="5e698-108">To retrieve data from two different tables we can use either a correlated subquery or a JOIN operation.</span></span> <span data-ttu-id="5e698-109">このチュートリアルでは相関サブクエリと比較 JOIN 構文メイン クエリで結合が含まれる、TableAdapter を作成する方法を探す前にします。</span><span class="sxs-lookup"><span data-stu-id="5e698-109">In this tutorial we compare correlated subqueries and the JOIN syntax before looking at how to create a TableAdapter that includes a JOIN in its main query.</span></span>


## <a name="introduction"></a><span data-ttu-id="5e698-110">はじめに</span><span class="sxs-lookup"><span data-stu-id="5e698-110">Introduction</span></span>

<span data-ttu-id="5e698-111">リレーショナル データベースでの操作では、データは複数のテーブルに分散多くの場合。</span><span class="sxs-lookup"><span data-stu-id="5e698-111">With relational databases the data we are interested in working with is often spread across multiple tables.</span></span> <span data-ttu-id="5e698-112">たとえば、製品情報を表示するときにおする可能性が高く各製品 s の対応するカテゴリと仕入先 %s の名前を一覧表示します。</span><span class="sxs-lookup"><span data-stu-id="5e698-112">For example, when displaying product information we likely want to list each product s corresponding category and supplier s names.</span></span> <span data-ttu-id="5e698-113">`Products`テーブルに`CategoryID`と`SupplierID`値が実際のカテゴリと供給業者の名前では、`Categories`と`Suppliers`テーブルをそれぞれします。</span><span class="sxs-lookup"><span data-stu-id="5e698-113">The `Products` table has `CategoryID` and `SupplierID` values, but the actual category and supplier names are in the `Categories` and `Suppliers` tables, respectively.</span></span>

<span data-ttu-id="5e698-114">使用するか、別の関連テーブルから情報を取得すること*相関サブクエリ*または`JOIN` *s*です。</span><span class="sxs-lookup"><span data-stu-id="5e698-114">To retrieve information from another, related table, we can either use *correlated subqueries* or `JOIN`*s*.</span></span> <span data-ttu-id="5e698-115">相関サブクエリは、入れ子になった`SELECT`外側のクエリで列を参照するクエリ。</span><span class="sxs-lookup"><span data-stu-id="5e698-115">A correlated subquery is a nested `SELECT` query that references columns in the outer query.</span></span> <span data-ttu-id="5e698-116">たとえば、[データ アクセス レイヤーを作成する](../introduction/creating-a-data-access-layer-vb.md)で 2 つの相関サブクエリを使用したチュートリアル、`ProductsTableAdapter`メイン クエリの各製品カテゴリと供給業者の名前を取得します。</span><span class="sxs-lookup"><span data-stu-id="5e698-116">For example, in the [Creating a Data Access Layer](../introduction/creating-a-data-access-layer-vb.md) tutorial we used two correlated subqueries in the `ProductsTableAdapter` s main query to return the category and supplier names for each product.</span></span> <span data-ttu-id="5e698-117">A `JOIN` 2 つの異なるテーブルから関連する行をマージする SQL 構造体です。</span><span class="sxs-lookup"><span data-stu-id="5e698-117">A `JOIN` is a SQL construct that merges related rows from two different tables.</span></span> <span data-ttu-id="5e698-118">使用して、`JOIN`で、 [SqlDataSource コントロールでのデータのクエリを実行する](../accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-vb.md)と共に各製品カテゴリ情報を表示するチュートリアルです。</span><span class="sxs-lookup"><span data-stu-id="5e698-118">We used a `JOIN` in the [Querying Data with the SqlDataSource Control](../accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-vb.md) tutorial to display category information alongside each product.</span></span>

<span data-ttu-id="5e698-119">使用してから abstained が理由`JOIN`対応の自動生成する TableAdapter のウィザードでの制限により、Tableadapter とは、 `INSERT`、 `UPDATE`、および`DELETE`ステートメントです。</span><span class="sxs-lookup"><span data-stu-id="5e698-119">The reason we have abstained from using `JOIN` s with the TableAdapters is because of limitations in the TableAdapter s wizard to auto-generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements.</span></span> <span data-ttu-id="5e698-120">具体的には、TableAdapter のメイン クエリでは、いずれかが含まれる場合`JOIN`s、TableAdapter できない自動的に作成、アドホック SQL ステートメントまたはストアド プロシージャをその`InsertCommand`、 `UpdateCommand`、および`DeleteCommand`プロパティです。</span><span class="sxs-lookup"><span data-stu-id="5e698-120">More specifically, if the TableAdapter s main query contains any `JOIN` s, the TableAdapter cannot auto-create the ad-hoc SQL statements or stored procedures for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span>

<span data-ttu-id="5e698-121">このチュートリアルを簡単に比較とコントラストの相関サブクエリと`JOIN`を含む TableAdapter を作成する方法を調べる前に s`JOIN`メイン クエリで s。</span><span class="sxs-lookup"><span data-stu-id="5e698-121">In this tutorial we will briefly compare and contrast correlated subqueries and `JOIN` s before exploring how to create a TableAdapter that includes `JOIN` s in its main query.</span></span>

## <a name="comparing-and-contrasting-correlated-subqueries-andjoin-s"></a><span data-ttu-id="5e698-122">比較対照相関サブクエリと`JOIN`s</span><span class="sxs-lookup"><span data-stu-id="5e698-122">Comparing and Contrasting Correlated Subqueries and`JOIN` s</span></span>

<span data-ttu-id="5e698-123">注意してください、`ProductsTableAdapter`最初のチュートリアルで作成した、`Northwind`データセットでは、相関サブクエリを使用して、各製品の対応するカテゴリおよび仕入先名を元に戻します。</span><span class="sxs-lookup"><span data-stu-id="5e698-123">Recall that the `ProductsTableAdapter` created in the first tutorial in the `Northwind` DataSet uses correlated subqueries to bring back each product s corresponding category and supplier name.</span></span> <span data-ttu-id="5e698-124">`ProductsTableAdapter` S メイン クエリを次に示します。</span><span class="sxs-lookup"><span data-stu-id="5e698-124">The `ProductsTableAdapter` s main query is shown below.</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample1.sql)]

<span data-ttu-id="5e698-125">2 つの相関サブクエリ -`(SELECT CategoryName FROM Categories WHERE Categories.CategoryID = Products.CategoryID)`と`(SELECT CompanyName FROM Suppliers WHERE Suppliers.SupplierID = Products.SupplierID)`-は`SELECT`、外側の追加の列と製品ごとに 1 つの値を返すクエリを`SELECT`ステートメントの列の一覧です。</span><span class="sxs-lookup"><span data-stu-id="5e698-125">The two correlated subqueries - `(SELECT CategoryName FROM Categories WHERE Categories.CategoryID = Products.CategoryID)` and `(SELECT CompanyName FROM Suppliers WHERE Suppliers.SupplierID = Products.SupplierID)` - are `SELECT` queries that return a single value per product as an additional column in the outer `SELECT` statement s column list.</span></span>

<span data-ttu-id="5e698-126">または、`JOIN`各製品の業者とカテゴリ名を返すために使用できます。</span><span class="sxs-lookup"><span data-stu-id="5e698-126">Alternatively, a `JOIN` can be used to return each product s supplier and category name.</span></span> <span data-ttu-id="5e698-127">次のクエリは上記の 1 つと同じ出力が返されますが、使用`JOIN`サブクエリの代わりに s:</span><span class="sxs-lookup"><span data-stu-id="5e698-127">The following query returns the same output as the above one, but uses `JOIN` s in place of subqueries:</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample2.sql)]

<span data-ttu-id="5e698-128">A`JOIN`いくつかの条件に基づく別のテーブルからレコードを含む 1 つのテーブルからレコードをマージします。</span><span class="sxs-lookup"><span data-stu-id="5e698-128">A `JOIN` merges the records from one table with records from another table based on some criteria.</span></span> <span data-ttu-id="5e698-129">たとえば、上記のクエリで、`LEFT JOIN Categories ON Categories.CategoryID = Products.CategoryID`をマージする各 SQL Server に指示カテゴリの製品レコードがレコードを`CategoryID`値に一致する製品の`CategoryID`値。</span><span class="sxs-lookup"><span data-stu-id="5e698-129">In the above query, for example, the `LEFT JOIN Categories ON Categories.CategoryID = Products.CategoryID` instructs SQL Server to merge each product record with the category record whose `CategoryID` value matches the product s `CategoryID` value.</span></span> <span data-ttu-id="5e698-130">マージされた結果には、各製品カテゴリの対応するフィールドを使用することができます (など`CategoryName`)。</span><span class="sxs-lookup"><span data-stu-id="5e698-130">The merged result allows us to work with the corresponding category fields for each product (such as `CategoryName`).</span></span>

> [!NOTE]
> <span data-ttu-id="5e698-131">`JOIN` s はリレーショナル データベースからデータを照会する際によく使用されます。</span><span class="sxs-lookup"><span data-stu-id="5e698-131">`JOIN` s are commonly used when querying data from relational databases.</span></span> <span data-ttu-id="5e698-132">初めて使用する場合、`JOIN`構文や使用法に関するもう少しを復習する必要があります、d をお勧め、 [SQL の Join チュートリアル](http://www.w3schools.com/sql/sql_join.asp)で[W3 学校](http://www.w3schools.com/)です。</span><span class="sxs-lookup"><span data-stu-id="5e698-132">If you are new to the `JOIN` syntax or need to brush up a bit on its usage, I d recommend the [SQL Join tutorial](http://www.w3schools.com/sql/sql_join.asp) at [W3 Schools](http://www.w3schools.com/).</span></span> <span data-ttu-id="5e698-133">また読み取り価値は、 [ `JOIN`基礎](https://msdn.microsoft.com/library/ms191517.aspx)と[サブクエリの基礎](https://msdn.microsoft.com/library/ms189575.aspx)のセクションでは、 [SQL オンライン ブック](https://msdn.microsoft.com/library/ms130214.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="5e698-133">Also worth reading are the [`JOIN` Fundamentals](https://msdn.microsoft.com/library/ms191517.aspx) and [Subquery Fundamentals](https://msdn.microsoft.com/library/ms189575.aspx) sections of the [SQL Books Online](https://msdn.microsoft.com/library/ms130214.aspx).</span></span>


<span data-ttu-id="5e698-134">`JOIN` S と相関サブクエリを両方使用できるその他のテーブルから関連するデータを取得する、そのヘッドをスクラッチおよび使用する方法を知り、多くの開発者は残されます。</span><span class="sxs-lookup"><span data-stu-id="5e698-134">Since `JOIN` s and correlated subqueries can both be used to retrieve related data from other tables, many developers are left scratching their heads and wondering which approach to use.</span></span> <span data-ttu-id="5e698-135">すべて SQL エキスパートの I はほぼ同じことにしたことされない問題では性能とほぼ同じ実行プランを SQL Server が生成されます。</span><span class="sxs-lookup"><span data-stu-id="5e698-135">All of the SQL gurus I ve talked to have said roughly the same thing, that it doesn t really matter performance-wise as SQL Server will produce roughly identical execution plans.</span></span> <span data-ttu-id="5e698-136">アドバイスは、次はおよびチームが最も慣れている手法を使用します。</span><span class="sxs-lookup"><span data-stu-id="5e698-136">Their advice, then, is to use the technique that you and your team are most comfortable with.</span></span> <span data-ttu-id="5e698-137">このアドバイスを深めます後にこれらのエキスパートすぐに express の設定に注意してください。 その最もメリットのある`JOIN`相関サブクエリ経由で s。</span><span class="sxs-lookup"><span data-stu-id="5e698-137">It merits noting that after imparting this advice these experts immediately express their preference of `JOIN` s over correlated subqueries.</span></span>

<span data-ttu-id="5e698-138">型指定されたデータセットを使用してデータ アクセス レイヤーを作成するときに、ツール優れてサブクエリを使用しています。</span><span class="sxs-lookup"><span data-stu-id="5e698-138">When building a Data Access Layer using Typed DataSets, the tools work better when using subqueries.</span></span> <span data-ttu-id="5e698-139">具体的には、TableAdapter のウィザードがない自動生成対応`INSERT`、 `UPDATE`、および`DELETE`ステートメント、メインのクエリでは、いずれかが含まれる場合`JOIN`s が自動生成相関ときに、これらのステートメントが、サブクエリ使用されます。</span><span class="sxs-lookup"><span data-stu-id="5e698-139">In particular, the TableAdapter s wizard will not auto-generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements if the main query contains any `JOIN` s, but will auto-generate these statements when correlated subqueries are used.</span></span>

<span data-ttu-id="5e698-140">この欠点を調査するに一時的な型指定されたデータセットを作成、`~/App_Code/DAL`フォルダーです。</span><span class="sxs-lookup"><span data-stu-id="5e698-140">To explore this shortcoming, create a temporary Typed DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="5e698-141">TableAdapter 構成ウィザードの中に、アドホック SQL ステートメントを使用して、次を入力を選択`SELECT`クエリ (図 1 を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="5e698-141">During the TableAdapter Configuration wizard, choose to use ad-hoc SQL statements and enter the following `SELECT` query (see Figure 1):</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample3.sql)]


<span data-ttu-id="5e698-142">[![結合を含むメイン クエリを入力してください。](updating-the-tableadapter-to-use-joins-vb/_static/image2.png)](updating-the-tableadapter-to-use-joins-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="5e698-142">[![Enter a Main Query that Contains JOINs](updating-the-tableadapter-to-use-joins-vb/_static/image2.png)](updating-the-tableadapter-to-use-joins-vb/_static/image1.png)</span></span>

<span data-ttu-id="5e698-143">**図 1**: を含むメイン クエリを入力して`JOIN`s ([フルサイズのイメージを表示するをクリックして](updating-the-tableadapter-to-use-joins-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="5e698-143">**Figure 1**: Enter a Main Query that Contains `JOIN` s ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image3.png))</span></span>


<span data-ttu-id="5e698-144">既定では、TableAdapter が自動的に作成`INSERT`、 `UPDATE`、および`DELETE`ステートメントは、メインのクエリに基づいています。</span><span class="sxs-lookup"><span data-stu-id="5e698-144">By default, the TableAdapter will automatically create `INSERT`, `UPDATE`, and `DELETE` statements based on the main query.</span></span> <span data-ttu-id="5e698-145">[詳細設定] をクリックした場合、この機能が有効になっていることが確認できます。</span><span class="sxs-lookup"><span data-stu-id="5e698-145">If you click the Advanced button you can see that this feature is enabled.</span></span> <span data-ttu-id="5e698-146">この設定に関係なく、TableAdapter ことはできませんを作成する、 `INSERT`、 `UPDATE`、および`DELETE`ステートメント、メインのクエリが含まれているため、`JOIN`です。</span><span class="sxs-lookup"><span data-stu-id="5e698-146">Despite this setting, the TableAdapter will not be able to create the `INSERT`, `UPDATE`, and `DELETE` statements because the main query contains a `JOIN`.</span></span>


![結合を含むメイン クエリを入力してください。](updating-the-tableadapter-to-use-joins-vb/_static/image4.png)

<span data-ttu-id="5e698-148">**図 2**: を含むメイン クエリを入力して`JOIN`s</span><span class="sxs-lookup"><span data-stu-id="5e698-148">**Figure 2**: Enter a Main Query that Contains `JOIN` s</span></span>


<span data-ttu-id="5e698-149">ウィザードを完了するには、[完了] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="5e698-149">Click Finish to complete the wizard.</span></span> <span data-ttu-id="5e698-150">この時点で、データセットの Designer は、列を含む DataTable を 1 つの TableAdapter で返されるフィールドの各、`SELECT`クエリの列リストです。</span><span class="sxs-lookup"><span data-stu-id="5e698-150">At this point your DataSet s Designer will include a single TableAdapter with a DataTable with columns for each of the fields returned in the `SELECT` query s column list.</span></span> <span data-ttu-id="5e698-151">これが含まれています、`CategoryName`と`SupplierName`図 3 に示すようにします。</span><span class="sxs-lookup"><span data-stu-id="5e698-151">This includes the `CategoryName` and `SupplierName`, as Figure 3 shows.</span></span>


![DataTable には列の一覧で返される各フィールドの列が含まれています](updating-the-tableadapter-to-use-joins-vb/_static/image5.png)

<span data-ttu-id="5e698-153">**図 3**: DataTable に列の一覧で返される各フィールドの列が含まれます</span><span class="sxs-lookup"><span data-stu-id="5e698-153">**Figure 3**: The DataTable Includes a Column for Each Field Returned in the Column List</span></span>


<span data-ttu-id="5e698-154">TableAdapter がの値がない DataTable には、適切な列が、その`InsertCommand`、 `UpdateCommand`、および`DeleteCommand`プロパティです。</span><span class="sxs-lookup"><span data-stu-id="5e698-154">While the DataTable has the appropriate columns, the TableAdapter lacks values for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span> <span data-ttu-id="5e698-155">これには、デザイナーの TableAdapter にクリックし、[プロパティ] ウィンドウに移動します。</span><span class="sxs-lookup"><span data-stu-id="5e698-155">To confirm this, click on the TableAdapter in the Designer and then go to the Properties window.</span></span> <span data-ttu-id="5e698-156">ある \outputfromtestproviderdebugmode.txt、 `InsertCommand`、 `UpdateCommand`、および`DeleteCommand`プロパティ (なし) に設定されます。</span><span class="sxs-lookup"><span data-stu-id="5e698-156">There you will see that the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties are set to (None) .</span></span>


<span data-ttu-id="5e698-157">[![InsertCommand、UpdateCommand、および DeleteCommand プロパティを (なし) に設定されます。](updating-the-tableadapter-to-use-joins-vb/_static/image7.png)](updating-the-tableadapter-to-use-joins-vb/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="5e698-157">[![The InsertCommand, UpdateCommand, and DeleteCommand Properties are Set to (None)](updating-the-tableadapter-to-use-joins-vb/_static/image7.png)](updating-the-tableadapter-to-use-joins-vb/_static/image6.png)</span></span>

<span data-ttu-id="5e698-158">**図 4**: `InsertCommand`、 `UpdateCommand`、および`DeleteCommand`プロパティ (なし) に設定されます ([フルサイズのイメージを表示するをクリックして](updating-the-tableadapter-to-use-joins-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="5e698-158">**Figure 4**: The `InsertCommand`, `UpdateCommand`, and `DeleteCommand` Properties are Set to (None) ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image8.png))</span></span>


<span data-ttu-id="5e698-159">この欠点を回避するには、手動で提供できます SQL ステートメントとパラメーターを`InsertCommand`、 `UpdateCommand`、および`DeleteCommand`プロパティ ウィンドウを使用してプロパティです。</span><span class="sxs-lookup"><span data-stu-id="5e698-159">To work around this shortcoming, we can manually provide the SQL statements and parameters for the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties via the Properties window.</span></span> <span data-ttu-id="5e698-160">またはに TableAdapter のメイン クエリを構成することによって開始でした*いない*を含める`JOIN`s。</span><span class="sxs-lookup"><span data-stu-id="5e698-160">Alternatively, we could start by configuring the TableAdapter s main query to *not* include any `JOIN` s.</span></span> <span data-ttu-id="5e698-161">これにより、 `INSERT`、 `UPDATE`、および`DELETE`うえで自動的に生成されるステートメントです。</span><span class="sxs-lookup"><span data-stu-id="5e698-161">This will allow the `INSERT`, `UPDATE`, and `DELETE` statements to be auto-generated for us.</span></span> <span data-ttu-id="5e698-162">ウィザードの完了後に、手動で更新すること、tableadapter`SelectCommand`そのが組み込まれているため、プロパティ ウィンドウから、`JOIN`構文です。</span><span class="sxs-lookup"><span data-stu-id="5e698-162">After completing the wizard, we could then manually update the TableAdapter s `SelectCommand` from the Properties window so that it includes the `JOIN` syntax.</span></span>

<span data-ttu-id="5e698-163">このアプローチは、中には不安定に非常がの場合、TableAdapter のメイン クエリをいつために、アドホック SQL クエリを使用して、自動生成される、ウィザードを使用して構成し直す`INSERT`、 `UPDATE`、および`DELETE`ステートメントが再作成します。</span><span class="sxs-lookup"><span data-stu-id="5e698-163">While this approach works, it is very brittle when using ad-hoc SQL queries because any time the TableAdapter s main query is re-configured through the wizard, the auto-generated `INSERT`, `UPDATE`, and `DELETE` statements are recreated.</span></span> <span data-ttu-id="5e698-164">つまり、すべての後で行ったカスタマイズが失われる TableAdapter を右クリックして、コンテキスト メニューから構成を選択すると、ウィザードをもう一度完了します。</span><span class="sxs-lookup"><span data-stu-id="5e698-164">That means all of the customizations we later made would be lost if we right-clicked on the TableAdapter, chose Configure from the context menu, and completed the wizard again.</span></span>

<span data-ttu-id="5e698-165">自動生成された tableadapter の脆弱性`INSERT`、 `UPDATE`、および`DELETE`ステートメントは幸いにも、アドホック SQL ステートメントに制限されます。</span><span class="sxs-lookup"><span data-stu-id="5e698-165">The brittleness of the TableAdapter s auto-generated `INSERT`, `UPDATE`, and `DELETE` statements is, fortunately, limited to ad-hoc SQL statements.</span></span> <span data-ttu-id="5e698-166">カスタマイズすることができます、TableAdapter は、ストアド プロシージャを使用している場合、 `SelectCommand`、 `InsertCommand`、 `UpdateCommand`、または`DeleteCommand`ストアド プロシージャおよびストアド プロシージャになることを心配しなくても、TableAdapter 構成ウィザードを再実行変更します。</span><span class="sxs-lookup"><span data-stu-id="5e698-166">If your TableAdapter uses stored procedures, you can customize the `SelectCommand`, `InsertCommand`, `UpdateCommand`, or `DeleteCommand` stored procedures and re-run the TableAdapter Configuration wizard without having to fear that the stored procedures will be modified.</span></span>

<span data-ttu-id="5e698-167">作成、TableAdapter を最初に、いくつかの手順を今後には、いずれかの指定を省略するメインのクエリを使用して`JOIN`s できるように、対応する挿入、更新、および削除のストアド プロシージャは、自動生成されます。</span><span class="sxs-lookup"><span data-stu-id="5e698-167">Over the next several steps we will create a TableAdapter that, initially, uses a main query that omits any `JOIN` s so that the corresponding insert, update, and delete stored procedures will be auto-generated.</span></span> <span data-ttu-id="5e698-168">マイクロソフトは、更新、`SelectCommand`使用するため、`JOIN`関連テーブルから追加の列を返します。</span><span class="sxs-lookup"><span data-stu-id="5e698-168">We will then update the `SelectCommand` so that uses a `JOIN` that returns additional columns from related tables.</span></span> <span data-ttu-id="5e698-169">最後に、対応するビジネス ロジック層クラスを作成し、ASP.NET web ページで、TableAdapter を使用する方法を示しますおします。</span><span class="sxs-lookup"><span data-stu-id="5e698-169">Finally, we'll create a corresponding Business Logic Layer class and demonstrate using the TableAdapter in an ASP.NET web page.</span></span>

## <a name="step-1-creating-the-tableadapter-using-a-simplified-main-query"></a><span data-ttu-id="5e698-170">手順 1: 簡素化されたメイン クエリを使用して、TableAdapter を作成します。</span><span class="sxs-lookup"><span data-stu-id="5e698-170">Step 1: Creating the TableAdapter Using a Simplified Main Query</span></span>

<span data-ttu-id="5e698-171">このチュートリアルでは、追加、TableAdapter の DataTable の厳密に型指定された、`Employees`テーブルに、`NorthwindWithSprocs`データセット。</span><span class="sxs-lookup"><span data-stu-id="5e698-171">For this tutorial we will add a TableAdapter and strongly-typed DataTable for the `Employees` table in the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="5e698-172">`Employees`テーブルが含まれています、`ReportsTo`指定されているフィールド、`EmployeeID`従業員のマネージャーのです。</span><span class="sxs-lookup"><span data-stu-id="5e698-172">The `Employees` table contains a `ReportsTo` field that specified the `EmployeeID` of the employee s manager.</span></span> <span data-ttu-id="5e698-173">Anne 複数のグラフ エリアが従業員など、`ReportTo`は 5 の値、 `EmployeeID` Steven Buchanan のです。</span><span class="sxs-lookup"><span data-stu-id="5e698-173">For example, employee Anne Dodsworth has a `ReportTo` value of 5, which is the `EmployeeID` of Steven Buchanan.</span></span> <span data-ttu-id="5e698-174">その結果、Anne は Steven、上司に報告します。</span><span class="sxs-lookup"><span data-stu-id="5e698-174">Consequently, Anne reports to Steven, her manager.</span></span> <span data-ttu-id="5e698-175">各従業員の s をレポートと一緒に`ReportsTo`値、おすることも、マネージャーの名前を取得します。</span><span class="sxs-lookup"><span data-stu-id="5e698-175">Along with reporting each employee s `ReportsTo` value, we might also want to retrieve the name of their manager.</span></span> <span data-ttu-id="5e698-176">これを使用して、`JOIN`です。</span><span class="sxs-lookup"><span data-stu-id="5e698-176">This can be accomplished using a `JOIN`.</span></span> <span data-ttu-id="5e698-177">使用して、`JOIN`ときから対応する挿入を自動的に生成するウィザードが除外最初に、TableAdapter を作成、更新、および機能を削除します。</span><span class="sxs-lookup"><span data-stu-id="5e698-177">But using a `JOIN` when initially creating the TableAdapter precludes the wizard from automatically generating the corresponding insert, update, and delete capabilities.</span></span> <span data-ttu-id="5e698-178">したがっては、まずそのメインのクエリは、TableAdapter を作成することで`JOIN`s。</span><span class="sxs-lookup"><span data-stu-id="5e698-178">Therefore, we will start by creating a TableAdapter whose main query does not contain any `JOIN` s.</span></span> <span data-ttu-id="5e698-179">次に、手順 2. では更新からマネージャーの名前を取得するメインのクエリがストアド プロシージャ、`JOIN`です。</span><span class="sxs-lookup"><span data-stu-id="5e698-179">Then, in Step 2, we will update the main query stored procedure to retrieve the manager s name via a `JOIN`.</span></span>

<span data-ttu-id="5e698-180">開いて開始、`NorthwindWithSprocs`内のデータセット、`~/App_Code/DAL`フォルダーです。</span><span class="sxs-lookup"><span data-stu-id="5e698-180">Start by opening the `NorthwindWithSprocs` DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="5e698-181">デザイナーを右クリックし、コンテキスト メニューから、[追加] オプションを選択および TableAdapter のメニュー項目を選択します。</span><span class="sxs-lookup"><span data-stu-id="5e698-181">Right-click on the Designer, select the Add option from the context menu, and pick the TableAdapter menu item.</span></span> <span data-ttu-id="5e698-182">これにより、TableAdapter 構成ウィザードが起動します。</span><span class="sxs-lookup"><span data-stu-id="5e698-182">This will launch the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="5e698-183">図 5 では、ある新しいストアド プロシージャを作成し、[次へ] をクリックしてウィザードになります。</span><span class="sxs-lookup"><span data-stu-id="5e698-183">As Figure 5 depicts, have the wizard create new stored procedures and click Next.</span></span> <span data-ttu-id="5e698-184">リフレッシャーで、新規に作成するストアド プロシージャ、TableAdapter のウィザードを参照してください、[を作成する新しいストアド プロシージャを型指定されたデータセットの Tableadapter](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)チュートリアルです。</span><span class="sxs-lookup"><span data-stu-id="5e698-184">For a refresher on creating new stored procedures from the TableAdapter s wizard, consult the [Creating New Stored Procedures for the Typed DataSet s TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span></span>


<span data-ttu-id="5e698-185">[![新しいストアド プロシージャの作成オプションを選択します。](updating-the-tableadapter-to-use-joins-vb/_static/image10.png)](updating-the-tableadapter-to-use-joins-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="5e698-185">[![Select the Create new stored procedures Option](updating-the-tableadapter-to-use-joins-vb/_static/image10.png)](updating-the-tableadapter-to-use-joins-vb/_static/image9.png)</span></span>

<span data-ttu-id="5e698-186">**図 5**: 新しいストアド プロシージャ オプションの選択、作成 ([フルサイズのイメージを表示するをクリックして](updating-the-tableadapter-to-use-joins-vb/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="5e698-186">**Figure 5**: Select the Create new stored procedures Option ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image11.png))</span></span>


<span data-ttu-id="5e698-187">以下を使用して`SELECT`TableAdapter のメイン クエリのステートメント。</span><span class="sxs-lookup"><span data-stu-id="5e698-187">Use the following `SELECT` statement for the TableAdapter s main query:</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample4.sql)]

<span data-ttu-id="5e698-188">このクエリは含まれませんので`JOIN`s、TableAdapter ウィザードが自動的に作成ストアド プロシージャに対応する`INSERT`、 `UPDATE`、および`DELETE`メインを実行するためのストアド プロシージャと同様に、ステートメントクエリ。</span><span class="sxs-lookup"><span data-stu-id="5e698-188">Since this query does not include any `JOIN` s, the TableAdapter wizard will automatically create stored procedures with corresponding `INSERT`, `UPDATE`, and `DELETE` statements, as well as a stored procedure for executing the main query.</span></span>

<span data-ttu-id="5e698-189">次の手順では、TableAdapter s ストアド プロシージャの名前を付けることができます。</span><span class="sxs-lookup"><span data-stu-id="5e698-189">The following step allows us to name the TableAdapter s stored procedures.</span></span> <span data-ttu-id="5e698-190">名前を使用して`Employees_Select`、 `Employees_Insert`、 `Employees_Update`、および`Employees_Delete`図 6 に示すように、します。</span><span class="sxs-lookup"><span data-stu-id="5e698-190">Use the names `Employees_Select`, `Employees_Insert`, `Employees_Update`, and `Employees_Delete`, as shown in Figure 6.</span></span>


<span data-ttu-id="5e698-191">[![TableAdapter s ストアド プロシージャの名前](updating-the-tableadapter-to-use-joins-vb/_static/image13.png)](updating-the-tableadapter-to-use-joins-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="5e698-191">[![Name the TableAdapter s Stored Procedures](updating-the-tableadapter-to-use-joins-vb/_static/image13.png)](updating-the-tableadapter-to-use-joins-vb/_static/image12.png)</span></span>

<span data-ttu-id="5e698-192">**図 6**: TableAdapter s ストアド プロシージャの名前を付けます ([フルサイズのイメージを表示するをクリックして](updating-the-tableadapter-to-use-joins-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="5e698-192">**Figure 6**: Name the TableAdapter s Stored Procedures ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image14.png))</span></span>


<span data-ttu-id="5e698-193">最後の手順には、TableAdapter のメソッドの名前を付けることが求められます。</span><span class="sxs-lookup"><span data-stu-id="5e698-193">The final step prompts us to name the TableAdapter s methods.</span></span> <span data-ttu-id="5e698-194">使用して`Fill`と`GetEmployees`メソッド名とします。</span><span class="sxs-lookup"><span data-stu-id="5e698-194">Use `Fill` and `GetEmployees` as the method names.</span></span> <span data-ttu-id="5e698-195">直接、データベース (GenerateDBDirectMethods) チェック ボックスをオンになって更新を送信するメソッドを作成するままにしておくことを確認できます。</span><span class="sxs-lookup"><span data-stu-id="5e698-195">Also be sure to leave the Create methods to send updates directly to the database (GenerateDBDirectMethods) checkbox checked.</span></span>


<span data-ttu-id="5e698-196">[![TableAdapter のメソッドの塗りつぶしの名前とため](updating-the-tableadapter-to-use-joins-vb/_static/image16.png)](updating-the-tableadapter-to-use-joins-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="5e698-196">[![Name the TableAdapter s Methods Fill and GetEmployees](updating-the-tableadapter-to-use-joins-vb/_static/image16.png)](updating-the-tableadapter-to-use-joins-vb/_static/image15.png)</span></span>

<span data-ttu-id="5e698-197">**図 7**: tableadapter のメソッドの名前を付けます`Fill`と`GetEmployees`([フルサイズのイメージを表示するをクリックして](updating-the-tableadapter-to-use-joins-vb/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="5e698-197">**Figure 7**: Name the TableAdapter s Methods `Fill` and `GetEmployees` ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image17.png))</span></span>


<span data-ttu-id="5e698-198">ウィザードを完了すると、すぐをデータベース内のストアド プロシージャを確認します。</span><span class="sxs-lookup"><span data-stu-id="5e698-198">After completing the wizard, take a moment to examine the stored procedures in the database.</span></span> <span data-ttu-id="5e698-199">次の 4 つの新しいファイルが表示されます: `Employees_Select`、 `Employees_Insert`、 `Employees_Update`、および`Employees_Delete`です。</span><span class="sxs-lookup"><span data-stu-id="5e698-199">You should see four new ones: `Employees_Select`, `Employees_Insert`, `Employees_Update`, and `Employees_Delete`.</span></span> <span data-ttu-id="5e698-200">次に、検査、`EmployeesDataTable`と`EmployeesTableAdapter`だけを作成します。</span><span class="sxs-lookup"><span data-stu-id="5e698-200">Next, inspect the `EmployeesDataTable` and `EmployeesTableAdapter` just created.</span></span> <span data-ttu-id="5e698-201">DataTable には、メインのクエリによって返される各フィールドの列が含まれています。</span><span class="sxs-lookup"><span data-stu-id="5e698-201">The DataTable contains a column for each field returned by the main query.</span></span> <span data-ttu-id="5e698-202">TableAdapter でクリックし、[プロパティ] ウィンドウに移動します。</span><span class="sxs-lookup"><span data-stu-id="5e698-202">Click on the TableAdapter and then go to the Properties window.</span></span> <span data-ttu-id="5e698-203">ある \outputfromtestproviderdebugmode.txt、 `InsertCommand`、 `UpdateCommand`、および`DeleteCommand`対応するストアド プロシージャを呼び出すのプロパティが正しく構成されています。</span><span class="sxs-lookup"><span data-stu-id="5e698-203">There you will see that the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties are correctly configured to call the corresponding stored procedures.</span></span>


<span data-ttu-id="5e698-204">[![TableAdapter の Insert、Update が含まれています、機能の削除](updating-the-tableadapter-to-use-joins-vb/_static/image19.png)](updating-the-tableadapter-to-use-joins-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="5e698-204">[![The TableAdapter Includes Insert, Update, and Delete Capabilities](updating-the-tableadapter-to-use-joins-vb/_static/image19.png)](updating-the-tableadapter-to-use-joins-vb/_static/image18.png)</span></span>

<span data-ttu-id="5e698-205">**図 8**: TableAdapter を含む Insert、Update、および機能の削除 ([フルサイズのイメージを表示するをクリックして](updating-the-tableadapter-to-use-joins-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="5e698-205">**Figure 8**: The TableAdapter Includes Insert, Update, and Delete Capabilities ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image20.png))</span></span>


<span data-ttu-id="5e698-206">挿入、更新、および delete ストアド プロシージャが自動的に作成され、 `InsertCommand`、 `UpdateCommand`、および`DeleteCommand`をカスタマイズする準備が整いましたプロパティが正しく構成されている、 `SelectCommand` s ストアド プロシージャから返される追加各従業員のマネージャーについて説明します。</span><span class="sxs-lookup"><span data-stu-id="5e698-206">With the insert, update, and delete stored procedures automatically created and the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties correctly configured, we are ready to customize the `SelectCommand` s stored procedure to return additional information about each employee s manager.</span></span> <span data-ttu-id="5e698-207">具体的には、更新する必要があります、`Employees_Select`ストアド プロシージャを使用する、 `JOIN` manager s を返すと`FirstName`と`LastName`値。</span><span class="sxs-lookup"><span data-stu-id="5e698-207">Specifically, we need to update the `Employees_Select` stored procedure to use a `JOIN` and return the manager s `FirstName` and `LastName` values.</span></span> <span data-ttu-id="5e698-208">ストアド プロシージャが更新された後はこれら追加の列が含まれるように、データ テーブルを更新する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5e698-208">After the stored procedure has been updated, we will need to update the DataTable so that it includes these additional columns.</span></span> <span data-ttu-id="5e698-209">これら 2 つのタスクの手順 2 および 3 取り上げるです。</span><span class="sxs-lookup"><span data-stu-id="5e698-209">We'll tackle these two tasks in Steps 2 and 3.</span></span>

## <a name="step-2-customizing-the-stored-procedure-to-include-ajoin"></a><span data-ttu-id="5e698-210">手順 2: のカスタマイズ、ストアド プロシージャを含めるには`JOIN`</span><span class="sxs-lookup"><span data-stu-id="5e698-210">Step 2: Customizing the Stored Procedure to Include a`JOIN`</span></span>

<span data-ttu-id="5e698-211">開始しようとして、サーバー エクスプ ローラー、Northwind データベース %s の Stored Procedures フォルダーへのドリル ダウンを開くと、`Employees_Select`ストアド プロシージャです。</span><span class="sxs-lookup"><span data-stu-id="5e698-211">Start by going to the Server Explorer, drilling down into the Northwind database s Stored Procedures folder, and opening the `Employees_Select` stored procedure.</span></span> <span data-ttu-id="5e698-212">このストアド プロシージャが表示されない場合は、ストアド プロシージャ フォルダーを右クリックし、更新 を選択します。</span><span class="sxs-lookup"><span data-stu-id="5e698-212">If you do not see this stored procedure, right-click on the Stored Procedures folder and choose Refresh.</span></span> <span data-ttu-id="5e698-213">使用するように、ストアド プロシージャを更新、 `LEFT JOIN` manager s を最初に返されますの姓と名にします。</span><span class="sxs-lookup"><span data-stu-id="5e698-213">Update the stored procedure so that it uses a `LEFT JOIN` to return the manager s first and last name:</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample5.sql)]

<span data-ttu-id="5e698-214">更新した後、`SELECT`ステートメントでは、ファイル メニューの 保存 を選択して変更を保存`Employees_Select`です。</span><span class="sxs-lookup"><span data-stu-id="5e698-214">After updating the `SELECT` statement, save the changes by going to the File menu and choosing Save `Employees_Select`.</span></span> <span data-ttu-id="5e698-215">または、ツールバーの [保存] アイコンをクリックしてしたり、Ctrl キーを押しながら S キーを押してできます。</span><span class="sxs-lookup"><span data-stu-id="5e698-215">Alternatively, you can click the Save icon in the toolbar or hit Ctrl+S.</span></span> <span data-ttu-id="5e698-216">右クリックし、変更内容を保存した後、`Employees_Select`サーバー エクスプ ローラーでストアド プロシージャと実行 を選択します。</span><span class="sxs-lookup"><span data-stu-id="5e698-216">After saving your changes, right-click on the `Employees_Select` stored procedure in the Server Explorer and choose Execute.</span></span> <span data-ttu-id="5e698-217">これは、ストアド プロシージャを実行され、出力ウィンドウにその結果を表示 (図 9 を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="5e698-217">This will run the stored procedure and show its results in the Output window (see Figure 9).</span></span>


<span data-ttu-id="5e698-218">[![ストアド プロシージャの結果が、出力ウィンドウに表示されます。](updating-the-tableadapter-to-use-joins-vb/_static/image22.png)](updating-the-tableadapter-to-use-joins-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="5e698-218">[![The Stored Procedures Results are Displayed in the Output Window](updating-the-tableadapter-to-use-joins-vb/_static/image22.png)](updating-the-tableadapter-to-use-joins-vb/_static/image21.png)</span></span>

<span data-ttu-id="5e698-219">**図 9**: は、出力ウィンドウに、ストアド プロシージャの結果が表示されます ([フルサイズのイメージを表示するをクリックして](updating-the-tableadapter-to-use-joins-vb/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="5e698-219">**Figure 9**: The Stored Procedures Results are Displayed in the Output Window ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image23.png))</span></span>


## <a name="step-3-updating-the-datatable-s-columns"></a><span data-ttu-id="5e698-220">手順 3: データ テーブルの列を更新します。</span><span class="sxs-lookup"><span data-stu-id="5e698-220">Step 3: Updating the DataTable s Columns</span></span>

<span data-ttu-id="5e698-221">この時点で、 `Employees_Select` 、ストアド プロシージャ`ManagerFirstName`と`ManagerLastName`値、ですが、`EmployeesDataTable`これらの列がありません。</span><span class="sxs-lookup"><span data-stu-id="5e698-221">At this point, the `Employees_Select` stored procedure returns `ManagerFirstName` and `ManagerLastName` values, but the `EmployeesDataTable` is missing these columns.</span></span> <span data-ttu-id="5e698-222">これらの不足している列は、2 つの方法のいずれかでデータ テーブルに追加できます。</span><span class="sxs-lookup"><span data-stu-id="5e698-222">These missing columns can be added to the DataTable in one of two ways:</span></span>

- <span data-ttu-id="5e698-223">**手動で**- データセット デザイナーでデータ テーブルを右クリックし、[追加] メニューから列を選択します。</span><span class="sxs-lookup"><span data-stu-id="5e698-223">**Manually** - right-click on the DataTable in the DataSet Designer and, from the Add menu, choose Column.</span></span> <span data-ttu-id="5e698-224">列の名前し、それに応じてそのプロパティを設定できます。</span><span class="sxs-lookup"><span data-stu-id="5e698-224">You can then name the column and set its properties accordingly.</span></span>
- <span data-ttu-id="5e698-225">**自動的に**-TableAdapter 構成ウィザードは、DataTable s の列を更新によって返されるフィールドを反映するように、`SelectCommand`ストアド プロシージャです。</span><span class="sxs-lookup"><span data-stu-id="5e698-225">**Automatically** - the TableAdapter Configuration wizard will update the DataTable s columns to reflect the fields returned by the `SelectCommand` stored procedure.</span></span> <span data-ttu-id="5e698-226">ウィザードが削除されますも、アドホック SQL ステートメントを使用する場合、 `InsertCommand`、 `UpdateCommand`、および`DeleteCommand`プロパティ、`SelectCommand`が含まれています、`JOIN`です。</span><span class="sxs-lookup"><span data-stu-id="5e698-226">When using ad-hoc SQL statements, the wizard will also remove the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties since the `SelectCommand` now contains a `JOIN`.</span></span> <span data-ttu-id="5e698-227">これらのコマンド プロパティはそのまま保持ストアド プロシージャを使用する場合。</span><span class="sxs-lookup"><span data-stu-id="5e698-227">But when using stored procedures, these command properties remain intact.</span></span>

<span data-ttu-id="5e698-228">など、前のチュートリアルで手動で追加のデータ テーブルの列について説明してきました[マスター/詳細レコードを使用して、箇条書きリストのマスター詳細 DataList で](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md)と[ファイルのアップロード](../working-with-binary-files/uploading-files-vb.md)では、[次へ]、チュートリアルでは、もう一度の詳細については、このプロセスを見てください。</span><span class="sxs-lookup"><span data-stu-id="5e698-228">We have explored manually adding DataTable columns in previous tutorials, including [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) and [Uploading Files](../working-with-binary-files/uploading-files-vb.md), and we will look at this process again in more detail in our next tutorial.</span></span> <span data-ttu-id="5e698-229">このチュートリアルでは、ただし、TableAdapter 構成ウィザードを使用して自動アプローチを使用して s を使用できます。</span><span class="sxs-lookup"><span data-stu-id="5e698-229">For this tutorial, however, let s use the automatic approach via the TableAdapter Configuration wizard.</span></span>

<span data-ttu-id="5e698-230">右クリックして開始、`EmployeesTableAdapter`し、コンテキスト メニューから構成を選択します。</span><span class="sxs-lookup"><span data-stu-id="5e698-230">Start by right-clicking on the `EmployeesTableAdapter` and selecting Configure from the context menu.</span></span> <span data-ttu-id="5e698-231">選択すると、挿入、更新、および削除、およびその戻り値とパラメーター (ある場合) を使用するストアド プロシージャを一覧表示すると、TableAdapter 構成ウィザードが表示されます。</span><span class="sxs-lookup"><span data-stu-id="5e698-231">This brings up the TableAdapter Configuration wizard, which lists the stored procedures used for selecting, inserting, updating, and deleting, along with their return values and parameters (if any).</span></span> <span data-ttu-id="5e698-232">図 10 では、このウィザードを示します。</span><span class="sxs-lookup"><span data-stu-id="5e698-232">Figure 10 shows this wizard.</span></span> <span data-ttu-id="5e698-233">ここでことが分かります、 `Employees_Select` 、ストアド プロシージャ now、`ManagerFirstName`と`ManagerLastName`フィールドです。</span><span class="sxs-lookup"><span data-stu-id="5e698-233">Here we can see that the `Employees_Select` stored procedure now returns the `ManagerFirstName` and `ManagerLastName` fields.</span></span>


<span data-ttu-id="5e698-234">[![ストアド プロシージャをウィザードに示す、Employees_Select の更新された列の一覧](updating-the-tableadapter-to-use-joins-vb/_static/image25.png)](updating-the-tableadapter-to-use-joins-vb/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="5e698-234">[![The Wizard Shows the Updated Column List for the Employees_Select Stored Procedure](updating-the-tableadapter-to-use-joins-vb/_static/image25.png)](updating-the-tableadapter-to-use-joins-vb/_static/image24.png)</span></span>

<span data-ttu-id="5e698-235">**図 10**: ウィザードの更新された列の一覧を示しています、`Employees_Select`ストアド プロシージャ ([フルサイズのイメージを表示するをクリックして](updating-the-tableadapter-to-use-joins-vb/_static/image26.png))</span><span class="sxs-lookup"><span data-stu-id="5e698-235">**Figure 10**: The Wizard Shows the Updated Column List for the `Employees_Select` Stored Procedure ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image26.png))</span></span>


<span data-ttu-id="5e698-236">[完了] をクリックして、ウィザードを完了します。</span><span class="sxs-lookup"><span data-stu-id="5e698-236">Complete the wizard by clicking Finish.</span></span> <span data-ttu-id="5e698-237">データセット デザイナーに戻ったときに、 `EmployeesDataTable` 2 つの列が含まれています:`ManagerFirstName`と`ManagerLastName`です。</span><span class="sxs-lookup"><span data-stu-id="5e698-237">Upon returning to the DataSet Designer, the `EmployeesDataTable` includes two additional columns: `ManagerFirstName` and `ManagerLastName`.</span></span>


<span data-ttu-id="5e698-238">[![EmployeesDataTable には、2 つの新しい列が含まれています。](updating-the-tableadapter-to-use-joins-vb/_static/image28.png)](updating-the-tableadapter-to-use-joins-vb/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="5e698-238">[![The EmployeesDataTable Contains Two New Columns](updating-the-tableadapter-to-use-joins-vb/_static/image28.png)](updating-the-tableadapter-to-use-joins-vb/_static/image27.png)</span></span>

<span data-ttu-id="5e698-239">**図 11**: `EmployeesDataTable` 2 つの新しい列が含まれています ([フルサイズのイメージを表示するをクリックして](updating-the-tableadapter-to-use-joins-vb/_static/image29.png))</span><span class="sxs-lookup"><span data-stu-id="5e698-239">**Figure 11**: The `EmployeesDataTable` Contains Two New Columns ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image29.png))</span></span>


<span data-ttu-id="5e698-240">説明するために、更新された`Employees_Select`ストアド プロシージャが有効になり、挿入が更新、および、TableAdapter の機能の削除が機能して、web ページを表示および従業員を削除することができますを作成しています。</span><span class="sxs-lookup"><span data-stu-id="5e698-240">To illustrate that the updated `Employees_Select` stored procedure is in effect and that the insert, update, and delete capabilities of the TableAdapter are still functional, let s create a web page that allows users to view and delete employees.</span></span> <span data-ttu-id="5e698-241">このようなページを作成する前に、必要があります最初の従業員を操作するためのビジネス ロジック層で、新しいクラスを作成する、`NorthwindWithSprocs`データセット。</span><span class="sxs-lookup"><span data-stu-id="5e698-241">Before we create such a page, however, we need to first create a new class in the Business Logic Layer for working with employees from the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="5e698-242">手順 4 では作成、`EmployeesBLLWithSprocs`クラスです。</span><span class="sxs-lookup"><span data-stu-id="5e698-242">In Step 4, we will create an `EmployeesBLLWithSprocs` class.</span></span> <span data-ttu-id="5e698-243">手順 5 では、ASP.NET ページからこのクラスを使用します。</span><span class="sxs-lookup"><span data-stu-id="5e698-243">In Step 5, we will use this class from an ASP.NET page.</span></span>

## <a name="step-4-implementing-the-business-logic-layer"></a><span data-ttu-id="5e698-244">手順 4: 層のビジネス ロジックを実装します。</span><span class="sxs-lookup"><span data-stu-id="5e698-244">Step 4: Implementing the Business Logic Layer</span></span>

<span data-ttu-id="5e698-245">クラスの新しいファイルを作成、`~/App_Code/BLL`という名前のフォルダー`EmployeesBLLWithSprocs.vb`です。</span><span class="sxs-lookup"><span data-stu-id="5e698-245">Create a new class file in the `~/App_Code/BLL` folder named `EmployeesBLLWithSprocs.vb`.</span></span> <span data-ttu-id="5e698-246">このクラスは、既存のセマンティクスを模倣`EmployeesBLL`のみ、この新しい 1 つ少ないメソッドを提供され、クラスを使用して、`NorthwindWithSprocs`データセット (の代わりに、`Northwind`データセット)。</span><span class="sxs-lookup"><span data-stu-id="5e698-246">This class mimics the semantics of the existing `EmployeesBLL` class, only this new one provides fewer methods and uses the `NorthwindWithSprocs` DataSet (instead of the `Northwind` DataSet).</span></span> <span data-ttu-id="5e698-247">`EmployeesBLLWithSprocs` クラスに次のコードを追加します。</span><span class="sxs-lookup"><span data-stu-id="5e698-247">Add the following code to the `EmployeesBLLWithSprocs` class.</span></span>


[!code-vb[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample6.vb)]

<span data-ttu-id="5e698-248">`EmployeesBLLWithSprocs`クラス s`Adapter`プロパティがのインスタンスを返します、`NorthwindWithSprocs`データセットの`EmployeesTableAdapter`です。</span><span class="sxs-lookup"><span data-stu-id="5e698-248">The `EmployeesBLLWithSprocs` class s `Adapter` property returns an instance of the `NorthwindWithSprocs` DataSet s `EmployeesTableAdapter`.</span></span> <span data-ttu-id="5e698-249">これは、クラス s によって使用`GetEmployees`と`DeleteEmployee`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="5e698-249">This is used by the class s `GetEmployees` and `DeleteEmployee` methods.</span></span> <span data-ttu-id="5e698-250">`GetEmployees`メソッドの呼び出し、 `EmployeesTableAdapter` s 対応`GetEmployees`によって実行されるメソッド、`Employees_Select`ストアド プロシージャでは、その結果を取り込んで、`EmployeeDataTable`です。</span><span class="sxs-lookup"><span data-stu-id="5e698-250">The `GetEmployees` method calls the `EmployeesTableAdapter` s corresponding `GetEmployees` method, which invokes the `Employees_Select` stored procedure and populates its results in an `EmployeeDataTable`.</span></span> <span data-ttu-id="5e698-251">`DeleteEmployee`メソッドを呼び出す同様に、 `EmployeesTableAdapter` s`Delete`によって実行されるメソッド、`Employees_Delete`ストアド プロシージャです。</span><span class="sxs-lookup"><span data-stu-id="5e698-251">The `DeleteEmployee` method similarly calls the `EmployeesTableAdapter` s `Delete` method, which invokes the `Employees_Delete` stored procedure.</span></span>

## <a name="step-5-working-with-the-data-in-the-presentation-layer"></a><span data-ttu-id="5e698-252">手順 5: プレゼンテーション層で、データの使用</span><span class="sxs-lookup"><span data-stu-id="5e698-252">Step 5: Working with the Data in the Presentation Layer</span></span>

<span data-ttu-id="5e698-253">`EmployeesBLLWithSprocs`お ASP.NET ページから従業員データを処理する準備が完了すると、クラスです。</span><span class="sxs-lookup"><span data-stu-id="5e698-253">With the `EmployeesBLLWithSprocs` class complete, we re ready to work with employee data through an ASP.NET page.</span></span> <span data-ttu-id="5e698-254">開く、 `JOINs.aspx`  ページで、`AdvancedDAL`フォルダーと、デザイナーの設定には、ツールボックスからドラッグ、GridView、`ID`プロパティを`Employees`です。</span><span class="sxs-lookup"><span data-stu-id="5e698-254">Open the `JOINs.aspx` page in the `AdvancedDAL` folder and drag a GridView from the Toolbox onto the Designer, setting its `ID` property to `Employees`.</span></span> <span data-ttu-id="5e698-255">次に、GridView s のスマート タグからグリッドにバインドという名前の新しい ObjectDataSource コントロール`EmployeesDataSource`です。</span><span class="sxs-lookup"><span data-stu-id="5e698-255">Next, from the GridView s smart tag, bind the grid to a new ObjectDataSource control named `EmployeesDataSource`.</span></span>

<span data-ttu-id="5e698-256">構成を使用する ObjectDataSource、`EmployeesBLLWithSprocs`クラス、タブの中を選択し、削除、ことを確認して、`GetEmployees`と`DeleteEmployee`メソッドは、ドロップダウン リストから選択します。</span><span class="sxs-lookup"><span data-stu-id="5e698-256">Configure the ObjectDataSource to use the `EmployeesBLLWithSprocs` class and, from the SELECT and DELETE tabs, ensure that the `GetEmployees` and `DeleteEmployee` methods are selected from the drop-down lists.</span></span> <span data-ttu-id="5e698-257">ObjectDataSource の構成を完了するには、[完了] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="5e698-257">Click Finish to complete the ObjectDataSource s configuration.</span></span>


<span data-ttu-id="5e698-258">[![構成、ObjectDataSource EmployeesBLLWithSprocs クラスを使用するには](updating-the-tableadapter-to-use-joins-vb/_static/image31.png)](updating-the-tableadapter-to-use-joins-vb/_static/image30.png)</span><span class="sxs-lookup"><span data-stu-id="5e698-258">[![Configure the ObjectDataSource to Use the EmployeesBLLWithSprocs Class](updating-the-tableadapter-to-use-joins-vb/_static/image31.png)](updating-the-tableadapter-to-use-joins-vb/_static/image30.png)</span></span>

<span data-ttu-id="5e698-259">**図 12**: 構成を使用する ObjectDataSource、`EmployeesBLLWithSprocs`クラス ([フルサイズのイメージを表示するをクリックして](updating-the-tableadapter-to-use-joins-vb/_static/image32.png))</span><span class="sxs-lookup"><span data-stu-id="5e698-259">**Figure 12**: Configure the ObjectDataSource to Use the `EmployeesBLLWithSprocs` Class ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image32.png))</span></span>


<span data-ttu-id="5e698-260">[![ObjectDataSource を使用するためとするメソッドがあります。](updating-the-tableadapter-to-use-joins-vb/_static/image34.png)](updating-the-tableadapter-to-use-joins-vb/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="5e698-260">[![Have the ObjectDataSource Use the GetEmployees and DeleteEmployee Methods](updating-the-tableadapter-to-use-joins-vb/_static/image34.png)](updating-the-tableadapter-to-use-joins-vb/_static/image33.png)</span></span>

<span data-ttu-id="5e698-261">**図 13**: ObjectDataSource に使用されている、`GetEmployees`と`DeleteEmployee`メソッド ([フルサイズのイメージを表示するをクリックして](updating-the-tableadapter-to-use-joins-vb/_static/image35.png))</span><span class="sxs-lookup"><span data-stu-id="5e698-261">**Figure 13**: Have the ObjectDataSource Use the `GetEmployees` and `DeleteEmployee` Methods ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image35.png))</span></span>


<span data-ttu-id="5e698-262">Visual Studio は、それぞれに対して GridView に BoundField を追加するが、`EmployeesDataTable`の列です。</span><span class="sxs-lookup"><span data-stu-id="5e698-262">Visual Studio will add a BoundField to the GridView for each of the `EmployeesDataTable` s columns.</span></span> <span data-ttu-id="5e698-263">これら BoundFields 以外をすべて削除`Title`、 `LastName`、 `FirstName`、 `ManagerFirstName`、および`ManagerLastName`の名前を変更し、`HeaderText`姓、名、マネージャーの名、最後の 4 つ BoundFields のプロパティとマネージャーの姓、名、それぞれします。</span><span class="sxs-lookup"><span data-stu-id="5e698-263">Remove all of these BoundFields except for `Title`, `LastName`, `FirstName`, `ManagerFirstName`, and `ManagerLastName` and rename the `HeaderText` properties for the last four BoundFields to Last Name, First Name, Manager s First Name, and Manager s Last Name, respectively.</span></span>

<span data-ttu-id="5e698-264">従業員をこのページから削除するユーザーを許可するのには、2 つの作業を行う必要があります。</span><span class="sxs-lookup"><span data-stu-id="5e698-264">To allow users to delete employees from this page we need to do two things.</span></span> <span data-ttu-id="5e698-265">最初に、そのスマート タグからの削除を有効にするオプションをオンにして削除機能を提供する GridView に指示します。</span><span class="sxs-lookup"><span data-stu-id="5e698-265">First, instruct the GridView to provide deleting capabilities by checking the Enable Deleting option from its smart tag.</span></span> <span data-ttu-id="5e698-266">次に、ObjectDataSource s を変更`OldValuesParameterFormatString`プロパティ値から、ObjectDataSource ウィザードによって設定 (`original_{0}`) をその既定値 (`{0}`)。</span><span class="sxs-lookup"><span data-stu-id="5e698-266">Second, change the ObjectDataSource s `OldValuesParameterFormatString` property from the value set by the ObjectDataSource wizard (`original_{0}`) to its default value (`{0}`).</span></span> <span data-ttu-id="5e698-267">これらの変更を加えたら、GridView と ObjectDataSource s 宣言型マークアップを次のようになります。</span><span class="sxs-lookup"><span data-stu-id="5e698-267">After making these changes, your GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample7.aspx)]

<span data-ttu-id="5e698-268">ブラウザーからアクセスして、ページをテストします。</span><span class="sxs-lookup"><span data-stu-id="5e698-268">Test out the page by visiting it through a browser.</span></span> <span data-ttu-id="5e698-269">図 14 に示すように、各従業員と (1 つがあると仮定) 自分のマネージャーの名前に、ページが表示されます。</span><span class="sxs-lookup"><span data-stu-id="5e698-269">As Figure 14 shows, the page will list each employee and his or her manager s name (assuming they have one).</span></span>


<span data-ttu-id="5e698-270">[![Employees_Select 内の結合、ストアド プロシージャ、マネージャー名](updating-the-tableadapter-to-use-joins-vb/_static/image37.png)](updating-the-tableadapter-to-use-joins-vb/_static/image36.png)</span><span class="sxs-lookup"><span data-stu-id="5e698-270">[![The JOIN in the Employees_Select Stored Procedure Returns the Manager s Name](updating-the-tableadapter-to-use-joins-vb/_static/image37.png)](updating-the-tableadapter-to-use-joins-vb/_static/image36.png)</span></span>

<span data-ttu-id="5e698-271">**図 14**:`JOIN`で、`Employees_Select`ストアド プロシージャは、マネージャー名を返します ([フルサイズのイメージを表示するをクリックして](updating-the-tableadapter-to-use-joins-vb/_static/image38.png))</span><span class="sxs-lookup"><span data-stu-id="5e698-271">**Figure 14**: The `JOIN` in the `Employees_Select` Stored Procedure Returns the Manager s Name ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image38.png))</span></span>


<span data-ttu-id="5e698-272">実行が完了、削除のワークフローの開始 [削除] ボタンをクリックすると、`Employees_Delete`ストアド プロシージャです。</span><span class="sxs-lookup"><span data-stu-id="5e698-272">Clicking the Delete button starts the deleting workflow, which culminates in the execution of the `Employees_Delete` stored procedure.</span></span> <span data-ttu-id="5e698-273">ただし、試み`DELETE`は外部キー制約違反のため、ストアド プロシージャ内のステートメントは失敗し (図 15 を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="5e698-273">However, the attempted `DELETE` statement in the stored procedure fails because of a foreign key constraint violation (see Figure 15).</span></span> <span data-ttu-id="5e698-274">具体的には、各従業員が、1 つまたは複数のレコード、`Orders`テーブル、原因で、削除に失敗します。</span><span class="sxs-lookup"><span data-stu-id="5e698-274">Specifically, each employee has one or more records in the `Orders` table, causing the delete to fail.</span></span>


<span data-ttu-id="5e698-275">[![外部キー制約の違反に対応する結果の順序を持つ従業員を削除します。](updating-the-tableadapter-to-use-joins-vb/_static/image40.png)](updating-the-tableadapter-to-use-joins-vb/_static/image39.png)</span><span class="sxs-lookup"><span data-stu-id="5e698-275">[![Deleting an Employee That has Corresponding Orders Results in a Foreign Key Constraint Violation](updating-the-tableadapter-to-use-joins-vb/_static/image40.png)](updating-the-tableadapter-to-use-joins-vb/_static/image39.png)</span></span>

<span data-ttu-id="5e698-276">**図 15**: を外部キー制約の違反に対応する結果の順序を持つ従業員を削除する ([フルサイズのイメージを表示するをクリックして](updating-the-tableadapter-to-use-joins-vb/_static/image41.png))</span><span class="sxs-lookup"><span data-stu-id="5e698-276">**Figure 15**: Deleting an Employee That has Corresponding Orders Results in a Foreign Key Constraint Violation ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image41.png))</span></span>


<span data-ttu-id="5e698-277">削除する従業員を許可する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="5e698-277">To allow an employee to be deleted you could:</span></span>

- <span data-ttu-id="5e698-278">更新プログラムを削除、カスケード外部キー制約</span><span class="sxs-lookup"><span data-stu-id="5e698-278">Update the foreign key constraint to cascade deletes,</span></span>
- <span data-ttu-id="5e698-279">レコードを手動で削除、 `Orders` 、削除する名のテーブルまたは</span><span class="sxs-lookup"><span data-stu-id="5e698-279">Manually delete the records from the `Orders` table for the employee(s) you want to delete, or</span></span>
- <span data-ttu-id="5e698-280">更新プログラム、`Employees_Delete`ストアド プロシージャを最初から関連するレコードを削除する、`Orders`テーブルを削除する前に、`Employees`レコード。</span><span class="sxs-lookup"><span data-stu-id="5e698-280">Update the `Employees_Delete` stored procedure to first delete the related records from the `Orders` table before deleting the `Employees` record.</span></span> <span data-ttu-id="5e698-281">この手法を説明した、[を使用して既存のストアド プロシージャを型指定されたデータセットの Tableadapter](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)チュートリアルです。</span><span class="sxs-lookup"><span data-stu-id="5e698-281">We discussed this technique in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span></span>

<span data-ttu-id="5e698-282">私のままに練習として、リーダーの。</span><span class="sxs-lookup"><span data-stu-id="5e698-282">I leave this as an exercise for the reader.</span></span>

## <a name="summary"></a><span data-ttu-id="5e698-283">まとめ</span><span class="sxs-lookup"><span data-stu-id="5e698-283">Summary</span></span>

<span data-ttu-id="5e698-284">リレーショナル データベースを使用する場合は、関連テーブルにクエリから複数のデータをプルするが一般的です。</span><span class="sxs-lookup"><span data-stu-id="5e698-284">When working with relational databases, it is common for queries to pull their data from multiple, related tables.</span></span> <span data-ttu-id="5e698-285">相関サブクエリと`JOIN`s がクエリ内の関連テーブルからデータにアクセスするために 2 つの異なる方法を提供します。</span><span class="sxs-lookup"><span data-stu-id="5e698-285">Correlated subqueries and `JOIN` s provide two different techniques for accessing data from related tables in a query.</span></span> <span data-ttu-id="5e698-286">TableAdapter は自動生成するため、相関サブクエリの最も一般的に行われた前のチュートリアルを使用して`INSERT`、 `UPDATE`、および`DELETE`関連するクエリに対するステートメント`JOIN`s。</span><span class="sxs-lookup"><span data-stu-id="5e698-286">In previous tutorials we most commonly made use of correlated subqueries because the TableAdapter cannot auto-generate `INSERT`, `UPDATE`, and `DELETE` statements for queries involving `JOIN` s.</span></span> <span data-ttu-id="5e698-287">アドホック SQL ステートメントを使用する場合に、これらの値を手動で指定することができます、TableAdapter 構成ウィザードが完了したときに、カスタマイズは上書きされます。</span><span class="sxs-lookup"><span data-stu-id="5e698-287">While these values can be provided manually, when using ad-hoc SQL statements any customizations will be overwritten when the TableAdapter Configuration wizard is completed.</span></span>

<span data-ttu-id="5e698-288">幸いにも、ストアド プロシージャを使用して作成された Tableadapter では、アドホック SQL ステートメントを使用して作成されたものと同じ脆弱性からことはありません。</span><span class="sxs-lookup"><span data-stu-id="5e698-288">Fortunately, TableAdapters created using stored procedures do not suffer from the same brittleness as those created using ad-hoc SQL statements.</span></span> <span data-ttu-id="5e698-289">したがってがメイン クエリを使用して TableAdapter を作成する実行可能では、`JOIN`ストアド プロシージャを使用する場合。</span><span class="sxs-lookup"><span data-stu-id="5e698-289">Therefore, it is feasible to create a TableAdapter whose main query uses a `JOIN` when using stored procedures.</span></span> <span data-ttu-id="5e698-290">このチュートリアルでは、このような TableAdapter を作成する方法を説明しました。</span><span class="sxs-lookup"><span data-stu-id="5e698-290">In this tutorial we saw how to create such a TableAdapter.</span></span> <span data-ttu-id="5e698-291">使用して起動しました、 `JOIN`-小さい`SELECT`対応する挿入、更新、および削除のストアド プロシージャの自動作成ができるように、TableAdapter のメイン クエリでクエリを実行します。</span><span class="sxs-lookup"><span data-stu-id="5e698-291">We started by using a `JOIN`-less `SELECT` query for the TableAdapter s main query so that the corresponding insert, update, and delete stored procedures would be auto-created.</span></span> <span data-ttu-id="5e698-292">補強、TableAdapter の初期構成が完了した、`SelectCommand`ストアド プロシージャを使用する、`JOIN`を更新する TableAdapter 構成ウィザードを再実行し、`EmployeesDataTable`の列です。</span><span class="sxs-lookup"><span data-stu-id="5e698-292">With the TableAdapter s initial configuration complete, we augmented the `SelectCommand` stored procedure to use a `JOIN` and re-ran the TableAdapter Configuration wizard to update the `EmployeesDataTable` s columns.</span></span>

<span data-ttu-id="5e698-293">TableAdapter 構成ウィザードが自動的に更新を再実行、`EmployeesDataTable`列によって返されるデータ フィールドを反映するように、`Employees_Select`ストアド プロシージャです。</span><span class="sxs-lookup"><span data-stu-id="5e698-293">Re-running the TableAdapter Configuration wizard automatically updated the `EmployeesDataTable` columns to reflect the data fields returned by the `Employees_Select` stored procedure.</span></span> <span data-ttu-id="5e698-294">代わりに、おでしたがこれらの列に手動で追加、DataTable です。</span><span class="sxs-lookup"><span data-stu-id="5e698-294">Alternatively, we could have added these columns manually to the DataTable.</span></span> <span data-ttu-id="5e698-295">について学びます列を手動で追加するには、DataTable に次のチュートリアルでします。</span><span class="sxs-lookup"><span data-stu-id="5e698-295">We will explore manually adding columns to the DataTable in the next tutorial.</span></span>

<span data-ttu-id="5e698-296">満足プログラミング!</span><span class="sxs-lookup"><span data-stu-id="5e698-296">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="5e698-297">作成者について</span><span class="sxs-lookup"><span data-stu-id="5e698-297">About the Author</span></span>

<span data-ttu-id="5e698-298">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)、7 つ受け取りますブックとの創設者の作成者[4GuysFromRolla.com](http://www.4guysfromrolla.com)、1998 年からマイクロソフトの Web テクノロジで取り組んできました。</span><span class="sxs-lookup"><span data-stu-id="5e698-298">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="5e698-299">Scott は、コンサルタント、トレーナー、ライターとして機能します。</span><span class="sxs-lookup"><span data-stu-id="5e698-299">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="5e698-300">最新の著書[ *Sam 学べる自分で ASP.NET 2.0 が 24 時間以内に*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)です。</span><span class="sxs-lookup"><span data-stu-id="5e698-300">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="5e698-301">彼に到達できる[ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)彼のブログを使用して含まれているのか[ http://ScottOnWriting.NET](http://ScottOnWriting.NET)です。</span><span class="sxs-lookup"><span data-stu-id="5e698-301">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="5e698-302">感謝の特別な</span><span class="sxs-lookup"><span data-stu-id="5e698-302">Special Thanks To</span></span>

<span data-ttu-id="5e698-303">このチュートリアルの系列は既に多くの便利なレビュー担当者によって確認済みです。</span><span class="sxs-lookup"><span data-stu-id="5e698-303">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="5e698-304">このチュートリアルの潜在顧客レビュー担当者には、Hilton Geisenow、David Suru Teresa マーフィーがされていました。</span><span class="sxs-lookup"><span data-stu-id="5e698-304">Lead reviewers for this tutorial were Hilton Geisenow, David Suru, and Teresa Murphy.</span></span> <span data-ttu-id="5e698-305">今後、MSDN の記事を確認することに関心のあるですか。</span><span class="sxs-lookup"><span data-stu-id="5e698-305">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="5e698-306">場合は、ドロップ me 一度に 1 行ずつ[mitchell@4GuysFromRolla.comです。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="5e698-306">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="5e698-307">[前へ](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)
> [次へ](adding-additional-datatable-columns-vb.md)</span><span class="sxs-lookup"><span data-stu-id="5e698-307">[Previous](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)
[Next](adding-additional-datatable-columns-vb.md)</span></span>
