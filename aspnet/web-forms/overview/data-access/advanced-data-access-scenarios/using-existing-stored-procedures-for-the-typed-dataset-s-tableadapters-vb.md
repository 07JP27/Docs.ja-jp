---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb
title: "型指定されたデータセットの Tableadapter (VB) のストアド プロシージャを既存の使用 |Microsoft ドキュメント"
author: rick-anderson
description: "前のチュートリアルでは、TableAdapter ウィザードを使用して、新しいストアド プロシージャを生成する方法を学習します。 このチュートリアルで学習はどのように同じ TableAdapter しています."
ms.author: aspnetcontent
manager: wpickett
ms.date: 07/18/2007
ms.topic: article
ms.assetid: 2da25f6a-757e-4e7b-a812-1575288d8f7a
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb
msc.type: authoredcontent
ms.openlocfilehash: 5d1be6c30cda5a06087516210a77f48b6a3fe45b
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/24/2018
---
<a name="using-existing-stored-procedures-for-the-typed-datasets-tableadapters-vb"></a><span data-ttu-id="03c13-104">型指定されたデータセットの Tableadapter (VB) のストアド プロシージャを既存の使用</span><span class="sxs-lookup"><span data-stu-id="03c13-104">Using Existing Stored Procedures for the Typed DataSet's TableAdapters (VB)</span></span>
====================
<span data-ttu-id="03c13-105">によって[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="03c13-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="03c13-106">[コードをダウンロードする](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_68_VB.zip)または[PDF のダウンロード](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/datatutorial68vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="03c13-106">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_68_VB.zip) or [Download PDF](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/datatutorial68vb1.pdf)</span></span>

> <span data-ttu-id="03c13-107">前のチュートリアルでは、TableAdapter ウィザードを使用して、新しいストアド プロシージャを生成する方法を学習します。</span><span class="sxs-lookup"><span data-stu-id="03c13-107">In the previous tutorial we learned how to use the TableAdapter Wizard to generate new stored procedures.</span></span> <span data-ttu-id="03c13-108">このチュートリアルでは、同じ TableAdapter ウィザードが既存のストアド プロシージャを機能させる方法おについて説明します。</span><span class="sxs-lookup"><span data-stu-id="03c13-108">In this tutorial we learn how the same TableAdapter Wizard can work with existing stored procedures.</span></span> <span data-ttu-id="03c13-109">私たちは、データベースに新しいストアド プロシージャを手動で追加する方法も学習します。</span><span class="sxs-lookup"><span data-stu-id="03c13-109">We also learn how to manually add new stored procedures to our database.</span></span>


## <a name="introduction"></a><span data-ttu-id="03c13-110">はじめに</span><span class="sxs-lookup"><span data-stu-id="03c13-110">Introduction</span></span>

<span data-ttu-id="03c13-111">[前のチュートリアル](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)アクセス データではなく、アドホック SQL ステートメントをストアド プロシージャを使用して型指定されたデータセットの Tableadapter の構成方法を説明しました。</span><span class="sxs-lookup"><span data-stu-id="03c13-111">In the [preceding tutorial](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) we saw how the Typed DataSet s TableAdapters could be configured to use stored procedures to access data rather than ad-hoc SQL statements.</span></span> <span data-ttu-id="03c13-112">具体的には、TableAdapter ウィザードで自動的にこれらのストアド プロシージャを作成する方法を確認します。</span><span class="sxs-lookup"><span data-stu-id="03c13-112">In particular, we examined how to have the TableAdapter wizard automatically create these stored procedures.</span></span> <span data-ttu-id="03c13-113">ASP.NET 2.0 にレガシ アプリケーションを移植するとき、または既存のデータ モデルの周囲で ASP.NET 2.0 web サイトを構築するときに、データベースに既に必要なストアド プロシージャが含まれる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="03c13-113">When porting a legacy application to ASP.NET 2.0 or when building an ASP.NET 2.0 website around an existing data model, chances are that the database already contains the stored procedures we need.</span></span> <span data-ttu-id="03c13-114">また、手動で、または、ストアド プロシージャを自動生成する TableAdapter ウィザード以外のいくつかのツールをストアド プロシージャを作成することができます。</span><span class="sxs-lookup"><span data-stu-id="03c13-114">Alternatively, you may prefer to create your stored procedures by hand or through some tool other than the TableAdapter wizard that auto-generates your stored procedures.</span></span>

<span data-ttu-id="03c13-115">このチュートリアルでは、既存のストアド プロシージャを使用して、TableAdapter を構成する方法について取り上げます。</span><span class="sxs-lookup"><span data-stu-id="03c13-115">In this tutorial we will look at how to configure the TableAdapter to use existing stored procedures.</span></span> <span data-ttu-id="03c13-116">Northwind データベースでは、組み込みのストアド プロシージャの小さなセットのみがある後も見ていきます Visual Studio 環境によってデータベースに新しいストアド プロシージャを手動で追加するために必要な手順を実行します。</span><span class="sxs-lookup"><span data-stu-id="03c13-116">Since the Northwind database only has a small set of built-in stored procedures, we will also look at the steps needed to manually add new stored procedures to the database through the Visual Studio environment.</span></span> <span data-ttu-id="03c13-117">開始 s を let!</span><span class="sxs-lookup"><span data-stu-id="03c13-117">Let s get started!</span></span>

> [!NOTE]
> <span data-ttu-id="03c13-118">[トランザクション内でデータベースの変更をラッピング](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)トランザクションをサポートするために、TableAdapter にメソッドを追加したチュートリアル (`BeginTransaction`、`CommitTransaction`など)。</span><span class="sxs-lookup"><span data-stu-id="03c13-118">In the [Wrapping Database Modifications within a Transaction](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial we added methods to the TableAdapter to support transactions (`BeginTransaction`, `CommitTransaction`, and so on).</span></span> <span data-ttu-id="03c13-119">代わりに、トランザクションは、データ アクセス層のコードに変更が必要としない、ストアド プロシージャ内に完全に管理できます。</span><span class="sxs-lookup"><span data-stu-id="03c13-119">Alternatively, transactions can be managed entirely within a stored procedure, which requires no modifications to the Data Access Layer code.</span></span> <span data-ttu-id="03c13-120">このチュートリアルではトランザクションのスコープ内でストアド プロシージャのステートメントを実行するために使用する T-SQL コマンドをについて説明します。</span><span class="sxs-lookup"><span data-stu-id="03c13-120">In this tutorial we'll explore the T-SQL commands used to execute a stored procedure s statements within the scope of a transaction.</span></span>


## <a name="step-1-adding-stored-procedures-to-the-northwind-database"></a><span data-ttu-id="03c13-121">手順 1: Northwind データベースへのストアド プロシージャの追加</span><span class="sxs-lookup"><span data-stu-id="03c13-121">Step 1: Adding Stored Procedures to the Northwind Database</span></span>

<span data-ttu-id="03c13-122">Visual Studio では簡単に新しいストアド プロシージャをデータベースに追加します。</span><span class="sxs-lookup"><span data-stu-id="03c13-122">Visual Studio makes it easy to add new stored procedures to a database.</span></span> <span data-ttu-id="03c13-123">Let s は、Northwind データベースからすべての列を表すオブジェクトを新しいストアド プロシージャを追加、`Products`を持つ特定のテーブル`CategoryID`値。</span><span class="sxs-lookup"><span data-stu-id="03c13-123">Let s add a new stored procedure to the Northwind database that returns all columns from the `Products` table for those that have a particular `CategoryID` value.</span></span> <span data-ttu-id="03c13-124">サーバー エクスプ ローラー ウィンドウからのデータベース ダイアグラム、テーブル、ビュー、およびなど、そのフォルダーが表示されるように、Northwind データベースを展開します。</span><span class="sxs-lookup"><span data-stu-id="03c13-124">From the Server Explorer window, expand the Northwind database so that its folders - Database Diagrams, Tables, Views, and so forth - are displayed.</span></span> <span data-ttu-id="03c13-125">前のチュートリアルで説明したとおり、Stored Procedures フォルダーには、データベースの既存のストアド プロシージャが含まれています。</span><span class="sxs-lookup"><span data-stu-id="03c13-125">As we saw in the preceding tutorial, the Stored Procedures folder contains the database s existing stored procedures.</span></span> <span data-ttu-id="03c13-126">新しいストアド プロシージャを追加するには、ストアド プロシージャ フォルダーを右クリックし、コンテキスト メニューから新しいストアド プロシージャの追加オプションを選択します。</span><span class="sxs-lookup"><span data-stu-id="03c13-126">To add a new stored procedure, simply right-click the Stored Procedures folder and choose the Add New Stored Procedure option from the context menu.</span></span>


<span data-ttu-id="03c13-127">[![ストアド プロシージャのフォルダーを右クリックし、新しいストアド プロシージャの追加](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image2.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="03c13-127">[![Right-Click the Stored Procedures Folder and Add a New Stored Procedure](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image2.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image1.png)</span></span>

<span data-ttu-id="03c13-128">**図 1**: ストアド プロシージャ フォルダーを右クリックし、新しいストアド プロシージャの追加 ([フルサイズのイメージを表示するをクリックして](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="03c13-128">**Figure 1**: Right-Click the Stored Procedures Folder and Add a New Stored Procedure ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image3.png))</span></span>


<span data-ttu-id="03c13-129">図 1 に示す新しいストアド プロシージャの追加オプションを選択するウィンドウを開き、スクリプト Visual Studio でストアド プロシージャを作成するために必要な SQL スクリプトのアウトラインします。</span><span class="sxs-lookup"><span data-stu-id="03c13-129">As Figure 1 shows, selecting the Add New Stored Procedure option opens a script window in Visual Studio with the outline of the SQL script needed to create the stored procedure.</span></span> <span data-ttu-id="03c13-130">このジョブをこのスクリプトを具体化し、実行するか、この時点でストアド プロシージャをデータベースに追加 ことをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="03c13-130">It is our job to flesh out this script and execute it, at which point the stored procedure will be added to the database.</span></span>

<span data-ttu-id="03c13-131">次のスクリプトを入力します。</span><span class="sxs-lookup"><span data-stu-id="03c13-131">Enter the following script:</span></span>


[!code-sql[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample1.sql)]

<span data-ttu-id="03c13-132">実行すると、このスクリプトはという Northwind データベースに新しいストアド プロシージャを追加`Products_SelectByCategoryID`です。</span><span class="sxs-lookup"><span data-stu-id="03c13-132">This script, when executed, will add a new stored procedure to the Northwind database named `Products_SelectByCategoryID`.</span></span> <span data-ttu-id="03c13-133">このストアド プロシージャは 1 つの入力パラメーターを受け取ります (`@CategoryID`、型の`int`) を返しますのすべての一致する製品のフィールドと`CategoryID`値。</span><span class="sxs-lookup"><span data-stu-id="03c13-133">This stored procedure accepts a single input parameter (`@CategoryID`, of type `int`) and it returns all of the fields for those products with a matching `CategoryID` value.</span></span>

<span data-ttu-id="03c13-134">これを実行する`CREATE PROCEDURE`スクリプトおよびストアド プロシージャをデータベースに追加、ツールバーの [保存] アイコンをクリックしてまたは Ctrl キーを押しながら S キーをヒットします。</span><span class="sxs-lookup"><span data-stu-id="03c13-134">To execute this `CREATE PROCEDURE` script and add the stored procedure to the database, click the Save icon in the toolbar or hit Ctrl+S.</span></span> <span data-ttu-id="03c13-135">これを行った後、ストアド プロシージャのフォルダーの更新、新しく作成されたを示すと、プロシージャが格納されます。</span><span class="sxs-lookup"><span data-stu-id="03c13-135">After doing so, the Stored Procedures folder refreshes, showing the newly created stored procedure.</span></span> <span data-ttu-id="03c13-136">また、ウィンドウ内のスクリプトがから注意を変更`CREATE PROCEDURE dbo.Products_SelectProductByCategoryID`に`ALTER PROCEDURE``dbo.Products_SelectProductByCategoryID`です。</span><span class="sxs-lookup"><span data-stu-id="03c13-136">Also, the script in the window will change subtlety from `CREATE PROCEDURE dbo.Products_SelectProductByCategoryID` to `ALTER PROCEDURE` `dbo.Products_SelectProductByCategoryID`.</span></span> <span data-ttu-id="03c13-137">`CREATE PROCEDURE`新しいストアド プロシージャをデータベースに追加中に`ALTER PROCEDURE`既存のものを更新します。</span><span class="sxs-lookup"><span data-stu-id="03c13-137">`CREATE PROCEDURE` adds a new stored procedure to the database, while `ALTER PROCEDURE` updates an existing one.</span></span> <span data-ttu-id="03c13-138">スクリプトの先頭に変更されたため`ALTER PROCEDURE`ストアド プロシージャを変更する入力パラメーターまたは SQL ステートメント、および保存 アイコンをクリックするとすると、ストアド プロシージャがこれらの変更が更新されます。</span><span class="sxs-lookup"><span data-stu-id="03c13-138">Since the start of the script has changed to `ALTER PROCEDURE`, changing the stored procedures input parameters or SQL statements and clicking the Save icon will update the stored procedure with these changes.</span></span>

<span data-ttu-id="03c13-139">図 2 は、Visual Studio の後に、`Products_SelectByCategoryID`ストアド プロシージャが保存されました。</span><span class="sxs-lookup"><span data-stu-id="03c13-139">Figure 2 shows Visual Studio after the `Products_SelectByCategoryID` stored procedure has been saved.</span></span>


<span data-ttu-id="03c13-140">[![ストアド プロシージャ Products_SelectByCategoryID がデータベースに追加されました](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image5.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="03c13-140">[![The Stored Procedure Products_SelectByCategoryID Has Been Added to the Database](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image5.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image4.png)</span></span>

<span data-ttu-id="03c13-141">**図 2**: ストアド プロシージャの`Products_SelectByCategoryID`がデータベースに追加されました ([フルサイズのイメージを表示するをクリックして](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="03c13-141">**Figure 2**: The Stored Procedure `Products_SelectByCategoryID` Has Been Added to the Database ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image6.png))</span></span>


## <a name="step-2-configuring-the-tableadapter-to-use-an-existing-stored-procedure"></a><span data-ttu-id="03c13-142">手順 2: 既存のストアド プロシージャを使用する TableAdapter を構成します。</span><span class="sxs-lookup"><span data-stu-id="03c13-142">Step 2: Configuring the TableAdapter to Use an Existing Stored Procedure</span></span>

<span data-ttu-id="03c13-143">これで、`Products_SelectByCategoryID`ストアド プロシージャがデータベースに追加されて、そのメソッドのいずれかが呼び出されるときに、このストアド プロシージャを使用するデータ アクセス層を構成できます。</span><span class="sxs-lookup"><span data-stu-id="03c13-143">Now that the `Products_SelectByCategoryID` stored procedure has been added to the database, we can configure our Data Access Layer to use this stored procedure when one of its methods is invoked.</span></span> <span data-ttu-id="03c13-144">具体的には、追加、`GetProducstByCategoryID(<_i22_>categoryID)<!--_i22_-->`メソッドを`ProductsTableAdapter`で、`NorthwindWithSprocs`型指定されたデータセットを呼び出す、`Products_SelectByCategoryID`ストアド プロシージャを作成したばかりです。</span><span class="sxs-lookup"><span data-stu-id="03c13-144">In particular, we will add a `GetProducstByCategoryID(<_i22_>categoryID)<!--_i22_-->` method to the `ProductsTableAdapter` in the `NorthwindWithSprocs` Typed DataSet that calls the `Products_SelectByCategoryID` stored procedure we just created.</span></span>

<span data-ttu-id="03c13-145">開いて開始、`NorthwindWithSprocs`データセット。</span><span class="sxs-lookup"><span data-stu-id="03c13-145">Start by opening the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="03c13-146">右クリックし、 `ProductsTableAdapter` TableAdapter クエリの構成ウィザードを起動するには、クエリの追加を選択します。</span><span class="sxs-lookup"><span data-stu-id="03c13-146">Right-click on the `ProductsTableAdapter` and choose Add Query to launch the TableAdapter Query Configuration wizard.</span></span> <span data-ttu-id="03c13-147">[前のチュートリアル](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)するうえで、新しいストアド プロシージャを作成する TableAdapter があることにしました。</span><span class="sxs-lookup"><span data-stu-id="03c13-147">In the [preceding tutorial](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) we opted to have the TableAdapter create a new stored procedure for us.</span></span> <span data-ttu-id="03c13-148">このチュートリアルでは、ただし、したいネットワーク上で、既存の新しい TableAdapter メソッド`Products_SelectByCategoryID`ストアド プロシージャです。</span><span class="sxs-lookup"><span data-stu-id="03c13-148">For this tutorial, however, we want to wire the new TableAdapter method to the existing `Products_SelectByCategoryID` stored procedure.</span></span> <span data-ttu-id="03c13-149">そのため、ウィザードの最初の手順から既存のストアド プロシージャを使用する オプションを選択し、次へ をクリックします。</span><span class="sxs-lookup"><span data-stu-id="03c13-149">Therefore, choose the Use existing stored procedure option from the wizard s first step and then click Next.</span></span>


<span data-ttu-id="03c13-150">[![既存のストアド プロシージャ オプションの使用を選択します。](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image8.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="03c13-150">[![Choose the Use existing stored procedure Option](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image8.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image7.png)</span></span>

<span data-ttu-id="03c13-151">**図 3**: を使用して既存のストアド プロシージャ オプションを選択 ([フルサイズのイメージを表示するをクリックして](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="03c13-151">**Figure 3**: Choose the Use existing stored procedure Option ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image9.png))</span></span>


<span data-ttu-id="03c13-152">次の画面は、ドロップダウン リストに表示されます、データベースのストアド プロシージャを提供します。</span><span class="sxs-lookup"><span data-stu-id="03c13-152">The following screen provides a drop-down list populated with the database s stored procedures.</span></span> <span data-ttu-id="03c13-153">ストアド プロシージャを選択するには、左側と右側 (存在する場合) は返されたデータ フィールドに入力パラメーターが一覧表示します。</span><span class="sxs-lookup"><span data-stu-id="03c13-153">Selecting a stored procedure lists its input parameters on the left and the data fields returned (if any) on the right.</span></span> <span data-ttu-id="03c13-154">選択、`Products_SelectByCategoryID`ストアド プロシージャの一覧から、[次へ] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="03c13-154">Choose the `Products_SelectByCategoryID` stored procedure from the list and click Next.</span></span>


<span data-ttu-id="03c13-155">[![選択、Products_SelectByCategoryID ストアド プロシージャ](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image11.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="03c13-155">[![Pick the Products_SelectByCategoryID Stored Procedure](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image11.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image10.png)</span></span>

<span data-ttu-id="03c13-156">**図 4**: Pick、`Products_SelectByCategoryID`ストアド プロシージャ ([フルサイズのイメージを表示するをクリックして](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="03c13-156">**Figure 4**: Pick the `Products_SelectByCategoryID` Stored Procedure ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image12.png))</span></span>


<span data-ttu-id="03c13-157">次の画面をかけるとデータの種類は、ストアド プロシージャによって返されるし、答えが TableAdapter のメソッドによって返される型を判別します。</span><span class="sxs-lookup"><span data-stu-id="03c13-157">The next screen asks us what kind of data is returned by the stored procedure and our answer here determines the type returned by the TableAdapter s method.</span></span> <span data-ttu-id="03c13-158">たとえば、表形式のデータが返されることを示すは場合、メソッドは、`ProductsDataTable`インスタンスが、ストアド プロシージャによって返されるレコードを格納します。</span><span class="sxs-lookup"><span data-stu-id="03c13-158">For example, if we indicate that tabular data is returned, the method will return a `ProductsDataTable` instance populated with the records returned by the stored procedure.</span></span> <span data-ttu-id="03c13-159">これに対し、このストアド プロシージャが単一の値を返すことを示している場合、TableAdapter が返されます、`Object`ストアド プロシージャによって返される最初のレコードの最初の列の値を割り当てることができます。</span><span class="sxs-lookup"><span data-stu-id="03c13-159">In contrast, if we indicate that this stored procedure returns a single value the TableAdapter will return an `Object` that is assigned the value in the first column of the first record returned by the stored procedure.</span></span>

<span data-ttu-id="03c13-160">以降、`Products_SelectByCategoryID`ストアド プロシージャが返すすべての製品を特定のカテゴリに属するを表形式データの最初の応答を選択して [次へ] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="03c13-160">Since the `Products_SelectByCategoryID` stored procedure returns all products that belong to a particular category, choose the first answer - Tabular data - and click Next.</span></span>


<span data-ttu-id="03c13-161">[![ストアド プロシージャが表形式のデータを返すことを示します](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image14.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="03c13-161">[![Indicate that the Stored Procedure Returns Tabular Data](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image14.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image13.png)</span></span>

<span data-ttu-id="03c13-162">**図 5**: ストアド プロシージャが表形式のデータを返すことを示します ([フルサイズのイメージを表示するをクリックして](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="03c13-162">**Figure 5**: Indicate that the Stored Procedure Returns Tabular Data ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image15.png))</span></span>


<span data-ttu-id="03c13-163">これらのメソッド名を使用して後に使用するメソッドのパターンを示すためにします。</span><span class="sxs-lookup"><span data-stu-id="03c13-163">All that remains is to indicate what method patterns to use followed by the names for these methods.</span></span> <span data-ttu-id="03c13-164">両方の塗りつぶし DataTable オプションがオンになっているが、メソッドの名前を変更 DataTable と戻り値のままにして`FillByCategoryID`と`GetProductsByCategoryID`です。</span><span class="sxs-lookup"><span data-stu-id="03c13-164">Leave both the Fill a DataTable and Return a DataTable options checked, but rename the methods to `FillByCategoryID` and `GetProductsByCategoryID`.</span></span> <span data-ttu-id="03c13-165">ウィザードが実行するタスクの概要を確認するには、次へ をクリックします。</span><span class="sxs-lookup"><span data-stu-id="03c13-165">Then click Next to review a summary of the tasks the wizard will perform.</span></span> <span data-ttu-id="03c13-166">すべてが正しい場合、[完了] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="03c13-166">If everything looks correct, click Finish.</span></span>


<span data-ttu-id="03c13-167">[![名前のメソッド FillByCategoryID と GetProductsByCategoryID](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image17.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="03c13-167">[![Name the Methods FillByCategoryID and GetProductsByCategoryID](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image17.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image16.png)</span></span>

<span data-ttu-id="03c13-168">**図 6**: メソッドの名前を付けます`FillByCategoryID`と`GetProductsByCategoryID`([フルサイズのイメージを表示するをクリックして](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="03c13-168">**Figure 6**: Name the Methods `FillByCategoryID` and `GetProductsByCategoryID` ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image18.png))</span></span>


> [!NOTE]
> <span data-ttu-id="03c13-169">TableAdapter のメソッドを先ほど作成した`FillByCategoryID`と`GetProductsByCategoryID`、型の入力パラメーターを想定して`Integer`です。</span><span class="sxs-lookup"><span data-stu-id="03c13-169">The TableAdapter methods we just created, `FillByCategoryID` and `GetProductsByCategoryID`, expect an input parameter of type `Integer`.</span></span> <span data-ttu-id="03c13-170">この入力パラメーターの値が使用してストアド プロシージャに渡されたその`@CategoryID`パラメーター。</span><span class="sxs-lookup"><span data-stu-id="03c13-170">This input parameter value is passed into the stored procedure via its `@CategoryID` parameter.</span></span> <span data-ttu-id="03c13-171">変更する場合、`Products_SelectByCategory`ストアド プロシージャのパラメーター、またこれら TableAdapter のメソッドのパラメーターを更新する必要があります。</span><span class="sxs-lookup"><span data-stu-id="03c13-171">If you modify the `Products_SelectByCategory` stored procedure s parameters, you'll need to also update the parameters for these TableAdapter methods.</span></span> <span data-ttu-id="03c13-172">説明したように、[前のチュートリアル](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)、2 つの方法のいずれかでこれ行う: 手動で追加または削除してパラメーターをパラメーター コレクションから、または、TableAdapter ウィザードを再実行しています。</span><span class="sxs-lookup"><span data-stu-id="03c13-172">As discussed in the [previous tutorial](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md), this can be done in one of two ways: by manually adding or removing parameters from the parameters collection or by rerunning the TableAdapter wizard.</span></span>


## <a name="step-3-adding-agetproductsbycategoryidcategoryidmethod-to-the-bll"></a><span data-ttu-id="03c13-173">手順 3: 追加、`GetProductsByCategoryID(categoryID)`BLL メソッド</span><span class="sxs-lookup"><span data-stu-id="03c13-173">Step 3: Adding a`GetProductsByCategoryID(categoryID)`Method to the BLL</span></span>

<span data-ttu-id="03c13-174">`GetProductsByCategoryID` DAL メソッドが完了したら、次に、ビジネス ロジック層でこのメソッドにアクセスできるようにします。</span><span class="sxs-lookup"><span data-stu-id="03c13-174">With the `GetProductsByCategoryID` DAL method complete, the next step is to provide access to this method in the Business Logic Layer.</span></span> <span data-ttu-id="03c13-175">開く、`ProductsBLLWithSprocs`クラス ファイルと、次のメソッドを追加します。</span><span class="sxs-lookup"><span data-stu-id="03c13-175">Open the `ProductsBLLWithSprocs` class file and add the following method:</span></span>


[!code-vb[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample2.vb)]

<span data-ttu-id="03c13-176">この BLL メソッドだけを返します、`ProductsDataTable`から返される、 `ProductsTableAdapter` s`GetProductsByCategoryID`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="03c13-176">This BLL method simply returns the `ProductsDataTable` returned from the `ProductsTableAdapter` s `GetProductsByCategoryID` method.</span></span> <span data-ttu-id="03c13-177">`DataObjectMethodAttribute`属性は、ObjectDataSource のデータ ソース構成ウィザードで使用されるメタデータを提供します。</span><span class="sxs-lookup"><span data-stu-id="03c13-177">The `DataObjectMethodAttribute` attribute provides metadata used by the ObjectDataSource s Configure Data Source wizard.</span></span> <span data-ttu-id="03c13-178">具体的には、このメソッドは、タブの s ドロップダウン リストに表示されます。</span><span class="sxs-lookup"><span data-stu-id="03c13-178">In particular, this method will appear in the SELECT tab s drop-down list.</span></span>

## <a name="step-4-displaying-products-by-category"></a><span data-ttu-id="03c13-179">手順 4: カテゴリによって製品を表示します。</span><span class="sxs-lookup"><span data-stu-id="03c13-179">Step 4: Displaying Products by Category</span></span>

<span data-ttu-id="03c13-180">新しく追加されたテスト`Products_SelectByCategoryID`ストアド プロシージャと、対応する DAL と BLL メソッド、s、DropDownList と GridView を含む ASP.NET ページを作成できるようにします。</span><span class="sxs-lookup"><span data-stu-id="03c13-180">To test the newly added `Products_SelectByCategoryID` stored procedure and the corresponding DAL and BLL methods, let s create an ASP.NET page that contains a DropDownList and a GridView.</span></span> <span data-ttu-id="03c13-181">DropDownList はすべて一覧表示、データベース内のカテゴリの中に、GridView、選択したカテゴリに属する製品が表示されます。</span><span class="sxs-lookup"><span data-stu-id="03c13-181">The DropDownList will list all of the categories in the database while the GridView will display the products belonging to the selected category.</span></span>

> [!NOTE]
> <span data-ttu-id="03c13-182">作成したマスター/詳細インターフェイスお DropDownLists を前のチュートリアルで使用します。</span><span class="sxs-lookup"><span data-stu-id="03c13-182">We ve created master/detail interfaces using DropDownLists in previous tutorials.</span></span> <span data-ttu-id="03c13-183">このようなマスター/詳細レポートの実装をより詳しくを参照してください、[マスター/詳細のフィルター処理で、DropDownList](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md)チュートリアルです。</span><span class="sxs-lookup"><span data-stu-id="03c13-183">For a more in-depth look at implementing such a master/detail report, refer to the [Master/Detail Filtering With a DropDownList](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md) tutorial.</span></span>


<span data-ttu-id="03c13-184">開く、 `ExistingSprocs.aspx`  ページで、`AdvancedDAL`フォルダーと、ツールボックスからデザイナーにドラッグ DropDownList です。</span><span class="sxs-lookup"><span data-stu-id="03c13-184">Open the `ExistingSprocs.aspx` page in the `AdvancedDAL` folder and drag a DropDownList from the Toolbox onto the Designer.</span></span> <span data-ttu-id="03c13-185">集合の DropDownList s`ID`プロパティを`Categories`とその`AutoPostBack`プロパティを`True`です。</span><span class="sxs-lookup"><span data-stu-id="03c13-185">Set the DropDownList s `ID` property to `Categories` and its `AutoPostBack` property to `True`.</span></span> <span data-ttu-id="03c13-186">次に、そのスマート タグからバインド DropDownList という名前の新しい ObjectDataSource`CategoriesDataSource`です。</span><span class="sxs-lookup"><span data-stu-id="03c13-186">Next, from its smart tag, bind the DropDownList to a new ObjectDataSource named `CategoriesDataSource`.</span></span> <span data-ttu-id="03c13-187">データを取得するための構成、ObjectDataSource、`CategoriesBLL`クラスの`GetCategories`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="03c13-187">Configure the ObjectDataSource so that it retrieves its data from the `CategoriesBLL` class s `GetCategories` method.</span></span> <span data-ttu-id="03c13-188">UPDATE、INSERT でドロップダウン リストを設定し、(なし) タブを削除します。</span><span class="sxs-lookup"><span data-stu-id="03c13-188">Set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) .</span></span>


<span data-ttu-id="03c13-189">[![CategoriesBLL クラスのメソッドからデータを取得します。](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image20.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="03c13-189">[![Retrieve Data from the CategoriesBLL Class s GetCategories Method](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image20.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image19.png)</span></span>

<span data-ttu-id="03c13-190">**図 7**: からのデータの取得、`CategoriesBLL`クラス s`GetCategories`メソッド ([フルサイズのイメージを表示するをクリックして](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="03c13-190">**Figure 7**: Retrieve Data from the `CategoriesBLL` Class s `GetCategories` Method ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image21.png))</span></span>


<span data-ttu-id="03c13-191">[![UPDATE、INSERT のドロップダウン リストを設定し、(なし) タブを削除します。](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image23.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="03c13-191">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image23.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image22.png)</span></span>

<span data-ttu-id="03c13-192">**図 8**: (なし) に、UPDATE、INSERT、および削除のタブで、ドロップダウン リストを設定 ([フルサイズのイメージを表示するをクリックして](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="03c13-192">**Figure 8**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None) ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image24.png))</span></span>


<span data-ttu-id="03c13-193">ObjectDataSource ウィザードを完了すると、構成を表示する DropDownList、`CategoryName`データ フィールドを使用して、`CategoryID`フィールド、`Value`各`ListItem`です。</span><span class="sxs-lookup"><span data-stu-id="03c13-193">After completing the ObjectDataSource wizard, configure the DropDownList to display the `CategoryName` data field and to use the `CategoryID` field as the `Value` for each `ListItem`.</span></span>

<span data-ttu-id="03c13-194">この時点での DropDownList と ObjectDataSource s の宣言型マークアップは、次のようにする必要があります。</span><span class="sxs-lookup"><span data-stu-id="03c13-194">At this point, the DropDownList and ObjectDataSource s declarative markup should similar to the following:</span></span>


[!code-aspx[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample3.aspx)]

<span data-ttu-id="03c13-195">次に、デザイナーにドラッグ、GridView、DropDownList の下に配置します。</span><span class="sxs-lookup"><span data-stu-id="03c13-195">Next, drag a GridView onto the Designer, placing it beneath the DropDownList.</span></span> <span data-ttu-id="03c13-196">集合 GridView s`ID`に`ProductsByCategory`と、という名前の新しい ObjectDataSource へのバインドのスマート タグから`ProductsByCategoryDataSource`です。</span><span class="sxs-lookup"><span data-stu-id="03c13-196">Set the GridView s `ID` to `ProductsByCategory` and, from its smart tag, bind it to a new ObjectDataSource named `ProductsByCategoryDataSource`.</span></span> <span data-ttu-id="03c13-197">構成、 `ProductsByCategoryDataSource` ObjectDataSource を使用する、`ProductsBLLWithSprocs`してクラスを使用してそのデータを取得する、`GetProductsByCategoryID(categoryID)`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="03c13-197">Configure the `ProductsByCategoryDataSource` ObjectDataSource to use the `ProductsBLLWithSprocs` class, having it retrieve its data using the `GetProductsByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="03c13-198">この GridView のみが使用されますデータを表示するため、UPDATE、INSERT でのドロップダウン リストの設定 (なし) にタブを削除して 次へ をクリックします。</span><span class="sxs-lookup"><span data-stu-id="03c13-198">Since this GridView will only be used to display data, set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) and click Next.</span></span>


<span data-ttu-id="03c13-199">[![構成、ObjectDataSource ProductsBLLWithSprocs クラスを使用するには](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image26.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="03c13-199">[![Configure the ObjectDataSource to Use the ProductsBLLWithSprocs Class](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image26.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image25.png)</span></span>

<span data-ttu-id="03c13-200">**図 9**: 構成を使用する ObjectDataSource、`ProductsBLLWithSprocs`クラス ([フルサイズのイメージを表示するをクリックして](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="03c13-200">**Figure 9**: Configure the ObjectDataSource to Use the `ProductsBLLWithSprocs` Class ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image27.png))</span></span>


<span data-ttu-id="03c13-201">[![GetProductsByCategoryID(categoryID) メソッドからデータを取得します。](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image29.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="03c13-201">[![Retrieve Data from the GetProductsByCategoryID(categoryID) Method](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image29.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image28.png)</span></span>

<span data-ttu-id="03c13-202">**図 10**: からのデータの取得、`GetProductsByCategoryID(categoryID)`メソッド ([フルサイズのイメージを表示するをクリックして](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="03c13-202">**Figure 10**: Retrieve Data from the `GetProductsByCategoryID(categoryID)` Method ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image30.png))</span></span>


<span data-ttu-id="03c13-203">選択 タブで選択された方法ではため、ウィザードの最後の手順はごパラメーター s のソースの入力が求め、パラメーターが必要です。</span><span class="sxs-lookup"><span data-stu-id="03c13-203">The method chosen in the SELECT tab expects a parameter, so the final step of the wizard prompts us for the parameter s source.</span></span> <span data-ttu-id="03c13-204">パラメーターのソースのドロップダウン リストをコントロールに設定し、選択、 `Categories` ControlID ドロップダウン リストから管理します。</span><span class="sxs-lookup"><span data-stu-id="03c13-204">Set the Parameter source drop-down list to Control and choose the `Categories` control from the ControlID drop-down list.</span></span> <span data-ttu-id="03c13-205">ウィザードを完了するには、[完了] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="03c13-205">Click Finish to complete the wizard.</span></span>


<span data-ttu-id="03c13-206">[![カテゴリの DropDownList の categoryID パラメーターのソースとして使用します。](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image32.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="03c13-206">[![Use the Categories DropDownList as the Source of the categoryID Parameter](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image32.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image31.png)</span></span>

<span data-ttu-id="03c13-207">**図 11**: を使用して、 `Categories` DropDownList のソースとして、`categoryID`パラメーター ([フルサイズのイメージを表示するをクリックして](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="03c13-207">**Figure 11**: Use the `Categories` DropDownList as the Source of the `categoryID` Parameter ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image33.png))</span></span>


<span data-ttu-id="03c13-208">ObjectDataSource ウィザードを完了すると、Visual Studio は追加 BoundFields、CheckBoxField の各製品のデータ フィールドのします。</span><span class="sxs-lookup"><span data-stu-id="03c13-208">Upon completing the ObjectDataSource wizard, Visual Studio will add BoundFields and a CheckBoxField for each of the product data fields.</span></span> <span data-ttu-id="03c13-209">自由に応じて表示と、これらのフィールドをカスタマイズしてください。</span><span class="sxs-lookup"><span data-stu-id="03c13-209">Feel free to customize these fields as you see fit.</span></span>

<span data-ttu-id="03c13-210">ブラウザーでページを参照してください。</span><span class="sxs-lookup"><span data-stu-id="03c13-210">Visit the page through a browser.</span></span> <span data-ttu-id="03c13-211">飲み物のカテゴリが選択されているページと対応する製品へのアクセスは、グリッドに表示されます。</span><span class="sxs-lookup"><span data-stu-id="03c13-211">When visiting the page the Beverages category is selected and the corresponding products listed in the grid.</span></span> <span data-ttu-id="03c13-212">図 12 として、代替のカテゴリにドロップダウン リストを変更するとを示しています、ポストバックを発生させるし、新しく選択したカテゴリの製品を持つグリッドが再度読み込まれます。</span><span class="sxs-lookup"><span data-stu-id="03c13-212">Changing the drop-down list to an alternative category, as Figure 12 shows, causes a postback and reloads the grid with the products of the newly selected category.</span></span>


<span data-ttu-id="03c13-213">[![生成カテゴリの製品が表示されます。](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image35.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="03c13-213">[![The Products in the Produce Category are Displayed](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image35.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image34.png)</span></span>

<span data-ttu-id="03c13-214">**図 12**: 生成カテゴリ、製品が表示されます ([フルサイズのイメージを表示するをクリックして](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="03c13-214">**Figure 12**: The Products in the Produce Category are Displayed ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image36.png))</span></span>


## <a name="step-5-wrapping-a-stored-procedure-s-statements-within-the-scope-of-a-transaction"></a><span data-ttu-id="03c13-215">手順 5: トランザクションのスコープ内のストアド プロシージャのステートメントのラッピング</span><span class="sxs-lookup"><span data-stu-id="03c13-215">Step 5: Wrapping a Stored Procedure s Statements Within the Scope of a Transaction</span></span>

<span data-ttu-id="03c13-216">[トランザクション内でデータベースの変更をラッピング](../working-with-batched-data/wrapping-database-modifications-within-a-transaction-vb.md)一連のトランザクションのスコープ内でのデータベース変更ステートメントを実行するための手法を説明したチュートリアルです。</span><span class="sxs-lookup"><span data-stu-id="03c13-216">In the [Wrapping Database Modifications within a Transaction](../working-with-batched-data/wrapping-database-modifications-within-a-transaction-vb.md) tutorial we discussed techniques for performing a series of database modification statements within the scope of a transaction.</span></span> <span data-ttu-id="03c13-217">すべて成功するか、トランザクションの包括的な実行の変更を取り消します。 または原子性を確保し、すべて失敗します。</span><span class="sxs-lookup"><span data-stu-id="03c13-217">Recall that the modifications performed under the umbrella of a transaction either all succeed or all fail, guaranteeing atomicity.</span></span> <span data-ttu-id="03c13-218">トランザクションを使用するための手法は次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="03c13-218">Techniques for using transactions include:</span></span>

- <span data-ttu-id="03c13-219">クラスを使用して、`System.Transactions`名前空間</span><span class="sxs-lookup"><span data-stu-id="03c13-219">Using the classes in the `System.Transactions` namespace,</span></span>
- <span data-ttu-id="03c13-220">同様に、ADO.NET クラスを使用して、データ アクセス レイヤーを持つ`SqlTransaction`、および</span><span class="sxs-lookup"><span data-stu-id="03c13-220">Having the Data Access Layer use ADO.NET classes like `SqlTransaction`, and</span></span>
- <span data-ttu-id="03c13-221">ストアド プロシージャ内で直接 T-SQL トランザクション コマンドを追加します。</span><span class="sxs-lookup"><span data-stu-id="03c13-221">Adding the T-SQL transaction commands directly within the stored procedure</span></span>

<span data-ttu-id="03c13-222">*トランザクション内でデータベースの変更をラッピング*チュートリアルは、DAL で ADO.NET クラスを使用します。</span><span class="sxs-lookup"><span data-stu-id="03c13-222">The *Wrapping Database Modifications within a Transaction* tutorial used the ADO.NET classes in the DAL.</span></span> <span data-ttu-id="03c13-223">このチュートリアルの残りの部分は、ストアド プロシージャ内から T-SQL コマンドを使用してトランザクションを管理する方法を説明します。</span><span class="sxs-lookup"><span data-stu-id="03c13-223">The remainder of this tutorial examines how to manage a transaction using T-SQL commands from within a stored procedure.</span></span>

<span data-ttu-id="03c13-224">手動で開始、コミット、およびトランザクションのロールバックの 3 つのキー SQL コマンドは、 `BEGIN TRANSACTION`、 `COMMIT TRANSACTION`、および`ROLLBACK TRANSACTION`、それぞれします。</span><span class="sxs-lookup"><span data-stu-id="03c13-224">The three key SQL commands for manually starting, committing, and rolling back a transaction are `BEGIN TRANSACTION`, `COMMIT TRANSACTION`, and `ROLLBACK TRANSACTION`, respectively.</span></span> <span data-ttu-id="03c13-225">などの方法では、ADO.NET、次のパターンを適用する必要があります、ストアド プロシージャ内からトランザクションを使用する場合。</span><span class="sxs-lookup"><span data-stu-id="03c13-225">Like with the ADO.NET approach, when using transactions from within a stored procedure we need to apply the following pattern:</span></span>

1. <span data-ttu-id="03c13-226">トランザクションの開始を示します。</span><span class="sxs-lookup"><span data-stu-id="03c13-226">Indicate the start of a transaction.</span></span>
2. <span data-ttu-id="03c13-227">トランザクションを構成する SQL ステートメントを実行します。</span><span class="sxs-lookup"><span data-stu-id="03c13-227">Execute the SQL statements that comprise the transaction.</span></span>
3. <span data-ttu-id="03c13-228">手順 2、ロールバック、トランザクションのステートメントのいずれかでエラーがある場合</span><span class="sxs-lookup"><span data-stu-id="03c13-228">If there is an error in any one of the statements from Step 2, rollback the transaction.</span></span>
4. <span data-ttu-id="03c13-229">エラーなしですべての手順 2 からステートメント完了、トランザクションをコミットします。</span><span class="sxs-lookup"><span data-stu-id="03c13-229">If all of the statements from Step 2 complete without error, commit the transaction.</span></span>

<span data-ttu-id="03c13-230">次のテンプレートを使用する T-SQL 構文では、このパターンを実装できます。</span><span class="sxs-lookup"><span data-stu-id="03c13-230">This pattern can be implemented in T-SQL syntax using the following template:</span></span>


[!code-sql[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample4.sql)]

<span data-ttu-id="03c13-231">テンプレートを定義することで開始、`TRY...CATCH`を初めて使用する SQL Server 2005 のコンストラクトをブロックします。</span><span class="sxs-lookup"><span data-stu-id="03c13-231">The template starts by defining a `TRY...CATCH` block, a construct new to SQL Server 2005.</span></span> <span data-ttu-id="03c13-232">使用するような`Try...Catch`Visual basic で SQL ブロック`TRY...CATCH`ブロック内のステートメントを実行する、`TRY`ブロックします。</span><span class="sxs-lookup"><span data-stu-id="03c13-232">Like with `Try...Catch` blocks in Visual Basic, the SQL `TRY...CATCH` block executes the statements in the `TRY` block.</span></span> <span data-ttu-id="03c13-233">コントロールに転送してすぐに任意のステートメントでは、エラーが発生した場合、`CATCH`ブロックします。</span><span class="sxs-lookup"><span data-stu-id="03c13-233">If any statement raises an error, control is immediately transferred to the `CATCH` block.</span></span>

<span data-ttu-id="03c13-234">その構成トランザクション、SQL ステートメントの実行エラーがない場合、`COMMIT TRANSACTION`ステートメントが、変更をコミットし、トランザクションを完了します。</span><span class="sxs-lookup"><span data-stu-id="03c13-234">If there are no errors executing the SQL statements that makeup the transaction, the `COMMIT TRANSACTION` statement commits the changes and completes the transaction.</span></span> <span data-ttu-id="03c13-235">、ただし、ステートメントのいずれかの結果になった場合、エラー、`ROLLBACK TRANSACTION`で、`CATCH`ブロックがトランザクションの開始前の状態にデータベースを返します。</span><span class="sxs-lookup"><span data-stu-id="03c13-235">If, however, one of the statements results in an error, the `ROLLBACK TRANSACTION` in the `CATCH` block returns the database to its state prior to the start of the transaction.</span></span> <span data-ttu-id="03c13-236">ストアド プロシージャでを使用して、エラーを発生させます、 [RAISERROR コマンド](https://msdn.microsoft.com/library/ms178592.aspx)、これにより、`SqlException`がアプリケーションで発生します。</span><span class="sxs-lookup"><span data-stu-id="03c13-236">The stored procedure also raises an error using the [RAISERROR command](https://msdn.microsoft.com/library/ms178592.aspx), which causes a `SqlException` to be raised in the application.</span></span>

> [!NOTE]
> <span data-ttu-id="03c13-237">以降、`TRY...CATCH`ブロックは初めて使用する SQL Server 2005、Microsoft SQL Server の以前のバージョンを使用している場合、このテンプレートは機能しません。</span><span class="sxs-lookup"><span data-stu-id="03c13-237">Since the `TRY...CATCH` block is new to SQL Server 2005, the above template will not work if you are using older versions of Microsoft SQL Server.</span></span> <span data-ttu-id="03c13-238">SQL Server 2005 を使用していない場合を参照してください[SQL Server ストアド プロシージャでのトランザクションの管理](http://www.4guysfromrolla.com/webtech/080305-1.shtml)for SQL Server の他のバージョンで動作するテンプレートです。</span><span class="sxs-lookup"><span data-stu-id="03c13-238">If you are not using SQL Server 2005, consult [Managing Transactions in SQL Server Stored Procedures](http://www.4guysfromrolla.com/webtech/080305-1.shtml) for a template that will work with other versions of SQL Server.</span></span>


<span data-ttu-id="03c13-239">具体的な例を見て s を使用できます。</span><span class="sxs-lookup"><span data-stu-id="03c13-239">Let s look at a concrete example.</span></span> <span data-ttu-id="03c13-240">間で外部キー制約が存在する、`Categories`と`Products`テーブル、つまり各`CategoryID`フィールドで、`Products`をテーブルにマップする必要があります、`CategoryID`値で、`Categories`テーブル。</span><span class="sxs-lookup"><span data-stu-id="03c13-240">A foreign key constraint exists between the `Categories` and `Products` tables, meaning that each `CategoryID` field in the `Products` table must map to a `CategoryID` value in the `Categories` table.</span></span> <span data-ttu-id="03c13-241">外部キー制約に違反など、製品に関連付けられているカテゴリを削除しようとしています。 この制約に違反するすべての操作の結果します。</span><span class="sxs-lookup"><span data-stu-id="03c13-241">Any action that would violate this constraint, such as attempting to delete a category that has associated products, results in a foreign key constraint violation.</span></span> <span data-ttu-id="03c13-242">これを確認するには、更新および既存のバイナリ データを削除する例では、「バイナリ データ操作を再表示 (`~/BinaryData/UpdatingAndDeleting.aspx`).</span><span class="sxs-lookup"><span data-stu-id="03c13-242">To verify this, revisit the Updating and Deleting Existing Binary Data example in the Working with Binary Data section (`~/BinaryData/UpdatingAndDeleting.aspx`).</span></span> <span data-ttu-id="03c13-243">このページは、編集および削除のボタンが (図 13 を参照してください)、と共にシステムに各カテゴリを一覧表示されますが、外部キー制約違反のため、削除に失敗 - 飲み物のなどの製品に関連付けられているカテゴリを削除しようとすると (図 14 を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="03c13-243">This page lists each category in the system along with Edit and Delete buttons (see Figure 13), but if you attempt to delete a category that has associated products - such as Beverages - the delete fails due to a foreign key constraint violation (see Figure 14).</span></span>


<span data-ttu-id="03c13-244">[![編集と削除ボタンを含む GridView に各カテゴリが表示されます。](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image38.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="03c13-244">[![Each Category is Displayed in a GridView with Edit and Delete Buttons](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image38.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image37.png)</span></span>

<span data-ttu-id="03c13-245">**図 13**: 編集と削除ボタンを含む GridView に各カテゴリが表示されます ([フルサイズのイメージを表示するをクリックして](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="03c13-245">**Figure 13**: Each Category is Displayed in a GridView with Edit and Delete Buttons ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image39.png))</span></span>


<span data-ttu-id="03c13-246">[![持つ既存の製品カテゴリを削除することはできません。](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image41.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="03c13-246">[![You Cannot Delete a Category that has Existing Products](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image41.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image40.png)</span></span>

<span data-ttu-id="03c13-247">**図 14**: を持つ既存の製品カテゴリを削除することはできません ([フルサイズのイメージを表示するをクリックして](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="03c13-247">**Figure 14**: You Cannot Delete a Category that has Existing Products ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image42.png))</span></span>


<span data-ttu-id="03c13-248">ただし、製品に関連付けられているかどうかに関係なく削除するカテゴリを許可するかを想像してください。</span><span class="sxs-lookup"><span data-stu-id="03c13-248">Imagine, though, that we want to allow categories to be deleted regardless of whether they have associated products.</span></span> <span data-ttu-id="03c13-249">製品のカテゴリを削除する必要も、既存の製品を削除することを想像してください (単にその製品を設定する別のオプションが`CategoryID`値を`NULL`)。</span><span class="sxs-lookup"><span data-stu-id="03c13-249">Should a category with products be deleted, imagine that we want to also delete its existing products (although another option would be to simply set its products `CategoryID` values to `NULL`).</span></span> <span data-ttu-id="03c13-250">この機能は、外部キー制約の連鎖規則によって実装できます。</span><span class="sxs-lookup"><span data-stu-id="03c13-250">This functionality could be implemented through the cascade rules of the foreign key constraint.</span></span> <span data-ttu-id="03c13-251">受け取るストアド プロシージャを作成代わりに、`@CategoryID`入力パラメーターと、呼び出されると、明示的にすべての関連する製品と削除し、指定されたカテゴリ。</span><span class="sxs-lookup"><span data-stu-id="03c13-251">Alternatively, we could create a stored procedure that accepts a `@CategoryID` input parameter and, when invoked, explicitly deletes all of the associated products and then the specified category.</span></span>

<span data-ttu-id="03c13-252">このようなストアド プロシージャでの最初の計画は、次のようになります。</span><span class="sxs-lookup"><span data-stu-id="03c13-252">Our first attempt at such a stored procedure might look like the following:</span></span>


[!code-sql[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample5.sql)]

<span data-ttu-id="03c13-253">関連する製品と分類を削除確実中に、行われないトランザクションの傘下にします。</span><span class="sxs-lookup"><span data-stu-id="03c13-253">While this will definitely delete the associated products and category, it does not do so under the umbrella of a transaction.</span></span> <span data-ttu-id="03c13-254">その他の外部キー制約があることを想像してください`Categories`、特定の削除を禁止`@CategoryID`値。</span><span class="sxs-lookup"><span data-stu-id="03c13-254">Imagine that there is some other foreign key constraint on `Categories` that would prohibit the deletion of a particular `@CategoryID` value.</span></span> <span data-ttu-id="03c13-255">この問題は、このようなケースですべての製品が削除されること、カテゴリを削除する前にです。</span><span class="sxs-lookup"><span data-stu-id="03c13-255">The problem is that in such a case all of the products will be deleted before we attempt to delete the category.</span></span> <span data-ttu-id="03c13-256">最終的な結果は、このようなカテゴリには、このストアド プロシージャは削除することの製品すべてさせながらも、カテゴリ別のテーブル内のレコードは関連がそれ以降のままです。</span><span class="sxs-lookup"><span data-stu-id="03c13-256">The net result is that for such a category, this stored procedure would remove all of its products while the category remained since it still has related records in some other table.</span></span>

<span data-ttu-id="03c13-257">場合は、ストアド プロシージャがラップされた、トランザクションのスコープ内でただし、削除を`Products`テーブルはロールバックされます失敗した削除が発生した場合`Categories`です。</span><span class="sxs-lookup"><span data-stu-id="03c13-257">If the stored procedure were wrapped within the scope of a transaction, however, the deletes to the `Products` table would be rolled back in the face of a failed delete on `Categories`.</span></span> <span data-ttu-id="03c13-258">次のストアド プロシージャのスクリプトを 2 つの間の原子性を保証するにはトランザクションを使用して`DELETE`ステートメント。</span><span class="sxs-lookup"><span data-stu-id="03c13-258">The following stored procedure script uses a transaction to assure atomicity between the two `DELETE` statements:</span></span>


[!code-sql[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample6.sql)]

<span data-ttu-id="03c13-259">追加する、`Categories_Delete`ストアド プロシージャを Northwind データベース。</span><span class="sxs-lookup"><span data-stu-id="03c13-259">Take a moment to add the `Categories_Delete` stored procedure to the Northwind database.</span></span> <span data-ttu-id="03c13-260">参照手順 1. のストアド プロシージャをデータベースに追加する手順についてはします。</span><span class="sxs-lookup"><span data-stu-id="03c13-260">Refer back to Step 1 for instructions on adding stored procedures to a database.</span></span>

## <a name="step-6-updating-thecategoriestableadapter"></a><span data-ttu-id="03c13-261">手順 6: 更新する、`CategoriesTableAdapter`</span><span class="sxs-lookup"><span data-stu-id="03c13-261">Step 6: Updating the`CategoriesTableAdapter`</span></span>

<span data-ttu-id="03c13-262">ここに追加しました、`Categories_Delete`をアドホック SQL ステートメントを使用して、削除を実行するには、DAL、データベースのストアド プロシージャが現在構成されています。</span><span class="sxs-lookup"><span data-stu-id="03c13-262">While we ve added the `Categories_Delete` stored procedure to the database, the DAL is currently configured to use ad-hoc SQL statements to perform the delete.</span></span> <span data-ttu-id="03c13-263">更新する必要があります、`CategoriesTableAdapter`を使用するように指定し、`Categories_Delete`ストアド プロシージャの代わりにします。</span><span class="sxs-lookup"><span data-stu-id="03c13-263">We need to update the `CategoriesTableAdapter` and instruct it to use the `Categories_Delete` stored procedure instead.</span></span>

> [!NOTE]
> <span data-ttu-id="03c13-264">このチュートリアルで前に作業していた、`NorthwindWithSprocs`データセット。</span><span class="sxs-lookup"><span data-stu-id="03c13-264">Earlier in this tutorial we were working with the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="03c13-265">データセットは 1 つのエンティティのみがある、その`ProductsDataTable`カテゴリを使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="03c13-265">But that DataSet only has a single entity, `ProductsDataTable`, and we need to work with categories.</span></span> <span data-ttu-id="03c13-266">そのため、データ アクセス レイヤー I m を参照する方法については、このチュートリアルの残りの部分、`Northwind`データセットを最初に作成した、[データ アクセス レイヤーを作成する](../introduction/creating-a-data-access-layer-vb.md)チュートリアルです。</span><span class="sxs-lookup"><span data-stu-id="03c13-266">Therefore, for the remainder of this tutorial when I talk about the Data Access Layer I m referring to the `Northwind` DataSet, the one that we first created in the [Creating a Data Access Layer](../introduction/creating-a-data-access-layer-vb.md) tutorial.</span></span>


<span data-ttu-id="03c13-267">開いている Northwind データセットの選択、 `CategoriesTableAdapter`、[プロパティ] ウィンドウに移動します。</span><span class="sxs-lookup"><span data-stu-id="03c13-267">Open the Northwind DataSet, select the `CategoriesTableAdapter`, and go to the Properties window.</span></span> <span data-ttu-id="03c13-268">プロパティ ウィンドウの一覧、 `InsertCommand`、 `UpdateCommand`、 `DeleteCommand`、および`SelectCommand`TableAdapter と、その名前と接続情報を使用します。</span><span class="sxs-lookup"><span data-stu-id="03c13-268">The Properties window lists the `InsertCommand`, `UpdateCommand`, `DeleteCommand`, and `SelectCommand` used by the TableAdapter, as well as its name and connection information.</span></span> <span data-ttu-id="03c13-269">展開して、`DeleteCommand`プロパティをその詳細を参照してください。</span><span class="sxs-lookup"><span data-stu-id="03c13-269">Expand the `DeleteCommand` property to see its details.</span></span> <span data-ttu-id="03c13-270">図 15 に示す、 `DeleteCommand` s`ComamndType`プロパティのテキストとして送信するよう指示のテキストに設定されて、`CommandText`アドホック SQL クエリとしてプロパティです。</span><span class="sxs-lookup"><span data-stu-id="03c13-270">As Figure 15 shows, the `DeleteCommand` s `ComamndType` property is set to Text, which instructs it to send the text in the `CommandText` property as an ad-hoc SQL query.</span></span>


![[プロパティ] ウィンドウでプロパティを表示するデザイナーで、CategoriesTableAdapter を選択します。](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image43.png)

<span data-ttu-id="03c13-272">**図 15**: 選択、`CategoriesTableAdapter`デザイナーで、[プロパティ] ウィンドウでそのプロパティを表示</span><span class="sxs-lookup"><span data-stu-id="03c13-272">**Figure 15**: Select the `CategoriesTableAdapter` in the Designer to View Its Properties in the Properties Window</span></span>


<span data-ttu-id="03c13-273">これらの設定を変更するには、プロパティ ウィンドウで (DeleteCommand) テキストを選択し、(新規) をドロップダウン リストから選択します。</span><span class="sxs-lookup"><span data-stu-id="03c13-273">To change these settings, select the (DeleteCommand) text in the Properties window and choose (New) from the drop-down list.</span></span> <span data-ttu-id="03c13-274">設定をクリアします、 `CommandText`、 `CommandType`、および`Parameters`プロパティです。</span><span class="sxs-lookup"><span data-stu-id="03c13-274">This will clear out the settings for the `CommandText`, `CommandType`, and `Parameters` properties.</span></span> <span data-ttu-id="03c13-275">次に、設定、`CommandType`プロパティを`StoredProcedure`、ストアド プロシージャの名前を入力し、 `CommandText` (`dbo.Categories_Delete`)。</span><span class="sxs-lookup"><span data-stu-id="03c13-275">Next, set the `CommandType` property to `StoredProcedure` and then type in the name of the stored procedure for the `CommandText` (`dbo.Categories_Delete`).</span></span> <span data-ttu-id="03c13-276">プロパティを入力します - この順序で最初に確認する場合、`CommandType`し、 `CommandText` -Visual Studio はパラメーター コレクションを自動的に設定します。</span><span class="sxs-lookup"><span data-stu-id="03c13-276">If you make sure to enter the properties in this order - first the `CommandType` and then the `CommandText` - Visual Studio will automatically populate the Parameters collection.</span></span> <span data-ttu-id="03c13-277">この順序でこれらのプロパティを入力しないと場合、は、パラメーター コレクション エディターを使ってパラメーターを手動で追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="03c13-277">If you do not enter these properties in this order, you will have to manually add the parameters through the Parameters Collection Editor.</span></span> <span data-ttu-id="03c13-278">どちらの場合に、パラメーター コレクション エディター を表示 (図 16 を参照してください) 適切なパラメーター設定の変更が行われたことを確認するには、パラメーター プロパティで省略記号をクリックするが賢明です。</span><span class="sxs-lookup"><span data-stu-id="03c13-278">In either case, it s prudent to click on the ellipses in the Parameters property to bring up the Parameters Collection Editor to verify that the correct parameter settings changes have been made (see Figure 16).</span></span> <span data-ttu-id="03c13-279">任意のパラメーター ダイアログ ボックスが表示されない場合は、追加、`@CategoryID`パラメーター手動で (を追加する必要はありません、`@RETURN_VALUE`パラメーター)。</span><span class="sxs-lookup"><span data-stu-id="03c13-279">If you do not see any parameters in the dialog box, add the `@CategoryID` parameter manually (you do not need to add the `@RETURN_VALUE` parameter).</span></span>


![パラメーターの設定が適切であることを確認してください。](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image44.png)

<span data-ttu-id="03c13-281">**図 16**: パラメーター設定が正しいことを確認</span><span class="sxs-lookup"><span data-stu-id="03c13-281">**Figure 16**: Ensure That the Parameters Settings are Correct</span></span>


<span data-ttu-id="03c13-282">DAL が更新されると、カテゴリを削除するは自動的に関連付けられた製品をすべて削除し、包括的なトランザクションの下にあるようにします。</span><span class="sxs-lookup"><span data-stu-id="03c13-282">Once the DAL has been updated, deleting a category will automatically delete all of its associated products and do so under the umbrella of a transaction.</span></span> <span data-ttu-id="03c13-283">これを確認するには、更新と既存のバイナリ データを削除するページに戻るし、カテゴリの 1 つの削除 をクリックします。</span><span class="sxs-lookup"><span data-stu-id="03c13-283">To verify this, return to the Updating and Deleting Existing Binary Data page and click the Delete button for one of the categories.</span></span> <span data-ttu-id="03c13-284">マウスの 1 つ 1 回のクリックで、カテゴリとの関連付けられている製品すべて削除されます。</span><span class="sxs-lookup"><span data-stu-id="03c13-284">With one single click of the mouse, the category and all of its associated products will be deleted.</span></span>

> [!NOTE]
> <span data-ttu-id="03c13-285">テストする前に、`Categories_Delete`ストアド プロシージャは、選択したカテゴリと製品の数が削除されますがあります、データベースのバックアップ コピーを作成します。</span><span class="sxs-lookup"><span data-stu-id="03c13-285">Before testing the `Categories_Delete` stored procedure, which will delete a number of products along with the selected category, it might be prudent to make a backup copy of your database.</span></span> <span data-ttu-id="03c13-286">使用している場合、`NORTHWND.MDF`データベース`App_Data`、単に Visual Studio を終了およびに MDF と LDF ファイルをコピー`App_Data`の他のフォルダーにします。</span><span class="sxs-lookup"><span data-stu-id="03c13-286">If you are using the `NORTHWND.MDF` database in `App_Data`, simply close Visual Studio and copy the MDF and LDF files in `App_Data` to some other folder.</span></span> <span data-ttu-id="03c13-287">機能をテストした後は、Visual Studio を終了して、データベースを戻すことができ、置き換える現在 MDF と LDF ファイル`App_Data`バックアップのコピーにします。</span><span class="sxs-lookup"><span data-stu-id="03c13-287">After testing the functionality, you can restore the database by closing Visual Studio and replacing the current MDF and LDF files in `App_Data` with the backup copies.</span></span>


## <a name="summary"></a><span data-ttu-id="03c13-288">まとめ</span><span class="sxs-lookup"><span data-stu-id="03c13-288">Summary</span></span>

<span data-ttu-id="03c13-289">TableAdapter の s ウィザードでは、ご利用の米国のストアド プロシージャを自動的に生成されますもおが既にこのようなストアド プロシージャを作成したりに手動でまたはその他のツールを使用して代わりに作成します。</span><span class="sxs-lookup"><span data-stu-id="03c13-289">While the TableAdapter s wizard will automatically generate stored procedures for us, there are times when we might already have such stored procedures created or want to create them manually or with other tools instead.</span></span> <span data-ttu-id="03c13-290">このようなシナリオに合わせてに、既存のストアド プロシージャを指す、TableAdapter を構成することもできます。</span><span class="sxs-lookup"><span data-stu-id="03c13-290">To accommodate such scenarios, the TableAdapter can also be configured to point to an existing stored procedure.</span></span> <span data-ttu-id="03c13-291">このチュートリアルでは、これらのストアド プロシージャを TableAdapter のメソッドを接続するための方法と、Visual Studio 環境を使用してデータベースにストアド プロシージャを手動で追加する方法を説明しました。</span><span class="sxs-lookup"><span data-stu-id="03c13-291">In this tutorial we looked at how to manually add stored procedures to a database through the Visual Studio environment and how to wire the TableAdapter s methods to these stored procedures.</span></span> <span data-ttu-id="03c13-292">おは、T-SQL コマンドおよびスクリプトのパターンの開始、コミット、およびストアド プロシージャ内からトランザクションをロールバックするためにも検討します。</span><span class="sxs-lookup"><span data-stu-id="03c13-292">We also examined the T-SQL commands and script pattern used for starting, committing, and rolling back transactions from within a stored procedure.</span></span>

<span data-ttu-id="03c13-293">満足プログラミング!</span><span class="sxs-lookup"><span data-stu-id="03c13-293">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="03c13-294">作成者について</span><span class="sxs-lookup"><span data-stu-id="03c13-294">About the Author</span></span>

<span data-ttu-id="03c13-295">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)、7 つ受け取りますブックとの創設者の作成者[4GuysFromRolla.com](http://www.4guysfromrolla.com)、1998 年からマイクロソフトの Web テクノロジで取り組んできました。</span><span class="sxs-lookup"><span data-stu-id="03c13-295">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="03c13-296">Scott は、コンサルタント、トレーナー、ライターとして機能します。</span><span class="sxs-lookup"><span data-stu-id="03c13-296">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="03c13-297">最新の著書[ *Sam 学べる自分で ASP.NET 2.0 が 24 時間以内に*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)です。</span><span class="sxs-lookup"><span data-stu-id="03c13-297">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="03c13-298">彼に到達できる[ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)彼のブログを使用して含まれているのか[http://ScottOnWriting.NET](http://ScottOnWriting.NET)です。</span><span class="sxs-lookup"><span data-stu-id="03c13-298">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="03c13-299">感謝の特別な</span><span class="sxs-lookup"><span data-stu-id="03c13-299">Special Thanks To</span></span>

<span data-ttu-id="03c13-300">このチュートリアルの系列は既に多くの便利なレビュー担当者によって確認済みです。</span><span class="sxs-lookup"><span data-stu-id="03c13-300">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="03c13-301">このチュートリアルの潜在顧客レビュー担当者には、Hilton Geisenow、S ren 一 Lauritsen Teresa マーフィーがされていました。</span><span class="sxs-lookup"><span data-stu-id="03c13-301">Lead reviewers for this tutorial were Hilton Geisenow, S ren Jacob Lauritsen, and Teresa Murphy.</span></span> <span data-ttu-id="03c13-302">今後、MSDN の記事を確認することに関心のあるですか。</span><span class="sxs-lookup"><span data-stu-id="03c13-302">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="03c13-303">場合は、ドロップ me 一度に 1 行ずつ[mitchell@4GuysFromRolla.comです。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="03c13-303">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="03c13-304">[前へ](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)
[次へ](updating-the-tableadapter-to-use-joins-vb.md)</span><span class="sxs-lookup"><span data-stu-id="03c13-304">[Previous](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)
[Next](updating-the-tableadapter-to-use-joins-vb.md)</span></span>
