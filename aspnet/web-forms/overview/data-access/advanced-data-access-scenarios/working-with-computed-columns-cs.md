---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/working-with-computed-columns-cs
title: 計算列 (c#) の使用 |Microsoft ドキュメント
author: rick-anderson
description: Microsoft SQL Server が、式からその値を計算する計算列を定義することができます、データベース テーブルを作成するときに通常、referen しています.
ms.author: aspnetcontent
manager: wpickett
ms.date: 08/03/2007
ms.topic: article
ms.assetid: 57459065-ed7c-4dfe-ac9c-54c093abc261
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/working-with-computed-columns-cs
msc.type: authoredcontent
ms.openlocfilehash: 7a67abd2a0c140c0503c07f764549a6d90ef7298
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/06/2018
---
<a name="working-with-computed-columns-c"></a><span data-ttu-id="c77eb-103">計算列 (c#) の使用</span><span class="sxs-lookup"><span data-stu-id="c77eb-103">Working with Computed Columns (C#)</span></span>
====================
<span data-ttu-id="c77eb-104">によって[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="c77eb-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="c77eb-105">[コードをダウンロードする](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_71_CS.zip)または[PDF のダウンロード](working-with-computed-columns-cs/_static/datatutorial71cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="c77eb-105">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_71_CS.zip) or [Download PDF](working-with-computed-columns-cs/_static/datatutorial71cs1.pdf)</span></span>

> <span data-ttu-id="c77eb-106">データベース テーブルを作成するときに Microsoft SQL Server では、通常は同じデータベース レコードの他の値を参照する式からその値を計算する計算列を定義することができます。</span><span class="sxs-lookup"><span data-stu-id="c77eb-106">When creating a database table, Microsoft SQL Server allows you to define a computed column whose value is calculated from an expression that usually references other values in the same database record.</span></span> <span data-ttu-id="c77eb-107">そのような値は、Tableadapter を使用する場合は、特別な考慮事項を必要とすると、データベースに読み取り専用です。</span><span class="sxs-lookup"><span data-stu-id="c77eb-107">Such values are read-only at the database, which requires special considerations when working with TableAdapters.</span></span> <span data-ttu-id="c77eb-108">このチュートリアルでは、計算列によって引き起こされる問題に対応する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="c77eb-108">In this tutorial we learn how to meet the challenges posed by computed columns.</span></span>


## <a name="introduction"></a><span data-ttu-id="c77eb-109">はじめに</span><span class="sxs-lookup"><span data-stu-id="c77eb-109">Introduction</span></span>

<span data-ttu-id="c77eb-110">Microsoft SQL Server では、 *[計算列](https://msdn.microsoft.com/library/ms191250.aspx)*、これらは列の値は、通常、同じテーブル内の他の列から値を参照する式から計算されます。</span><span class="sxs-lookup"><span data-stu-id="c77eb-110">Microsoft SQL Server allows for *[computed columns](https://msdn.microsoft.com/library/ms191250.aspx)*, which are columns whose values are calculated from an expression that usually references the values from other columns in the same table.</span></span> <span data-ttu-id="c77eb-111">例として、追跡データ モデルにテーブルがあるという`ServiceLog`を含む列を含む`ServicePerformed`、 `EmployeeID`、 `Rate`、および`Duration`、他のユーザー間でします。</span><span class="sxs-lookup"><span data-stu-id="c77eb-111">As an example, a time tracking data model might have a table named `ServiceLog` with columns including `ServicePerformed`, `EmployeeID`, `Rate`, and `Duration`, among others.</span></span> <span data-ttu-id="c77eb-112">額を中にサービスごとの項目 (される期間を掛けたレート) でしたが計算されます web ページまたはその他のプログラム インターフェイス経由で列を含めるように便利な場合があります、`ServiceLog`という名前のテーブル`AmountDue`を報告この情報です。</span><span class="sxs-lookup"><span data-stu-id="c77eb-112">While the amount due per service item (being the rate multiplied by the duration) could be calculated through a web page or other programmatic interface, it might be handy to include a column in the `ServiceLog` table named `AmountDue` that reported this information.</span></span> <span data-ttu-id="c77eb-113">この列は、通常の列として作成できませんでしたが、いつでも更新する必要があります、`Rate`または`Duration`列値を変更します。</span><span class="sxs-lookup"><span data-stu-id="c77eb-113">This column could be created as a normal column, but it would need to be updated anytime the `Rate` or `Duration` column values changed.</span></span> <span data-ttu-id="c77eb-114">させることにより、`AmountDue`列、式を使用して計算列`Rate * Duration`です。</span><span class="sxs-lookup"><span data-stu-id="c77eb-114">A better approach would be to make the `AmountDue` column a computed column using the expression `Rate * Duration`.</span></span> <span data-ttu-id="c77eb-115">これには SQL Server が自動的に計算が発生、`AmountDue`クエリで参照されていたときに、列の値。</span><span class="sxs-lookup"><span data-stu-id="c77eb-115">Doing so would cause SQL Server to automatically calculate the `AmountDue` column value whenever it was referenced in a query.</span></span>

<span data-ttu-id="c77eb-116">計算列の値は、式によって決まりますがため、このような列読み取り専用あり、したがってできない値に割り当てたでそれら`INSERT`または`UPDATE`ステートメントです。</span><span class="sxs-lookup"><span data-stu-id="c77eb-116">Since a computed column s value is determined by an expression, such columns are read-only and therefore cannot have values assigned to them in `INSERT` or `UPDATE` statements.</span></span> <span data-ttu-id="c77eb-117">ただし、計算列が、アドホック SQL ステートメントを使用する TableAdapter のメイン クエリの一部である場合は、それらが自動的に追加で自動生成された`INSERT`と`UPDATE`ステートメントです。</span><span class="sxs-lookup"><span data-stu-id="c77eb-117">However, when computed columns are part of the main query for a TableAdapter that uses ad-hoc SQL statements, they are automatically included in the auto-generated `INSERT` and `UPDATE` statements.</span></span> <span data-ttu-id="c77eb-118">Tableadapter ではその結果、`INSERT`と`UPDATE`クエリと`InsertCommand`と`UpdateCommand`計算列への参照を削除するプロパティを更新する必要があります。</span><span class="sxs-lookup"><span data-stu-id="c77eb-118">Consequently, the TableAdapter s `INSERT` and `UPDATE` queries and `InsertCommand` and `UpdateCommand` properties must be updated to remove references to any computed columns.</span></span>

<span data-ttu-id="c77eb-119">使用する 1 つの課題は、アドホック SQL ステートメントを使用して、TableAdapter を持つ列を計算する、tableadapter は、`INSERT`と`UPDATE`クエリには、いつでも、TableAdapter 構成ウィザードが完了したが自動的に再生成します。</span><span class="sxs-lookup"><span data-stu-id="c77eb-119">One challenge of using computed columns with a TableAdapter that uses ad-hoc SQL statements is that the TableAdapter s `INSERT` and `UPDATE` queries are automatically regenerated any time the TableAdapter Configuration wizard is completed.</span></span> <span data-ttu-id="c77eb-120">そのため、計算列から手動で削除、`INSERT`と`UPDATE`場合、ウィザードを再実行クエリが再表示します。</span><span class="sxs-lookup"><span data-stu-id="c77eb-120">Therefore, the computed columns manually removed from the `INSERT` and `UPDATE` queries will reappear if the wizard is re-run.</span></span> <span data-ttu-id="c77eb-121">ストアド プロシージャを使用する Tableadapter のないこの脆弱性が、手順 3. で対処する独自の quirks です。</span><span class="sxs-lookup"><span data-stu-id="c77eb-121">Although TableAdapters that use stored procedures don t suffer from this brittleness, they do have their own quirks that we will address in Step 3.</span></span>

<span data-ttu-id="c77eb-122">このチュートリアルでは、計算列に、追加、 `Suppliers` Northwind データベースのテーブルが表示され、このテーブルとその計算列を操作する対応する TableAdapter を作成します。</span><span class="sxs-lookup"><span data-stu-id="c77eb-122">In this tutorial we will add a computed column to the `Suppliers` table in the Northwind database and then create a corresponding TableAdapter to work with this table and its computed column.</span></span> <span data-ttu-id="c77eb-123">アドホック SQL ステートメントではなくストアド プロシージャを使用して、TableAdapter 構成ウィザードを使用すると、カスタマイズは t が失われるように、TableAdapter があります。</span><span class="sxs-lookup"><span data-stu-id="c77eb-123">We will have our TableAdapter use stored procedures instead of ad-hoc SQL statements so that our customizations aren t lost when the TableAdapter Configuration wizard is used.</span></span>

<span data-ttu-id="c77eb-124">開始 s を let!</span><span class="sxs-lookup"><span data-stu-id="c77eb-124">Let s get started!</span></span>

## <a name="step-1-adding-a-computed-column-to-thesupplierstable"></a><span data-ttu-id="c77eb-125">手順 1: する計算列の追加、`Suppliers`テーブル</span><span class="sxs-lookup"><span data-stu-id="c77eb-125">Step 1: Adding a Computed Column to the`Suppliers`Table</span></span>

<span data-ttu-id="c77eb-126">Northwind データベースには計算列はないのでおは社内で 1 つを追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="c77eb-126">The Northwind database does not have any computed columns so we will need to add one ourselves.</span></span> <span data-ttu-id="c77eb-127">このチュートリアルは、計算列を追加 s を使用できます。 の、`Suppliers`という名前のテーブル`FullContactName`次の形式で連絡先の名前、タイトル、および会社の作業を返す: `ContactName` (`ContactTitle`、 `CompanyName`)。</span><span class="sxs-lookup"><span data-stu-id="c77eb-127">For this tutorial let s add a computed column to the `Suppliers` table called `FullContactName` that returns the contact s name, title, and the company they work for in the following format: `ContactName` (`ContactTitle`, `CompanyName`).</span></span> <span data-ttu-id="c77eb-128">これは、計算列は仕入先に関する情報を表示するときに、レポートで使用する場合があります。</span><span class="sxs-lookup"><span data-stu-id="c77eb-128">This computed column might be used in reports when displaying information about suppliers.</span></span>

<span data-ttu-id="c77eb-129">開いて開始、`Suppliers`テーブル定義を右クリックして、`Suppliers`サーバー エクスプ ローラーでテーブルし、テーブル定義を開くのコンテキスト メニューから選択します。</span><span class="sxs-lookup"><span data-stu-id="c77eb-129">Start by opening the `Suppliers` table definition by right-clicking on the `Suppliers` table in the Server Explorer and choosing Open Table Definition from the context-menu.</span></span> <span data-ttu-id="c77eb-130">これが可能にするかどうかの列、テーブルと、そのデータ型などのプロパティが表示されます`NULL`s などです。</span><span class="sxs-lookup"><span data-stu-id="c77eb-130">This will display the columns of the table and their properties, such as their data type, whether they allow `NULL` s, and so forth.</span></span> <span data-ttu-id="c77eb-131">計算列を追加するには、テーブルの定義に列の名前を入力して起動します。</span><span class="sxs-lookup"><span data-stu-id="c77eb-131">To add a computed column, start by typing in the name of the column into the table definition.</span></span> <span data-ttu-id="c77eb-132">次に、その式テキスト ボックスに入力 (数式) 列のプロパティ] ウィンドウの [計算列の指定」セクションの下 (図 1 を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="c77eb-132">Next, enter its expression into the (Formula) textbox under the Computed Column Specification section in the Column Properties window (see Figure 1).</span></span> <span data-ttu-id="c77eb-133">計算列の名前を付けます`FullContactName`し、次の式を使用します。</span><span class="sxs-lookup"><span data-stu-id="c77eb-133">Name the computed column `FullContactName` and use the following expression:</span></span>


[!code-sql[Main](working-with-computed-columns-cs/samples/sample1.sql)]

<span data-ttu-id="c77eb-134">SQL の文字列を連結できることに注意してください。 を使用して、`+`演算子。</span><span class="sxs-lookup"><span data-stu-id="c77eb-134">Note that strings can be concatenated in SQL using the `+` operator.</span></span> <span data-ttu-id="c77eb-135">`CASE`ステートメントは、従来のプログラミング言語で条件付きのように使用することができます。</span><span class="sxs-lookup"><span data-stu-id="c77eb-135">The `CASE` statement can be used like a conditional in a traditional programming language.</span></span> <span data-ttu-id="c77eb-136">上記の式で、`CASE`としてステートメントを読み取ることができます: 場合`ContactTitle`は`NULL`し、出力、`ContactTitle`コンマ、それ以外の場合と連結された値を出力何も行われません。</span><span class="sxs-lookup"><span data-stu-id="c77eb-136">In the above expression the `CASE` statement can be read as: If `ContactTitle` is not `NULL` then output the `ContactTitle` value concatenated with a comma, otherwise emit nothing.</span></span> <span data-ttu-id="c77eb-137">詳細の有用性について、`CASE`ステートメントを参照してください[SQL の電源`CASE`ステートメント](http://www.4guysfromrolla.com/webtech/102704-1.shtml)です。</span><span class="sxs-lookup"><span data-stu-id="c77eb-137">For more on the usefulness of the `CASE` statement, see [The Power of SQL `CASE` Statements](http://www.4guysfromrolla.com/webtech/102704-1.shtml).</span></span>

> [!NOTE]
> <span data-ttu-id="c77eb-138">使用する代わりに、`CASE`ステートメントは、ここではまたは使用することも`ISNULL(ContactTitle, '')`します。</span><span class="sxs-lookup"><span data-stu-id="c77eb-138">Instead of using a `CASE` statement here, we could have alternatively used `ISNULL(ContactTitle, '')`.</span></span> <span data-ttu-id="c77eb-139">[`ISNULL(checkExpression, replacementValue)`](https://msdn.microsoft.com/library/ms184325.aspx) 返します*checkExpression* NULL 以外の場合、それ以外の場合を返します*replacementValue*です。</span><span class="sxs-lookup"><span data-stu-id="c77eb-139">[`ISNULL(checkExpression, replacementValue)`](https://msdn.microsoft.com/library/ms184325.aspx) returns *checkExpression* if it is non-NULL, otherwise it returns *replacementValue*.</span></span> <span data-ttu-id="c77eb-140">どちらか一方`ISNULL`または`CASE`は機能、このインスタンスより複雑なシナリオは場所の柔軟性、`CASE`でステートメントを照合することはできません`ISNULL`です。</span><span class="sxs-lookup"><span data-stu-id="c77eb-140">While either `ISNULL` or `CASE` will work in this instance, there are more intricate scenarios where the flexibility of the `CASE` statement cannot be matched by `ISNULL`.</span></span>


<span data-ttu-id="c77eb-141">この計算列を追加した後、画面が図 1 でスクリーン ショットのようになります。</span><span class="sxs-lookup"><span data-stu-id="c77eb-141">After adding this computed column your screen should look like the screen shot in Figure 1.</span></span>


<span data-ttu-id="c77eb-142">[![Suppliers テーブルを FullContactName を名前付き計算列を追加します。](working-with-computed-columns-cs/_static/image2.png)](working-with-computed-columns-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="c77eb-142">[![Add a Computed Column Named FullContactName to the Suppliers Table](working-with-computed-columns-cs/_static/image2.png)](working-with-computed-columns-cs/_static/image1.png)</span></span>

<span data-ttu-id="c77eb-143">**図 1**: 追加、計算列の名前は`FullContactName`を`Suppliers`テーブル ([フルサイズのイメージを表示するをクリックして](working-with-computed-columns-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="c77eb-143">**Figure 1**: Add a Computed Column Named `FullContactName` to the `Suppliers` Table ([Click to view full-size image](working-with-computed-columns-cs/_static/image3.png))</span></span>


<span data-ttu-id="c77eb-144">計算列の名前を付け、その式を入力して後の変更を保存の表に、ツールバーの 保存 アイコンをクリックして、Ctrl + S をクリックして、またはファイル メニューの 保存 を選択して`Suppliers`です。</span><span class="sxs-lookup"><span data-stu-id="c77eb-144">After naming the computed column and entering its expression, save the changes to the table by clicking the Save icon in the toolbar, by hitting Ctrl+S, or by going to the File menu and choosing Save `Suppliers`.</span></span>

<span data-ttu-id="c77eb-145">テーブルを保存する必要があります、サーバー エクスプ ローラーを更新で単に追加された列を含む、`Suppliers`テーブル列の一覧です。</span><span class="sxs-lookup"><span data-stu-id="c77eb-145">Saving the table should refresh the Server Explorer, including the just-added column in the `Suppliers` table s column list.</span></span> <span data-ttu-id="c77eb-146">(数式) ボックスに入力された式は不要な空白文字を削除、列名を角かっこで囲まれている同等の式を自動的に調整されてさらに、(`[]`) より明示的に表示するかっこが含まれています操作の順序:</span><span class="sxs-lookup"><span data-stu-id="c77eb-146">Furthermore, the expression entered into the (Formula) textbox will automatically adjust to an equivalent expression that strips unnecessary whitespace, surrounds column names with brackets (`[]`), and includes parentheses to more explicitly show the order of operations:</span></span>


[!code-sql[Main](working-with-computed-columns-cs/samples/sample2.sql)]

<span data-ttu-id="c77eb-147">Microsoft SQL Server の計算列の詳細についてを参照してください、[のテクニカル ドキュメント](https://msdn.microsoft.com/library/ms191250.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="c77eb-147">For more information on computed columns in Microsoft SQL Server, refer to the [technical documentation](https://msdn.microsoft.com/library/ms191250.aspx).</span></span> <span data-ttu-id="c77eb-148">チェック アウト、[する方法: 計算列の指定](https://msdn.microsoft.com/library/ms188300.aspx)計算列の作成のステップ バイ ステップ チュートリアルについてはします。</span><span class="sxs-lookup"><span data-stu-id="c77eb-148">Also check out the [How to: Specify Computed Columns](https://msdn.microsoft.com/library/ms188300.aspx) for a step-by-step walkthrough of creating computed columns.</span></span>

> [!NOTE]
> <span data-ttu-id="c77eb-149">既定では、計算列は、テーブルに物理的に格納されていないが、クエリで参照されるたびに再計算は、代わりにします。</span><span class="sxs-lookup"><span data-stu-id="c77eb-149">By default, computed columns are not physically stored in the table but are instead recalculated each time they are referenced in a query.</span></span> <span data-ttu-id="c77eb-150">ただし、チェック ボックスをオンが永続化されるには、計算列をテーブルに物理的に格納する SQL Server を指示することができます。</span><span class="sxs-lookup"><span data-stu-id="c77eb-150">By checking the Is Persisted checkbox, however, you can instruct SQL Server to physically store the computed column in the table.</span></span> <span data-ttu-id="c77eb-151">これにより、インデックスを作成する、計算列、計算列の値を使用するクエリのパフォーマンスを向上させることができます、`WHERE`句。</span><span class="sxs-lookup"><span data-stu-id="c77eb-151">Doing so allows an index to be created on the computed column, which can improve the performance of queries that use the computed column value in their `WHERE` clauses.</span></span> <span data-ttu-id="c77eb-152">参照してください[計算列のインデックスを作成する](https://msdn.microsoft.com/library/ms189292.aspx)詳細についてはします。</span><span class="sxs-lookup"><span data-stu-id="c77eb-152">See [Creating Indexes on Computed Columns](https://msdn.microsoft.com/library/ms189292.aspx) for more information.</span></span>


## <a name="step-2-viewing-the-computed-column-s-values"></a><span data-ttu-id="c77eb-153">手順 2: 計算列の値の表示</span><span class="sxs-lookup"><span data-stu-id="c77eb-153">Step 2: Viewing the Computed Column s Values</span></span>

<span data-ttu-id="c77eb-154">データ アクセス層の作業を始める前に let s、時間がかかるを表示する、`FullContactName`値。</span><span class="sxs-lookup"><span data-stu-id="c77eb-154">Before we start work on the Data Access Layer, let s take a minute to view the `FullContactName` values.</span></span> <span data-ttu-id="c77eb-155">サーバー エクスプ ローラーを右クリックし、`Suppliers`テーブル名と、コンテキスト メニューから新しいクエリを選択します。</span><span class="sxs-lookup"><span data-stu-id="c77eb-155">From the Server Explorer, right-click on the `Suppliers` table name and choose New Query from the context-menu.</span></span> <span data-ttu-id="c77eb-156">これは、どのようなクエリに含めるテーブルを選択するように入力が求められるクエリ ウィンドウが表示されます。</span><span class="sxs-lookup"><span data-stu-id="c77eb-156">This will bring up a Query window that prompts us to choose what tables to include in the query.</span></span> <span data-ttu-id="c77eb-157">追加、`Suppliers`テーブルし、[閉じる] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="c77eb-157">Add the `Suppliers` table and click Close.</span></span> <span data-ttu-id="c77eb-158">次に、確認、 `CompanyName`、 `ContactName`、 `ContactTitle`、および`FullContactName`Suppliers テーブルから列です。</span><span class="sxs-lookup"><span data-stu-id="c77eb-158">Next, check the `CompanyName`, `ContactName`, `ContactTitle`, and `FullContactName` columns from the Suppliers table.</span></span> <span data-ttu-id="c77eb-159">最後に、クエリを実行し、結果を表示するには、ツールバーの赤い感嘆符アイコンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="c77eb-159">Finally, click the red exclamation point icon in the Toolbar to execute the query and view the results.</span></span>

<span data-ttu-id="c77eb-160">図 2 に示す結果に含める`FullContactName`、リスト、 `CompanyName`、 `ContactName`、および`ContactTitle`形式 ldquo; を使用して列`ContactName`(`ContactTitle`, `CompanyName`) .</span><span class="sxs-lookup"><span data-stu-id="c77eb-160">As Figure 2 shows, the results include `FullContactName`, which lists the `CompanyName`, `ContactName`, and `ContactTitle` columns using the format ldquo;`ContactName` (`ContactTitle`, `CompanyName`) .</span></span>


<span data-ttu-id="c77eb-161">[![FullContactName 形式 ContactName (部署、CompanyName) を使用します。](working-with-computed-columns-cs/_static/image5.png)](working-with-computed-columns-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="c77eb-161">[![The FullContactName Uses the Format ContactName (ContactTitle, CompanyName)](working-with-computed-columns-cs/_static/image5.png)](working-with-computed-columns-cs/_static/image4.png)</span></span>

<span data-ttu-id="c77eb-162">**図 2**:`FullContactName`形式を使用して`ContactName`(`ContactTitle`、 `CompanyName`) ([フルサイズのイメージを表示するをクリックして](working-with-computed-columns-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="c77eb-162">**Figure 2**: The `FullContactName` Uses the Format `ContactName` (`ContactTitle`, `CompanyName`) ([Click to view full-size image](working-with-computed-columns-cs/_static/image6.png))</span></span>


## <a name="step-3-adding-thesupplierstableadapterto-the-data-access-layer"></a><span data-ttu-id="c77eb-163">手順 3: 追加、`SuppliersTableAdapter`には、データ アクセス レイヤー</span><span class="sxs-lookup"><span data-stu-id="c77eb-163">Step 3: Adding the`SuppliersTableAdapter`to the Data Access Layer</span></span>

<span data-ttu-id="c77eb-164">アプリケーションでは、仕入先情報を使用するのには、最初に、DAL に TableAdapter と DataTable を作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="c77eb-164">In order to work with the supplier information in our application we need to first create a TableAdapter and DataTable in our DAL.</span></span> <span data-ttu-id="c77eb-165">理想的には、これは、行われる前のチュートリアルで確認簡単な手順と同じです。</span><span class="sxs-lookup"><span data-stu-id="c77eb-165">Ideally, this would be accomplished using the same straightforward steps examined in earlier tutorials.</span></span> <span data-ttu-id="c77eb-166">ただし、計算列の使用には、ディスカッションを示す、いくつかのしわが導入されています。</span><span class="sxs-lookup"><span data-stu-id="c77eb-166">However, working with computed columns introduces a few wrinkles that merit discussion.</span></span>

<span data-ttu-id="c77eb-167">アドホック SQL ステートメントを使用して、TableAdapter を使用している場合、TableAdapter のメインのクエリに TableAdapter 構成ウィザードを使用して、計算列を単純に含めることができます。</span><span class="sxs-lookup"><span data-stu-id="c77eb-167">If you are using a TableAdapter that uses ad-hoc SQL statements, you can simply include the computed column in the TableAdapter s main query via the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="c77eb-168">これには、ただし、自動生成`INSERT`と`UPDATE`計算列を含むステートメント。</span><span class="sxs-lookup"><span data-stu-id="c77eb-168">This, however, will auto-generate `INSERT` and `UPDATE` statements that include the computed column.</span></span> <span data-ttu-id="c77eb-169">これらのメソッドのいずれかを実行しようとすると、`SqlException`メッセージ列と共に*ColumnName*は、計算列または UNION 演算子の結果がスローされるため、変更できません。</span><span class="sxs-lookup"><span data-stu-id="c77eb-169">If you attempt to execute one of these methods, a `SqlException` with the message The column *ColumnName* cannot be modified because it is either a computed column or is the result of a UNION operator will be thrown.</span></span> <span data-ttu-id="c77eb-170">中に、`INSERT`と`UPDATE`ステートメントは、tableadapter を手動で調整できる`InsertCommand`と`UpdateCommand`プロパティ、こうしたカスタマイズは失われます TableAdapter 構成ウィザードが再実行されるたびにします。</span><span class="sxs-lookup"><span data-stu-id="c77eb-170">While the `INSERT` and `UPDATE` statement can be manually adjusted through the TableAdapter s `InsertCommand` and `UpdateCommand` properties, these customizations will be lost whenever the TableAdapter Configuration wizard is re-run.</span></span>

<span data-ttu-id="c77eb-171">アドホック SQL ステートメントを使用して Tableadapter の脆弱性、原因は、計算列を使用するときにストアド プロシージャを使用をお勧めします。</span><span class="sxs-lookup"><span data-stu-id="c77eb-171">Due to the brittleness of TableAdapters that use ad-hoc SQL statements, it is recommended that we use stored procedures when working with computed columns.</span></span> <span data-ttu-id="c77eb-172">既存のストアド プロシージャを使用している場合だけ、TableAdapter を構成で説明したように、[を使用して既存のストアド プロシージャを型指定されたデータセットの Tableadapter](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md)チュートリアルです。</span><span class="sxs-lookup"><span data-stu-id="c77eb-172">If you are using existing stored procedures, simply configure the TableAdapter as discussed in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) tutorial.</span></span> <span data-ttu-id="c77eb-173">ストアド プロシージャは作成、TableAdapter ウィザードがあれば、ただし、これが重要を最初にメインのクエリから計算列を省略する場合です。</span><span class="sxs-lookup"><span data-stu-id="c77eb-173">If you have the TableAdapter wizard create the stored procedures for you, however, it is important to initially omit any computed columns from the main query.</span></span> <span data-ttu-id="c77eb-174">メインのクエリで計算列を含める場合、TableAdapter 構成ウィザードは、通知完了すると、対応するストアド プロシージャを作成することはできません。</span><span class="sxs-lookup"><span data-stu-id="c77eb-174">If you include a computed column in the main query, the TableAdapter Configuration wizard will inform you, upon completion, that it cannot create the corresponding stored procedures.</span></span> <span data-ttu-id="c77eb-175">つまり、最初に計算列を必要としないメイン クエリを使用して、TableAdapter を構成し、対応するストアド プロシージャと、tableadapter を手動で更新する必要があります`SelectCommand`計算列を含めるようにします。</span><span class="sxs-lookup"><span data-stu-id="c77eb-175">In short, we need to initially configure the TableAdapter using a computed column-free main query and then manually update the corresponding stored procedure and the TableAdapter s `SelectCommand` to include the computed column.</span></span> <span data-ttu-id="c77eb-176">この方法と似ていますで使用される、 [TableAdapter を使用する更新](updating-the-tableadapter-to-use-joins-cs.md)`JOIN`*s*チュートリアルです。</span><span class="sxs-lookup"><span data-stu-id="c77eb-176">This approach is similar to the one used in the [Updating the TableAdapter to Use](updating-the-tableadapter-to-use-joins-cs.md)`JOIN`*s* tutorial.</span></span>

<span data-ttu-id="c77eb-177">このチュートリアルでは、s 新しい TableAdapter を追加して、それを自動的にご利用の米国ストアド プロシージャの作成を使用できます。</span><span class="sxs-lookup"><span data-stu-id="c77eb-177">For this tutorial, let s add a new TableAdapter and have it automatically create the stored procedures for us.</span></span> <span data-ttu-id="c77eb-178">その結果、最初に省略する必要が、`FullContactName`メイン クエリから列を計算します。</span><span class="sxs-lookup"><span data-stu-id="c77eb-178">Consequently, we will need to initially omit the `FullContactName` computed column from the main query.</span></span>

<span data-ttu-id="c77eb-179">開いて開始、`NorthwindWithSprocs`内のデータセット、`~/App_Code/DAL`フォルダーです。</span><span class="sxs-lookup"><span data-stu-id="c77eb-179">Start by opening the `NorthwindWithSprocs` DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="c77eb-180">デザイナー内を右クリックし、新しい TableAdapter を追加、コンテキスト メニューから選択します。</span><span class="sxs-lookup"><span data-stu-id="c77eb-180">Right-click in the Designer and, from the context-menu, choose to add a new TableAdapter.</span></span> <span data-ttu-id="c77eb-181">これにより、TableAdapter 構成ウィザードが起動します。</span><span class="sxs-lookup"><span data-stu-id="c77eb-181">This will launch the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="c77eb-182">データベースからデータをクエリするを指定する (`NORTHWNDConnectionString`から`Web.config`) し、[次へ] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="c77eb-182">Specify the database to query data from (`NORTHWNDConnectionString` from `Web.config`) and click Next.</span></span> <span data-ttu-id="c77eb-183">私たちが作成されていないクエリを実行または変更するための任意のストアド プロシージャから、`Suppliers`テーブルで、作成する新しいストアド プロシージャをウィザードが us 用に作成し、[次へ] のオプションを選択します。</span><span class="sxs-lookup"><span data-stu-id="c77eb-183">Since we have not yet created any stored procedures for querying or modifying the `Suppliers` table, select the Create new stored procedures option so that the wizard will create them for us and click Next.</span></span>


<span data-ttu-id="c77eb-184">[![新しいストアド プロシージャの作成オプションを選択します。](working-with-computed-columns-cs/_static/image8.png)](working-with-computed-columns-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="c77eb-184">[![Choose the Create new stored procedures Option](working-with-computed-columns-cs/_static/image8.png)](working-with-computed-columns-cs/_static/image7.png)</span></span>

<span data-ttu-id="c77eb-185">**図 3**: 新しいストアド プロシージャの作成オプションを選択 ([フルサイズのイメージを表示するをクリックして](working-with-computed-columns-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="c77eb-185">**Figure 3**: Choose the Create new stored procedures Option ([Click to view full-size image](working-with-computed-columns-cs/_static/image9.png))</span></span>


<span data-ttu-id="c77eb-186">後続の手順では、メインのクエリに us を求めます。</span><span class="sxs-lookup"><span data-stu-id="c77eb-186">The subsequent step prompts us for the main query.</span></span> <span data-ttu-id="c77eb-187">返す次のクエリを入力して、 `SupplierID`、 `CompanyName`、 `ContactName`、および`ContactTitle`各仕入先の列です。</span><span class="sxs-lookup"><span data-stu-id="c77eb-187">Enter the following query, which returns the `SupplierID`, `CompanyName`, `ContactName`, and `ContactTitle` columns for each supplier.</span></span> <span data-ttu-id="c77eb-188">注このクエリは、計算列を意図的に省略 (`FullContactName`) です。 この列を含める手順 4. で対応するストアド プロシージャを更新します。</span><span class="sxs-lookup"><span data-stu-id="c77eb-188">Note that this query purposefully omits the computed column (`FullContactName`); we will update the corresponding stored procedure to include this column in Step 4.</span></span>


[!code-sql[Main](working-with-computed-columns-cs/samples/sample3.sql)]

<span data-ttu-id="c77eb-189">後、メインのクエリを入力して、次をクリックすると、ウィザードにより、名前を次の 4 つのストアド プロシージャが生成されます。</span><span class="sxs-lookup"><span data-stu-id="c77eb-189">After entering the main query and clicking Next, the wizard allows us to name the four stored procedures it will generate.</span></span> <span data-ttu-id="c77eb-190">これらのストアド プロシージャの名前を付けます`Suppliers_Select`、 `Suppliers_Insert`、 `Suppliers_Update`、および`Suppliers_Delete`図 4 に示すようにします。</span><span class="sxs-lookup"><span data-stu-id="c77eb-190">Name these stored procedures `Suppliers_Select`, `Suppliers_Insert`, `Suppliers_Update`, and `Suppliers_Delete`, as Figure 4 illustrates.</span></span>


<span data-ttu-id="c77eb-191">[![自動生成ストアド プロシージャの名前を変更します。](working-with-computed-columns-cs/_static/image11.png)](working-with-computed-columns-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="c77eb-191">[![Customize the Names of the Auto-Generated Stored Procedures](working-with-computed-columns-cs/_static/image11.png)](working-with-computed-columns-cs/_static/image10.png)</span></span>

<span data-ttu-id="c77eb-192">**図 4**: Auto-Generated ストアド プロシージャの名前を変更する ([フルサイズのイメージを表示するをクリックして](working-with-computed-columns-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="c77eb-192">**Figure 4**: Customize the Names of the Auto-Generated Stored Procedures ([Click to view full-size image](working-with-computed-columns-cs/_static/image12.png))</span></span>


<span data-ttu-id="c77eb-193">ウィザードの次の手順では、TableAdapter のメソッドの名前し、データにアクセスして更新するために使用するパターンを指定することができます。</span><span class="sxs-lookup"><span data-stu-id="c77eb-193">The next wizard step allows us to name the TableAdapter s methods and specify the patterns used to access and update data.</span></span> <span data-ttu-id="c77eb-194">すべての 3 つチェック ボックスをオンのままにして、名前を変更、`GetData`メソッドを`GetSuppliers`です。</span><span class="sxs-lookup"><span data-stu-id="c77eb-194">Leave all three checkboxes checked, but rename the `GetData` method to `GetSuppliers`.</span></span> <span data-ttu-id="c77eb-195">ウィザードを完了するには、[完了] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="c77eb-195">Click Finish to complete the wizard.</span></span>


<span data-ttu-id="c77eb-196">[![GetSuppliers に GetData メソッドの名前を変更します。](working-with-computed-columns-cs/_static/image14.png)](working-with-computed-columns-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="c77eb-196">[![Rename the GetData Method to GetSuppliers](working-with-computed-columns-cs/_static/image14.png)](working-with-computed-columns-cs/_static/image13.png)</span></span>

<span data-ttu-id="c77eb-197">**図 5**: 名前を変更、`GetData`メソッドを`GetSuppliers`([フルサイズのイメージを表示するをクリックして](working-with-computed-columns-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="c77eb-197">**Figure 5**: Rename the `GetData` Method to `GetSuppliers` ([Click to view full-size image](working-with-computed-columns-cs/_static/image15.png))</span></span>


<span data-ttu-id="c77eb-198">[完了] をクリックすると、ウィザードは次の 4 つのストアド プロシージャを作成し、型指定されたデータセットに TableAdapter と対応する DataTable を追加します。</span><span class="sxs-lookup"><span data-stu-id="c77eb-198">Upon clicking Finish, the wizard will create the four stored procedures and add the TableAdapter and corresponding DataTable to the Typed DataSet.</span></span>

## <a name="step-4-including-the-computed-column-in-the-tableadapter-s-main-query"></a><span data-ttu-id="c77eb-199">手順 4: TableAdapter のメイン クエリで計算列を含む</span><span class="sxs-lookup"><span data-stu-id="c77eb-199">Step 4: Including the Computed Column in the TableAdapter s Main Query</span></span>

<span data-ttu-id="c77eb-200">これで、TableAdapter を更新する必要があり、DataTable の作成に含める手順 3. で、`FullContactName`計算列です。</span><span class="sxs-lookup"><span data-stu-id="c77eb-200">We now need to update the TableAdapter and DataTable created in Step 3 to include the `FullContactName` computed column.</span></span> <span data-ttu-id="c77eb-201">これには、2 つの手順が含まれます。</span><span class="sxs-lookup"><span data-stu-id="c77eb-201">This involves two steps:</span></span>

1. <span data-ttu-id="c77eb-202">更新、`Suppliers_Select`ストアド プロシージャを返す、`FullContactName`計算列、および</span><span class="sxs-lookup"><span data-stu-id="c77eb-202">Updating the `Suppliers_Select` stored procedure to return the `FullContactName` computed column, and</span></span>
2. <span data-ttu-id="c77eb-203">更新に含める、対応する DataTable`FullContactName`列です。</span><span class="sxs-lookup"><span data-stu-id="c77eb-203">Updating the DataTable to include a corresponding `FullContactName` column.</span></span>

<span data-ttu-id="c77eb-204">サーバー エクスプ ローラーに移動して Stored Procedures フォルダーへのドリル ダウンを開始します。</span><span class="sxs-lookup"><span data-stu-id="c77eb-204">Start by navigating to the Server Explorer and drilling down into the Stored Procedures folder.</span></span> <span data-ttu-id="c77eb-205">開く、`Suppliers_Select`ストアド プロシージャと更新プログラム、`SELECT`クエリに含まれる、`FullContactName`計算列。</span><span class="sxs-lookup"><span data-stu-id="c77eb-205">Open the `Suppliers_Select` stored procedure and update the `SELECT` query to include the `FullContactName` computed column:</span></span>


[!code-sql[Main](working-with-computed-columns-cs/samples/sample4.sql)]

<span data-ttu-id="c77eb-206">ツールバーの 保存 アイコンをクリックして、Ctrl + S をクリックして、または保存を選択して、ストアド プロシージャに変更を保存`Suppliers_Select`ファイル メニュー オプション。</span><span class="sxs-lookup"><span data-stu-id="c77eb-206">Save the changes to the stored procedure by clicking the Save icon in the Toolbar, by hitting Ctrl+S, or by choosing the Save `Suppliers_Select` option from the File menu.</span></span>

<span data-ttu-id="c77eb-207">次に、データセット デザイナーに戻りを右クリックし、 `SuppliersTableAdapter`、コンテキスト メニューから構成を選択します。</span><span class="sxs-lookup"><span data-stu-id="c77eb-207">Next, return to the DataSet Designer, right-click on the `SuppliersTableAdapter`, and choose Configure from the context-menu.</span></span> <span data-ttu-id="c77eb-208">なお、`Suppliers_Select`列が含まれています、`FullContactName`そのデータ列のコレクション内の列です。</span><span class="sxs-lookup"><span data-stu-id="c77eb-208">Note that the `Suppliers_Select` column now includes the `FullContactName` column in its Data Columns collection.</span></span>


<span data-ttu-id="c77eb-209">[![DataTable の列を更新するには、TableAdapter の構成ウィザードを実行します。](working-with-computed-columns-cs/_static/image17.png)](working-with-computed-columns-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="c77eb-209">[![Run the TableAdapter s Configuration Wizard to Update the DataTable s Columns](working-with-computed-columns-cs/_static/image17.png)](working-with-computed-columns-cs/_static/image16.png)</span></span>

<span data-ttu-id="c77eb-210">**図 6**: tableadapter の DataTable の列を更新するための構成ウィザードを実行 ([フルサイズのイメージを表示するをクリックして](working-with-computed-columns-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="c77eb-210">**Figure 6**: Run the TableAdapter s Configuration Wizard to Update the DataTable s Columns ([Click to view full-size image](working-with-computed-columns-cs/_static/image18.png))</span></span>


<span data-ttu-id="c77eb-211">ウィザードを完了するには、[完了] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="c77eb-211">Click Finish to complete the wizard.</span></span> <span data-ttu-id="c77eb-212">これが自動的に対応する列を追加、`SuppliersDataTable`です。</span><span class="sxs-lookup"><span data-stu-id="c77eb-212">This will automatically add a corresponding column to the `SuppliersDataTable`.</span></span> <span data-ttu-id="c77eb-213">TableAdapter ウィザードでは、ことを検出するのに十分なスマート、`FullContactName`列は計算列および読み取り専用です。</span><span class="sxs-lookup"><span data-stu-id="c77eb-213">The TableAdapter wizard is smart enough to detect that the `FullContactName` column is a computed column and therefore read-only.</span></span> <span data-ttu-id="c77eb-214">その結果、その列に、設定 s`ReadOnly`プロパティを`true`です。</span><span class="sxs-lookup"><span data-stu-id="c77eb-214">Consequently, it sets the column s `ReadOnly` property to `true`.</span></span> <span data-ttu-id="c77eb-215">これを確認するから列を選択、`SuppliersDataTable`し、[プロパティ] ウィンドウに移動 (図 7 を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="c77eb-215">To verify this, select the column from the `SuppliersDataTable` and then go to the Properties window (see Figure 7).</span></span> <span data-ttu-id="c77eb-216">なお、`FullContactName`列 s`DataType`と`MaxLength`プロパティはそれに応じても設定します。</span><span class="sxs-lookup"><span data-stu-id="c77eb-216">Note that the `FullContactName` column s `DataType` and `MaxLength` properties are also set accordingly.</span></span>


<span data-ttu-id="c77eb-217">[![FullContactName 列が読み取り専用としてマークされています。](working-with-computed-columns-cs/_static/image20.png)](working-with-computed-columns-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="c77eb-217">[![The FullContactName Column is Marked as Read-Only](working-with-computed-columns-cs/_static/image20.png)](working-with-computed-columns-cs/_static/image19.png)</span></span>

<span data-ttu-id="c77eb-218">**図 7**:`FullContactName`列は読み取り専用とマークされています ([フルサイズのイメージを表示するをクリックして](working-with-computed-columns-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="c77eb-218">**Figure 7**: The `FullContactName` Column is Marked as Read-Only ([Click to view full-size image](working-with-computed-columns-cs/_static/image21.png))</span></span>


## <a name="step-5-adding-agetsupplierbysupplieridmethod-to-the-tableadapter"></a><span data-ttu-id="c77eb-219">手順 5: 追加、`GetSupplierBySupplierID`TableAdapter にメソッド</span><span class="sxs-lookup"><span data-stu-id="c77eb-219">Step 5: Adding a`GetSupplierBySupplierID`Method to the TableAdapter</span></span>

<span data-ttu-id="c77eb-220">このチュートリアルでは更新可能なグリッドで、仕入先を表示するための ASP.NET ページを作成します。</span><span class="sxs-lookup"><span data-stu-id="c77eb-220">For this tutorial we will create an ASP.NET page that displays the suppliers in an updateable grid.</span></span> <span data-ttu-id="c77eb-221">過去のチュートリアルを更新したビジネス ロジック層から 1 つのレコードを厳密に型指定された DataTable として、そのプロパティを更新し、更新された DataTable を送信 DAL から特定のレコードが、DAL に変更を反映するバックアップを取得することでデータベースです。</span><span class="sxs-lookup"><span data-stu-id="c77eb-221">In past tutorials we have updated a single record from the Business Logic Layer by retrieving that particular record from the DAL as a strongly-typed DataTable, updating its properties, and then sending the updated DataTable back to the DAL to propagate the changes to the database.</span></span> <span data-ttu-id="c77eb-222">-DAL から更新されているレコードを取得して、この最初の手順を実行する必要があります最初に追加、 `GetSupplierBySupplierID(supplierID)` DAL にメソッドです。</span><span class="sxs-lookup"><span data-stu-id="c77eb-222">To accomplish this first step - retrieving the record being updated from the DAL - we need to first add a `GetSupplierBySupplierID(supplierID)` method to the DAL.</span></span>

<span data-ttu-id="c77eb-223">右クリックし、`SuppliersTableAdapter`データセット デザインで、コンテキスト メニューから、クエリの追加オプションを選択します。</span><span class="sxs-lookup"><span data-stu-id="c77eb-223">Right-click on the `SuppliersTableAdapter` in the DataSet Design and choose the Add Query option from the context-menu.</span></span> <span data-ttu-id="c77eb-224">手順 3. で行ったようにご利用の米国を新しいストアド プロシージャの作成 オプションを選択すると、新しいストアド プロシージャを生成するウィザードを使用できます (戻って図 3 にこの手順のスクリーン ショットの)。</span><span class="sxs-lookup"><span data-stu-id="c77eb-224">As we did in Step 3, let the wizard generate a new stored procedure for us by selecting the Create new stored procedure option (refer back to Figure 3 for a screenshot of this wizard step).</span></span> <span data-ttu-id="c77eb-225">このメソッドは、複数の列を持つレコードを返しますが、以降を行を返す SELECT は、SQL クエリを使用し、[次へ] をクリックすることを示します。</span><span class="sxs-lookup"><span data-stu-id="c77eb-225">Since this method will return a record with multiple columns, indicate that we want to use a SQL query that is a SELECT which returns rows and click Next.</span></span>


<span data-ttu-id="c77eb-226">[![選択 オプションの行が返されます](working-with-computed-columns-cs/_static/image23.png)](working-with-computed-columns-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="c77eb-226">[![Choose the SELECT which returns rows Option](working-with-computed-columns-cs/_static/image23.png)](working-with-computed-columns-cs/_static/image22.png)</span></span>

<span data-ttu-id="c77eb-227">**図 8**: 選択オプションの行が返されます ([フルサイズのイメージを表示するをクリックして](working-with-computed-columns-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="c77eb-227">**Figure 8**: Choose the SELECT which returns rows Option ([Click to view full-size image](working-with-computed-columns-cs/_static/image24.png))</span></span>


<span data-ttu-id="c77eb-228">後続の手順では、このメソッドを使用するクエリの場合、us ように求められます。</span><span class="sxs-lookup"><span data-stu-id="c77eb-228">The subsequent step prompts us for the query to use for this method.</span></span> <span data-ttu-id="c77eb-229">特定仕入先が、メインのクエリは、同じデータ フィールドを返すと、次を入力します。</span><span class="sxs-lookup"><span data-stu-id="c77eb-229">Enter the following, which returns the same data fields as the main query but for a particular supplier.</span></span>


[!code-sql[Main](working-with-computed-columns-cs/samples/sample5.sql)]

<span data-ttu-id="c77eb-230">次の画面では、自動生成されるストアド プロシージャの名前を付けることが求められます。</span><span class="sxs-lookup"><span data-stu-id="c77eb-230">The next screen asks us to name the stored procedure that will be auto-generated.</span></span> <span data-ttu-id="c77eb-231">このストアド プロシージャの名前を付けます`Suppliers_SelectBySupplierID`[次へ] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="c77eb-231">Name this stored procedure `Suppliers_SelectBySupplierID` and click Next.</span></span>


<span data-ttu-id="c77eb-232">[![名前のストアド プロシージャ Suppliers_SelectBySupplierID](working-with-computed-columns-cs/_static/image26.png)](working-with-computed-columns-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="c77eb-232">[![Name the Stored Procedure Suppliers_SelectBySupplierID](working-with-computed-columns-cs/_static/image26.png)](working-with-computed-columns-cs/_static/image25.png)</span></span>

<span data-ttu-id="c77eb-233">**図 9**: ストアド プロシージャの名前を付けます`Suppliers_SelectBySupplierID`([フルサイズのイメージを表示するをクリックして](working-with-computed-columns-cs/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="c77eb-233">**Figure 9**: Name the Stored Procedure `Suppliers_SelectBySupplierID` ([Click to view full-size image](working-with-computed-columns-cs/_static/image27.png))</span></span>


<span data-ttu-id="c77eb-234">最後に、ウィザードのプロンプト パターンと、TableAdapter を使用するメソッドの名前へのアクセス、データの場合、us です。</span><span class="sxs-lookup"><span data-stu-id="c77eb-234">Lastly, the wizard prompts us for the data access patterns and method names to use for the TableAdapter.</span></span> <span data-ttu-id="c77eb-235">両方のチェック ボックスがオンのままにして、名前の変更、`FillBy`と`GetDataBy`メソッド`FillBySupplierID`と`GetSupplierBySupplierID`、それぞれします。</span><span class="sxs-lookup"><span data-stu-id="c77eb-235">Leave both checkboxes checked, but rename the `FillBy` and `GetDataBy` methods to `FillBySupplierID` and `GetSupplierBySupplierID`, respectively.</span></span>


<span data-ttu-id="c77eb-236">[![名前の TableAdapter メソッド FillBySupplierID と GetSupplierBySupplierID](working-with-computed-columns-cs/_static/image29.png)](working-with-computed-columns-cs/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="c77eb-236">[![Name the TableAdapter Methods FillBySupplierID and GetSupplierBySupplierID](working-with-computed-columns-cs/_static/image29.png)](working-with-computed-columns-cs/_static/image28.png)</span></span>

<span data-ttu-id="c77eb-237">**図 10**: TableAdapter のメソッドの名前を付けます`FillBySupplierID`と`GetSupplierBySupplierID`([フルサイズのイメージを表示するをクリックして](working-with-computed-columns-cs/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="c77eb-237">**Figure 10**: Name the TableAdapter Methods `FillBySupplierID` and `GetSupplierBySupplierID` ([Click to view full-size image](working-with-computed-columns-cs/_static/image30.png))</span></span>


<span data-ttu-id="c77eb-238">ウィザードを完了するには、[完了] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="c77eb-238">Click Finish to complete the wizard.</span></span>

## <a name="step-6-creating-the-business-logic-layer"></a><span data-ttu-id="c77eb-239">手順 6: ビジネス ロジック層を作成します。</span><span class="sxs-lookup"><span data-stu-id="c77eb-239">Step 6: Creating the Business Logic Layer</span></span>

<span data-ttu-id="c77eb-240">手順 1. で作成された計算列を使用する ASP.NET ページを作成する前に、BLL に対応するメソッドを追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="c77eb-240">Before we create an ASP.NET page that uses the computed column created in Step 1, we first need to add the corresponding methods in the BLL.</span></span> <span data-ttu-id="c77eb-241">ASP.NET ページ、手順 7. で作成する、により、ユーザーを表示して、suppliers を編集できます。</span><span class="sxs-lookup"><span data-stu-id="c77eb-241">Our ASP.NET page, which we will create in Step 7, will allow users to view and edit suppliers.</span></span> <span data-ttu-id="c77eb-242">そのため、当社 BLL に少なくとも、仕入先との別を特定のサプライヤーの更新すべてを取得する方法を提供する必要があります。</span><span class="sxs-lookup"><span data-stu-id="c77eb-242">Therefore, we need our BLL to provide, at minimum, a method to get all of the suppliers and another to update a particular supplier.</span></span>

<span data-ttu-id="c77eb-243">という新しいクラス ファイルを作成する`SuppliersBLLWithSprocs`で、`~/App_Code/BLL`フォルダーし、次のコードを追加します。</span><span class="sxs-lookup"><span data-stu-id="c77eb-243">Create a new class file named `SuppliersBLLWithSprocs` in the `~/App_Code/BLL` folder and add the following code:</span></span>


[!code-csharp[Main](working-with-computed-columns-cs/samples/sample6.cs)]

<span data-ttu-id="c77eb-244">などの他の BLL クラス`SuppliersBLLWithSprocs`が、 `protected` `Adapter`プロパティのインスタンスを返す、`SuppliersTableAdapter`と共に 2 つのクラス`public`メソッド:`GetSuppliers`と`UpdateSupplier`です。</span><span class="sxs-lookup"><span data-stu-id="c77eb-244">Like the other BLL classes, `SuppliersBLLWithSprocs` has a `protected` `Adapter` property that returns an instance of the `SuppliersTableAdapter` class along with two `public` methods: `GetSuppliers` and `UpdateSupplier`.</span></span> <span data-ttu-id="c77eb-245">`GetSuppliers`メソッドの呼び出しを返します、 `SuppliersDataTable` 、対応するによって返される`GetSupplier`データ アクセス層内のメソッドです。</span><span class="sxs-lookup"><span data-stu-id="c77eb-245">The `GetSuppliers` method calls and returns the `SuppliersDataTable` returned by the corresponding `GetSupplier` method in the Data Access Layer.</span></span> <span data-ttu-id="c77eb-246">`UpdateSupplier`メソッドは、DAL s への呼び出しによって更新されている特定の仕入先に関する情報を取得`GetSupplierBySupplierID(supplierID)`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="c77eb-246">The `UpdateSupplier` method retrieves information about the particular supplier being updated via a call to the DAL s `GetSupplierBySupplierID(supplierID)` method.</span></span> <span data-ttu-id="c77eb-247">更新、 `CategoryName`、 `ContactName`、および`ContactTitle`プロパティ データ アクセス層 s を呼び出すことによって、これらの変更をデータベースにコミットし、`Update`メソッドで変更された`SuppliersRow`オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="c77eb-247">It then updates the `CategoryName`, `ContactName`, and `ContactTitle` properties and commits these changes to the database by calling the Data Access Layer s `Update` method, passing in the modified `SuppliersRow` object.</span></span>

> [!NOTE]
> <span data-ttu-id="c77eb-248">除く`SupplierID`と`CompanyName`、Suppliers テーブルのすべての列を許可する`NULL`値。</span><span class="sxs-lookup"><span data-stu-id="c77eb-248">Except for `SupplierID` and `CompanyName`, all columns in the Suppliers table allow `NULL` values.</span></span> <span data-ttu-id="c77eb-249">そのため場合は、渡された`contactName`または`contactTitle`パラメーターは`null`、対応するを設定する必要があります`ContactName`と`ContactTitle`プロパティを`NULL`データベース値を使用して、`SetContactNameNull`と`SetContactTitleNull`メソッド、それぞれします。</span><span class="sxs-lookup"><span data-stu-id="c77eb-249">Therefore, if the passed-in `contactName` or `contactTitle` parameters are `null` we need to set the corresponding `ContactName` and `ContactTitle` properties to a `NULL` database value using the `SetContactNameNull` and `SetContactTitleNull` methods, respectively.</span></span>


## <a name="step-7-working-with-the-computed-column-from-the-presentation-layer"></a><span data-ttu-id="c77eb-250">手順 7: プレゼンテーション層から、計算列の使用</span><span class="sxs-lookup"><span data-stu-id="c77eb-250">Step 7: Working with the Computed Column from the Presentation Layer</span></span>

<span data-ttu-id="c77eb-251">追加された計算列で、`Suppliers`テーブル DAL および BLL が適宜更新で動作する ASP.NET ページを作成する準備が整いました、`FullContactName`計算列です。</span><span class="sxs-lookup"><span data-stu-id="c77eb-251">With the computed column added to the `Suppliers` table and the DAL and BLL updated accordingly, we are ready to build an ASP.NET page that works with the `FullContactName` computed column.</span></span> <span data-ttu-id="c77eb-252">開いて開始、 `ComputedColumns.aspx`  ページで、`AdvancedDAL`フォルダーと、ツールボックスからデザイナーにドラッグする GridView。</span><span class="sxs-lookup"><span data-stu-id="c77eb-252">Start by opening the `ComputedColumns.aspx` page in the `AdvancedDAL` folder and drag a GridView from the Toolbox onto the Designer.</span></span> <span data-ttu-id="c77eb-253">集合 GridView s`ID`プロパティを`Suppliers`と、という名前の新しい ObjectDataSource へのバインドのスマート タグから`SuppliersDataSource`です。</span><span class="sxs-lookup"><span data-stu-id="c77eb-253">Set the GridView s `ID` property to `Suppliers` and, from its smart tag, bind it to a new ObjectDataSource named `SuppliersDataSource`.</span></span> <span data-ttu-id="c77eb-254">構成を使用する ObjectDataSource、`SuppliersBLLWithSprocs`クラスを追加しましたは手順 6. でバックアップし、[次へ] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="c77eb-254">Configure the ObjectDataSource to use the `SuppliersBLLWithSprocs` class we added back in Step 6 and click Next.</span></span>


<span data-ttu-id="c77eb-255">[![構成、ObjectDataSource SuppliersBLLWithSprocs クラスを使用するには](working-with-computed-columns-cs/_static/image32.png)](working-with-computed-columns-cs/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="c77eb-255">[![Configure the ObjectDataSource to Use the SuppliersBLLWithSprocs Class](working-with-computed-columns-cs/_static/image32.png)](working-with-computed-columns-cs/_static/image31.png)</span></span>

<span data-ttu-id="c77eb-256">**図 11**: 構成を使用する ObjectDataSource、`SuppliersBLLWithSprocs`クラス ([フルサイズのイメージを表示するをクリックして](working-with-computed-columns-cs/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="c77eb-256">**Figure 11**: Configure the ObjectDataSource to Use the `SuppliersBLLWithSprocs` Class ([Click to view full-size image](working-with-computed-columns-cs/_static/image33.png))</span></span>


<span data-ttu-id="c77eb-257">定義された 2 つのメソッドがある、`SuppliersBLLWithSprocs`クラス:`GetSuppliers`と`UpdateSupplier`です。</span><span class="sxs-lookup"><span data-stu-id="c77eb-257">There are only two methods defined in the `SuppliersBLLWithSprocs` class: `GetSuppliers` and `UpdateSupplier`.</span></span> <span data-ttu-id="c77eb-258">ことを確認これら 2 つの方法の選択で指定されたそれぞれのタブを更新、ObjectDataSource の構成を完了するには、[完了] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="c77eb-258">Ensure that these two methods are specified in the SELECT and UPDATE tabs, respectively, and click Finish to complete the configuration of the ObjectDataSource.</span></span>

<span data-ttu-id="c77eb-259">完了すると、データ ソース構成ウィザードの Visual Studio は、返されるデータ フィールドの各、BoundField を追加します。</span><span class="sxs-lookup"><span data-stu-id="c77eb-259">Upon completion of the Data Source Configuration wizard, Visual Studio will add a BoundField for each of the data fields returned.</span></span> <span data-ttu-id="c77eb-260">削除、 `SupplierID` BoundField を変更して、`HeaderText`のプロパティ、 `CompanyName`、 `ContactName`、 `ContactTitle`、および`FullContactName`BoundFields 会社、連絡先の名前、タイトル、および完全の連絡先名をそれぞれします。</span><span class="sxs-lookup"><span data-stu-id="c77eb-260">Remove the `SupplierID` BoundField and change the `HeaderText` properties of the `CompanyName`, `ContactName`, `ContactTitle`, and `FullContactName` BoundFields to Company, Contact Name, Title, and Full Contact Name, respectively.</span></span> <span data-ttu-id="c77eb-261">スマート タグから、編集を有効にするチェック ボックスをオン GridView s 組み込みの編集機能を有効にします。</span><span class="sxs-lookup"><span data-stu-id="c77eb-261">From the smart tag, check the Enable Editing checkbox to turn on the GridView s built-in editing capabilities.</span></span>

<span data-ttu-id="c77eb-262">BoundFields GridView に追加するだけでなく、データ ソース ウィザードの完了もが ObjectDataSource s を設定する Visual Studio`OldValuesParameterFormatString`プロパティを元に\_{0}。</span><span class="sxs-lookup"><span data-stu-id="c77eb-262">In addition to adding BoundFields to the GridView, completion of the Data Source Wizard also causes Visual Studio to set the ObjectDataSource s `OldValuesParameterFormatString` property to original\_{0}.</span></span> <span data-ttu-id="c77eb-263">この設定を既定値、{0} に戻されます。</span><span class="sxs-lookup"><span data-stu-id="c77eb-263">Revert this setting back to its default value, {0} .</span></span>

<span data-ttu-id="c77eb-264">ObjectDataSource、GridView にこれらの編集を行った後、宣言型マークアップを次のようになります。</span><span class="sxs-lookup"><span data-stu-id="c77eb-264">After making these edits to the GridView and ObjectDataSource, their declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](working-with-computed-columns-cs/samples/sample7.aspx)]

<span data-ttu-id="c77eb-265">次に、ブラウザーからこのページを参照してください。</span><span class="sxs-lookup"><span data-stu-id="c77eb-265">Next, visit this page through a browser.</span></span> <span data-ttu-id="c77eb-266">各仕入先を含むグリッドに表示されている図 12 に示す、`FullContactName`として書式設定された列、値があるその他の 3 つの列を連結したものでは単に`ContactName`(`ContactTitle`、 `CompanyName`)。</span><span class="sxs-lookup"><span data-stu-id="c77eb-266">As Figure 12 shows, each supplier is listed in a grid that includes the `FullContactName` column, whose value is simply the concatenation of the other three columns formatted as `ContactName` (`ContactTitle`, `CompanyName`) .</span></span>


<span data-ttu-id="c77eb-267">[![各仕入先がグリッドに一覧表示します。](working-with-computed-columns-cs/_static/image35.png)](working-with-computed-columns-cs/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="c77eb-267">[![Each Supplier is Listed in the Grid](working-with-computed-columns-cs/_static/image35.png)](working-with-computed-columns-cs/_static/image34.png)</span></span>

<span data-ttu-id="c77eb-268">**図 12**: 各仕入先がグリッドに表示されている ([フルサイズのイメージを表示するをクリックして](working-with-computed-columns-cs/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="c77eb-268">**Figure 12**: Each Supplier is Listed in the Grid ([Click to view full-size image](working-with-computed-columns-cs/_static/image36.png))</span></span>


<span data-ttu-id="c77eb-269">特定供給業者がポストバックを発生させるしがその行で表示の [編集] ボタンをクリックすると、編集インターフェイスの (図 13 を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="c77eb-269">Clicking the Edit button for a particular supplier causes a postback and has that row rendered in its editing interface (see Figure 13).</span></span> <span data-ttu-id="c77eb-270">最初の 3 つの列の表示で、既定のインターフェイスを編集 - いるテキスト ボックス コントロール`Text`プロパティがデータ フィールドの値に設定します。</span><span class="sxs-lookup"><span data-stu-id="c77eb-270">The first three columns render in their default editing interface - a TextBox control whose `Text` property is set to the value of the data field.</span></span> <span data-ttu-id="c77eb-271">`FullContactName`列、依然、テキストとして。</span><span class="sxs-lookup"><span data-stu-id="c77eb-271">The `FullContactName` column, however, remains as text.</span></span> <span data-ttu-id="c77eb-272">データ ソース構成ウィザードの完了時に GridView に、BoundFields が追加されたときに、 `FullContactName` BoundField s`ReadOnly`プロパティに設定された`true`ため、対応する`FullContactName`内の列、 `SuppliersDataTable`その`ReadOnly`プロパティに設定`true`です。</span><span class="sxs-lookup"><span data-stu-id="c77eb-272">When the BoundFields were added to the GridView at the completion of the Data Source Configuration wizard, the `FullContactName` BoundField s `ReadOnly` property was set to `true` because the corresponding `FullContactName` column in the `SuppliersDataTable` has its `ReadOnly` property set to `true`.</span></span> <span data-ttu-id="c77eb-273">手順 4 で説明したとおり、 `FullContactName` s`ReadOnly`プロパティに設定された`true`TableAdapter の列が計算列が検出されたためです。</span><span class="sxs-lookup"><span data-stu-id="c77eb-273">As noted in Step 4, the `FullContactName` s `ReadOnly` property was set to `true` because the TableAdapter detected that the column was a computed column.</span></span>


<span data-ttu-id="c77eb-274">[![FullContactName 列が編集できません。](working-with-computed-columns-cs/_static/image38.png)](working-with-computed-columns-cs/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="c77eb-274">[![The FullContactName Column is Not Editable](working-with-computed-columns-cs/_static/image38.png)](working-with-computed-columns-cs/_static/image37.png)</span></span>

<span data-ttu-id="c77eb-275">**図 13**:`FullContactName`列が編集できない ([フルサイズのイメージを表示するをクリックして](working-with-computed-columns-cs/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="c77eb-275">**Figure 13**: The `FullContactName` Column is Not Editable ([Click to view full-size image](working-with-computed-columns-cs/_static/image39.png))</span></span>


<span data-ttu-id="c77eb-276">1 つまたは複数の編集可能な列の値を更新してください [更新] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="c77eb-276">Go ahead and update the value of one or more of the editable columns and click Update.</span></span> <span data-ttu-id="c77eb-277">注方法、`FullContactName`の値が変更を反映するように自動的に更新します。</span><span class="sxs-lookup"><span data-stu-id="c77eb-277">Note how the `FullContactName` s value is automatically updated to reflect the change.</span></span>

> [!NOTE]
> <span data-ttu-id="c77eb-278">GridView 現在使用して BoundFields 編集可能なフィールドの結果として既定のインターフェイスを編集します。</span><span class="sxs-lookup"><span data-stu-id="c77eb-278">The GridView currently uses BoundFields for the editable fields, resulting in the default editing interface.</span></span> <span data-ttu-id="c77eb-279">以降、`CompanyName`フィールドは必須では、RequiredFieldValidator を含む TemplateField に変換する必要があります。</span><span class="sxs-lookup"><span data-stu-id="c77eb-279">Since the `CompanyName` field is required, it should be converted into a TemplateField that includes a RequiredFieldValidator.</span></span> <span data-ttu-id="c77eb-280">I のままに練習として、興味のリーダーの。</span><span class="sxs-lookup"><span data-stu-id="c77eb-280">I leave this as an exercise for the interested reader.</span></span> <span data-ttu-id="c77eb-281">参照してください、[検証コントロールを編集および挿入するインターフェイスを追加する](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-cs.md)BoundField を TemplateField に変換し、検証コントロールを追加する手順についてのチュートリアルです。</span><span class="sxs-lookup"><span data-stu-id="c77eb-281">Consult the [Adding Validation Controls to the Editing and Inserting Interfaces](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-cs.md) tutorial for step-by-step instructions on converting a BoundField to a TemplateField and adding validation controls.</span></span>


## <a name="summary"></a><span data-ttu-id="c77eb-282">まとめ</span><span class="sxs-lookup"><span data-stu-id="c77eb-282">Summary</span></span>

<span data-ttu-id="c77eb-283">テーブルのスキーマを定義するときに Microsoft SQL Server によって計算列を含めることができます。</span><span class="sxs-lookup"><span data-stu-id="c77eb-283">When defining the schema for a table, Microsoft SQL Server allows the inclusion of computed columns.</span></span> <span data-ttu-id="c77eb-284">これらは、値を持つは、通常、同じのレコードの他の列から値を参照する式から計算列です。</span><span class="sxs-lookup"><span data-stu-id="c77eb-284">These are columns whose values are calculated from an expression that usually references the values from other columns in the same record.</span></span> <span data-ttu-id="c77eb-285">以降の値の計算列は、式に基づいて、読み取り専用、内の値を割り当てることができません、`INSERT`または`UPDATE`ステートメントです。</span><span class="sxs-lookup"><span data-stu-id="c77eb-285">Since the values for computed columns are based on an expression, they are read-only and cannot be assigned a value in an `INSERT` or `UPDATE` statement.</span></span> <span data-ttu-id="c77eb-286">対応するを自動的に生成しようとする TableAdapter のメイン クエリで計算列を使用する場合の課題が生じます`INSERT`、 `UPDATE`、および`DELETE`ステートメントです。</span><span class="sxs-lookup"><span data-stu-id="c77eb-286">This introduces challenges when using a computed column in the main query of a TableAdapter that tries to automatically generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements.</span></span>

<span data-ttu-id="c77eb-287">このチュートリアルでは、計算列によって引き起こされる問題を回避する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="c77eb-287">In this tutorial we discussed techniques for circumventing the challenges posed by computed columns.</span></span> <span data-ttu-id="c77eb-288">具体的には、使用してストアド プロシージャ、TableAdapter のアドホック SQL ステートメントを使用して Tableadapter に特有の脆弱性を解消しました。</span><span class="sxs-lookup"><span data-stu-id="c77eb-288">In particular, we used stored procedures in our TableAdapter to overcome the brittleness inherent in TableAdapters that use ad-hoc SQL statements.</span></span> <span data-ttu-id="c77eb-289">ストアド プロシージャを TableAdapter ウィザードを新規作成するときは、最初に生成されないデータの変更ストアド プロシージャが含まれているのため、計算列を省略するメインのクエリがあることが重要です。</span><span class="sxs-lookup"><span data-stu-id="c77eb-289">When having the TableAdapter wizard create new stored procedures, it is important that we have the main query initially omit any computed columns because their presence prevents the data modification stored procedures from being generated.</span></span> <span data-ttu-id="c77eb-290">TableAdapter が最初に構成された後にその`SelectCommand`ストアド プロシージャは、計算列を含める retooled ことができます。</span><span class="sxs-lookup"><span data-stu-id="c77eb-290">After the TableAdapter has been initially configured, its `SelectCommand` stored procedure can be retooled to include any computed columns.</span></span>

<span data-ttu-id="c77eb-291">満足プログラミング!</span><span class="sxs-lookup"><span data-stu-id="c77eb-291">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="c77eb-292">作成者について</span><span class="sxs-lookup"><span data-stu-id="c77eb-292">About the Author</span></span>

<span data-ttu-id="c77eb-293">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)、7 つ受け取りますブックとの創設者の作成者[4GuysFromRolla.com](http://www.4guysfromrolla.com)、1998 年からマイクロソフトの Web テクノロジで取り組んできました。</span><span class="sxs-lookup"><span data-stu-id="c77eb-293">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="c77eb-294">Scott は、コンサルタント、トレーナー、ライターとして機能します。</span><span class="sxs-lookup"><span data-stu-id="c77eb-294">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="c77eb-295">最新の著書[ *Sam 学べる自分で ASP.NET 2.0 が 24 時間以内に*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)です。</span><span class="sxs-lookup"><span data-stu-id="c77eb-295">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="c77eb-296">彼に到達できる[ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)彼のブログを使用して含まれているのか[ http://ScottOnWriting.NET](http://ScottOnWriting.NET)です。</span><span class="sxs-lookup"><span data-stu-id="c77eb-296">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="c77eb-297">感謝の特別な</span><span class="sxs-lookup"><span data-stu-id="c77eb-297">Special Thanks To</span></span>

<span data-ttu-id="c77eb-298">このチュートリアルの系列は既に多くの便利なレビュー担当者によって確認済みです。</span><span class="sxs-lookup"><span data-stu-id="c77eb-298">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="c77eb-299">このチュートリアルの潜在顧客レビュー担当者は、Hilton Geisenow および Teresa マーフィーがいました。</span><span class="sxs-lookup"><span data-stu-id="c77eb-299">Lead reviewers for this tutorial were Hilton Geisenow and Teresa Murphy.</span></span> <span data-ttu-id="c77eb-300">今後、MSDN の記事を確認することに関心のあるですか。</span><span class="sxs-lookup"><span data-stu-id="c77eb-300">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="c77eb-301">場合は、ドロップ me 一度に 1 行ずつ[mitchell@4GuysFromRolla.comです。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="c77eb-301">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="c77eb-302">[前へ](adding-additional-datatable-columns-cs.md)
> [次へ](configuring-the-data-access-layer-s-connection-and-command-level-settings-cs.md)</span><span class="sxs-lookup"><span data-stu-id="c77eb-302">[Previous](adding-additional-datatable-columns-cs.md)
[Next](configuring-the-data-access-layer-s-connection-and-command-level-settings-cs.md)</span></span>
