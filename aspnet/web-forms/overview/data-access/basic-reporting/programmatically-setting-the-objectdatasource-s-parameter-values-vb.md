---
uid: web-forms/overview/data-access/basic-reporting/programmatically-setting-the-objectdatasource-s-parameter-values-vb
title: ObjectDataSource のパラメーター値 (VB) をプログラムによって設定 |Microsoft ドキュメント
author: rick-anderson
description: このチュートリアルでは、DAL および BLL を単一の入力パラメーターを受け入れてデータを返すメソッドを追加するのに紹介します。 例は、このパラメーターを設定しています.
ms.author: aspnetcontent
manager: wpickett
ms.date: 03/31/2010
ms.topic: article
ms.assetid: 0ecb03b6-52a0-4731-8c7a-436391d36838
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/basic-reporting/programmatically-setting-the-objectdatasource-s-parameter-values-vb
msc.type: authoredcontent
ms.openlocfilehash: ac53d651601829b6e7d2ce312a084618a8afbb61
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/06/2018
---
<a name="programmatically-setting-the-objectdatasources-parameter-values-vb"></a><span data-ttu-id="76269-104">ObjectDataSource のパラメーター値 (VB) のプログラムで設定</span><span class="sxs-lookup"><span data-stu-id="76269-104">Programmatically Setting the ObjectDataSource's Parameter Values (VB)</span></span>
====================
<span data-ttu-id="76269-105">によって[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="76269-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="76269-106">[サンプル アプリをダウンロード](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_6_VB.exe)または[PDF のダウンロード](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/datatutorial06vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="76269-106">[Download Sample App](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_6_VB.exe) or [Download PDF](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/datatutorial06vb1.pdf)</span></span>

> <span data-ttu-id="76269-107">このチュートリアルでは、DAL および BLL を単一の入力パラメーターを受け入れてデータを返すメソッドを追加するのに紹介します。</span><span class="sxs-lookup"><span data-stu-id="76269-107">In this tutorial we'll look at adding a method to our DAL and BLL that accepts a single input parameter and returns data.</span></span> <span data-ttu-id="76269-108">例では、このパラメーターをプログラムで設定されます。</span><span class="sxs-lookup"><span data-stu-id="76269-108">The example will set this parameter programmatically.</span></span>


## <a name="introduction"></a><span data-ttu-id="76269-109">はじめに</span><span class="sxs-lookup"><span data-stu-id="76269-109">Introduction</span></span>

<span data-ttu-id="76269-110">説明したとおり、[前のチュートリアル](declarative-parameters-vb.md)、宣言によって ObjectDataSource のメソッドにパラメーター値を渡すためのオプションが多数利用できます。</span><span class="sxs-lookup"><span data-stu-id="76269-110">As we saw in the [previous tutorial](declarative-parameters-vb.md), a number of options are available for declaratively passing parameter values to the ObjectDataSource's methods.</span></span> <span data-ttu-id="76269-111">ページで、Web コントロールに由来または読み取り可能なデータ ソースによっては、その他のソースでは、パラメーターの値がハード コーディングされた場合は、`Parameter`オブジェクト、たとえば、コードの行を記述することがなく値が入力パラメーターにバインドできます。</span><span class="sxs-lookup"><span data-stu-id="76269-111">If the parameter value is hard-coded, comes from a Web control on the page, or is in any other source that is readable by a data source `Parameter` object, for example, that value can be bound to the input parameter without writing a line of code.</span></span>

<span data-ttu-id="76269-112">ただし、組み込みのデータ ソースのいずれかによってについて考慮されていないソースからパラメーター値を取得する場合がある可能性があります`Parameter`オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="76269-112">There may be times, however, when the parameter value comes from some source not already accounted for by one of the built-in data source `Parameter` objects.</span></span> <span data-ttu-id="76269-113">サイトには、ユーザー アカウントがサポートされている場合に、現在ログインしている訪問者のユーザー ID に基づくパラメーターを設定することがあります。</span><span class="sxs-lookup"><span data-stu-id="76269-113">If our site supported user accounts we might want to set the parameter based on the currently logged in visitor's User ID.</span></span> <span data-ttu-id="76269-114">または、に沿って ObjectDataSource の基になるオブジェクトのメソッドに送信する前に、パラメーターの値をカスタマイズする必要があります。</span><span class="sxs-lookup"><span data-stu-id="76269-114">Or we may need to customize the parameter value before sending it along to the ObjectDataSource's underlying object's method.</span></span>

<span data-ttu-id="76269-115">たびに ObjectDataSource の`Select`メソッドが呼び出される、ObjectDataSource を最初に発生させるその[を選択するとイベント](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting%28VS.80%29.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="76269-115">Whenever the ObjectDataSource's `Select` method is invoked the ObjectDataSource first raises its [Selecting event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting%28VS.80%29.aspx).</span></span> <span data-ttu-id="76269-116">ObjectDataSource の基になるオブジェクトのメソッドは、呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="76269-116">The ObjectDataSource's underlying object's method is then invoked.</span></span> <span data-ttu-id="76269-117">完了し、ObjectDataSource[選択したイベント](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selected%28VS.80%29.aspx)(図 1 は、このイベントのシーケンスを示しています) に発生します。</span><span class="sxs-lookup"><span data-stu-id="76269-117">Once that completes the ObjectDataSource's [Selected event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selected%28VS.80%29.aspx) fires (Figure 1 illustrates this sequence of events).</span></span> <span data-ttu-id="76269-118">ObjectDataSource の基になるオブジェクトのメソッドに渡されたパラメーター値を設定またはのイベント ハンドラーでカスタマイズできる、`Selecting`イベント。</span><span class="sxs-lookup"><span data-stu-id="76269-118">The parameter values passed into the ObjectDataSource's underlying object's method can be set or customized in an event handler for the `Selecting` event.</span></span>


<span data-ttu-id="76269-119">[![ObjectDataSource の選択とを選択するとイベント起動する前に、後の基になるオブジェクトのメソッドが呼び出されます](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image2.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="76269-119">[![The ObjectDataSource's Selected and Selecting Events Fire Before and After Its Underlying Object's Method is Invoked](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image2.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image1.png)</span></span>

<span data-ttu-id="76269-120">**図 1**:、ObjectDataSource`Selected`と`Selecting`イベントの発生前に、と後の基になるオブジェクトのメソッドが呼び出されます ([フルサイズのイメージを表示するをクリックして](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="76269-120">**Figure 1**: The ObjectDataSource's `Selected` and `Selecting` Events Fire Before and After Its Underlying Object's Method is Invoked ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image3.png))</span></span>


<span data-ttu-id="76269-121">このチュートリアルで見ていきます、DAL と 1 つの入力パラメーターを受け入れる BLL にメソッドを追加する`Month`、型の`Integer`を返します、`EmployeesDataTable`オブジェクトを指定したその雇用日を持つそれらの従業員が設定されます`Month`.</span><span class="sxs-lookup"><span data-stu-id="76269-121">In this tutorial we'll look at adding a method to our DAL and BLL that accepts a single input parameter `Month`, of type `Integer` and returns an `EmployeesDataTable` object populated with those employees that have their hiring anniversary in the specified `Month`.</span></span> <span data-ttu-id="76269-122">この例ではプログラムによって「従業員の記念日今月」の一覧を示す現在の月に基づくこのパラメーターを設定します。</span><span class="sxs-lookup"><span data-stu-id="76269-122">Our example will set this parameter programmatically based on the current month, showing a list of "Employee Anniversaries This Month."</span></span>

<span data-ttu-id="76269-123">開始しましょう!</span><span class="sxs-lookup"><span data-stu-id="76269-123">Let's get started!</span></span>

## <a name="step-1-adding-a-method-toemployeestableadapter"></a><span data-ttu-id="76269-124">手順 1: 追加する方法`EmployeesTableAdapter`</span><span class="sxs-lookup"><span data-stu-id="76269-124">Step 1: Adding a Method to`EmployeesTableAdapter`</span></span>

<span data-ttu-id="76269-125">それらの従業員を取得するための手段を追加する必要があります最初の例の持つ`HireDate`で指定した月が発生しました。</span><span class="sxs-lookup"><span data-stu-id="76269-125">For our first example we need to add a means to retrieve those employees whose `HireDate` occurred in a specified month.</span></span> <span data-ttu-id="76269-126">最初のメソッドを作成する必要があります、アーキテクチャに従ってこの機能を提供する`EmployeesTableAdapter`適切な SQL ステートメントに対応します。</span><span class="sxs-lookup"><span data-stu-id="76269-126">To provide this functionality in accordance with our architecture we need to first create a method in `EmployeesTableAdapter` that maps to the proper SQL statement.</span></span> <span data-ttu-id="76269-127">これを実現するには、Northwind の型指定されたデータセットを開くことによって開始します。</span><span class="sxs-lookup"><span data-stu-id="76269-127">To accomplish this, start by opening the Northwind Typed DataSet.</span></span> <span data-ttu-id="76269-128">右クリックし、`EmployeesTableAdapter`にラベルを付けるし、クエリの追加を選択します。</span><span class="sxs-lookup"><span data-stu-id="76269-128">Right-click on the `EmployeesTableAdapter` label and choose Add Query.</span></span>


<span data-ttu-id="76269-129">[![新しいクエリ、EmployeesTableAdapter を追加します。](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image5.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="76269-129">[![Add a New Query to the EmployeesTableAdapter](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image5.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image4.png)</span></span>

<span data-ttu-id="76269-130">**図 2**: 新しいクエリを追加、 `EmployeesTableAdapter` ([フルサイズのイメージを表示するをクリックして](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="76269-130">**Figure 2**: Add a New Query to the `EmployeesTableAdapter` ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image6.png))</span></span>


<span data-ttu-id="76269-131">選択すると、行を返す SQL ステートメントを追加します。</span><span class="sxs-lookup"><span data-stu-id="76269-131">Choose to add a SQL statement that returns rows.</span></span> <span data-ttu-id="76269-132">指定に達すると、`SELECT`ステートメントは、既定値を画面`SELECT`のステートメント、`EmployeesTableAdapter`は既に読み込まれます。</span><span class="sxs-lookup"><span data-stu-id="76269-132">When you reach the Specify a `SELECT` Statement screen the default `SELECT` statement for the `EmployeesTableAdapter` will already be loaded.</span></span> <span data-ttu-id="76269-133">単に追加、`WHERE`句:`WHERE DATEPART(m, HireDate) = @Month`です。</span><span class="sxs-lookup"><span data-stu-id="76269-133">Simply add in the `WHERE` clause: `WHERE DATEPART(m, HireDate) = @Month`.</span></span> <span data-ttu-id="76269-134">[DATEPART](https://msdn.microsoft.com/library/ms174420.aspx) T-SQL 関数の特定の日付部分を返しますです、`datetime`入力です。 ここではを使用して`DATEPART`の月を返す、`HireDate`列です。</span><span class="sxs-lookup"><span data-stu-id="76269-134">[DATEPART](https://msdn.microsoft.com/library/ms174420.aspx) is a T-SQL function that returns a particular date portion of a `datetime` type; in this case we're using `DATEPART` to return the month of the `HireDate` column.</span></span>


<span data-ttu-id="76269-135">[![戻り値のみもの行が、HireDate 列が以下に、@HiredBeforeDateパラメーター](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image8.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="76269-135">[![Return Only Those Rows Where the HireDate Column is Less Than or Equal to the @HiredBeforeDate Parameter](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image8.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image7.png)</span></span>

<span data-ttu-id="76269-136">**図 3**: 返すのみもの行が、`HireDate`列は、以下に、`@HiredBeforeDate`パラメーター ([フルサイズのイメージを表示するをクリックして](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="76269-136">**Figure 3**: Return Only Those Rows Where the `HireDate` Column is Less Than or Equal to the `@HiredBeforeDate` Parameter ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image9.png))</span></span>


<span data-ttu-id="76269-137">最後に、変更、`FillBy`と`GetDataBy`メソッドの名前を`FillByHiredDateMonth`と`GetEmployeesByHiredDateMonth`、それぞれします。</span><span class="sxs-lookup"><span data-stu-id="76269-137">Finally, change the `FillBy` and `GetDataBy` method names to `FillByHiredDateMonth` and `GetEmployeesByHiredDateMonth`, respectively.</span></span>


<span data-ttu-id="76269-138">[![FillBy と GetDataBy より適切なメソッド名を選択します。](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image11.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="76269-138">[![Choose More Appropriate Method Names Than FillBy and GetDataBy](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image11.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image10.png)</span></span>

<span data-ttu-id="76269-139">**図 4**: 選択より適切なメソッド名よりも`FillBy`と`GetDataBy`([フルサイズのイメージを表示するをクリックして](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="76269-139">**Figure 4**: Choose More Appropriate Method Names Than `FillBy` and `GetDataBy` ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image12.png))</span></span>


<span data-ttu-id="76269-140">ウィザードを完了し、データセットのデザイン画面に戻るには、[完了] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="76269-140">Click Finish to complete the wizard and return to the DataSet's design surface.</span></span> <span data-ttu-id="76269-141">`EmployeesTableAdapter`指定された月で採用された従業員にアクセスするためのメソッドの新しいセットを含める必要がありますようになりました。</span><span class="sxs-lookup"><span data-stu-id="76269-141">The `EmployeesTableAdapter` should now include a new set of methods for accessing employees hired in a specified month.</span></span>


<span data-ttu-id="76269-142">[![メソッドを新しいデータセットのデザイン画面に表示します。](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image14.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="76269-142">[![The New Methods Appear in the DataSet's Design Surface](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image14.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image13.png)</span></span>

<span data-ttu-id="76269-143">**図 5**: 新しいメソッドに表示データセットのデザイン サーフェイス ([フルサイズのイメージを表示するをクリックして](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="76269-143">**Figure 5**: The New Methods Appear in the DataSet's Design Surface ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image15.png))</span></span>


## <a name="step-2-adding-thegetemployeesbyhireddatemonthmonthmethod-to-the-business-logic-layer"></a><span data-ttu-id="76269-144">手順 2: 追加、`GetEmployeesByHiredDateMonth(month)`ビジネス ロジック層メソッド</span><span class="sxs-lookup"><span data-stu-id="76269-144">Step 2: Adding the`GetEmployeesByHiredDateMonth(month)`Method to the Business Logic Layer</span></span>

<span data-ttu-id="76269-145">ロジックをアプリケーション アーキテクチャで使用する別のレイヤーのビジネス ロジックとデータにアクセスするために指定した日付より前に採用された従業員を取得するまで、DAL の呼び出しを BLL メソッドを追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="76269-145">Since our application architecture uses a separate layer for the business logic and data access logic, we need to add a method to our BLL that calls down to the DAL to retrieve employees hired before a specified date.</span></span> <span data-ttu-id="76269-146">開く、`EmployeesBLL.vb`ファイルし、次のメソッドを追加します。</span><span class="sxs-lookup"><span data-stu-id="76269-146">Open the `EmployeesBLL.vb` file and add the following method:</span></span>


[!code-vb[Main](programmatically-setting-the-objectdatasource-s-parameter-values-vb/samples/sample1.vb)]

<span data-ttu-id="76269-147">このクラスで、他のメソッドと同様`GetEmployeesByHiredDateMonth(month)`だけで、DAL 呼び出し、結果を返します。</span><span class="sxs-lookup"><span data-stu-id="76269-147">As with our other methods in this class, `GetEmployeesByHiredDateMonth(month)` simply calls down into the DAL and returns the results.</span></span>

## <a name="step-3-displaying-employees-whose-hiring-anniversary-is-this-month"></a><span data-ttu-id="76269-148">手順 3: 社員が雇用記念日はこの月を表示します。</span><span class="sxs-lookup"><span data-stu-id="76269-148">Step 3: Displaying Employees Whose Hiring Anniversary Is This Month</span></span>

<span data-ttu-id="76269-149">この例の最後の手順では、それらの従業員が雇用記念日はこの月を表示します。</span><span class="sxs-lookup"><span data-stu-id="76269-149">Our final step for this example is to display those employees whose hiring anniversary is this month.</span></span> <span data-ttu-id="76269-150">GridView を追加して、開始、 `ProgrammaticParams.aspx`  ページで、`BasicReporting`フォルダーし、そのデータ ソースとして新しい ObjectDataSource を追加します。</span><span class="sxs-lookup"><span data-stu-id="76269-150">Start by adding a GridView to the `ProgrammaticParams.aspx` page in the `BasicReporting` folder and add a new ObjectDataSource as its data source.</span></span> <span data-ttu-id="76269-151">構成を使用する ObjectDataSource、`EmployeesBLL`クラス、 `SelectMethod` 'éý'`GetEmployeesByHiredDateMonth(month)`です。</span><span class="sxs-lookup"><span data-stu-id="76269-151">Configure the ObjectDataSource to use the `EmployeesBLL` class with the `SelectMethod` set to `GetEmployeesByHiredDateMonth(month)`.</span></span>


<span data-ttu-id="76269-152">[![EmployeesBLL クラスを使用します。](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image17.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="76269-152">[![Use the EmployeesBLL Class](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image17.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image16.png)</span></span>

<span data-ttu-id="76269-153">**図 6**: を使用して、`EmployeesBLL`クラス ([フルサイズのイメージを表示するをクリックして](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="76269-153">**Figure 6**: Use the `EmployeesBLL` Class ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image18.png))</span></span>


<span data-ttu-id="76269-154">[![GetEmployeesByHiredDateMonth(month) から選択メソッド](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image20.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="76269-154">[![Select From the GetEmployeesByHiredDateMonth(month) method](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image20.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image19.png)</span></span>

<span data-ttu-id="76269-155">**図 7**: Select From、`GetEmployeesByHiredDateMonth(month)`メソッド ([フルサイズのイメージを表示するをクリックして](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="76269-155">**Figure 7**: Select From the `GetEmployeesByHiredDateMonth(month)` method ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image21.png))</span></span>


<span data-ttu-id="76269-156">最終画面には、提供するよう求められます、`month`パラメーター値のソース。</span><span class="sxs-lookup"><span data-stu-id="76269-156">The final screen asks us to provide the `month` parameter value's source.</span></span> <span data-ttu-id="76269-157">この値プログラムで設定します、パラメーターのソースが なし、既定値に設定のままにしてオプションし、ため完了 をクリックできます。</span><span class="sxs-lookup"><span data-stu-id="76269-157">Since we'll set this value programmatically, leave the Parameter source set to the default None option and click Finish.</span></span>


<span data-ttu-id="76269-158">[![[なし] にパラメーターのソースの設定のままにしてください。](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image23.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="76269-158">[![Leave the Parameter Source Set to None](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image23.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image22.png)</span></span>

<span data-ttu-id="76269-159">**図 8**: なし にパラメーターのソースの設定のままにして ([フルサイズのイメージを表示するをクリックして](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="76269-159">**Figure 8**: Leave the Parameter Source Set to None ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image24.png))</span></span>


<span data-ttu-id="76269-160">これが作成されます、 `Parameter` objectdatasource のオブジェクト`SelectParameters`値が指定されていないコレクションです。</span><span class="sxs-lookup"><span data-stu-id="76269-160">This will create a `Parameter` object in the ObjectDataSource's `SelectParameters` collection that does not have a value specified.</span></span>


[!code-aspx[Main](programmatically-setting-the-objectdatasource-s-parameter-values-vb/samples/sample2.aspx)]

<span data-ttu-id="76269-161">この値をプログラムで設定する必要があります、ObjectDataSource のイベント ハンドラーを作成する`Selecting`イベント。</span><span class="sxs-lookup"><span data-stu-id="76269-161">To set this value programmatically, we need to create an event handler for the ObjectDataSource's `Selecting` event.</span></span> <span data-ttu-id="76269-162">これを実現するには、デザイン ビューに移動し、ObjectDataSource をダブルクリックします。</span><span class="sxs-lookup"><span data-stu-id="76269-162">To accomplish this, go to the Design view and double-click the ObjectDataSource.</span></span> <span data-ttu-id="76269-163">または、ObjectDataSource を選択、[プロパティ] ウィンドウに移動し、稲妻のアイコンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="76269-163">Alternatively, select the ObjectDataSource, go to the Properties window, and click the lightning bolt icon.</span></span> <span data-ttu-id="76269-164">次に、いずれかをダブルクリックしてテキスト ボックスの横に、`Selecting`イベントまたは使用する場合、イベント ハンドラーの名前を入力します。</span><span class="sxs-lookup"><span data-stu-id="76269-164">Next, either double-click in the textbox next to the `Selecting` event or type in the name of the event handler you want to use.</span></span> <span data-ttu-id="76269-165">ObjectDataSource を選択して、イベント ハンドラーを作成するには 3 つ目のオプションとして、その`Selecting`ページの分離コード クラスの上部にある 2 つのドロップダウン リストからのイベントです。</span><span class="sxs-lookup"><span data-stu-id="76269-165">As a third option, you can create the event handler by selecting the ObjectDataSource and its `Selecting` event from the two drop-down lists at the top of the page's code-behind class.</span></span>


![Web コントロールのイベントを一覧表示する [プロパティ] ウィンドウで表示される稲妻アイコンをクリックします。](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image25.png)

<span data-ttu-id="76269-167">**図 9**: Web コントロールのイベントを一覧表示する [プロパティ] ウィンドウで表示される稲妻アイコンをクリックして</span><span class="sxs-lookup"><span data-stu-id="76269-167">**Figure 9**: Click on the Lightning Bolt Icon in the Properties Window to List a Web Control's Events</span></span>


<span data-ttu-id="76269-168">次の 3 つの方法はすべて、ObjectDataSource を新しいイベント ハンドラーを追加する`Selecting`ページの分離コード クラスをイベント。</span><span class="sxs-lookup"><span data-stu-id="76269-168">All three approaches add a new event handler for the ObjectDataSource's `Selecting` event to the page's code-behind class.</span></span> <span data-ttu-id="76269-169">このイベント ハンドラー内には、読み取りし、書き込みを使用してパラメーターの値おできます`e.InputParameters(parameterName)`ここで、 *`parameterName`*の値は、`Name`属性、`<asp:Parameter>`タグ (、`InputParameters`コレクションすることもできます序数に基づく、としてのインデックス付き`e.InputParameters(index)`)。</span><span class="sxs-lookup"><span data-stu-id="76269-169">In this event handler we can read and write to the parameter values using `e.InputParameters(parameterName)`, where *`parameterName`* is the value of the `Name` attribute in the `<asp:Parameter>` tag (the `InputParameters` collection can also be indexed ordinally, as in `e.InputParameters(index)`).</span></span> <span data-ttu-id="76269-170">設定する、`month`現在の月にパラメーターを追加するには、次の`Selecting`イベントのハンドラー。</span><span class="sxs-lookup"><span data-stu-id="76269-170">To set the `month` parameter to the current month, add the following to the `Selecting` event handler:</span></span>


[!code-vb[Main](programmatically-setting-the-objectdatasource-s-parameter-values-vb/samples/sample3.vb)]

<span data-ttu-id="76269-171">ブラウザーからこのページにアクセスしたときがわかりますその 1 つだけの従業員には、今月 (年 3 月) が採用された山久吉田一佳、1994 年より会社とされました。</span><span class="sxs-lookup"><span data-stu-id="76269-171">When visiting this page through a browser we can see that only one employee was hired this month (March) Laura Callahan, who's been with the company since 1994.</span></span>


<span data-ttu-id="76269-172">[![これらの従業員の記念日今月が表示されます。](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image27.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="76269-172">[![Those Employees Whose Anniversaries This Month Are Shown](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image27.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image26.png)</span></span>

<span data-ttu-id="76269-173">**図 10**: これらの従業員を記念日この月が表示されます ([フルサイズのイメージを表示するをクリックして](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="76269-173">**Figure 10**: Those Employees Whose Anniversaries This Month Are Shown ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image28.png))</span></span>


## <a name="summary"></a><span data-ttu-id="76269-174">まとめ</span><span class="sxs-lookup"><span data-stu-id="76269-174">Summary</span></span>

<span data-ttu-id="76269-175">ObjectDataSource のパラメーターの通常設定できる値は、宣言によって、コードの行を必要とせずは、簡単にプログラムでパラメーターの値を設定します。</span><span class="sxs-lookup"><span data-stu-id="76269-175">While the ObjectDataSource's parameters' values can typically be set declaratively, without requiring a line of code, it's easy to set the parameter values programmatically.</span></span> <span data-ttu-id="76269-176">ObjectDataSource のためのイベント ハンドラーの作成が必要なことを行うには`Selecting`基になるオブジェクトのメソッドが呼び出され、経由で 1 つまたは複数のパラメーターの値を手動で設定する前に発生するイベント、`InputParameters`コレクション。</span><span class="sxs-lookup"><span data-stu-id="76269-176">All we need to do is create an event handler for the ObjectDataSource's `Selecting` event, which fires before the underlying object's method is invoked, and manually set the values for one or more parameters via the `InputParameters` collection.</span></span>

<span data-ttu-id="76269-177">このチュートリアルでは、基本レポートのセクションで終了します。</span><span class="sxs-lookup"><span data-stu-id="76269-177">This tutorial concludes the Basic Reporting section.</span></span> <span data-ttu-id="76269-178">[次のチュートリアル](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md)が開始されると、フィルタ リングとマスター/詳細シナリオ セクションをうまくビジター データをフィルター処理を許可するための手法を見てし、マスター レポートから詳細レポートにドリル ダウンします。</span><span class="sxs-lookup"><span data-stu-id="76269-178">The [next tutorial](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md) kicks off the Filtering and Master-Details Scenarios section, in which we'll look at techniques for allowing the visitor to filter data and drill down from a master report into a details report.</span></span>

<span data-ttu-id="76269-179">満足プログラミング!</span><span class="sxs-lookup"><span data-stu-id="76269-179">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="76269-180">作成者について</span><span class="sxs-lookup"><span data-stu-id="76269-180">About the Author</span></span>

<span data-ttu-id="76269-181">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)、7 つ受け取りますブックとの創設者の作成者[4GuysFromRolla.com](http://www.4guysfromrolla.com)、1998 年からマイクロソフトの Web テクノロジで取り組んできました。</span><span class="sxs-lookup"><span data-stu-id="76269-181">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="76269-182">Scott は、コンサルタント、トレーナー、ライターとして機能します。</span><span class="sxs-lookup"><span data-stu-id="76269-182">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="76269-183">最新の著書[ *Sam 学べる自分で ASP.NET 2.0 が 24 時間以内に*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)です。</span><span class="sxs-lookup"><span data-stu-id="76269-183">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="76269-184">彼に到達できる[ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)彼のブログを使用して含まれているのか[ http://ScottOnWriting.NET](http://ScottOnWriting.NET)です。</span><span class="sxs-lookup"><span data-stu-id="76269-184">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="76269-185">感謝の特別な</span><span class="sxs-lookup"><span data-stu-id="76269-185">Special Thanks To</span></span>

<span data-ttu-id="76269-186">このチュートリアルの系列は既に多くの便利なレビュー担当者によって確認済みです。</span><span class="sxs-lookup"><span data-stu-id="76269-186">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="76269-187">このチュートリアルのレビュー担当者の潜在顧客が Hilton Giesenow しました。</span><span class="sxs-lookup"><span data-stu-id="76269-187">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="76269-188">今後、MSDN の記事を確認することに関心のあるですか。</span><span class="sxs-lookup"><span data-stu-id="76269-188">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="76269-189">場合は、ドロップ me 一度に 1 行ずつ[mitchell@4GuysFromRolla.comです。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="76269-189">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="76269-190">前へ</span><span class="sxs-lookup"><span data-stu-id="76269-190">Previous</span></span>](declarative-parameters-vb.md)
