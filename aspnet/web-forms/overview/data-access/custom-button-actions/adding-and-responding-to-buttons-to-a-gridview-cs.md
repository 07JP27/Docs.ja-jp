---
uid: web-forms/overview/data-access/custom-button-actions/adding-and-responding-to-buttons-to-a-gridview-cs
title: 追加して、GridView (c#) をボタンに応答して |Microsoft ドキュメント
author: rick-anderson
description: このチュートリアルでは、テンプレートと GridView または DetailsView コントロールのフィールドの両方にカスタム ボタンを追加する方法を紹介します。 具体的には、bui をします.
ms.author: aspnetcontent
manager: wpickett
ms.date: 09/13/2006
ms.topic: article
ms.assetid: 128fdb5f-4c5e-42b5-b485-f3aee90a8e38
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/custom-button-actions/adding-and-responding-to-buttons-to-a-gridview-cs
msc.type: authoredcontent
ms.openlocfilehash: 90648e10d5d058ea2e4aa5b3d8c4ed7448ea7166
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/06/2018
ms.locfileid: "30878296"
---
<a name="adding-and-responding-to-buttons-to-a-gridview-c"></a><span data-ttu-id="0ff37-104">GridView (c#) をボタンに応答して追加します。</span><span class="sxs-lookup"><span data-stu-id="0ff37-104">Adding and Responding to Buttons to a GridView (C#)</span></span>
====================
<span data-ttu-id="0ff37-105">によって[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="0ff37-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="0ff37-106">[サンプル アプリをダウンロード](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_28_CS.exe)または[PDF のダウンロード](adding-and-responding-to-buttons-to-a-gridview-cs/_static/datatutorial28cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="0ff37-106">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_28_CS.exe) or [Download PDF](adding-and-responding-to-buttons-to-a-gridview-cs/_static/datatutorial28cs1.pdf)</span></span>

> <span data-ttu-id="0ff37-107">このチュートリアルでは、テンプレートと GridView または DetailsView コントロールのフィールドの両方にカスタム ボタンを追加する方法を紹介します。</span><span class="sxs-lookup"><span data-stu-id="0ff37-107">In this tutorial we'll look at how to add custom buttons, both to a template and to the fields of a GridView or DetailsView control.</span></span> <span data-ttu-id="0ff37-108">具体的には、仕入先のページをユーザーができるフォーム ビューのあるインターフェイスを構築します。</span><span class="sxs-lookup"><span data-stu-id="0ff37-108">In particular, we'll build an interface that has a FormView that allows the user to page through the suppliers.</span></span>


## <a name="introduction"></a><span data-ttu-id="0ff37-109">はじめに</span><span class="sxs-lookup"><span data-stu-id="0ff37-109">Introduction</span></span>

<span data-ttu-id="0ff37-110">レポートの多くのシナリオでは、レポートのデータの読み取り専用のアクセスを伴う、中に、レポートに表示されるデータに基づくアクションを実行する機能を含めるは珍しいことではありません。</span><span class="sxs-lookup"><span data-stu-id="0ff37-110">While many reporting scenarios involve read-only access to the report data, it's not uncommon for reports to include the ability to perform actions based upon the data displayed.</span></span> <span data-ttu-id="0ff37-111">ボタン、LinkButton、ImageButton Web コントロールを追加する、レポートに表示される各レコードに関係しているこの通常、クリックすると、ポストバックを発生させるし、いくつかのサーバー側コードを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="0ff37-111">Typically this involved adding a Button, LinkButton, or ImageButton Web control with each record displayed in the report that, when clicked, causes a postback and invokes some server-side code.</span></span> <span data-ttu-id="0ff37-112">編集し、レコードごとにデータを削除すると、最も一般的な例です。</span><span class="sxs-lookup"><span data-stu-id="0ff37-112">Editing and deleting the data on a record-by-record basis is the most common example.</span></span> <span data-ttu-id="0ff37-113">実際には、以降で説明したように、[の概要の挿入、更新、およびデータの削除](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md)チュートリアルでは、編集および削除は、GridView、DetailsView、およびフォーム ビュー コントロールがなくこのような機能をサポートできることもよく、1 行のコードを記述するため必要があります。</span><span class="sxs-lookup"><span data-stu-id="0ff37-113">In fact, as we saw starting with the [Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md) tutorial, editing and deleting is so common that the GridView, DetailsView, and FormView controls can support such functionality without the need for writing a single line of code.</span></span>

<span data-ttu-id="0ff37-114">さらに編集およびボタン、GridView、DetailsView、およびフォーム ビューを削除するコントロールも、ボタン、ある、または ImageButtons をクリックすると、なんらかのカスタム サーバー側ロジックを実行します。</span><span class="sxs-lookup"><span data-stu-id="0ff37-114">In addition to Edit and Delete buttons, the GridView, DetailsView, and FormView controls can also include Buttons, LinkButtons, or ImageButtons that, when clicked, perform some custom server-side logic.</span></span> <span data-ttu-id="0ff37-115">このチュートリアルでは、テンプレートと GridView または DetailsView コントロールのフィールドの両方にカスタム ボタンを追加する方法を紹介します。</span><span class="sxs-lookup"><span data-stu-id="0ff37-115">In this tutorial we'll look at how to add custom buttons, both to a template and to the fields of a GridView or DetailsView control.</span></span> <span data-ttu-id="0ff37-116">具体的には、仕入先のページをユーザーができるフォーム ビューのあるインターフェイスを構築します。</span><span class="sxs-lookup"><span data-stu-id="0ff37-116">In particular, we'll build an interface that has a FormView that allows the user to page through the suppliers.</span></span> <span data-ttu-id="0ff37-117">特定の業者の FormView にボタン Web コントロールをクリックするはマーク設定すべて関連付けられている製品の提供が中止されたと共に仕入先に関する情報が表示されます。</span><span class="sxs-lookup"><span data-stu-id="0ff37-117">For a given supplier, the FormView will show information about the supplier along with a Button Web control that, if clicked, will mark all of their associated products as discontinued.</span></span> <span data-ttu-id="0ff37-118">さらに、価格を増やすと、クリックすると場合、発生または軽減するため、製品の割引価格ボタンを含む行ごとに、選択した業者によって提供されるこれらの製品の一覧、GridView`UnitPrice`を 10% (図 1 を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="0ff37-118">Additionally, a GridView lists those products provided by the selected supplier, with each row containing Increase Price and Discount Price Buttons that, if clicked, raise or reduce the product's `UnitPrice` by 10% (see Figure 1).</span></span>


<span data-ttu-id="0ff37-119">[![フォーム ビューと GridView の両方がカスタム アクションを実行するボタンを含む](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image2.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="0ff37-119">[![Both the FormView and GridView Contain Buttons That Perform Custom Actions](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image2.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image1.png)</span></span>

<span data-ttu-id="0ff37-120">**図 1**: 両方 FormView および GridView を含むボタンをカスタムの操作の実行 ([フルサイズのイメージを表示するをクリックして](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="0ff37-120">**Figure 1**: Both the FormView and GridView Contain Buttons That Perform Custom Actions ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image3.png))</span></span>


## <a name="step-1-adding-the-button-tutorial-web-pages"></a><span data-ttu-id="0ff37-121">手順 1: ボタンのチュートリアル Web ページの追加</span><span class="sxs-lookup"><span data-stu-id="0ff37-121">Step 1: Adding the Button Tutorial Web Pages</span></span>

<span data-ttu-id="0ff37-122">カスタム ボタンを追加する方法を見ると、前にまずみましょう。 このチュートリアルに必要とする、web サイト プロジェクトで ASP.NET ページを作成します。</span><span class="sxs-lookup"><span data-stu-id="0ff37-122">Before we look at how to add a custom buttons, let's first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial.</span></span> <span data-ttu-id="0ff37-123">という名前の新しいフォルダーを追加することによって開始`CustomButtons`です。</span><span class="sxs-lookup"><span data-stu-id="0ff37-123">Start by adding a new folder named `CustomButtons`.</span></span> <span data-ttu-id="0ff37-124">次に、各ページに関連付けるように、そのフォルダーに次の 2 つの ASP.NET ページを追加、`Site.master`マスター ページ。</span><span class="sxs-lookup"><span data-stu-id="0ff37-124">Next, add the following two ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `CustomButtons.aspx`


![カスタム ボタンに関連するチュートリアルについては、ASP.NET ページを追加します。](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image4.png)

<span data-ttu-id="0ff37-126">**図 2**: カスタム ボタンに関連するチュートリアルについては、ASP.NET ページを追加します。</span><span class="sxs-lookup"><span data-stu-id="0ff37-126">**Figure 2**: Add the ASP.NET Pages for the Custom Buttons-Related Tutorials</span></span>


<span data-ttu-id="0ff37-127">などの他のフォルダーで`Default.aspx`で、`CustomButtons`フォルダーは、チュートリアルのセクションに一覧表示します。</span><span class="sxs-lookup"><span data-stu-id="0ff37-127">Like in the other folders, `Default.aspx` in the `CustomButtons` folder will list the tutorials in its section.</span></span> <span data-ttu-id="0ff37-128">注意してください、`SectionLevelTutorialListing.ascx`ユーザー コントロールは、この機能を提供します。</span><span class="sxs-lookup"><span data-stu-id="0ff37-128">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="0ff37-129">そのため、このユーザー コントロールを追加`Default.aspx`ページの [デザイン] ビューに、ソリューション エクスプ ローラーからドラッグしています。</span><span class="sxs-lookup"><span data-stu-id="0ff37-129">Therefore, add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page's Design view.</span></span>


<span data-ttu-id="0ff37-130">[![Default.aspx に SectionLevelTutorialListing.ascx ユーザー コントロールを追加します。](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image6.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="0ff37-130">[![Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image6.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image5.png)</span></span>

<span data-ttu-id="0ff37-131">**図 3**: 追加、`SectionLevelTutorialListing.ascx`ユーザー コントロールを`Default.aspx`([フルサイズのイメージを表示するをクリックして](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="0ff37-131">**Figure 3**: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image7.png))</span></span>


<span data-ttu-id="0ff37-132">最後に、エントリとして、ページを追加、`Web.sitemap`ファイル。</span><span class="sxs-lookup"><span data-stu-id="0ff37-132">Lastly, add the pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="0ff37-133">具体的には、ページングと並べ替えの後に、次のマークアップを追加`<siteMapNode>`:</span><span class="sxs-lookup"><span data-stu-id="0ff37-133">Specifically, add the following markup after the Paging and Sorting `<siteMapNode>`:</span></span>

[!code-xml[Main](adding-and-responding-to-buttons-to-a-gridview-cs/samples/sample1.xml)]

<span data-ttu-id="0ff37-134">更新した後に`Web.sitemap`ブラウザーを使って、チュートリアルの web サイトを表示します。</span><span class="sxs-lookup"><span data-stu-id="0ff37-134">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="0ff37-135">左側のメニューには、編集、挿入、およびチュートリアルを削除する項目が含まれています。</span><span class="sxs-lookup"><span data-stu-id="0ff37-135">The menu on the left now includes items for the editing, inserting, and deleting tutorials.</span></span>


![サイト マップではカスタム ボタンのチュートリアル」のエントリが含まれるようになりました](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image8.png)

<span data-ttu-id="0ff37-137">**図 4**: サイト マップではカスタム ボタンのチュートリアル」のエントリが含まれるようになりました</span><span class="sxs-lookup"><span data-stu-id="0ff37-137">**Figure 4**: The Site Map Now Includes the Entry for the Custom Buttons Tutorial</span></span>


## <a name="step-2-adding-a-formview-that-lists-the-suppliers"></a><span data-ttu-id="0ff37-138">手順 2: 仕入先の一覧を表示するフォーム ビューの追加</span><span class="sxs-lookup"><span data-stu-id="0ff37-138">Step 2: Adding a FormView that Lists the Suppliers</span></span>

<span data-ttu-id="0ff37-139">開始しましょうこのチュートリアルを仕入先の一覧を表示するフォーム ビューを追加することで。</span><span class="sxs-lookup"><span data-stu-id="0ff37-139">Let's get started with this tutorial by adding the FormView that lists the suppliers.</span></span> <span data-ttu-id="0ff37-140">導入で既に説明した、この FormView は GridView で業者によって提供される製品を示す、仕入先からのページにユーザーを許可します。</span><span class="sxs-lookup"><span data-stu-id="0ff37-140">As discussed in the Introduction, this FormView will allow the user to page through the suppliers, showing the products provided by the supplier in a GridView.</span></span> <span data-ttu-id="0ff37-141">さらに、このフォーム ビューは、ボタンをクリックするはすべての業者の製品としてマーク提供が中止されました。</span><span class="sxs-lookup"><span data-stu-id="0ff37-141">Additionally, this FormView will include a Button that, when clicked, will mark all of the supplier's products as discontinued.</span></span> <span data-ttu-id="0ff37-142">自分に関係お FormView へのカスタム ボタンの追加と、前に作成してみましょう最初だけ FormView 仕入先の情報を表示するよう。</span><span class="sxs-lookup"><span data-stu-id="0ff37-142">Before we concern ourselves with adding the custom button to the FormView, let's first just create the FormView so that it displays the supplier information.</span></span>

<span data-ttu-id="0ff37-143">開いて開始、 `CustomButtons.aspx`  ページで、`CustomButtons`フォルダーです。</span><span class="sxs-lookup"><span data-stu-id="0ff37-143">Start by opening the `CustomButtons.aspx` page in the `CustomButtons` folder.</span></span> <span data-ttu-id="0ff37-144">デザイナーとセットには、ツールボックスからドラッグして、FormView をページに追加の`ID`プロパティを`Suppliers`です。</span><span class="sxs-lookup"><span data-stu-id="0ff37-144">Add a FormView to the page by dragging it from the Toolbox onto the Designer and set its `ID` property to `Suppliers`.</span></span> <span data-ttu-id="0ff37-145">FormView のスマート タグからという名前の新しい ObjectDataSource を作成すること`SuppliersDataSource`です。</span><span class="sxs-lookup"><span data-stu-id="0ff37-145">From the FormView's smart tag, opt to create a new ObjectDataSource named `SuppliersDataSource`.</span></span>


<span data-ttu-id="0ff37-146">[![SuppliersDataSource をという名前の新しい ObjectDataSource を作成します。](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image10.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="0ff37-146">[![Create a New ObjectDataSource Named SuppliersDataSource](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image10.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image9.png)</span></span>

<span data-ttu-id="0ff37-147">**図 5**: 名前付き新しい ObjectDataSource 作成`SuppliersDataSource`([フルサイズのイメージを表示するをクリックして](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="0ff37-147">**Figure 5**: Create a New ObjectDataSource Named `SuppliersDataSource` ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image11.png))</span></span>


<span data-ttu-id="0ff37-148">クエリを実行するように、この新しい ObjectDataSource を構成、`SuppliersBLL`クラスの`GetSuppliers()`メソッド (図 6 を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="0ff37-148">Configure this new ObjectDataSource such that it queries from the `SuppliersBLL` class's `GetSuppliers()` method (see Figure 6).</span></span> <span data-ttu-id="0ff37-149">以降、このフォーム ビューでは、仕入先については、選択更新 タブで、ドロップダウン リストからオプション (なし) を更新するためのインターフェイスは提供されません。</span><span class="sxs-lookup"><span data-stu-id="0ff37-149">Since this FormView does not provide an interface for updating the supplier information, select the (None) option from the drop-down list in the UPDATE tab.</span></span>


<span data-ttu-id="0ff37-150">[![SuppliersBLL クラスの GetSuppliers() メソッドを使用するデータ ソースを構成します。](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image13.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="0ff37-150">[![Configure the Data Source to use the SuppliersBLL Class s GetSuppliers() Method](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image13.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image12.png)</span></span>

<span data-ttu-id="0ff37-151">**図 6**: を使用するデータ ソースを構成、`SuppliersBLL`クラスの`GetSuppliers()`メソッド ([フルサイズのイメージを表示するをクリックして](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="0ff37-151">**Figure 6**: Configure the Data Source to use the `SuppliersBLL` Class's `GetSuppliers()` Method ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image14.png))</span></span>


<span data-ttu-id="0ff37-152">Visual Studio は生成、ObjectDataSource を構成した後、 `InsertItemTemplate`、 `EditItemTemplate`、および`ItemTemplate`FormView の。</span><span class="sxs-lookup"><span data-stu-id="0ff37-152">After configuring the ObjectDataSource, Visual Studio will generate an `InsertItemTemplate`, `EditItemTemplate`, and `ItemTemplate` for the FormView.</span></span> <span data-ttu-id="0ff37-153">削除、`InsertItemTemplate`と`EditItemTemplate`および変更、`ItemTemplate`だけ仕入先の会社名と電話番号を表示するようです。</span><span class="sxs-lookup"><span data-stu-id="0ff37-153">Remove the `InsertItemTemplate` and `EditItemTemplate` and modify the `ItemTemplate` so that it displays just the supplier's company name and phone number.</span></span> <span data-ttu-id="0ff37-154">スマート タグからのページングを有効にするチェック ボックスをオンして、FormView のページング サポートを有効に最後に、(かを設定してその`AllowPaging`プロパティを`True`)。</span><span class="sxs-lookup"><span data-stu-id="0ff37-154">Finally, turn on paging support for the FormView by checking the Enable Paging checkbox from its smart tag (or by setting its `AllowPaging` property to `True`).</span></span> <span data-ttu-id="0ff37-155">これらの変更後に、ページの宣言型マークアップを次のようになります。</span><span class="sxs-lookup"><span data-stu-id="0ff37-155">After these changes your page's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](adding-and-responding-to-buttons-to-a-gridview-cs/samples/sample2.aspx)]

<span data-ttu-id="0ff37-156">図 7 は、ブラウザーで表示したときに、CustomButtons.aspx ページを示します。</span><span class="sxs-lookup"><span data-stu-id="0ff37-156">Figure 7 shows the CustomButtons.aspx page when viewed through a browser.</span></span>


<span data-ttu-id="0ff37-157">[![FormView は、CompanyName と現在選択されている、業者からの電話のフィールドを一覧表示します。](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image16.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="0ff37-157">[![The FormView Lists the CompanyName and Phone Fields from the Currently Selected Supplier](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image16.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image15.png)</span></span>

<span data-ttu-id="0ff37-158">**図 7**: フォーム ビューを一覧表示、`CompanyName`と`Phone`、現在選択されている業者からのフィールド ([フルサイズのイメージを表示するをクリックして](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="0ff37-158">**Figure 7**: The FormView Lists the `CompanyName` and `Phone` Fields from the Currently Selected Supplier ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image17.png))</span></span>


## <a name="step-3-adding-a-gridview-that-lists-the-selected-suppliers-products"></a><span data-ttu-id="0ff37-159">手順 3: 選択した供給業者の製品を一覧表示する GridView の追加</span><span class="sxs-lookup"><span data-stu-id="0ff37-159">Step 3: Adding a GridView that Lists the Selected Supplier's Products</span></span>

<span data-ttu-id="0ff37-160">FormView のテンプレートにすべての製品の中止 ボタンを追加お前に、選択した業者によって提供される製品を一覧表示するフォーム ビューの下にある GridView を追加してみましょう最初。</span><span class="sxs-lookup"><span data-stu-id="0ff37-160">Before we add the Discontinue All Products Button to the FormView's template, let's first add a GridView beneath the FormView that lists the products provided by the selected supplier.</span></span> <span data-ttu-id="0ff37-161">これには、GridView ページを追加するには設定、`ID`プロパティを`SuppliersProducts`、という名前の新しい ObjectDataSource を追加および`SuppliersProductsDataSource`です。</span><span class="sxs-lookup"><span data-stu-id="0ff37-161">To accomplish this, add a GridView to the page, set its `ID` property to `SuppliersProducts`, and add a new ObjectDataSource named `SuppliersProductsDataSource`.</span></span>


<span data-ttu-id="0ff37-162">[![SuppliersProductsDataSource をという名前の新しい ObjectDataSource を作成します。](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image19.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="0ff37-162">[![Create a New ObjectDataSource Named SuppliersProductsDataSource](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image19.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image18.png)</span></span>

<span data-ttu-id="0ff37-163">**図 8**: 名前付き新しい ObjectDataSource 作成`SuppliersProductsDataSource`([フルサイズのイメージを表示するをクリックして](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="0ff37-163">**Figure 8**: Create a New ObjectDataSource Named `SuppliersProductsDataSource` ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image20.png))</span></span>


<span data-ttu-id="0ff37-164">構成、ProductsBLL クラスを使用するには、この ObjectDataSource`GetProductsBySupplierID(supplierID)`メソッド (図 9 を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="0ff37-164">Configure this ObjectDataSource to use the ProductsBLL class's `GetProductsBySupplierID(supplierID)` method (see Figure 9).</span></span> <span data-ttu-id="0ff37-165">この GridView は、調整する製品の価格の許可は、編集または GridView から機能を削除する、組み込みが使用するはありません。</span><span class="sxs-lookup"><span data-stu-id="0ff37-165">While this GridView will allow for a product's price to be adjusted, it won't be using the built-in editing or deleting features from the GridView.</span></span> <span data-ttu-id="0ff37-166">したがって、ObjectDataSource の更新、挿入、およびタブを削除する (なし) をドロップダウン リストを設定できます。</span><span class="sxs-lookup"><span data-stu-id="0ff37-166">Therefore, we can set the drop-down list to (None) for the ObjectDataSource's UPDATE, INSERT, and DELETE tabs.</span></span>


<span data-ttu-id="0ff37-167">[![ProductsBLL クラスの GetProductsBySupplierID(supplierID) メソッドを使用するデータ ソースを構成します。](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image22.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="0ff37-167">[![Configure the Data Source to use the ProductsBLL Class s GetProductsBySupplierID(supplierID) Method](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image22.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image21.png)</span></span>

<span data-ttu-id="0ff37-168">**図 9**: を使用するデータ ソースを構成、`ProductsBLL`クラスの`GetProductsBySupplierID(supplierID)`メソッド ([フルサイズのイメージを表示するをクリックして](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="0ff37-168">**Figure 9**: Configure the Data Source to use the `ProductsBLL` Class's `GetProductsBySupplierID(supplierID)` Method ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image23.png))</span></span>


<span data-ttu-id="0ff37-169">以降、`GetProductsBySupplierID(supplierID)`メソッドは、入力パラメーターを受け取り、ObjectDataSource ウィザードの指示に従って us このパラメーター値のソース。</span><span class="sxs-lookup"><span data-stu-id="0ff37-169">Since the `GetProductsBySupplierID(supplierID)` method accepts an input parameter, the ObjectDataSource wizard prompts us for the source of this parameter value.</span></span> <span data-ttu-id="0ff37-170">渡す、 `SupplierID` FormView からの値、コントロールと ControlID のドロップダウン リストにパラメーターのソースのドロップダウン リストを設定`Suppliers`(FormView の ID は、手順 2. で作成) します。</span><span class="sxs-lookup"><span data-stu-id="0ff37-170">To pass in the `SupplierID` value from the FormView, set the Parameter source drop-down list to Control and the ControlID drop-down list to `Suppliers` (the ID of the FormView created in Step 2).</span></span>


<span data-ttu-id="0ff37-171">[![SupplierID パラメーターから取得するように Suppliers FormView コントロールを示します](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image25.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="0ff37-171">[![Indicate that the supplierID Parameter Should Come from the Suppliers FormView Control](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image25.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image24.png)</span></span>

<span data-ttu-id="0ff37-172">**図 10**: ことを示すため、 *`supplierID`* からパラメーターを取得する、 `Suppliers` FormView コントロール ([フルサイズのイメージを表示するをクリックして](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image26.png))</span><span class="sxs-lookup"><span data-stu-id="0ff37-172">**Figure 10**: Indicate that the *`supplierID`* Parameter Should Come from the `Suppliers` FormView Control ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image26.png))</span></span>


<span data-ttu-id="0ff37-173">ObjectDataSource ウィザードの完了後は、GridView はの各製品のデータ フィールドのも、BoundField または CheckBoxField に含まれます。</span><span class="sxs-lookup"><span data-stu-id="0ff37-173">After completing the ObjectDataSource wizard, the GridView will contain a BoundField or CheckBoxField for each of the product's data fields.</span></span> <span data-ttu-id="0ff37-174">みましょうトリムこれを表示するだけ、`ProductName`と`UnitPrice`と共に BoundFields、 `Discontinued` CheckBoxField; さらに、書式設定してみましょう、 `UnitPrice` BoundField そのテキストが通貨として書式設定されるようです。</span><span class="sxs-lookup"><span data-stu-id="0ff37-174">Let's trim this down to show just the `ProductName` and `UnitPrice` BoundFields along with the `Discontinued` CheckBoxField; furthermore, let's format the `UnitPrice` BoundField such that its text is formatted as a currency.</span></span> <span data-ttu-id="0ff37-175">GridView と`SuppliersProductsDataSource`ObjectDataSource の宣言型マークアップは、次のマークアップのようになります。</span><span class="sxs-lookup"><span data-stu-id="0ff37-175">Your GridView and `SuppliersProductsDataSource` ObjectDataSource's declarative markup should look similar to the following markup:</span></span>

[!code-aspx[Main](adding-and-responding-to-buttons-to-a-gridview-cs/samples/sample3.aspx)]

<span data-ttu-id="0ff37-176">この時点で、チュートリアルでは、上部にある FormView から仕入先を選択して、下部にある GridView を通じてその業者によって提供される製品を表示するユーザーを許可する、マスター/詳細レポートが表示されます。</span><span class="sxs-lookup"><span data-stu-id="0ff37-176">At this point our tutorial displays a master/details report, allowing the user to pick a supplier from the FormView at the top and to view the products provided by that supplier through the GridView at the bottom.</span></span> <span data-ttu-id="0ff37-177">図 11 は、FormView から東京 Traders 仕入先を選択するときに、このページのスクリーン ショットを示します。</span><span class="sxs-lookup"><span data-stu-id="0ff37-177">Figure 11 shows a screen shot of this page when selecting the Tokyo Traders supplier from the FormView.</span></span>


<span data-ttu-id="0ff37-178">[![GridView に、仕入先の選択した製品が表示されます。](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image28.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="0ff37-178">[![The Selected Supplier s Products are Displayed in the GridView](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image28.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image27.png)</span></span>

<span data-ttu-id="0ff37-179">**図 11**: GridView で、選択した供給業者の製品が表示されます ([フルサイズのイメージを表示するをクリックして](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image29.png))</span><span class="sxs-lookup"><span data-stu-id="0ff37-179">**Figure 11**: The Selected Supplier's Products are Displayed in the GridView ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image29.png))</span></span>


## <a name="step-4-creating-dal-and-bll-methods-to-discontinue-all-products-for-a-supplier"></a><span data-ttu-id="0ff37-180">手順 4: 作成、業者のすべての製品を中止するには、DAL と BLL メソッド</span><span class="sxs-lookup"><span data-stu-id="0ff37-180">Step 4: Creating DAL and BLL Methods to Discontinue All Products for a Supplier</span></span>

<span data-ttu-id="0ff37-181">FormView にボタンを追加するをクリックすると、すべてを停止、業者の製品の最初いただくために DAL とこのアクションを実行する BLL の両方にメソッドを追加します。</span><span class="sxs-lookup"><span data-stu-id="0ff37-181">Before we can add a Button to the FormView that, when clicked, discontinues all of the supplier's products, we first need to add a method to both the DAL and BLL that performs this action.</span></span> <span data-ttu-id="0ff37-182">具体的には、このメソッドの名前は`DiscontinueAllProductsForSupplier(supplierID)`します。</span><span class="sxs-lookup"><span data-stu-id="0ff37-182">In particular, this method will be named `DiscontinueAllProductsForSupplier(supplierID)`.</span></span> <span data-ttu-id="0ff37-183">FormView のボタンがクリックされたときにおありますメソッドを呼び出すこのビジネス ロジック層に渡す、選択した業者の`SupplierID`; BLL をを発行するの対応するデータ アクセス層メソッドを呼び出し、`UPDATE`ステートメントデータベースには、指定された業者の商品を停止します。</span><span class="sxs-lookup"><span data-stu-id="0ff37-183">When the FormView's Button is clicked, we'll invoke this method in the Business Logic Layer, passing in the selected supplier's `SupplierID`; the BLL will then call down to the corresponding Data Access Layer method, which will issue an `UPDATE` statement to the database that discontinues the specified supplier's products.</span></span>

<span data-ttu-id="0ff37-184">ように実行して、前のチュートリアルを使用しますボトムアップ方式では、DAL メソッド、then BLL メソッドを作成し、最後に、機能を実装する ASP.NET ページで始まります。</span><span class="sxs-lookup"><span data-stu-id="0ff37-184">As we have done in our previous tutorials, we'll use a bottom-up approach, starting with creating the DAL method, then the BLL method, and finally implementing the functionality in the ASP.NET page.</span></span> <span data-ttu-id="0ff37-185">開く、`Northwind.xsd`に型指定されたデータセット、`App_Code/DAL`フォルダー新しいメソッドを追加して、 `ProductsTableAdapter` (を右クリックし、`ProductsTableAdapter`クエリの追加を選択) します。</span><span class="sxs-lookup"><span data-stu-id="0ff37-185">Open the `Northwind.xsd` Typed DataSet in the `App_Code/DAL` folder and add a new method to the `ProductsTableAdapter` (right-click on the `ProductsTableAdapter` and choose Add Query).</span></span> <span data-ttu-id="0ff37-186">これにより、新しいメソッドを追加する手順を追って us TableAdapter クエリの構成ウィザードが表示されます。</span><span class="sxs-lookup"><span data-stu-id="0ff37-186">Doing so will bring up the TableAdapter Query Configuration wizard, which walks us through the process of adding the new method.</span></span> <span data-ttu-id="0ff37-187">DAL メソッドが、アドホック SQL ステートメントを使用することを示す開始します。</span><span class="sxs-lookup"><span data-stu-id="0ff37-187">Start by indicating that our DAL method will use an ad-hoc SQL statement.</span></span>


<span data-ttu-id="0ff37-188">[![アドホック SQL ステートメントを使用して、DAL メソッドを作成します。](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image31.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image30.png)</span><span class="sxs-lookup"><span data-stu-id="0ff37-188">[![Create the DAL Method Using an Ad-Hoc SQL Statement](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image31.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image30.png)</span></span>

<span data-ttu-id="0ff37-189">**図 12**: アドホック SQL ステートメントを使用して、DAL メソッドを作成 ([フルサイズのイメージを表示するをクリックして](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image32.png))</span><span class="sxs-lookup"><span data-stu-id="0ff37-189">**Figure 12**: Create the DAL Method Using an Ad-Hoc SQL Statement ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image32.png))</span></span>


<span data-ttu-id="0ff37-190">次に、ウィザードの指示に従ってに関してどのようなクエリの種類を作成することです。</span><span class="sxs-lookup"><span data-stu-id="0ff37-190">Next, the wizard prompts us as to what type of query to create.</span></span> <span data-ttu-id="0ff37-191">以降、`DiscontinueAllProductsForSupplier(supplierID)`メソッドは更新する必要があります、`Products`設定、データベース テーブル、 `Discontinued`  フィールドを指定したによって提供されるすべての製品の 1  *`supplierID`* データを更新するクエリを作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="0ff37-191">Since the `DiscontinueAllProductsForSupplier(supplierID)` method will need to update the `Products` database table, setting the `Discontinued` field to 1 for all products provided by the specified *`supplierID`*, we need to create a query that updates data.</span></span>


<span data-ttu-id="0ff37-192">[![更新クエリ タイプを選択します。](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image34.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="0ff37-192">[![Choose the UPDATE Query Type](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image34.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image33.png)</span></span>

<span data-ttu-id="0ff37-193">**図 13**: 更新クエリの種類を選択 ([フルサイズのイメージを表示するをクリックして](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image35.png))</span><span class="sxs-lookup"><span data-stu-id="0ff37-193">**Figure 13**: Choose the UPDATE Query Type ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image35.png))</span></span>


<span data-ttu-id="0ff37-194">次のウィザード画面は、TableAdapter の既存の`UPDATE`ステートメントでは、それぞれで定義されたフィールドを更新する、 `Products` DataTable です。</span><span class="sxs-lookup"><span data-stu-id="0ff37-194">The next wizard screen provides the TableAdapter's existing `UPDATE` statement, which updates each of the fields defined in the `Products` DataTable.</span></span> <span data-ttu-id="0ff37-195">このクエリのテキストを次のステートメントに置き換えます。</span><span class="sxs-lookup"><span data-stu-id="0ff37-195">Replace this query text with the following statement:</span></span>

[!code-sql[Main](adding-and-responding-to-buttons-to-a-gridview-cs/samples/sample4.sql)]

<span data-ttu-id="0ff37-196">このクエリを入力し、[次へ] をクリックして、後に、新しいメソッドの名前を使用を要求する最後のウィザード画面`DiscontinueAllProductsForSupplier`です。</span><span class="sxs-lookup"><span data-stu-id="0ff37-196">After entering this query and clicking Next, the last wizard screen asks for the new method's name use `DiscontinueAllProductsForSupplier`.</span></span> <span data-ttu-id="0ff37-197">[完了] ボタンをクリックして、ウィザードを完了します。</span><span class="sxs-lookup"><span data-stu-id="0ff37-197">Complete the wizard by clicking the Finish button.</span></span> <span data-ttu-id="0ff37-198">データセット デザイナーに戻ったときに表示されるはずで新しいメソッド、`ProductsTableAdapter`という`DiscontinueAllProductsForSupplier(@SupplierID)`です。</span><span class="sxs-lookup"><span data-stu-id="0ff37-198">Upon returning to the DataSet Designer you should see a new method in the `ProductsTableAdapter` named `DiscontinueAllProductsForSupplier(@SupplierID)`.</span></span>


<span data-ttu-id="0ff37-199">[![名前を新しい DAL メソッド DiscontinueAllProductsForSupplier](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image37.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image36.png)</span><span class="sxs-lookup"><span data-stu-id="0ff37-199">[![Name the New DAL Method DiscontinueAllProductsForSupplier](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image37.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image36.png)</span></span>

<span data-ttu-id="0ff37-200">**図 14**: 新しい DAL メソッド名前`DiscontinueAllProductsForSupplier`([フルサイズのイメージを表示するをクリックして](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image38.png))</span><span class="sxs-lookup"><span data-stu-id="0ff37-200">**Figure 14**: Name the New DAL Method `DiscontinueAllProductsForSupplier` ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image38.png))</span></span>


<span data-ttu-id="0ff37-201">`DiscontinueAllProductsForSupplier(supplierID)`を作成する、データ アクセス レイヤーで作成したメソッドを次のタスクは、`DiscontinueAllProductsForSupplier(supplierID)`ビジネス ロジック層内のメソッドです。</span><span class="sxs-lookup"><span data-stu-id="0ff37-201">With the `DiscontinueAllProductsForSupplier(supplierID)` method created in the Data Access Layer, our next task is to create the `DiscontinueAllProductsForSupplier(supplierID)` method in the Business Logic Layer.</span></span> <span data-ttu-id="0ff37-202">これを実現する、開く、`ProductsBLL`クラス ファイルと、次を追加します。</span><span class="sxs-lookup"><span data-stu-id="0ff37-202">To accomplish this, open the `ProductsBLL` class file and add the following:</span></span>

[!code-csharp[Main](adding-and-responding-to-buttons-to-a-gridview-cs/samples/sample5.cs)]

<span data-ttu-id="0ff37-203">下にこのメソッドを呼び出すだけ、`DiscontinueAllProductsForSupplier(supplierID)`メソッドに渡す提供されている、DAL *`supplierID`* パラメーターの値。</span><span class="sxs-lookup"><span data-stu-id="0ff37-203">This method simply calls down to the `DiscontinueAllProductsForSupplier(supplierID)` method in the DAL, passing along the provided *`supplierID`* parameter value.</span></span> <span data-ttu-id="0ff37-204">特定の状況で中止された業者の製品のみを実行できる任意のビジネス ルールがある場合、それらのルールを実装するここでは、BLL でします。</span><span class="sxs-lookup"><span data-stu-id="0ff37-204">If there were any business rules that only allowed a supplier's products to be discontinued under certain circumstances, those rules should be implemented here, in the BLL.</span></span>

> [!NOTE]
> <span data-ttu-id="0ff37-205">異なり、`UpdateProduct`でオーバー ロード、`ProductsBLL`クラス、`DiscontinueAllProductsForSupplier(supplierID)`メソッド シグネチャを含まない、`DataObjectMethodAttribute`属性 (`<System.ComponentModel.DataObjectMethodAttribute(System.ComponentModel.DataObjectMethodType.Update, Boolean)>`)。</span><span class="sxs-lookup"><span data-stu-id="0ff37-205">Unlike the `UpdateProduct` overloads in the `ProductsBLL` class, the `DiscontinueAllProductsForSupplier(supplierID)` method signature does not include the `DataObjectMethodAttribute` attribute (`<System.ComponentModel.DataObjectMethodAttribute(System.ComponentModel.DataObjectMethodType.Update, Boolean)>`).</span></span> <span data-ttu-id="0ff37-206">そのため、`DiscontinueAllProductsForSupplier(supplierID)`更新 タブで、ObjectDataSource のデータ ソース構成ウィザードのドロップダウン リストからメソッドです。I ve おを呼び出すためにのこの属性を省略すると、 `DiscontinueAllProductsForSupplier(supplierID)` ASP.NET ページ内のイベント ハンドラーから直接メソッドです。</span><span class="sxs-lookup"><span data-stu-id="0ff37-206">This precludes the `DiscontinueAllProductsForSupplier(supplierID)` method from the ObjectDataSource's Configure Data Source wizard's drop-down list in the UPDATE tab. I ve omitted this attribute because we'll be calling the `DiscontinueAllProductsForSupplier(supplierID)` method directly from an event handler in our ASP.NET page.</span></span>


## <a name="step-5-adding-a-discontinue-all-products-button-to-the-formview"></a><span data-ttu-id="0ff37-207">手順 5: 追加、FormView にすべての製品ボタンを中止します。</span><span class="sxs-lookup"><span data-stu-id="0ff37-207">Step 5: Adding a Discontinue All Products Button to the FormView</span></span>

<span data-ttu-id="0ff37-208">`DiscontinueAllProductsForSupplier(supplierID)` BLL と完全な DAL のメソッドは、選択した仕入先のすべての製品を中止する機能を追加するための最後の手順は FormView にボタン Web コントロールを追加する`ItemTemplate`です。</span><span class="sxs-lookup"><span data-stu-id="0ff37-208">With the `DiscontinueAllProductsForSupplier(supplierID)` method in the BLL and DAL complete, the final step for adding the ability to discontinue all products for the selected supplier is to add a Button Web control to the FormView's `ItemTemplate`.</span></span> <span data-ttu-id="0ff37-209">ボタン テキストをすべての製品の中止、業者の電話番号の下にこのようなボタンを追加してみましょう。 と`ID`のプロパティの値`DiscontinueAllProductsForSupplier`です。</span><span class="sxs-lookup"><span data-stu-id="0ff37-209">Let's add such a Button below the supplier's phone number with the button text, Discontinue All Products and an `ID` property value of `DiscontinueAllProductsForSupplier`.</span></span> <span data-ttu-id="0ff37-210">FormView のスマート タグにテンプレートの編集リンクをクリックして、デザイナーでは、このボタン Web コントロールを追加できます (図 15 を参照)、または宣言の構文を直接使用します。</span><span class="sxs-lookup"><span data-stu-id="0ff37-210">You can add this Button Web control through the Designer by clicking on the Edit Templates link in the FormView's smart tag (see Figure 15), or directly through the declarative syntax.</span></span>


<span data-ttu-id="0ff37-211">[![追加、FormView の ItemTemplate にすべての製品ボタン Web コントロールを中止します。](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image40.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image39.png)</span><span class="sxs-lookup"><span data-stu-id="0ff37-211">[![Add a Discontinue All Products Button Web Control to the FormView s ItemTemplate](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image40.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image39.png)</span></span>

<span data-ttu-id="0ff37-212">**図 15**: を中止するすべての製品ボタン Web コントロールを追加 FormView の`ItemTemplate`([フルサイズのイメージを表示するをクリックして](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image41.png))</span><span class="sxs-lookup"><span data-stu-id="0ff37-212">**Figure 15**: Add a Discontinue All Products Button Web Control to the FormView's `ItemTemplate` ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image41.png))</span></span>


<span data-ttu-id="0ff37-213">ページ ポストバックに陥りますユーザーにアクセスして、FormView のボタンがクリックされたときに[`ItemCommand`イベント](https://msdn.microsoft.com/library/system.web.ui.webcontrols.formview.itemcommand.aspx)発生します。</span><span class="sxs-lookup"><span data-stu-id="0ff37-213">When the Button is clicked by a user visiting the page, a postback ensues and the FormView's [`ItemCommand` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.formview.itemcommand.aspx) fires.</span></span> <span data-ttu-id="0ff37-214">カスタム コードを実行するには、このボタンをクリックしてに応答するには、ことができます、このイベントのイベント ハンドラーを作成します。</span><span class="sxs-lookup"><span data-stu-id="0ff37-214">To execute custom code in response to this Button being clicked, we can create an event handler for this event.</span></span> <span data-ttu-id="0ff37-215">点に注意して、ただし、`ItemCommand`イベントが発生するたびに*任意*FormView でボタン、LinkButton、ImageButton Web コントロールをクリックします。</span><span class="sxs-lookup"><span data-stu-id="0ff37-215">Understand, though, that the `ItemCommand` event fires whenever *any* Button, LinkButton, or ImageButton Web control is clicked within the FormView.</span></span> <span data-ttu-id="0ff37-216">つまり、ユーザーが 1 つのページ、フォーム ビュー内の別に移動すると、`ItemCommand`イベントの起動以外の同じユーザーが、編集、新規をクリックするか、挿入、更新、または削除をサポートするフォーム ビューを削除します。</span><span class="sxs-lookup"><span data-stu-id="0ff37-216">That means that when the user moves from one page to another in the FormView, the `ItemCommand` event fires; same thing when the user clicks New, Edit, or Delete in a FormView that supports inserting, updating, or deleting.</span></span>

<span data-ttu-id="0ff37-217">以降、`ItemCommand`イベント ハンドラーお必要があるすべての製品の中止 ボタンがクリックしてされたかどうかを決定する方法、またはその他のいくつかのボタンが、どのようなボタンがクリックされたに関係なく発生します。</span><span class="sxs-lookup"><span data-stu-id="0ff37-217">Since the `ItemCommand` fires regardless of what button is clicked, in the event handler we need a way to determine if the Discontinue All Products Button was clicked or if it was some other button.</span></span> <span data-ttu-id="0ff37-218">これを実現する、設定できるボタン Web コントロールの`CommandName`プロパティを識別するいくつかの値にします。</span><span class="sxs-lookup"><span data-stu-id="0ff37-218">To accomplish this, we can set the Button Web control's `CommandName` property to some identifying value.</span></span> <span data-ttu-id="0ff37-219">ときに、ボタンがクリックされた、この`CommandName`に値が渡された、`ItemCommand`すべての製品の中止 ボタンがクリックされたボタンをしたかどうかを判断することを有効にすると、イベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="0ff37-219">When the Button is clicked, this `CommandName` value is passed into the `ItemCommand` event handler, enabling us to determine whether the Discontinue All Products Button was the button clicked.</span></span> <span data-ttu-id="0ff37-220">設定を中止するすべての製品ボタンの`CommandName`DiscontinueProducts するプロパティです。</span><span class="sxs-lookup"><span data-stu-id="0ff37-220">Set the Discontinue All Products Button's `CommandName` property to DiscontinueProducts .</span></span>

<span data-ttu-id="0ff37-221">最後に、説明を使用して、クライアント側の確認 ダイアログ ボックス、ユーザーが選択されている、業者の商品を中止するどうしても必要があります。</span><span class="sxs-lookup"><span data-stu-id="0ff37-221">Finally, let's use a client-side confirm dialog box to ensure that the user really wants to discontinue the selected supplier's products.</span></span> <span data-ttu-id="0ff37-222">示したように、[削除時にクライアント側の確認を追加する](../editing-inserting-and-deleting-data/adding-client-side-confirmation-when-deleting-cs.md)チュートリアルでは、これは JavaScript のビットを使用して実行できます。</span><span class="sxs-lookup"><span data-stu-id="0ff37-222">As we saw in the [Adding Client-Side Confirmation When Deleting](../editing-inserting-and-deleting-data/adding-client-side-confirmation-when-deleting-cs.md) tutorial, this can be accomplished with a bit of JavaScript.</span></span> <span data-ttu-id="0ff37-223">具体的には、ボタンの Web コントロールの OnClientClick プロパティに設定します。 `return confirm('This will mark _all_ of this supplier\'s products as discontinued. Are you certain you want to do this?');`</span><span class="sxs-lookup"><span data-stu-id="0ff37-223">In particular, set the Button Web control's OnClientClick property to `return confirm('This will mark _all_ of this supplier\'s products as discontinued. Are you certain you want to do this?');`</span></span>

<span data-ttu-id="0ff37-224">これらの変更を加えたら、フォーム ビューの宣言の構文は次のようになります。</span><span class="sxs-lookup"><span data-stu-id="0ff37-224">After making these changes, the FormView's declarative syntax should look like the following:</span></span>

[!code-aspx[Main](adding-and-responding-to-buttons-to-a-gridview-cs/samples/sample6.aspx)]

<span data-ttu-id="0ff37-225">FormView のイベント ハンドラーを次に、作成`ItemCommand`イベント。</span><span class="sxs-lookup"><span data-stu-id="0ff37-225">Next, create an event handler for the FormView's `ItemCommand` event.</span></span> <span data-ttu-id="0ff37-226">このイベント ハンドラーでは、最初にすべての製品の中止 ボタンがクリックしてされたかどうかを確認する必要があります。</span><span class="sxs-lookup"><span data-stu-id="0ff37-226">In this event handler we need to first determine whether the Discontinue All Products Button was clicked.</span></span> <span data-ttu-id="0ff37-227">インスタンスを作成するため場合、`ProductsBLL`クラスし、呼び出し、`DiscontinueAllProductsForSupplier(supplierID)`に渡して、メソッド、`SupplierID`選択 FormView の。</span><span class="sxs-lookup"><span data-stu-id="0ff37-227">If so, we want to create an instance of the `ProductsBLL` class and invoke its `DiscontinueAllProductsForSupplier(supplierID)` method, passing in the `SupplierID` of the selected FormView:</span></span>

[!code-csharp[Main](adding-and-responding-to-buttons-to-a-gridview-cs/samples/sample7.cs)]

<span data-ttu-id="0ff37-228">なお、 `SupplierID` FormView で現在選択されている仕入先のことができますを使用してアクセス FormView の[`SelectedValue`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.formview.selectedvalue.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="0ff37-228">Note that the `SupplierID` of the current selected supplier in the FormView can be accessed using the FormView's [`SelectedValue` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.formview.selectedvalue.aspx).</span></span> <span data-ttu-id="0ff37-229">`SelectedValue`プロパティは、最初のデータ、フォーム ビューに表示されているレコードの値のキーを返します。</span><span class="sxs-lookup"><span data-stu-id="0ff37-229">The `SelectedValue` property returns the first data key value for the record being displayed in the FormView.</span></span> <span data-ttu-id="0ff37-230">FormView の[`DataKeyNames`プロパティ](https://msdn.microsoft.com/system.web.ui.webcontrols.formview.datakeynames.aspx)に自動的に設定されたフィールドのデータを元には、キーの値からプルされたデータを示す`SupplierID`FormView に、ObjectDataSource をバインドするときに、Visual Studio で手順 2 に戻ります.</span><span class="sxs-lookup"><span data-stu-id="0ff37-230">The FormView's [`DataKeyNames` property](https://msdn.microsoft.com/system.web.ui.webcontrols.formview.datakeynames.aspx), which indicates the data fields from which the data key values are pulled from, was automatically set to `SupplierID` by Visual Studio when binding the ObjectDataSource to the FormView back in Step 2.</span></span>

<span data-ttu-id="0ff37-231">`ItemCommand`作成されると、イベント ハンドラーをとって、ページをテストします。</span><span class="sxs-lookup"><span data-stu-id="0ff37-231">With the `ItemCommand` event handler created, take a moment to test out the page.</span></span> <span data-ttu-id="0ff37-232">Cooperativa de Quesos する参照 ' Las Cabras' supplier (私にとって FormView で業者に 5 つ目は)。</span><span class="sxs-lookup"><span data-stu-id="0ff37-232">Browse to the Cooperativa de Quesos 'Las Cabras' supplier (it's the fifth supplier in the FormView for me).</span></span> <span data-ttu-id="0ff37-233">この供給業者は、2 つの製品、Queso Cabrales と Queso Manchego La Pastora、どちらも*いない*廃止されました。</span><span class="sxs-lookup"><span data-stu-id="0ff37-233">This supplier provides two products, Queso Cabrales and Queso Manchego La Pastora, both of which are *not* discontinued.</span></span>

<span data-ttu-id="0ff37-234">Cooperativa de Quesos ' Las Cabras' が外に出てもビジネスとそのため、製品がある中止を想像してください。</span><span class="sxs-lookup"><span data-stu-id="0ff37-234">Imagine that Cooperativa de Quesos 'Las Cabras' has gone out of business and therefore its products are to be discontinued.</span></span> <span data-ttu-id="0ff37-235">クリックして、すべての製品ボタンを中止します。</span><span class="sxs-lookup"><span data-stu-id="0ff37-235">Click the Discontinue All Products Button.</span></span> <span data-ttu-id="0ff37-236">クライアント側の確認ダイアログが表示されます (図 16 を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="0ff37-236">This will display the client-side confirm dialog box (see Figure 16).</span></span>


<span data-ttu-id="0ff37-237">[![Cooperativa de Quesos Las Cabras 装置 2 つのアクティブな製品](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image43.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image42.png)</span><span class="sxs-lookup"><span data-stu-id="0ff37-237">[![Cooperativa de Quesos Las Cabras Supplies Two Active Products](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image43.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image42.png)</span></span>

<span data-ttu-id="0ff37-238">**図 16**: Cooperativa de Quesos Las Cabras 装置 2 つのアクティブな製品 ([フルサイズのイメージを表示するをクリックして](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image44.png))</span><span class="sxs-lookup"><span data-stu-id="0ff37-238">**Figure 16**: Cooperativa de Quesos Las Cabras Supplies Two Active Products ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image44.png))</span></span>


<span data-ttu-id="0ff37-239">クライアント側の確認 ダイアログ ボックスで ok をクリックすると、フォームの送信は続行、ポストバックをもたらす FormView の`ItemCommand`イベントが発生します。</span><span class="sxs-lookup"><span data-stu-id="0ff37-239">If you click OK in the client-side confirm dialog box, the form submission will proceed, causing a postback in which the FormView's `ItemCommand` event will fire.</span></span> <span data-ttu-id="0ff37-240">作成したイベント ハンドラーは実行、呼び出し、`DiscontinueAllProductsForSupplier(supplierID)`メソッドおよび Queso Cabrales と Queso Manchego La Pastora の両方の製品を中止します。</span><span class="sxs-lookup"><span data-stu-id="0ff37-240">The event handler we created will then execute, invoking the `DiscontinueAllProductsForSupplier(supplierID)` method and discontinuing both the Queso Cabrales and Queso Manchego La Pastora products.</span></span>

<span data-ttu-id="0ff37-241">GridView のビュー ステートを無効にした場合、GridView はポストバックのたびに基になるデータ ストアに再バインドされているし、そのためするこれら 2 つの製品は、廃止されました (図 17 を参照してください) を反映するためにすぐに更新されます。</span><span class="sxs-lookup"><span data-stu-id="0ff37-241">If you have disabled the GridView's view state, the GridView is being rebound to the underlying data store on every postback, and therefore will immediately be updated to reflect that these two products are now discontinued (see Figure 17).</span></span> <span data-ttu-id="0ff37-242">ただし、GridView での表示状態に無効にしたはない場合は、この変更を行った後 GridView にデータを手動で再バインドする必要があります。</span><span class="sxs-lookup"><span data-stu-id="0ff37-242">If, however, you have not disabled view state in the GridView, you will need to manually rebind the data to the GridView after making this change.</span></span> <span data-ttu-id="0ff37-243">これを実現する GridView の呼び出しを行うだけで`DataBind()`メソッドの呼び出し後にすぐに、`DiscontinueAllProductsForSupplier(supplierID)`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="0ff37-243">To accomplish this, simply make a call to the GridView's `DataBind()` method immediately after invoking the `DiscontinueAllProductsForSupplier(supplierID)` method.</span></span>


<span data-ttu-id="0ff37-244">[![すべての製品の中止 ボタンをクリックすると、業者 s は、製品が適宜更新](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image46.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image45.png)</span><span class="sxs-lookup"><span data-stu-id="0ff37-244">[![After Clicking the Discontinue All Products Button, the Supplier s Products are Updated Accordingly](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image46.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image45.png)</span></span>

<span data-ttu-id="0ff37-245">**図 17**: 供給業者の商品をそれに従って更新はすべての製品の中止 ボタンをクリックすると、([フルサイズのイメージを表示するをクリックして](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image47.png))</span><span class="sxs-lookup"><span data-stu-id="0ff37-245">**Figure 17**: After Clicking the Discontinue All Products Button, the Supplier's Products are Updated Accordingly ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image47.png))</span></span>


## <a name="step-6-creating-an-updateproduct-overload-in-the-business-logic-layer-for-adjusting-a-products-price"></a><span data-ttu-id="0ff37-246">手順 6: 製品の価格を調整するためのビジネス ロジック層で UpdateProduct オーバー ロードを作成します。</span><span class="sxs-lookup"><span data-stu-id="0ff37-246">Step 6: Creating an UpdateProduct Overload in the Business Logic Layer for Adjusting a Product's Price</span></span>

<span data-ttu-id="0ff37-247">同様を中止するすべての製品ボタンで、フォーム ビューの拡大と縮小 GridView で製品の価格のボタンを追加するために必要があります最初に、適切なデータ アクセス層とビジネス ロジック層のメソッドを追加します。</span><span class="sxs-lookup"><span data-stu-id="0ff37-247">Like with the Discontinue All Products Button in the FormView, in order to add buttons for increasing and decreasing the price for a product in the GridView we need to first add the appropriate Data Access Layer and Business Logic Layer methods.</span></span> <span data-ttu-id="0ff37-248">DAL で 1 つの製品の行を更新するメソッドが既にある、ためこのような機能の新しいオーバー ロードを作成することで提供できます、 `UpdateProduct` BLL 内のメソッドです。</span><span class="sxs-lookup"><span data-stu-id="0ff37-248">Since we already have a method that updates a single product row in the DAL, we can provide such functionality by creating a new overload for the `UpdateProduct` method in the BLL.</span></span>

<span data-ttu-id="0ff37-249">以前は、`UpdateProduct`スカラーの入力値として製品フィールドのいくつかの組み合わせで取得したし、指定された製品のフィールドだけを更新し、オーバー ロードします。</span><span class="sxs-lookup"><span data-stu-id="0ff37-249">Our past `UpdateProduct` overloads have taken in some combination of product fields as scalar input values and have then updated just those fields for the specified product.</span></span> <span data-ttu-id="0ff37-250">このオーバー ロードのためには、この標準は若干異なります、製品の代わりに渡すお行います`ProductID`、割合を調整する、 `UnitPrice` (新しいに渡すこととは対照的調整`UnitPrice`自体)。</span><span class="sxs-lookup"><span data-stu-id="0ff37-250">For this overload we'll vary slightly from this standard and instead pass in the product's `ProductID` and the percentage by which to adjust the `UnitPrice` (as opposed to passing in the new, adjusted `UnitPrice` itself).</span></span> <span data-ttu-id="0ff37-251">このアプローチには、現在の製品を判断するに気にする必要はないために、ASP.NET ページの分離コード クラスで記述する必要のあるコードが簡略化`UnitPrice`です。</span><span class="sxs-lookup"><span data-stu-id="0ff37-251">This approach will simplify the code we need to write in the ASP.NET page code-behind class, since we don't have to bother with determining the current product's `UnitPrice`.</span></span>

<span data-ttu-id="0ff37-252">`UpdateProduct`オーバー ロードのため、このチュートリアルを次に示します。</span><span class="sxs-lookup"><span data-stu-id="0ff37-252">The `UpdateProduct` overload for this tutorial is shown below:</span></span>

[!code-csharp[Main](adding-and-responding-to-buttons-to-a-gridview-cs/samples/sample8.cs)]

<span data-ttu-id="0ff37-253">このオーバー ロードは、DAL のを通じて指定された製品に関する情報を取得`GetProductByProductID(productID)`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="0ff37-253">This overload retrieves information about the specified product through the DAL's `GetProductByProductID(productID)` method.</span></span> <span data-ttu-id="0ff37-254">これは、後かを確認するかどうか、製品の`UnitPrice`データベースが割り当てられている`NULL`値。</span><span class="sxs-lookup"><span data-stu-id="0ff37-254">It then checks to see whether the product's `UnitPrice` is assigned a database `NULL` value.</span></span> <span data-ttu-id="0ff37-255">価格はままになっている場合は、変更されていません。</span><span class="sxs-lookup"><span data-stu-id="0ff37-255">If it is, the price is left unaltered.</span></span> <span data-ttu-id="0ff37-256">ただし、あるない場合は、`NULL` `UnitPrice`値、メソッドが、製品の更新プログラム`UnitPrice`指定 % (`unitPriceAdjustmentPercent`)。</span><span class="sxs-lookup"><span data-stu-id="0ff37-256">If, however, there is a non-`NULL` `UnitPrice` value, the method updates the product's `UnitPrice` by the specified percent (`unitPriceAdjustmentPercent`).</span></span>

## <a name="step-7-adding-the-increase-and-decrease-buttons-to-the-gridview"></a><span data-ttu-id="0ff37-257">手順 7: GridView の増加と縮小ボタンの追加</span><span class="sxs-lookup"><span data-stu-id="0ff37-257">Step 7: Adding the Increase and Decrease Buttons to the GridView</span></span>

<span data-ttu-id="0ff37-258">GridView (および DetailsView) は両方の構成されて、フィールドのコレクション。</span><span class="sxs-lookup"><span data-stu-id="0ff37-258">The GridView (and DetailsView) are both made up of a collection of fields.</span></span> <span data-ttu-id="0ff37-259">BoundFields、CheckBoxFields、および TemplateFields、に加えては、ASP.NET には、その名前からわかるように、ボタン、LinkButton、ImageButton に行ごとの列として表示すると、ButtonField が含まれています。</span><span class="sxs-lookup"><span data-stu-id="0ff37-259">In addition to BoundFields, CheckBoxFields, and TemplateFields, ASP.NET includes the ButtonField, which, as its name implies, renders as a column with a Button, LinkButton, or ImageButton for each row.</span></span> <span data-ttu-id="0ff37-260">クリックすると、フォーム ビューのような*任意*内、GridView ページング ボタン、編集または削除のボタン、並べ替えボタンは、ボタンは、ポストバックが発生させ、GridView の[`RowCommand`イベント](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.rowcommand.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="0ff37-260">Similar to the FormView, clicking *any* button within the GridView paging buttons, Edit or Delete buttons, sorting buttons, and so on causes a postback and raises the GridView's [`RowCommand` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.rowcommand.aspx).</span></span>

<span data-ttu-id="0ff37-261">ButtonField が、`CommandName`そのボタンのそれぞれに、指定された値を割り当てるプロパティ`CommandName`プロパティです。</span><span class="sxs-lookup"><span data-stu-id="0ff37-261">The ButtonField has a `CommandName` property that assigns the specified value to each of its Buttons `CommandName` properties.</span></span> <span data-ttu-id="0ff37-262">FormView、使用するような`CommandName`によって値が使用される、`RowCommand`イベント ハンドラー ボタンがクリックしてされました。</span><span class="sxs-lookup"><span data-stu-id="0ff37-262">Like with the FormView, the `CommandName` value is used by the `RowCommand` event handler to determine which button was clicked.</span></span>

<span data-ttu-id="0ff37-263">ボタン テキスト価格 +10 いずれかの GridView に 2 つの新しい ButtonFields を追加してみましょう。 % および価格-10 テキストと、その他の % です。</span><span class="sxs-lookup"><span data-stu-id="0ff37-263">Let's add two new ButtonFields to the GridView, one with a button text Price +10% and the other with the text Price -10%.</span></span> <span data-ttu-id="0ff37-264">これら ButtonFields を追加するには、[GridView のスマート タグの表示から列の編集リンクをクリックして左上にある一覧から ButtonField フィールドの種類を選択して追加] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="0ff37-264">To add these ButtonFields, click on the Edit Columns link from the GridView's smart tag, select the ButtonField field type from the list in the upper left and click the Add button.</span></span>


![GridView に 2 つの ButtonFields を追加します。](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image48.png)

<span data-ttu-id="0ff37-266">**図 18**: GridView に 2 つの ButtonFields を追加</span><span class="sxs-lookup"><span data-stu-id="0ff37-266">**Figure 18**: Add Two ButtonFields to the GridView</span></span>


<span data-ttu-id="0ff37-267">最初の 2 つの GridView フィールドとして表示されるようにするには、2 つの ButtonFields を移動します。</span><span class="sxs-lookup"><span data-stu-id="0ff37-267">Move the two ButtonFields so that they appear as the first two GridView fields.</span></span> <span data-ttu-id="0ff37-268">次に、設定、`Text`プロパティ + 10% の価格を設定するこれら 2 つの ButtonFields および価格-10% と`CommandName`IncreasePrice および DecreasePrice、プロパティをそれぞれします。</span><span class="sxs-lookup"><span data-stu-id="0ff37-268">Next, set the `Text` properties of these two ButtonFields to Price +10% and Price -10% and the `CommandName` properties to IncreasePrice and DecreasePrice, respectively.</span></span> <span data-ttu-id="0ff37-269">既定では、ButtonField は、あるとしてその列のボタンをレンダリングします。</span><span class="sxs-lookup"><span data-stu-id="0ff37-269">By default, a ButtonField renders its column of buttons as LinkButtons.</span></span> <span data-ttu-id="0ff37-270">これは、ただし、ButtonField の[`ButtonType`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.buttonfieldbase.buttontype.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="0ff37-270">This can be changed, however, through the ButtonField's [`ButtonType` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.buttonfieldbase.buttontype.aspx).</span></span> <span data-ttu-id="0ff37-271">これら 2 つの ButtonFields 正規プッシュ ボタンとしてレンダリングされますがあてみましょうこのため、設定、`ButtonType`プロパティを`Button`です。</span><span class="sxs-lookup"><span data-stu-id="0ff37-271">Let's have these two ButtonFields rendered as regular push buttons; therefore, set the `ButtonType` property to `Button`.</span></span> <span data-ttu-id="0ff37-272">図 19 フィールドに表示 ダイアログ ボックス後、これらの変更が加えられました。GridView の宣言型マークアップは、次のことです。</span><span class="sxs-lookup"><span data-stu-id="0ff37-272">Figure 19 shows the Fields dialog box after these changes have been made; following that is the GridView's declarative markup.</span></span>


![ButtonFields テキスト、CommandName、および ButtonType プロパティを構成します。](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image49.png)

<span data-ttu-id="0ff37-274">**図 19**: 構成、ButtonFields `Text`、 `CommandName`、および`ButtonType`プロパティ</span><span class="sxs-lookup"><span data-stu-id="0ff37-274">**Figure 19**: Configure the ButtonFields `Text`, `CommandName`, and `ButtonType` Properties</span></span>


[!code-aspx[Main](adding-and-responding-to-buttons-to-a-gridview-cs/samples/sample9.aspx)]

<span data-ttu-id="0ff37-275">これら ButtonFields を作成すると、使用は、最後の手順を gridview のイベント ハンドラーを作成し`RowCommand`イベント。</span><span class="sxs-lookup"><span data-stu-id="0ff37-275">With these ButtonFields created, the final step is to create an event handler for the GridView's `RowCommand` event.</span></span> <span data-ttu-id="0ff37-276">発生した場合、このイベント ハンドラー、価格 +10% または価格-10% ボタンがクリックすると、確認する必要があります、`ProductID`持つボタンがクリックしてされたを呼び出す行の`ProductsBLL`クラスの`UpdateProduct`適切なに渡して、メソッド`UnitPrice`と共に割合の調整、`ProductID`です。</span><span class="sxs-lookup"><span data-stu-id="0ff37-276">This event handler, if fired because either the Price +10% or Price -10% buttons were clicked, needs to determine the `ProductID` for the row whose button was clicked and then invoke the `ProductsBLL` class's `UpdateProduct` method, passing in the appropriate `UnitPrice` percentage adjustment along with the `ProductID`.</span></span> <span data-ttu-id="0ff37-277">次のコードでは、これらのタスクを実行します。</span><span class="sxs-lookup"><span data-stu-id="0ff37-277">The following code performs these tasks:</span></span>

[!code-csharp[Main](adding-and-responding-to-buttons-to-a-gridview-cs/samples/sample10.cs)]

<span data-ttu-id="0ff37-278">判断するため、`ProductID`行の価格が +10% または価格-10% ボタンがクリックされ、GridView を参照する必要があります`DataKeys`コレクション。</span><span class="sxs-lookup"><span data-stu-id="0ff37-278">In order to determine the `ProductID` for the row whose Price +10% or Price -10% button was clicked, we need to consult the GridView's `DataKeys` collection.</span></span> <span data-ttu-id="0ff37-279">このコレクションで指定されたフィールドの値を保持する、 `DataKeyNames` GridView の行ごとのプロパティです。</span><span class="sxs-lookup"><span data-stu-id="0ff37-279">This collection holds the values of the fields specified in the `DataKeyNames` property for each GridView row.</span></span> <span data-ttu-id="0ff37-280">GridView の以降`DataKeyNames`プロパティは、Visual Studio によって、ObjectDataSource を GridView にバインドする場合で、ProductID に設定された`DataKeys(rowIndex).Value`提供、 `ProductID` 、指定された*rowIndex*です。</span><span class="sxs-lookup"><span data-stu-id="0ff37-280">Since the GridView's `DataKeyNames` property was set to ProductID by Visual Studio when binding the ObjectDataSource to the GridView, `DataKeys(rowIndex).Value` provides the `ProductID` for the specified *rowIndex*.</span></span>

<span data-ttu-id="0ff37-281">ButtonField が自動的に渡されます、 *rowIndex*経由のボタンがクリックされた行の`e.CommandArgument`パラメーター。</span><span class="sxs-lookup"><span data-stu-id="0ff37-281">The ButtonField automatically passes in the *rowIndex* of the row whose button was clicked through the `e.CommandArgument` parameter.</span></span> <span data-ttu-id="0ff37-282">したがってを決定する、`ProductID`行の価格が +10% または価格-10% ボタンがクリックされたを使用します:`Convert.ToInt32(SuppliersProducts.DataKeys(Convert.ToInt32(e.CommandArgument)).Value)`です。</span><span class="sxs-lookup"><span data-stu-id="0ff37-282">Therefore, to determine the `ProductID` for the row whose Price +10% or Price -10% button was clicked, we use: `Convert.ToInt32(SuppliersProducts.DataKeys(Convert.ToInt32(e.CommandArgument)).Value)`.</span></span>

<span data-ttu-id="0ff37-283">すべての製品の中止 ボタンで GridView のビューステートを無効にした場合 GridView ポストバックのたびに基になるデータ ストアに再バインドされているし、そのため、クリックしてから発生する料金変更を反映するためにすぐに更新されます。ボタンのいずれか。</span><span class="sxs-lookup"><span data-stu-id="0ff37-283">As with the Discontinue All Products button, if you have disabled the GridView's view state, the GridView is being rebound to the underlying data store on every postback, and therefore will immediately be updated to reflect a price change that occurs from clicking either of the buttons.</span></span> <span data-ttu-id="0ff37-284">ただし、GridView での表示状態に無効にしたはない場合は、この変更を行った後 GridView にデータを手動で再バインドする必要があります。</span><span class="sxs-lookup"><span data-stu-id="0ff37-284">If, however, you have not disabled view state in the GridView, you will need to manually rebind the data to the GridView after making this change.</span></span> <span data-ttu-id="0ff37-285">これを実現する GridView の呼び出しを行うだけで`DataBind()`メソッドの呼び出し後にすぐに、`UpdateProduct`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="0ff37-285">To accomplish this, simply make a call to the GridView's `DataBind()` method immediately after invoking the `UpdateProduct` method.</span></span>

<span data-ttu-id="0ff37-286">図 20 は、おばあちゃん Kelly Homestead によって提供される製品を表示するときに、ページを示します。</span><span class="sxs-lookup"><span data-stu-id="0ff37-286">Figure 20 shows the page when viewing the products provided by Grandma Kelly's Homestead.</span></span> <span data-ttu-id="0ff37-287">図 21 は、% ボタンがクリックされたおばあちゃんの果汁 100% の分散され、価格-10% ボタンを 2 回クリック 1 回ピリピリの価格 +10 の後に結果を示します。</span><span class="sxs-lookup"><span data-stu-id="0ff37-287">Figure 21 shows the results after the Price +10% button has been clicked twice for Grandma's Boysenberry Spread and the Price -10% button once for Northwoods Cranberry Sauce.</span></span>


<span data-ttu-id="0ff37-288">[![GridView には、価格 +10 が含まれています % と価格-10% ボタン。](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image51.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image50.png)</span><span class="sxs-lookup"><span data-stu-id="0ff37-288">[![The GridView Includes Price +10% and Price -10% Buttons](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image51.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image50.png)</span></span>

<span data-ttu-id="0ff37-289">**図 20**: GridView 含まれるの Price + 10% と価格-10% ボタン ([フルサイズのイメージを表示する をクリックします](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image52.png))。</span><span class="sxs-lookup"><span data-stu-id="0ff37-289">**Figure 20**: The GridView Includes Price +10% and Price -10% Buttons ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image52.png))</span></span>


<span data-ttu-id="0ff37-290">[![最初と 3 番目の製品の価格は、価格 +10 経由で更新されている % と価格-10% ボタン](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image54.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image53.png)</span><span class="sxs-lookup"><span data-stu-id="0ff37-290">[![The Prices for the First and Third Product Have Been Updated via the Price +10% and Price -10% Buttons](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image54.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image53.png)</span></span>

<span data-ttu-id="0ff37-291">**図 21**:、価格の最初と 3 番目製品によって更新される価格 +10% と価格-10% ボタン ([フルサイズのイメージを表示するをクリックして](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image55.png))</span><span class="sxs-lookup"><span data-stu-id="0ff37-291">**Figure 21**: The Prices for the First and Third Product Have Been Updated via the Price +10% and Price -10% Buttons ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image55.png))</span></span>


> [!NOTE]
> <span data-ttu-id="0ff37-292">ボタン、ある、またはその TemplateFields に追加された ImageButtons GridView (および DetailsView) こともできます。</span><span class="sxs-lookup"><span data-stu-id="0ff37-292">The GridView (and DetailsView) can also have Buttons, LinkButtons, or ImageButtons added to their TemplateFields.</span></span> <span data-ttu-id="0ff37-293">GridView を発生させるように、BoundField をクリックすると、これらのボタンはポストバックが引き起こされる、`RowCommand`イベント。</span><span class="sxs-lookup"><span data-stu-id="0ff37-293">As with the BoundField, these Buttons, when clicked, will induce a postback, raising the GridView's `RowCommand` event.</span></span> <span data-ttu-id="0ff37-294">ときに追加のボタンをクリックして TemplateField、ただし、ボタンの`CommandArgument`が自動的に設定されていない行のインデックスを ButtonFields を使用しているときもします。</span><span class="sxs-lookup"><span data-stu-id="0ff37-294">When adding buttons in a TemplateField, however, the Button's `CommandArgument` is not automatically set to the index of the row as it is when using ButtonFields.</span></span> <span data-ttu-id="0ff37-295">内でクリックしてされたボタンの行インデックスを確認する必要がある場合、 `RowCommand` 、イベント ハンドラー ボタンを手動で設定する必要があります`CommandArgument`のようなコードを使用して、TemplateField 内でその宣言の構文でのプロパティ。</span><span class="sxs-lookup"><span data-stu-id="0ff37-295">If you need to determine the row index of the button that was clicked within the `RowCommand` event handler, you'll need to manually set the Button's `CommandArgument` property in its declarative syntax within the TemplateField, using code like:</span></span>  
> <span data-ttu-id="0ff37-296">`<asp:Button runat="server" ... CommandArgument='<%# ((GridViewRow) Container).RowIndex %>'`。</span><span class="sxs-lookup"><span data-stu-id="0ff37-296">`<asp:Button runat="server" ... CommandArgument='<%# ((GridViewRow) Container).RowIndex %>'`.</span></span>


## <a name="summary"></a><span data-ttu-id="0ff37-297">まとめ</span><span class="sxs-lookup"><span data-stu-id="0ff37-297">Summary</span></span>

<span data-ttu-id="0ff37-298">GridView、DetailsView、FormView コントロールすべてには、ボタン、ある、または ImageButtons を含めることができます。</span><span class="sxs-lookup"><span data-stu-id="0ff37-298">The GridView, DetailsView, and FormView controls all can include Buttons, LinkButtons, or ImageButtons.</span></span> <span data-ttu-id="0ff37-299">クリックすると、このようなボタンがポストバックを発生させるし、生成、 `ItemCommand` 、FormView および DetailsView コントロール内のイベントと`RowCommand`GridView でイベント。</span><span class="sxs-lookup"><span data-stu-id="0ff37-299">Such buttons, when clicked, cause a postback and raise the `ItemCommand` event in the FormView and DetailsView controls and the `RowCommand` event in the GridView.</span></span> <span data-ttu-id="0ff37-300">これらの Web コントロールのデータには、削除するか、レコードの編集など、共通のコマンドに関連するアクションを処理する組み込みの機能があります。</span><span class="sxs-lookup"><span data-stu-id="0ff37-300">These data Web controls have built-in functionality to handle common command-related actions, such as deleting or editing records.</span></span> <span data-ttu-id="0ff37-301">ただし、おこともできますを使用してボタンをクリックしたときに、独自のカスタム コードの実行で応答します。</span><span class="sxs-lookup"><span data-stu-id="0ff37-301">However, we can also use buttons that, when clicked, respond with executing our own custom code.</span></span>

<span data-ttu-id="0ff37-302">これを実現する必要がありますのイベント ハンドラーを作成する、`ItemCommand`または`RowCommand`イベント。</span><span class="sxs-lookup"><span data-stu-id="0ff37-302">To accomplish this, we need to create an event handler for the `ItemCommand` or `RowCommand` event.</span></span> <span data-ttu-id="0ff37-303">このイベント ハンドラーで最初に確認着信`CommandName`クリックしてされたボタンを特定し、適切なカスタム アクションを実行する値。</span><span class="sxs-lookup"><span data-stu-id="0ff37-303">In this event handler we first check the incoming `CommandName` value to determine which button was clicked and then take appropriate custom action.</span></span> <span data-ttu-id="0ff37-304">このチュートリアルでは、指定された業者のすべての製品を中止するまたは、10% で、特定の製品の価格を増減するボタンと ButtonFields を使用する方法を説明しました。</span><span class="sxs-lookup"><span data-stu-id="0ff37-304">In this tutorial we saw how to use buttons and ButtonFields to discontinue all products for a specified supplier or to increase or decrease the price of a particular product by 10%.</span></span>

<span data-ttu-id="0ff37-305">満足プログラミング!</span><span class="sxs-lookup"><span data-stu-id="0ff37-305">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="0ff37-306">作成者について</span><span class="sxs-lookup"><span data-stu-id="0ff37-306">About the Author</span></span>

<span data-ttu-id="0ff37-307">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)、7 つ受け取りますブックとの創設者の作成者[4GuysFromRolla.com](http://www.4guysfromrolla.com)、1998 年からマイクロソフトの Web テクノロジで取り組んできました。</span><span class="sxs-lookup"><span data-stu-id="0ff37-307">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="0ff37-308">Scott は、コンサルタント、トレーナー、ライターとして機能します。</span><span class="sxs-lookup"><span data-stu-id="0ff37-308">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="0ff37-309">最新の著書[ *Sam 学べる自分で ASP.NET 2.0 が 24 時間以内に*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)です。</span><span class="sxs-lookup"><span data-stu-id="0ff37-309">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="0ff37-310">彼に到達できる[ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)彼のブログを使用して含まれているのか[ http://ScottOnWriting.NET](http://ScottOnWriting.NET)です。</span><span class="sxs-lookup"><span data-stu-id="0ff37-310">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="0ff37-311">次へ</span><span class="sxs-lookup"><span data-stu-id="0ff37-311">Next</span></span>](adding-and-responding-to-buttons-to-a-gridview-vb.md)
