---
uid: web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/adding-validation-controls-to-the-datalist-s-editing-interface-vb
title: DataList への検証コントロールの追加の編集インターフェイス (VB) |Microsoft ドキュメント
author: rick-anderson
description: このチュートリアルでは、DataList の後に編集 int です。 ユーザーより安全な方法で提供するために検証コントロールを追加することがいかに簡単思います.
ms.author: aspnetcontent
manager: wpickett
ms.date: 10/30/2006
ms.topic: article
ms.assetid: 6b073fc6-524d-453d-be7c-0c30986de391
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/adding-validation-controls-to-the-datalist-s-editing-interface-vb
msc.type: authoredcontent
ms.openlocfilehash: 46ff0b18c1ea24dd73c9e3034c1b5e53f2e6d0c2
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/06/2018
ms.locfileid: "30888332"
---
<a name="adding-validation-controls-to-the-datalists-editing-interface-vb"></a><span data-ttu-id="0de7e-103">DataList の編集インターフェイス (VB) への検証コントロールの追加</span><span class="sxs-lookup"><span data-stu-id="0de7e-103">Adding Validation Controls to the DataList's Editing Interface (VB)</span></span>
====================
<span data-ttu-id="0de7e-104">によって[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="0de7e-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="0de7e-105">[サンプル アプリをダウンロード](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_39_VB.exe)または[PDF のダウンロード](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/datatutorial39vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="0de7e-105">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_39_VB.exe) or [Download PDF](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/datatutorial39vb1.pdf)</span></span>

> <span data-ttu-id="0de7e-106">このチュートリアルより安全な方法で編集するユーザー インターフェイスを提供するために、DataList の後に検証コントロールを追加することがいかに簡単おが表示されます。</span><span class="sxs-lookup"><span data-stu-id="0de7e-106">In this tutorial we'll see how easy it is to add validation controls to the DataList's EditItemTemplate in order to provide a more foolproof editing user interface.</span></span>


## <a name="introduction"></a><span data-ttu-id="0de7e-107">はじめに</span><span class="sxs-lookup"><span data-stu-id="0de7e-107">Introduction</span></span>

<span data-ttu-id="0de7e-108">チュートリアルのこれまで編集 DataList、不足している製品名など、例外が負の値の価格の結果、無効なユーザー入力も事前にユーザー入力の検証の場所をこの後、Datalist インターフェイスの編集が含まれませんが。</span><span class="sxs-lookup"><span data-stu-id="0de7e-108">In the DataList editing tutorials thus far, the DataLists editing interfaces have not included any proactive user input validation even though invalid user input such as a missing product name or negative price results in an exception.</span></span> <span data-ttu-id="0de7e-109">[前のチュートリアル](handling-bll-and-dal-level-exceptions-vb.md)例外処理コード DataList s を追加する方法について説明しました`UpdateCommand`をキャッチして適切に発生した例外に関する情報を表示するためにイベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="0de7e-109">In the [preceding tutorial](handling-bll-and-dal-level-exceptions-vb.md) we examined how to add exception handling code to the DataList s `UpdateCommand` event handler in order to catch and gracefully display information about any exceptions that were raised.</span></span> <span data-ttu-id="0de7e-110">理想的には、ただし、編集のインターフェイスは追加の検証コントロールをユーザーがこのような無効なデータのため、最初に入力するを防ぐためにします。</span><span class="sxs-lookup"><span data-stu-id="0de7e-110">Ideally, however, the editing interface would include validation controls to prevent a user from entering such invalid data in the first place.</span></span>

<span data-ttu-id="0de7e-111">このチュートリアルでは会いしましょう DataList s に検証コントロールを追加することがいかに簡単`EditItemTemplate`より安全な方法で編集するユーザー インターフェイスを提供するためにします。</span><span class="sxs-lookup"><span data-stu-id="0de7e-111">In this tutorial we'll see how easy it is to add validation controls to the DataList s `EditItemTemplate` in order to provide a more foolproof editing user interface.</span></span> <span data-ttu-id="0de7e-112">具体的には、このチュートリアルでは、前のチュートリアルで作成された例を受け取るし、適切な検証を追加、編集のインターフェイスを拡張します。</span><span class="sxs-lookup"><span data-stu-id="0de7e-112">Specifically, this tutorial takes the example created in the preceding tutorial and augments the editing interface to include appropriate validation.</span></span>

## <a name="step-1-replicating-the-example-fromhandling-bll--and-dal-level-exceptionshandling-bll-and-dal-level-exceptions-vbmd"></a><span data-ttu-id="0de7e-113">手順 1: から例をレプリケートする[BLL および DAL レベルの例外処理](handling-bll-and-dal-level-exceptions-vb.md)</span><span class="sxs-lookup"><span data-stu-id="0de7e-113">Step 1: Replicating the Example from[Handling BLL- and DAL-Level Exceptions](handling-bll-and-dal-level-exceptions-vb.md)</span></span>

<span data-ttu-id="0de7e-114">[処理 BLL および DAL レベルの例外](handling-bll-and-dal-level-exceptions-vb.md)名前と 2 つの列に、編集できる DataList では、製品の価格を表示するページを作成したチュートリアルです。</span><span class="sxs-lookup"><span data-stu-id="0de7e-114">In the [Handling BLL- and DAL-Level Exceptions](handling-bll-and-dal-level-exceptions-vb.md) tutorial we created a page that listed the names and prices of the products in a two-column, editable DataList.</span></span> <span data-ttu-id="0de7e-115">このチュートリアルの目標は、検証コントロールを追加するには、DataList s 編集インターフェイスを強化することです。</span><span class="sxs-lookup"><span data-stu-id="0de7e-115">Our goal for this tutorial is to augment the DataList s editing interface to include validation controls.</span></span> <span data-ttu-id="0de7e-116">具体的には、この検証ロジックを行います。</span><span class="sxs-lookup"><span data-stu-id="0de7e-116">In particular, our validation logic will:</span></span>

- <span data-ttu-id="0de7e-117">製品の名前を指定することが必要</span><span class="sxs-lookup"><span data-stu-id="0de7e-117">Require that the product s name be provided</span></span>
- <span data-ttu-id="0de7e-118">価格の値が有効な通貨の形式であることを確認します。</span><span class="sxs-lookup"><span data-stu-id="0de7e-118">Ensure that the value entered for the price is a valid currency format</span></span>
- <span data-ttu-id="0de7e-119">価格がより大きいか等しいには、0、負の値から入力された値を確認してください`UnitPrice`値は無効です</span><span class="sxs-lookup"><span data-stu-id="0de7e-119">Ensure that the value entered for the price is greater than or equal to zero, since a negative `UnitPrice` value is illegal</span></span>

<span data-ttu-id="0de7e-120">最初の例をレプリケートする必要があります拡張検証をインクルードする前の例で見ることができます、前に、 `ErrorHandling.aspx`  ページで、`EditDeleteDataList`このチュートリアルでは、ページをフォルダー`UIValidation.aspx`です。</span><span class="sxs-lookup"><span data-stu-id="0de7e-120">Before we can look at augmenting the previous example to include validation, we first need to replicate the example from the `ErrorHandling.aspx` page in the `EditDeleteDataList` folder to the page for this tutorial, `UIValidation.aspx`.</span></span> <span data-ttu-id="0de7e-121">両方の経由でコピーする必要があります。 これを実現するために、 `ErrorHandling.aspx` s 宣言型マークアップとそのソース コード ページです。</span><span class="sxs-lookup"><span data-stu-id="0de7e-121">To achieve this we need to copy over both the `ErrorHandling.aspx` page s declarative markup and its source code.</span></span> <span data-ttu-id="0de7e-122">まず、次の手順を実行することによって宣言型マークアップをコピーします。</span><span class="sxs-lookup"><span data-stu-id="0de7e-122">First copy over the declarative markup by performing the following steps:</span></span>

1. <span data-ttu-id="0de7e-123">開く、 `ErrorHandling.aspx` Visual Studio でのページ</span><span class="sxs-lookup"><span data-stu-id="0de7e-123">Open the `ErrorHandling.aspx` page in Visual Studio</span></span>
2. <span data-ttu-id="0de7e-124">ページの宣言型マークアップ (ページの下部にある [ソース] ボタンをクリック) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="0de7e-124">Go to the page s declarative markup (click on the Source button at the bottom of the page)</span></span>
3. <span data-ttu-id="0de7e-125">内のテキストをコピー、`<asp:Content>`と`</asp:Content>`図 1 としてタグ (行 3 ~ 32)。</span><span class="sxs-lookup"><span data-stu-id="0de7e-125">Copy the text within the `<asp:Content>` and `</asp:Content>` tags (lines 3 through 32), as shown in Figure 1.</span></span>


<span data-ttu-id="0de7e-126">[![内のテキストのコピー、 &lt;Asp:content&gt;コントロール](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image2.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="0de7e-126">[![Copy the Text Within the &lt;asp:Content&gt; Control](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image2.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image1.png)</span></span>

<span data-ttu-id="0de7e-127">**図 2**: 内のテキストのコピー、`<asp:Content>`コントロール ([フルサイズのイメージを表示するをクリックして](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="0de7e-127">**Figure 2**: Copy the Text Within the `<asp:Content>` Control ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image3.png))</span></span>


1. <span data-ttu-id="0de7e-128">開く、`UIValidation.aspx`ページ</span><span class="sxs-lookup"><span data-stu-id="0de7e-128">Open the `UIValidation.aspx` page</span></span>
2. <span data-ttu-id="0de7e-129">S 宣言型マークアップをページに移動します。</span><span class="sxs-lookup"><span data-stu-id="0de7e-129">Go to the page s declarative markup</span></span>
3. <span data-ttu-id="0de7e-130">内のテキストを貼り付けます、`<asp:Content>`コントロール。</span><span class="sxs-lookup"><span data-stu-id="0de7e-130">Paste the text within the `<asp:Content>` control.</span></span>

<span data-ttu-id="0de7e-131">ソース コードをコピーするには、開く、`ErrorHandling.aspx.vb`ページし、同様のテキストをコピー*内*、`EditDeleteDataList_ErrorHandling`クラスです。</span><span class="sxs-lookup"><span data-stu-id="0de7e-131">To copy over the source code, open the `ErrorHandling.aspx.vb` page and copy just the text *within* the `EditDeleteDataList_ErrorHandling` class.</span></span> <span data-ttu-id="0de7e-132">3 つのイベント ハンドラーをコピー (`Products_EditCommand`、 `Products_CancelCommand`、および`Products_UpdateCommand`) と共に、`DisplayExceptionDetails`メソッドが、**いない**クラス宣言をコピーまたは`using`ステートメントです。</span><span class="sxs-lookup"><span data-stu-id="0de7e-132">Copy the three event handlers (`Products_EditCommand`, `Products_CancelCommand`, and `Products_UpdateCommand`) along with the `DisplayExceptionDetails` method, but do **not** copy the class declaration or `using` statements.</span></span> <span data-ttu-id="0de7e-133">コピーしたテキストを貼り付ける*内*、`EditDeleteDataList_UIValidation`クラス`UIValidation.aspx.vb`です。</span><span class="sxs-lookup"><span data-stu-id="0de7e-133">Paste the copied text *within* the `EditDeleteDataList_UIValidation` class in `UIValidation.aspx.vb`.</span></span>

<span data-ttu-id="0de7e-134">コンテンツおよびからコード経由で移動した後`ErrorHandling.aspx`に`UIValidation.aspx`ブラウザーでページをテストします。</span><span class="sxs-lookup"><span data-stu-id="0de7e-134">After moving over the content and code from `ErrorHandling.aspx` to `UIValidation.aspx`, take a moment to test out the pages in a browser.</span></span> <span data-ttu-id="0de7e-135">同じ出力を表示し、これら 2 つのページ (図 2 を参照してください) のそれぞれで同じ機能を操作する必要があります。</span><span class="sxs-lookup"><span data-stu-id="0de7e-135">You should see the same output and experience the same functionality in each of these two pages (see Figure 2).</span></span>


<span data-ttu-id="0de7e-136">[![UIValidation.aspx ページ模倣 ErrorHandling.aspx の機能](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image5.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="0de7e-136">[![The UIValidation.aspx Page Mimics the Functionality in ErrorHandling.aspx](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image5.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image4.png)</span></span>

<span data-ttu-id="0de7e-137">**図 2**:`UIValidation.aspx`ページと同じ動作に`ErrorHandling.aspx`([フルサイズのイメージを表示するをクリックして](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="0de7e-137">**Figure 2**: The `UIValidation.aspx` Page Mimics the Functionality in `ErrorHandling.aspx` ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image6.png))</span></span>


## <a name="step-2-adding-the-validation-controls-to-the-datalist-s-edititemtemplate"></a><span data-ttu-id="0de7e-138">手順 2: DataList の後に検証コントロールを追加します。</span><span class="sxs-lookup"><span data-stu-id="0de7e-138">Step 2: Adding the Validation Controls to the DataList s EditItemTemplate</span></span>

<span data-ttu-id="0de7e-139">データ エントリ フォームを構築するときに、重要なは、すべての必須フィールドに入力し、指定されたすべての入力が有効で適切にフォーマットされた値です。</span><span class="sxs-lookup"><span data-stu-id="0de7e-139">When constructing data entry forms, it is important that users enter any required fields and that all their provided inputs are legal, properly-formatted values.</span></span> <span data-ttu-id="0de7e-140">ユーザーの入力が有効であることを確認するには、ASP.NET には、1 つの入力 Web コントロールの値を検証するよう設計されている 5 つの組み込みの検証コントロールが用意されています。</span><span class="sxs-lookup"><span data-stu-id="0de7e-140">To help ensure that a user s inputs are valid, ASP.NET provides five built-in validation controls that are designed to validate the value of a single input Web control:</span></span>

- <span data-ttu-id="0de7e-141">[RequiredFieldValidator](https://msdn.microsoft.com/library/5hbw267h(VS.80).aspx)値が指定されていることを確認</span><span class="sxs-lookup"><span data-stu-id="0de7e-141">[RequiredFieldValidator](https://msdn.microsoft.com/library/5hbw267h(VS.80).aspx) ensures that a value has been provided</span></span>
- <span data-ttu-id="0de7e-142">[CompareValidator](https://msdn.microsoft.com/library/db330ayw(VS.80).aspx)値を別の Web コントロールの値または定数の値の検証や、秒の値の形式が指定されたデータ型に対して有効であることを確認</span><span class="sxs-lookup"><span data-stu-id="0de7e-142">[CompareValidator](https://msdn.microsoft.com/library/db330ayw(VS.80).aspx) validates a value against another Web control value or a constant value, or ensures that the value s format is legal for a specified data type</span></span>
- <span data-ttu-id="0de7e-143">[RangeValidator](https://msdn.microsoft.com/library/f70d09xt.aspx)値が値の範囲内であることを確認</span><span class="sxs-lookup"><span data-stu-id="0de7e-143">[RangeValidator](https://msdn.microsoft.com/library/f70d09xt.aspx) ensures that a value is within a range of values</span></span>
- <span data-ttu-id="0de7e-144">[RegularExpressionValidator](https://msdn.microsoft.com/library/eahwtc9e.aspx)に対して値を検証、[正規表現](http://en.wikipedia.org/wiki/Regular_expression)</span><span class="sxs-lookup"><span data-stu-id="0de7e-144">[RegularExpressionValidator](https://msdn.microsoft.com/library/eahwtc9e.aspx) validates a value against a [regular expression](http://en.wikipedia.org/wiki/Regular_expression)</span></span>
- <span data-ttu-id="0de7e-145">[CustomValidator](https://msdn.microsoft.com/library/9eee01cx(VS.80).aspx) 、ユーザー定義のカスタム メソッドに対して値を検証</span><span class="sxs-lookup"><span data-stu-id="0de7e-145">[CustomValidator](https://msdn.microsoft.com/library/9eee01cx(VS.80).aspx) validates a value against a custom, user-defined method</span></span>

<span data-ttu-id="0de7e-146">これら 5 つの制御の詳細を参照してください戻る、[検証コントロールを編集および挿入するインターフェイスを追加する](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb.md)チュートリアルまたはチェック アウト、[検証コントロール セクション](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/validation/default.aspx)の[ASP.NET のクイック スタート チュートリアル](https://quickstarts.asp.net)です。</span><span class="sxs-lookup"><span data-stu-id="0de7e-146">For more information on these five controls refer back to the [Adding Validation Controls to the Editing and Inserting Interfaces](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb.md) tutorial or check out the [Validation Controls section](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/validation/default.aspx) of the [ASP.NET Quickstart Tutorials](https://quickstarts.asp.net).</span></span>

<span data-ttu-id="0de7e-147">このチュートリアルでは、製品名の値が指定されていることを確認する RequiredFieldValidator と価格を入力が 0 以上の値を持つし、有効な通貨形式で表示されることを確認 CompareValidator を使用する必要になります。</span><span class="sxs-lookup"><span data-stu-id="0de7e-147">For our tutorial we'll need to use a RequiredFieldValidator to ensure that a value for the product name has been supplied and a CompareValidator to ensure that the entered price has a value greater than or equal to 0 and is presented in a valid currency format.</span></span>

> [!NOTE]
> <span data-ttu-id="0de7e-148">ASP.NET を while 1.x が同じこれら 5 つの検証コントロール、ASP.NET 2.0 には多数の機能強化が追加、主要な 2 つのクライアント側スクリプトの中だけでなく Internet Explorer ブラウザーおよびサポートにページ上のパーティション検証コントロールする機能検証のグループです。</span><span class="sxs-lookup"><span data-stu-id="0de7e-148">While ASP.NET 1.x had these same five validation controls, ASP.NET 2.0 has added a number of improvements, the main two being client-side script support for browsers in addition to Internet Explorer and the ability to partition validation controls on a page into validation groups.</span></span> <span data-ttu-id="0de7e-149">詳細については、検証コントロール 2.0 の新機能を参照してください[ASP.NET 2.0 の検証コントロールを分解](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="0de7e-149">For more information on the new validation control features in 2.0, refer to [Dissecting the Validation Controls in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx).</span></span>


<span data-ttu-id="0de7e-150">S DataList s に必要な検証コントロールを追加することによって開始できるように`EditItemTemplate`です。</span><span class="sxs-lookup"><span data-stu-id="0de7e-150">Let s start by adding the necessary validation controls to the DataList s `EditItemTemplate`.</span></span> <span data-ttu-id="0de7e-151">この作業を実行して、DataList s のスマート タグからテンプレートの編集リンクをクリックして、デザイナー、または宣言の構文を使用します。</span><span class="sxs-lookup"><span data-stu-id="0de7e-151">This task can be performed through the Designer by clicking on the Edit Templates link from the DataList s smart tag, or through the declarative syntax.</span></span> <span data-ttu-id="0de7e-152">S プロセスの手順に従って、[デザイン] ビューからテンプレートの編集オプションを使用することができます。</span><span class="sxs-lookup"><span data-stu-id="0de7e-152">Let s step through the process using the Edit Templates option from the Design view.</span></span> <span data-ttu-id="0de7e-153">DataList s を編集する選択した後に`EditItemTemplate`後の配置テンプレートの編集インターフェイスにツールボックスからドラッグして、RequiredFieldValidator を追加、 `ProductName`  テキスト ボックス。</span><span class="sxs-lookup"><span data-stu-id="0de7e-153">After choosing to edit the DataList s `EditItemTemplate`, add a RequiredFieldValidator by dragging it from the Toolbox into the template editing interface, placing it after the `ProductName` TextBox.</span></span>


<span data-ttu-id="0de7e-154">[![ProductName TextBox 後に、EditItemTemplate、RequiredFieldValidator を追加します。](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image8.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="0de7e-154">[![Add a RequiredFieldValidator to the EditItemTemplate After the ProductName TextBox](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image8.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image7.png)</span></span>

<span data-ttu-id="0de7e-155">**図 3**: に RequiredFieldValidator を追加、 `EditItemTemplate After` 、 `ProductName` TextBox ([フルサイズのイメージを表示するをクリックして](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="0de7e-155">**Figure 3**: Add a RequiredFieldValidator to the `EditItemTemplate After` the `ProductName` TextBox ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image9.png))</span></span>


<span data-ttu-id="0de7e-156">すべての検証コントロールは、1 つの ASP.NET Web コントロールの入力を検証することによって動作します。</span><span class="sxs-lookup"><span data-stu-id="0de7e-156">All validation controls work by validating the input of a single ASP.NET Web control.</span></span> <span data-ttu-id="0de7e-157">そのため、追加したばかり RequiredFieldValidator がに対して検証する必要があることを示すために必要があります、 `ProductName`  テキスト ボックスですこれは、s の検証コントロールを設定で[`ControlToValidate`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.controltovalidate(VS.80).aspx)を、`ID`の。適切な Web コントロール (`ProductName`、このインスタンスで)。</span><span class="sxs-lookup"><span data-stu-id="0de7e-157">Therefore, we need to indicate that the RequiredFieldValidator we just added should validate against the `ProductName` TextBox; this is done by setting the validation control s [`ControlToValidate` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.controltovalidate(VS.80).aspx) to the `ID` of the appropriate Web control (`ProductName`, in this instance).</span></span> <span data-ttu-id="0de7e-158">次に、設定、 [ `ErrorMessage`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.errormessage(VS.80).aspx)には、製品の名前を指定する必要があります、 [ `Text`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.text(VS.80).aspx)に\*です。</span><span class="sxs-lookup"><span data-stu-id="0de7e-158">Next, set the [`ErrorMessage` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.errormessage(VS.80).aspx) to You must provide the product s name and the [`Text` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.text(VS.80).aspx) to \*.</span></span> <span data-ttu-id="0de7e-159">`Text`プロパティの値、指定した場合は、検証が失敗した場合、検証コントロールによって表示されるテキストです。</span><span class="sxs-lookup"><span data-stu-id="0de7e-159">The `Text` property value, if provided, is the text that is displayed by the validation control if the validation fails.</span></span> <span data-ttu-id="0de7e-160">`ErrorMessage`場合 ValidationSummary コントロールによって必要となるプロパティの値が使用される、`Text`プロパティの値を省略すると、`ErrorMessage`プロパティ値が無効な入力の検証コントロールによって表示されます。</span><span class="sxs-lookup"><span data-stu-id="0de7e-160">The `ErrorMessage` property value, which is required, is used by the ValidationSummary control; if the `Text` property value is omitted, the `ErrorMessage` property value is displayed by the validation control on invalid input.</span></span>

<span data-ttu-id="0de7e-161">RequiredFieldValidator のこれら 3 つのプロパティを設定した後、画面は図 4 のようになります。</span><span class="sxs-lookup"><span data-stu-id="0de7e-161">After setting these three properties of the RequiredFieldValidator, your screen should look similar to Figure 4.</span></span>


<span data-ttu-id="0de7e-162">[![RequiredFieldValidator の ControlToValidate、エラー メッセージ、およびテキストのプロパティを設定します。](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image11.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="0de7e-162">[![Set the RequiredFieldValidator s ControlToValidate, ErrorMessage, and Text Properties](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image11.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image10.png)</span></span>

<span data-ttu-id="0de7e-163">**図 4**: 集合 RequiredFieldValidator s `ControlToValidate`、 `ErrorMessage`、および`Text`プロパティ ([フルサイズのイメージを表示する をクリックします](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image12.png))。</span><span class="sxs-lookup"><span data-stu-id="0de7e-163">**Figure 4**: Set the RequiredFieldValidator s `ControlToValidate`, `ErrorMessage`, and `Text` Properties ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image12.png))</span></span>


<span data-ttu-id="0de7e-164">追加された RequiredFieldValidator で、`EditItemTemplate`すべての製品の価格 ボックスに必要な検証を追加するは残りますが、します。</span><span class="sxs-lookup"><span data-stu-id="0de7e-164">With the RequiredFieldValidator added to the `EditItemTemplate`, all that remains is to add the necessary validation for the product s price TextBox.</span></span> <span data-ttu-id="0de7e-165">以降、`UnitPrice`は省略可能、RequiredFieldValidator に追加する必要があるレコードを編集するとき。</span><span class="sxs-lookup"><span data-stu-id="0de7e-165">Since the `UnitPrice` is optional when editing a record, we don t need to add a RequiredFieldValidator.</span></span> <span data-ttu-id="0de7e-166">ただし、ことを確認する CompareValidator を追加する必要がありますには、 `UnitPrice`、指定した場合、通貨の形式が正しく、0 以上。</span><span class="sxs-lookup"><span data-stu-id="0de7e-166">We do, however, need to add a CompareValidator to ensure that the `UnitPrice`, if supplied, is properly formatted as a currency and is greater than or equal to 0.</span></span>

<span data-ttu-id="0de7e-167">CompareValidator を追加、`EditItemTemplate`設定とその`ControlToValidate`プロパティを`UnitPrice`、その`ErrorMessage`価格にプロパティが 0 以上にする必要がありますおよび通貨記号を含めることはできませんし、その`Text`プロパティ\*.</span><span class="sxs-lookup"><span data-stu-id="0de7e-167">Add the CompareValidator into the `EditItemTemplate` and set its `ControlToValidate` property to `UnitPrice`, its `ErrorMessage` property to The price must be greater than or equal to zero and cannot include the currency symbol, and its `Text` property to \*.</span></span> <span data-ttu-id="0de7e-168">示すために、`UnitPrice`値が 0 以上でなければ、CompareValidator s を設定する必要があります[`Operator`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.operator(VS.80).aspx)に`GreaterThanEqual`、その[`ValueToCompare`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.valuetocompare(VS.80).aspx)を 0 にし、その[`Type`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basecomparevalidator.type.aspx)に`Currency`です。</span><span class="sxs-lookup"><span data-stu-id="0de7e-168">To indicate that the `UnitPrice` value must be greater than or equal to 0, set the CompareValidator s [`Operator` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.operator(VS.80).aspx) to `GreaterThanEqual`, its [`ValueToCompare` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.valuetocompare(VS.80).aspx) to 0, and its [`Type` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basecomparevalidator.type.aspx) to `Currency`.</span></span>

<span data-ttu-id="0de7e-169">DataList s、これらの 2 つの検証コントロールを追加した後`EditItemTemplate`s 宣言の構文は、次のようになります。</span><span class="sxs-lookup"><span data-stu-id="0de7e-169">After adding these two validation controls, the DataList s `EditItemTemplate` s declarative syntax should look similar to the following:</span></span>


[!code-aspx[Main](adding-validation-controls-to-the-datalist-s-editing-interface-vb/samples/sample1.aspx)]

<span data-ttu-id="0de7e-170">これらの変更を行った後は、ブラウザーでページを開きます。</span><span class="sxs-lookup"><span data-stu-id="0de7e-170">After making these changes, open the page in a browser.</span></span> <span data-ttu-id="0de7e-171">名前を省略するか、製品の編集時に、無効な価格の値を入力しようとすると、テキスト ボックスの横にアスタリスクが表示されます。</span><span class="sxs-lookup"><span data-stu-id="0de7e-171">If you attempt to omit the name or enter an invalid price value when editing a product, an asterisk appears next to the textbox.</span></span> <span data-ttu-id="0de7e-172">図 5 に示す $19.95 などの通貨記号を含む価格の値が無効と見なされます。</span><span class="sxs-lookup"><span data-stu-id="0de7e-172">As Figure 5 shows, a price value that includes the currency symbol such as $19.95 is considered invalid.</span></span> <span data-ttu-id="0de7e-173">CompareValidator s `Currency` `Type`では、桁区切り記号 (コンマ、ピリオド、カルチャの設定によってなど) と先頭プラスまたはマイナス記号が、*いない*通貨記号を許可します。</span><span class="sxs-lookup"><span data-stu-id="0de7e-173">The CompareValidator s `Currency` `Type` allows for digit separators (such as commas or periods, depending on the culture settings) and a leading plus or minus sign, but does *not* permit a currency symbol.</span></span> <span data-ttu-id="0de7e-174">この動作は、編集用のインターフェイスが現在表示ユーザーを perplex 可能性があります、`UnitPrice`通貨形式を使用します。</span><span class="sxs-lookup"><span data-stu-id="0de7e-174">This behavior may perplex users as the editing interface currently renders the `UnitPrice` using the currency format.</span></span>


<span data-ttu-id="0de7e-175">[![無効な入力でテキスト ボックスの横にアスタリスクが表示されます。](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image14.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="0de7e-175">[![An Asterisk Appears Next to the Textboxes with Invalid Input](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image14.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image13.png)</span></span>

<span data-ttu-id="0de7e-176">**図 5**: An アスタリスクが表示されますへの無効な入力でテキスト ボックス ([フルサイズのイメージを表示するをクリックして](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="0de7e-176">**Figure 5**: An Asterisk Appears Next to the Textboxes with Invalid Input ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image15.png))</span></span>


<span data-ttu-id="0de7e-177">として検証機能の中では、ユーザーが許されないレコードの編集時に、通貨記号を手動で削除します。</span><span class="sxs-lookup"><span data-stu-id="0de7e-177">While the validation works as-is, the user has to manually remove the currency symbol when editing a record, which is not acceptable.</span></span> <span data-ttu-id="0de7e-178">さらが有効な場合は、編集の入力はどちらも、更新プログラムも [キャンセル] ボタンのクリックされると、ポストバックを呼び出すときにやり取りできます。</span><span class="sxs-lookup"><span data-stu-id="0de7e-178">Moreover, if there are invalid inputs in the editing interface neither the Update nor Cancel buttons, when clicked, will invoke a postback.</span></span> <span data-ttu-id="0de7e-179">理想的には、[キャンセル] ボタンはユーザーの入力の有効性に関係なく、編集済みの状態を DataList を返します。</span><span class="sxs-lookup"><span data-stu-id="0de7e-179">Ideally, the Cancel button would return the DataList to its pre-editing state regardless of the validity of the user s inputs.</span></span> <span data-ttu-id="0de7e-180">また、DataList s の製品情報を更新する前に、ページ データが有効なことを確認する必要があります`UpdateCommand`としてブラウザーの JavaScript サポートがないか、保持して、ユーザーがクライアント側のロジックをバイパスできる検証コントロールのイベント ハンドラーサポートを無効になっています。</span><span class="sxs-lookup"><span data-stu-id="0de7e-180">Also, we need to ensure that the page s data is valid before updating the product information in the DataList s `UpdateCommand` event handler, as the validation controls client-side logic can be bypassed by users whose browsers either don t support JavaScript or have its support disabled.</span></span>

## <a name="removing-the-currency-symbol-from-the-edititemtemplate-s-unitprice-textbox"></a><span data-ttu-id="0de7e-181">EditItemTemplate の UnitPrice ボックスから通貨記号を削除します。</span><span class="sxs-lookup"><span data-stu-id="0de7e-181">Removing the Currency Symbol from the EditItemTemplate s UnitPrice TextBox</span></span>

<span data-ttu-id="0de7e-182">CompareValidator s を使用するときに`Currency``Type`、検証対象の入力には、通貨記号を含めることはできません。</span><span class="sxs-lookup"><span data-stu-id="0de7e-182">When using the CompareValidator s `Currency``Type`, the input being validated must not include any currency symbols.</span></span> <span data-ttu-id="0de7e-183">このようなシンボルの存在は、入力に無効なをマークする CompareValidator をによりします。</span><span class="sxs-lookup"><span data-stu-id="0de7e-183">The presence of such symbols causes the CompareValidator to mark the input as invalid.</span></span> <span data-ttu-id="0de7e-184">ただし、編集のインターフェイスは、通貨記号を現在を含めて、 `UnitPrice`  ボックスに、つまり、ユーザーが、変更を保存する前に通貨記号を明示的に削除する必要があります。</span><span class="sxs-lookup"><span data-stu-id="0de7e-184">However, our editing interface currently includes a currency symbol in the `UnitPrice` TextBox, meaning the user must explicitly remove the currency symbol before saving their changes.</span></span> <span data-ttu-id="0de7e-185">これを解決するには、3 つのオプションがあります。</span><span class="sxs-lookup"><span data-stu-id="0de7e-185">To remedy this we have three options:</span></span>

1. <span data-ttu-id="0de7e-186">構成、`EditItemTemplate`できるように、 `UnitPrice`  ボックスに値が通貨としてフォーマットされていません。</span><span class="sxs-lookup"><span data-stu-id="0de7e-186">Configure the `EditItemTemplate` so that the `UnitPrice` TextBox value is not formatted as a currency.</span></span>
2. <span data-ttu-id="0de7e-187">CompareValidator を削除して、正しく書式設定された通貨値をチェックする RegularExpressionValidator に置き換えることによって、通貨記号を入力できます。</span><span class="sxs-lookup"><span data-stu-id="0de7e-187">Allow the user to enter a currency symbol by removing the CompareValidator and replacing it with a RegularExpressionValidator that checks for a properly formatted currency value.</span></span> <span data-ttu-id="0de7e-188">ここで難しい通貨値を検証する正規表現は、CompareValidator として単純ではありません、カルチャ設定を組み込むたい場合に、コードの記述を必要とするとします。</span><span class="sxs-lookup"><span data-stu-id="0de7e-188">The challenge here is that the regular expression to validate a currency value is not as straightforward as the CompareValidator and would require writing code if we wanted to incorporate culture settings.</span></span>
3. <span data-ttu-id="0de7e-189">検証コントロールを完全に削除し、GridView s でカスタム サーバー側の検証ロジックに依存`RowUpdating`イベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="0de7e-189">Remove the validation control altogether and rely on custom server-side validation logic in the GridView s `RowUpdating` event handler.</span></span>

<span data-ttu-id="0de7e-190">このチュートリアルではオプション 1 と s を使用できます。</span><span class="sxs-lookup"><span data-stu-id="0de7e-190">Let s go with option 1 for this tutorial.</span></span> <span data-ttu-id="0de7e-191">現在、 `UnitPrice` 、テキスト ボックス内のデータ バインド式により通貨値として書式設定、 `EditItemTemplate`:`<%# Eval("UnitPrice", "{0:c}") %>`です。</span><span class="sxs-lookup"><span data-stu-id="0de7e-191">Currently the `UnitPrice` is formatted as a currency value due to the databinding expression for the TextBox in the `EditItemTemplate`: `<%# Eval("UnitPrice", "{0:c}") %>`.</span></span> <span data-ttu-id="0de7e-192">変更、`Eval`ステートメント`Eval("UnitPrice", "{0:n2}")`、有効桁数の数値 2 桁の数字で、結果の書式を設定します。</span><span class="sxs-lookup"><span data-stu-id="0de7e-192">Change the `Eval` statement to `Eval("UnitPrice", "{0:n2}")`, which formats the result as a number with two digits of precision.</span></span> <span data-ttu-id="0de7e-193">これは、宣言の構文を直接または行えますから databindings の編集 リンクをクリックして、 `UnitPrice` DataList s で TextBox`EditItemTemplate`です。</span><span class="sxs-lookup"><span data-stu-id="0de7e-193">This can be done directly through the declarative syntax or by clicking on the Edit DataBindings link from the `UnitPrice` TextBox in the DataList s `EditItemTemplate`.</span></span>

<span data-ttu-id="0de7e-194">この変更により、編集インターフェイスで書式設定された価格は桁区切り記号としてコンマ、小数点区切り文字としてピリオドが含まれていますが、通貨記号をオフのままにします。</span><span class="sxs-lookup"><span data-stu-id="0de7e-194">With this change, the formatted price in the editing interface includes commas as the group separator and a period as the decimal separator, but leaves off the currency symbol.</span></span>

> [!NOTE]
> <span data-ttu-id="0de7e-195">場合、編集可能なインターフェイスから、通貨の書式を削除するときにした方が便利な通貨記号をテキスト ボックスの外側のテキストとして配置します。</span><span class="sxs-lookup"><span data-stu-id="0de7e-195">When removing the currency format from the editable interface, I find it helpful to put the currency symbol as text outside the TextBox.</span></span> <span data-ttu-id="0de7e-196">これは、通貨記号を提供する必要がないことをユーザーにヒントとして機能します。</span><span class="sxs-lookup"><span data-stu-id="0de7e-196">This serves as a hint to the user that they do not need to provide the currency symbol.</span></span>


## <a name="fixing-the-cancel-button"></a><span data-ttu-id="0de7e-197">[キャンセル] ボタンを修正します。</span><span class="sxs-lookup"><span data-stu-id="0de7e-197">Fixing the Cancel Button</span></span>

<span data-ttu-id="0de7e-198">既定では、Web の検証コントロールは、クライアント側で検証を実行する JavaScript を生成します。</span><span class="sxs-lookup"><span data-stu-id="0de7e-198">By default, the validation Web controls emit JavaScript to perform validation on the client-side.</span></span> <span data-ttu-id="0de7e-199">ボタン、LinkButton、または ImageButton がクリックされたときに、ポストバックが発生する前にクライアント側で、ページ上の検証コントロールがチェックされます。</span><span class="sxs-lookup"><span data-stu-id="0de7e-199">When a Button, LinkButton, or ImageButton is clicked, the validation controls on the page are checked on the client-side before the postback occurs.</span></span> <span data-ttu-id="0de7e-200">無効なデータがある場合、ポストバックが取り消されました。</span><span class="sxs-lookup"><span data-stu-id="0de7e-200">If there is any invalid data, the postback is cancelled.</span></span> <span data-ttu-id="0de7e-201">特定のボタンは、データの妥当性できない可能性があります材料です。このような場合は、データが無効なため取り消されましたポストバックが迷惑です。</span><span class="sxs-lookup"><span data-stu-id="0de7e-201">For certain Buttons, though, the validity of the data might be immaterial; in such a case, having the postback cancelled due to invalid data is a nuisance.</span></span>

<span data-ttu-id="0de7e-202">[キャンセル] ボタンは、このような例を示します。</span><span class="sxs-lookup"><span data-stu-id="0de7e-202">The Cancel button is such an example.</span></span> <span data-ttu-id="0de7e-203">たとえば、ことユーザー、s の製品名を省略することなどの無効なデータが入力し彼女が t 保存したい製品すべてを決定し、[キャンセル] ボタンをヒットします。</span><span class="sxs-lookup"><span data-stu-id="0de7e-203">Imagine that a user enters invalid data, such as omitting the product s name, and then decides she doesn t want to save the product after all and hits the Cancel button.</span></span> <span data-ttu-id="0de7e-204">現時点では、キャンセル ボタンは、製品名が不足しているがポストバックを防ぐためであることを報告する ページで、検証コントロールをトリガーします。</span><span class="sxs-lookup"><span data-stu-id="0de7e-204">Currently, the Cancel button triggers the validation controls on the page, which report that the product name is missing and prevent the postback.</span></span> <span data-ttu-id="0de7e-205">ユーザーにテキストを入力するには、 `ProductName`  ボックスに、編集のプロセスをキャンセルするだけです。</span><span class="sxs-lookup"><span data-stu-id="0de7e-205">Our user has to type some text into the `ProductName` TextBox just to cancel out of the editing process.</span></span>

<span data-ttu-id="0de7e-206">さいわい、ボタン、LinkButton、および ImageButton が、 [ `CausesValidation`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.button.causesvalidation.aspx)ことを示すをクリックするかどうか、ボタンは、検証ロジックを開始する必要があります (既定値は`True`)。</span><span class="sxs-lookup"><span data-stu-id="0de7e-206">Fortunately, the Button, LinkButton, and ImageButton have a [`CausesValidation` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.button.causesvalidation.aspx) that can indicate whether or not clicking the Button should initiate the validation logic (defaults to `True`).</span></span> <span data-ttu-id="0de7e-207">設定は [キャンセル] ボタン s`CausesValidation`プロパティを`False`です。</span><span class="sxs-lookup"><span data-stu-id="0de7e-207">Set the Cancel Button s `CausesValidation` property to `False`.</span></span>

## <a name="ensuring-the-inputs-are-valid-in-the-updatecommand-event-handler"></a><span data-ttu-id="0de7e-208">有効な UpdateCommand イベント ハンドラーでは、入力のことを確認</span><span class="sxs-lookup"><span data-stu-id="0de7e-208">Ensuring the Inputs are Valid in the UpdateCommand Event Handler</span></span>

<span data-ttu-id="0de7e-209">検証コントロールによって生成されますクライアント側スクリプトにより無効な入力を入力した場合の検証コントロールをキャンセル ボタン、LinkButton、によって開始される任意のポストバック コントロールのまたは ImageButton が`CausesValidation`プロパティは、 `True` (。既定値) です。</span><span class="sxs-lookup"><span data-stu-id="0de7e-209">Due to the client-side script emitted by the validation controls, if a user enters invalid input the validation controls cancel any postbacks initiated by Button, LinkButton, or ImageButton controls whose `CausesValidation` properties are `True` (the default).</span></span> <span data-ttu-id="0de7e-210">ただし、時代遅れブラウザーまたはの JavaScript のサポートが無効にされているユーザーを訪問している場合、クライアント側検証チェックは実行されません。</span><span class="sxs-lookup"><span data-stu-id="0de7e-210">However, if a user is visiting with an antiquated browser or one whose JavaScript support has been disabled, the client-side validation checks will not execute.</span></span>

<span data-ttu-id="0de7e-211">ASP.NET の検証コントロールのすべてのポストバック時にすぐに検証ロジックを繰り返されを使用して、ページ入力の全体的な有効性を報告、 [ `Page.IsValid`プロパティ](https://msdn.microsoft.com/library/system.web.ui.page.isvalid.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="0de7e-211">All of the ASP.NET validation controls repeat their validation logic immediately upon postback and report the overall validity of the page s inputs via the [`Page.IsValid` property](https://msdn.microsoft.com/library/system.web.ui.page.isvalid.aspx).</span></span> <span data-ttu-id="0de7e-212">ただし、ページ フローまたはされていない中断されたいずれかの値に基づく方法で停止`Page.IsValid`です。</span><span class="sxs-lookup"><span data-stu-id="0de7e-212">However, the page flow is not interrupted or stopped in any way based on the value of `Page.IsValid`.</span></span> <span data-ttu-id="0de7e-213">開発者は、ことを確認する責任は、`Page.IsValid`プロパティの値を持つ`True`入力データを有効に与えられているコードに進む前にします。</span><span class="sxs-lookup"><span data-stu-id="0de7e-213">As developers, it is our responsibility to ensure that the `Page.IsValid` property has a value of `True` before proceeding with code that assumes valid input data.</span></span>

<span data-ttu-id="0de7e-214">ユーザーに JavaScript が無効になっている場合は、このページにアクセス、製品を編集、すぎますの価格の値を入力負荷の高い、更新ボタンをクリックして、クライアント側の検証がバイパスされ、ポストバックにつながります。</span><span class="sxs-lookup"><span data-stu-id="0de7e-214">If a user has JavaScript disabled, visits our page, edits a product, enters a price value of Too expensive, and clicks the Update button, the client-side validation will be bypassed and a postback will ensue.</span></span> <span data-ttu-id="0de7e-215">ポストバックで ASP.NET ページ`UpdateCommand`イベント ハンドラーを実行し、すぎるを解析しようとするときに、例外が発生するコストになる、`Decimal`です。</span><span class="sxs-lookup"><span data-stu-id="0de7e-215">On postback, the ASP.NET page s `UpdateCommand` event handler executes and an exception is raised when attempting to parse Too expensive to a `Decimal`.</span></span> <span data-ttu-id="0de7e-216">例外処理があるため、このような例外が適切に処理するおできない無効なデータのみを続行して、最初の場所から遅れて、`UpdateCommand`イベント ハンドラー場合`Page.IsValid`の値を持つ`True`します。</span><span class="sxs-lookup"><span data-stu-id="0de7e-216">Since we have exception handling, such an exception will be handled gracefully, but we could prevent the invalid data from slipping through in the first place by only proceeding with the `UpdateCommand` event handler if `Page.IsValid` has a value of `True`.</span></span>

<span data-ttu-id="0de7e-217">先頭に次のコードを追加、 `UpdateCommand` 、イベント ハンドラーの直前に、`Try`ブロック。</span><span class="sxs-lookup"><span data-stu-id="0de7e-217">Add the following code to the start of the `UpdateCommand` event handler, immediately before the `Try` block:</span></span>


[!code-vb[Main](adding-validation-controls-to-the-datalist-s-editing-interface-vb/samples/sample2.vb)]

<span data-ttu-id="0de7e-218">この追加すると、製品は、送信されたデータが有効な場合にのみ更新を試みます。</span><span class="sxs-lookup"><span data-stu-id="0de7e-218">With this addition, the product will attempt to be updated only if the submitted data is valid.</span></span> <span data-ttu-id="0de7e-219">T が勝利したほとんどのユーザーが無効なデータの検証コントロールのクライアント側スクリプトのためのポストバックできるが、ブラウザーのない t サポート JavaScript または JavaScript のサポートのあるユーザーをクライアント側のチェックを回避できます無効にして、無効なデータを送信します。</span><span class="sxs-lookup"><span data-stu-id="0de7e-219">Most users won t be able to postback invalid data due to the validation controls client-side scripts, but users whose browsers don t support JavaScript or that have JavaScript support disabled, can bypass the client-side checks and submit invalid data.</span></span>

> [!NOTE]
> <span data-ttu-id="0de7e-220">絶好のリーダーを思い出してを GridView にデータを更新するときになかった t が明示的にチェックする必要があります、`Page.IsValid`ページの分離コード クラスのプロパティ。</span><span class="sxs-lookup"><span data-stu-id="0de7e-220">The astute reader will recall that when updating data with the GridView, we didn t need to explicitly check the `Page.IsValid` property in our page s code-behind class.</span></span> <span data-ttu-id="0de7e-221">これは、GridView を参照しているため、`Page.IsValid`プロパティの値を返す場合にのみ、更新プログラムを続行のみと us`True`です。</span><span class="sxs-lookup"><span data-stu-id="0de7e-221">This is because the GridView consults the `Page.IsValid` property for us and only proceeds with the update only if it returns a value of `True`.</span></span>


## <a name="step-3-summarizing-data-entry-problems"></a><span data-ttu-id="0de7e-222">手順 3: 概要データ エントリの問題を作成します。</span><span class="sxs-lookup"><span data-stu-id="0de7e-222">Step 3: Summarizing Data Entry Problems</span></span>

<span data-ttu-id="0de7e-223">ASP.NET には、5 つの検証コントロールのほか、 [ValidationSummary コントロール](https://msdn.microsoft.com/library/f9h59855(VS.80).aspx)が表示される、`ErrorMessage`の無効なデータが検出された検証コントロール。</span><span class="sxs-lookup"><span data-stu-id="0de7e-223">In addition to the five validation controls, ASP.NET includes the [ValidationSummary control](https://msdn.microsoft.com/library/f9h59855(VS.80).aspx), which displays the `ErrorMessage` s of those validation controls that detected invalid data.</span></span> <span data-ttu-id="0de7e-224">この概要データは、モーダル、クライアント側のメッセージ ボックス データベースを介して、web ページ上のテキストとして表示できます。</span><span class="sxs-lookup"><span data-stu-id="0de7e-224">This summary data can be displayed as text on the web page or through a modal, client-side messagebox.</span></span> <span data-ttu-id="0de7e-225">S を任意の検証に関する問題の概要を作成するクライアント側のメッセージ ボックスを含めるには、このチュートリアルを向上させることができます。</span><span class="sxs-lookup"><span data-stu-id="0de7e-225">Let s enhance this tutorial to include a client-side messagebox summarizing any validation problems.</span></span>

<span data-ttu-id="0de7e-226">これを実現するには、ツールボックスからデザイナーに ValidationSummary コントロールをドラッグします。</span><span class="sxs-lookup"><span data-stu-id="0de7e-226">To accomplish this, drag a ValidationSummary control from the Toolbox onto the Designer.</span></span> <span data-ttu-id="0de7e-227">ValidationSummary コントロールが t の場所本当に問題からのみ、メッセージ ボックス データベースとしての概要を表示するように構成することです。</span><span class="sxs-lookup"><span data-stu-id="0de7e-227">The location of the ValidationSummary control doesn t really matter, since we re going to configure it to only display the summary as a messagebox.</span></span> <span data-ttu-id="0de7e-228">コントロールを追加すると、次のように設定します。 その[`ShowSummary`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showsummary(VS.80).aspx)に`False`とその[`ShowMessageBox`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showmessagebox(VS.80).aspx)に`True`です。</span><span class="sxs-lookup"><span data-stu-id="0de7e-228">After adding the control, set its [`ShowSummary` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showsummary(VS.80).aspx) to `False` and its [`ShowMessageBox` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showmessagebox(VS.80).aspx) to `True`.</span></span> <span data-ttu-id="0de7e-229">この追加のクライアント側のメッセージ ボックスに、この検証エラーをまとめたもの (図 6 を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="0de7e-229">With this addition, any validation errors are summarized in a client-side messagebox (see Figure 6).</span></span>


<span data-ttu-id="0de7e-230">[![クライアント側のメッセージ ボックスの妥当性確認エラーをまとめたもの](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image17.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="0de7e-230">[![The Validation Errors are Summarized in a Client-Side Messagebox](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image17.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image16.png)</span></span>

<span data-ttu-id="0de7e-231">**図 6**: クライアント側のメッセージ ボックスの 検証エラーをまとめたもの ([フルサイズのイメージを表示するをクリックして](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="0de7e-231">**Figure 6**: The Validation Errors are Summarized in a Client-Side Messagebox ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image18.png))</span></span>


## <a name="summary"></a><span data-ttu-id="0de7e-232">まとめ</span><span class="sxs-lookup"><span data-stu-id="0de7e-232">Summary</span></span>

<span data-ttu-id="0de7e-233">このチュートリアルでは、事前に 更新のワークフローでの使用を試行する前に、ユーザー入力が有効であることを確認する検証コントロールを使用して、例外の可能性を減少する方法を説明しました。</span><span class="sxs-lookup"><span data-stu-id="0de7e-233">In this tutorial we saw how to reduce the likelihood of exceptions by using validation controls to proactively ensure that our users inputs are valid before attempting to use them in the updating workflow.</span></span> <span data-ttu-id="0de7e-234">ASP.NET は、特定の Web を検査するよう設計されている 5 つの検証 Web コントロールが s 入力を制御し、入力の有効性に報告を提供します。</span><span class="sxs-lookup"><span data-stu-id="0de7e-234">ASP.NET provides five validation Web controls that are designed to inspect a particular Web control s input and report back on the input s validity.</span></span> <span data-ttu-id="0de7e-235">このチュートリアルで使用してこれら 5 つのコントロールの 2 つ、RequiredFieldValidator と、CompareValidator に製品の名前が指定されていることと、価格より大きいかゼロに等しい値を持つ通貨書式であることを確認してください。</span><span class="sxs-lookup"><span data-stu-id="0de7e-235">In this tutorial we used two of those five controls the RequiredFieldValidator and the CompareValidator to ensure that the product s name was supplied and that the price had a currency format with a value greater than or equal to zero.</span></span>

<span data-ttu-id="0de7e-236">上にドラッグなどの単純な編集インターフェイス DataList s を検証コントロールを追加するは、`EditItemTemplate`からツールボックスといくつかのプロパティを設定します。</span><span class="sxs-lookup"><span data-stu-id="0de7e-236">Adding validation controls to the DataList s editing interface is as simple as dragging them onto the `EditItemTemplate` from the Toolbox and setting a handful of properties.</span></span> <span data-ttu-id="0de7e-237">既定では、検証コントロールに自動的にスクリプトを出力クライアント側の検証。累積的な結果を格納する、ポストバック時にもサーバー側の検証を提供する、`Page.IsValid`プロパティです。</span><span class="sxs-lookup"><span data-stu-id="0de7e-237">By default, the validation controls automatically emit client-side validation script; they also provide server-side validation on postback, storing the cumulative result in the `Page.IsValid` property.</span></span> <span data-ttu-id="0de7e-238">ボタン、LinkButton、または ImageButton がクリックされたときに、クライアント側の検証をバイパスする設定ボタン s`CausesValidation`プロパティを`False`です。</span><span class="sxs-lookup"><span data-stu-id="0de7e-238">To bypass the client-side validation when a Button, LinkButton, or ImageButton is clicked, set the button s `CausesValidation` property to `False`.</span></span> <span data-ttu-id="0de7e-239">また、ポストバック時に送信されたデータのいずれかのタスクを実行する前にいることを確認、`Page.IsValid`プロパティから返される`True`です。</span><span class="sxs-lookup"><span data-stu-id="0de7e-239">Also, before performing any tasks with the data submitted on postback, ensure that the `Page.IsValid` property returns `True`.</span></span>

<span data-ttu-id="0de7e-240">すべてのチュートリアルを編集 DataList お解析してきた ve お持ちの非常に単純な編集インターフェイス、s の製品名のテキスト ボックスと別の価格です。</span><span class="sxs-lookup"><span data-stu-id="0de7e-240">All of the DataList editing tutorials we ve examined so far have had very simple editing interfaces a TextBox for the product s name and another for the price.</span></span> <span data-ttu-id="0de7e-241">ただし、編集のインターフェイスは、DropDownLists、カレンダー、ボタン、チェック ボックスなどの別の Web コントロールの組み合わせを含めることができます。</span><span class="sxs-lookup"><span data-stu-id="0de7e-241">The editing interface, however, can contain a mix of different Web controls, such as DropDownLists, Calendars, RadioButtons, CheckBoxes, and so on.</span></span> <span data-ttu-id="0de7e-242">[次へ]、チュートリアルでは、さまざまな Web コントロールを使用するインターフェイスの構築に紹介します。</span><span class="sxs-lookup"><span data-stu-id="0de7e-242">In our next tutorial we'll look at building an interface that uses a variety of Web controls.</span></span>

<span data-ttu-id="0de7e-243">満足プログラミング!</span><span class="sxs-lookup"><span data-stu-id="0de7e-243">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="0de7e-244">作成者について</span><span class="sxs-lookup"><span data-stu-id="0de7e-244">About the Author</span></span>

<span data-ttu-id="0de7e-245">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)、7 つ受け取りますブックとの創設者の作成者[4GuysFromRolla.com](http://www.4guysfromrolla.com)、1998 年からマイクロソフトの Web テクノロジで取り組んできました。</span><span class="sxs-lookup"><span data-stu-id="0de7e-245">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="0de7e-246">Scott は、コンサルタント、トレーナー、ライターとして機能します。</span><span class="sxs-lookup"><span data-stu-id="0de7e-246">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="0de7e-247">最新の著書[ *Sam 学べる自分で ASP.NET 2.0 が 24 時間以内に*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)です。</span><span class="sxs-lookup"><span data-stu-id="0de7e-247">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="0de7e-248">彼に到達できる[ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)彼のブログを使用して含まれているのか[ http://ScottOnWriting.NET](http://ScottOnWriting.NET)です。</span><span class="sxs-lookup"><span data-stu-id="0de7e-248">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="0de7e-249">感謝の特別な</span><span class="sxs-lookup"><span data-stu-id="0de7e-249">Special Thanks To</span></span>

<span data-ttu-id="0de7e-250">このチュートリアルの系列は既に多くの便利なレビュー担当者によって確認済みです。</span><span class="sxs-lookup"><span data-stu-id="0de7e-250">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="0de7e-251">このチュートリアルの潜在顧客レビュー担当者には、Dennis Patterson、Ken Pespisa Liz Shulok がされていました。</span><span class="sxs-lookup"><span data-stu-id="0de7e-251">Lead reviewers for this tutorial were Dennis Patterson, Ken Pespisa, and Liz Shulok.</span></span> <span data-ttu-id="0de7e-252">今後、MSDN の記事を確認することに関心のあるですか。</span><span class="sxs-lookup"><span data-stu-id="0de7e-252">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="0de7e-253">場合は、ドロップ me 一度に 1 行ずつ[mitchell@4GuysFromRolla.comです。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="0de7e-253">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="0de7e-254">[前へ](handling-bll-and-dal-level-exceptions-vb.md)
> [次へ](customizing-the-datalist-s-editing-interface-vb.md)</span><span class="sxs-lookup"><span data-stu-id="0de7e-254">[Previous](handling-bll-and-dal-level-exceptions-vb.md)
[Next](customizing-the-datalist-s-editing-interface-vb.md)</span></span>
