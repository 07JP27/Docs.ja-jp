---
uid: web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/an-overview-of-editing-and-deleting-data-in-the-datalist-vb
title: "編集および削除 DataList (VB) 内のデータの概要 |Microsoft ドキュメント"
author: rick-anderson
description: "DataList では、組み込みの編集と削除機能がない、ときにこのチュートリアルでは会いしましょうを編集および削除の o をサポートする DataList を作成する方法."
ms.author: aspnetcontent
manager: wpickett
ms.date: 10/30/2006
ms.topic: article
ms.assetid: 9410a23c-9697-4f07-bd71-e62b0ceac655
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/an-overview-of-editing-and-deleting-data-in-the-datalist-vb
msc.type: authoredcontent
ms.openlocfilehash: 3f43001b1980452e95187096cf884778c2970eb5
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/10/2017
---
<a name="an-overview-of-editing-and-deleting-data-in-the-datalist-vb"></a><span data-ttu-id="b537a-103">編集および削除 DataList (VB) 内のデータの概要</span><span class="sxs-lookup"><span data-stu-id="b537a-103">An Overview of Editing and Deleting Data in the DataList (VB)</span></span>
====================
<span data-ttu-id="b537a-104">によって[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="b537a-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="b537a-105">[サンプル アプリをダウンロード](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_36_VB.exe)または[PDF のダウンロード](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/datatutorial36vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="b537a-105">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_36_VB.exe) or [Download PDF](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/datatutorial36vb1.pdf)</span></span>

> <span data-ttu-id="b537a-106">DataList では、組み込みの編集と削除機能がない、ときにこのチュートリアルでは会いしましょうを編集およびその基になるデータの削除をサポートする DataList を作成する方法です。</span><span class="sxs-lookup"><span data-stu-id="b537a-106">While the DataList lacks built-in editing and deleting capabilities, in this tutorial we'll see how to create a DataList that supports editing and deleting of its underlying data.</span></span>


## <a name="introduction"></a><span data-ttu-id="b537a-107">はじめに</span><span class="sxs-lookup"><span data-stu-id="b537a-107">Introduction</span></span>

<span data-ttu-id="b537a-108">[、概要の挿入、更新、およびデータの削除](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md)チュートリアルでは、挿入、更新、およびアプリケーションのアーキテクチャ、ObjectDataSource、GridView、DetailsView、およびフォーム ビューを使用してデータを削除する方法について説明しました制御します。</span><span class="sxs-lookup"><span data-stu-id="b537a-108">In the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md) tutorial we looked at how to insert, update, and delete data using the application architecture, an ObjectDataSource, and the GridView, DetailsView, and FormView controls.</span></span> <span data-ttu-id="b537a-109">ObjectDataSource とこれら 3 つのデータの Web コントロールでは、単純なデータ変更のインターフェイスを実装する、スナップインが関与してスマート タグのチェック ボックスをオンに時間刻みだけを実行します。</span><span class="sxs-lookup"><span data-stu-id="b537a-109">With the ObjectDataSource and these three data Web controls, implementing simple data modification interfaces was a snap and involved merely ticking a checkbox from a smart tag.</span></span> <span data-ttu-id="b537a-110">コードを記述する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="b537a-110">No code needed to be written.</span></span>

<span data-ttu-id="b537a-111">残念ながら、DataList では、編集、および GridView コントロールに固有の機能を削除すると、組み込みが不足しています。</span><span class="sxs-lookup"><span data-stu-id="b537a-111">Unfortunately, the DataList lacks the built-in editing and deleting capabilities inherent in the GridView control.</span></span> <span data-ttu-id="b537a-112">不足しているこの機能は、一部には、DataList は、宣言型のデータ ソース コントロールとコードを必要としないデータ変更のページは使用できなかったときに、ASP.NET の以前のバージョンから relic をファクト、due です。</span><span class="sxs-lookup"><span data-stu-id="b537a-112">This missing functionality is due in part to the fact that the DataList is a relic from the previous version of ASP.NET, when declarative data source controls and code-free data modification pages were unavailable.</span></span> <span data-ttu-id="b537a-113">DataList ASP.NET 2.0 では提供しませんすぐ同じデータ変更機能として GridView、中に、ASP.NET 1.x 手法を使用して、このような機能が含まれておできます。</span><span class="sxs-lookup"><span data-stu-id="b537a-113">While the DataList in ASP.NET 2.0 does not offer the same out of the box data modification capabilities as the GridView, we can use ASP.NET 1.x techniques to include such functionality.</span></span> <span data-ttu-id="b537a-114">このアプローチには、コードのビットが必要ですが、このチュートリアルで後ほどお見せ、DataList れているようにいくつかのイベントおよびプロパティでこのプロセスを支援する場所。</span><span class="sxs-lookup"><span data-stu-id="b537a-114">This approach requires a bit of code but, as we'll see in this tutorial, the DataList has some events and properties in place to aid in this process.</span></span>

<span data-ttu-id="b537a-115">このチュートリアルでは編集、およびその基になるデータの削除をサポートする DataList を作成する方法が表示されます。</span><span class="sxs-lookup"><span data-stu-id="b537a-115">In this tutorial we'll see how to create a DataList that supports editing and deleting of its underlying data.</span></span> <span data-ttu-id="b537a-116">今後のチュートリアルより高度な編集しシナリオを削除すると、入力フィールドの検証を含む、データ アクセスまたはビジネス ロジック層、およびなどから発生した例外を適切に処理を調べます。</span><span class="sxs-lookup"><span data-stu-id="b537a-116">Future tutorials will examine more advanced editing and deleting scenarios, including input field validation, gracefully handling exceptions raised from the Data Access or Business Logic Layers, and so on.</span></span>

> [!NOTE]
> <span data-ttu-id="b537a-117">DataList と同様にリピータ コントロールには、外の挿入、更新、または削除するボックスの機能が不足しています。</span><span class="sxs-lookup"><span data-stu-id="b537a-117">Like the DataList, the Repeater control lacks the out of the box functionality for inserting, updating, or deleting.</span></span> <span data-ttu-id="b537a-118">このような機能を追加することができます、DataList には、プロパティおよびリピータに見つかりませんを簡単にこのような機能を追加するイベントが含まれます。</span><span class="sxs-lookup"><span data-stu-id="b537a-118">While such functionality can be added, the DataList includes properties and events not found in the Repeater that simplify adding such capabilities.</span></span> <span data-ttu-id="b537a-119">そのため、このチュートリアルを編集および削除を見て今後もにフォーカスが置か厳密に DataList です。</span><span class="sxs-lookup"><span data-stu-id="b537a-119">Therefore, this tutorial and future ones that look at editing and deleting will focus strictly on the DataList.</span></span>


## <a name="step-1-creating-the-editing-and-deleting-tutorials-web-pages"></a><span data-ttu-id="b537a-120">手順 1: 編集と削除のチュートリアルの Web ページの作成</span><span class="sxs-lookup"><span data-stu-id="b537a-120">Step 1: Creating the Editing and Deleting Tutorials Web Pages</span></span>

<span data-ttu-id="b537a-121">更新して、DataList からデータを削除する方法の探索を開始して、前に、まず、このチュートリアルを次のいくつかのものが必要な web サイト プロジェクトに、ASP.NET ページを作成するのにはしばらく s を使用できます。</span><span class="sxs-lookup"><span data-stu-id="b537a-121">Before we start exploring how to update and delete data from a DataList, let s first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial and the next several ones.</span></span> <span data-ttu-id="b537a-122">という名前の新しいフォルダーを追加することによって開始`EditDeleteDataList`です。</span><span class="sxs-lookup"><span data-stu-id="b537a-122">Start by adding a new folder named `EditDeleteDataList`.</span></span> <span data-ttu-id="b537a-123">次に、各ページに関連付けるように、そのフォルダーに次の ASP.NET ページを追加、`Site.master`マスター ページ。</span><span class="sxs-lookup"><span data-stu-id="b537a-123">Next, add the following ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `Basics.aspx`
- `BatchUpdate.aspx`
- `ErrorHandling.aspx`
- `UIValidation.aspx`
- `CustomizedUI.aspx`
- `OptimisticConcurrency.aspx`
- `ConfirmationOnDelete.aspx`
- `UserLevelAccess.aspx`


![チュートリアルについては、ASP.NET ページを追加します。](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image1.png)

<span data-ttu-id="b537a-125">**図 1**: チュートリアルについては、ASP.NET ページを追加します。</span><span class="sxs-lookup"><span data-stu-id="b537a-125">**Figure 1**: Add the ASP.NET Pages for the Tutorials</span></span>


<span data-ttu-id="b537a-126">などの他のフォルダーで`Default.aspx`で、`EditDeleteDataList`フォルダーは、そのセクションのチュートリアルを一覧表示されます。</span><span class="sxs-lookup"><span data-stu-id="b537a-126">Like in the other folders, `Default.aspx` in the `EditDeleteDataList` folder lists the tutorials in its section.</span></span> <span data-ttu-id="b537a-127">注意してください、`SectionLevelTutorialListing.ascx`ユーザー コントロールは、この機能を提供します。</span><span class="sxs-lookup"><span data-stu-id="b537a-127">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="b537a-128">そのため、このユーザー コントロールを追加`Default.aspx`をページのデザイン ビューに、ソリューション エクスプ ローラーからドラッグしています。</span><span class="sxs-lookup"><span data-stu-id="b537a-128">Therefore, add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page s Design view.</span></span>


<span data-ttu-id="b537a-129">[![Default.aspx に SectionLevelTutorialListing.ascx ユーザー コントロールを追加します。](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image3.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="b537a-129">[![Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image3.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image2.png)</span></span>

<span data-ttu-id="b537a-130">**図 2**: 追加、`SectionLevelTutorialListing.ascx`ユーザー コントロールを`Default.aspx`([フルサイズのイメージを表示するをクリックして](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="b537a-130">**Figure 2**: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image4.png))</span></span>


<span data-ttu-id="b537a-131">最後に、エントリとして、ページを追加、`Web.sitemap`ファイル。</span><span class="sxs-lookup"><span data-stu-id="b537a-131">Lastly, add the pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="b537a-132">具体的には、DataList リピータとマスター/詳細レポートの後に、次のマークアップを追加`<siteMapNode>`:</span><span class="sxs-lookup"><span data-stu-id="b537a-132">Specifically, add the following markup after the Master/Detail Reports with the DataList and Repeater `<siteMapNode>`:</span></span>


[!code-xml[Main](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/samples/sample1.xml)]

<span data-ttu-id="b537a-133">更新した後に`Web.sitemap`ブラウザーを使って、チュートリアルの web サイトを表示します。</span><span class="sxs-lookup"><span data-stu-id="b537a-133">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="b537a-134">左側のメニューには、DataList 編集および削除のチュートリアルの項目が含まれています。</span><span class="sxs-lookup"><span data-stu-id="b537a-134">The menu on the left now includes items for the DataList editing and deleting tutorials.</span></span>


![サイト マップでは DataList 編集および削除のチュートリアルのエントリが含まれるようになりました](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image5.png)

<span data-ttu-id="b537a-136">**図 3**: サイト マップでは DataList 編集および削除のチュートリアルのエントリが含まれるようになりました</span><span class="sxs-lookup"><span data-stu-id="b537a-136">**Figure 3**: The Site Map Now Includes Entries for the DataList Editing and Deleting Tutorials</span></span>


## <a name="step-2-examining-techniques-for-updating-and-deleting-data"></a><span data-ttu-id="b537a-137">手順 2: データを更新し、削除の方法を確認します。</span><span class="sxs-lookup"><span data-stu-id="b537a-137">Step 2: Examining Techniques for Updating and Deleting Data</span></span>

<span data-ttu-id="b537a-138">編集および GridView にデータの削除はとても簡単、背後の ObjectDataSource、GridView 連携動作です。</span><span class="sxs-lookup"><span data-stu-id="b537a-138">Editing and deleting data with the GridView is so easy because, underneath the covers, the GridView and ObjectDataSource work in concert.</span></span> <span data-ttu-id="b537a-139">説明したように、 [、イベントに関連付けられている挿入、更新、および削除を確認する](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-cs.md)チュートリアルでは、行の更新 ボタンがクリックされたときに、GridView を自動的に割り当てます、に双方向データバインドを使用するフィールド`UpdateParameters` 、ObjectDataSource を集めた ObjectDataSource s を呼び出して`Update()`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="b537a-139">As discussed in the [Examining the Events Associated with Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-cs.md) tutorial, when a row s Update button is clicked, the GridView automatically assigns its fields that used two-way databinding to the `UpdateParameters` collection of its ObjectDataSource and then invokes that ObjectDataSource s `Update()` method.</span></span>

<span data-ttu-id="b537a-140">残念ながら、DataList では、この組み込みの機能のいずれかの用意されていません。</span><span class="sxs-lookup"><span data-stu-id="b537a-140">Sadly, the DataList does not provide any of this built-in functionality.</span></span> <span data-ttu-id="b537a-141">ObjectDataSource のパラメーターにユーザー秒の値が割り当てられていることを確認する責任はその`Update()`メソッドが呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="b537a-141">It is our responsibility to ensure that the user s values are assigned to the ObjectDataSource s parameters and that its `Update()` method is called.</span></span> <span data-ttu-id="b537a-142">私たちを役立てるため、この作業は、DataList は、次のプロパティとイベントを提供します。</span><span class="sxs-lookup"><span data-stu-id="b537a-142">To aid us in this endeavor, the DataList provides the following properties and events:</span></span>

- <span data-ttu-id="b537a-143">**[ `DataKeyField`プロパティ](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.basedatalist.datakeyfield.aspx)**更新または削除すると、DataList 内の各項目を一意に識別できる必要があります。</span><span class="sxs-lookup"><span data-stu-id="b537a-143">**The [`DataKeyField` property](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.basedatalist.datakeyfield.aspx)** when updating or deleting, we need to be able to uniquely identify each item in the DataList.</span></span> <span data-ttu-id="b537a-144">このプロパティは、表示されるデータの主キー フィールドに設定します。</span><span class="sxs-lookup"><span data-stu-id="b537a-144">Set this property to the primary key field of the displayed data.</span></span> <span data-ttu-id="b537a-145">DataList s を表示するように[`DataKeys`コレクション](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.basedatalist.datakeys.aspx)、指定した`DataKeyField`DataList の各項目の値。</span><span class="sxs-lookup"><span data-stu-id="b537a-145">Doing so will populate the DataList s [`DataKeys` collection](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.basedatalist.datakeys.aspx) with the specified `DataKeyField` value for each DataList item.</span></span>
- <span data-ttu-id="b537a-146">**[ `EditCommand`イベント](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.datalist.editcommand.aspx)**ボタン、LinkButton、または ImageButton ときに発生が`CommandName`プロパティに設定されている編集をクリックします。</span><span class="sxs-lookup"><span data-stu-id="b537a-146">**The [`EditCommand` event](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.datalist.editcommand.aspx)** fires when a Button, LinkButton, or ImageButton whose `CommandName` property is set to Edit is clicked.</span></span>
- <span data-ttu-id="b537a-147">**[ `CancelCommand`イベント](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.datalist.cancelcommand.aspx)**ボタン、LinkButton、または ImageButton ときに発生が`CommandName`プロパティに設定されている [キャンセル] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="b537a-147">**The [`CancelCommand` event](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.datalist.cancelcommand.aspx)** fires when a Button, LinkButton, or ImageButton whose `CommandName` property is set to Cancel is clicked.</span></span>
- <span data-ttu-id="b537a-148">**[ `UpdateCommand`イベント](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.datalist.updatecommand.aspx)**ボタン、LinkButton、または ImageButton ときに発生が`CommandName`プロパティに設定されている更新プログラムをクリックします。</span><span class="sxs-lookup"><span data-stu-id="b537a-148">**The [`UpdateCommand` event](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.datalist.updatecommand.aspx)** fires when a Button, LinkButton, or ImageButton whose `CommandName` property is set to Update is clicked.</span></span>
- <span data-ttu-id="b537a-149">**[ `DeleteCommand`イベント](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.datalist.deletecommand.aspx)**ボタン、LinkButton、または ImageButton ときに発生が`CommandName`プロパティに設定されている Delete をクリックします。</span><span class="sxs-lookup"><span data-stu-id="b537a-149">**The [`DeleteCommand` event](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.datalist.deletecommand.aspx)** fires when a Button, LinkButton, or ImageButton whose `CommandName` property is set to Delete is clicked.</span></span>

<span data-ttu-id="b537a-150">これらのプロパティとイベントを使用して、4 つの方法お使用して更新し、DataList からデータを削除できます。</span><span class="sxs-lookup"><span data-stu-id="b537a-150">Using these properties and events, there are four approaches we can use to update and delete data from the DataList:</span></span>

1. <span data-ttu-id="b537a-151">**ASP.NET 1.x 手法を使用して**DataList ASP.NET 2.0 および ObjectDataSources する前に存在し、プログラムによる方法ですべてのデータ更新および削除することができます。</span><span class="sxs-lookup"><span data-stu-id="b537a-151">**Using ASP.NET 1.x Techniques** the DataList existed prior to ASP.NET 2.0 and ObjectDataSources and was able to update and delete data entirely through programmatic means.</span></span> <span data-ttu-id="b537a-152">この方法は、ObjectDataSource をまったく ditches、両方表示するデータの取得中にビジネス ロジック層から直接、DataList にデータのバインドが必要とされ、更新、またはレコードを削除するとします。</span><span class="sxs-lookup"><span data-stu-id="b537a-152">This technique ditches the ObjectDataSource altogether and requires that we bind the data to the DataList directly from the Business Logic Layer, both in retrieving the data to display and when updating or deleting a record.</span></span>
2. <span data-ttu-id="b537a-153">**ページ上の単一 ObjectDataSource コントロールを使用して、選択すると、更新、および削除の**DataList は GridView s 本質的な編集と削除機能がない、ときに s t ことが理由なしで追加自分でします。</span><span class="sxs-lookup"><span data-stu-id="b537a-153">**Using a Single ObjectDataSource Control on the Page for Selecting, Updating, and Deleting** while the DataList lacks the GridView s inherent editing and deleting capabilities, there s no reason we can t add them in ourselves.</span></span> <span data-ttu-id="b537a-154">この方法でお GridView の例と同じように、ObjectDataSource を使用してが DataList s のイベント ハンドラーを作成する必要があります`UpdateCommand`イベント、ObjectDataSource のパラメーターと呼び出しをセットしてその`Update()`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="b537a-154">With this approach, we use an ObjectDataSource just like in the GridView examples, but must create an event handler for the DataList s `UpdateCommand` event where we set the ObjectDataSource s parameters and call its `Update()` method.</span></span>
3. <span data-ttu-id="b537a-155">**ObjectDataSource コントロールを使用して、選択するが、更新および削除すると直接に対して、BLL**オプション 2 を使用する場合のコードのビットを書き込む必要があります、`UpdateCommand`などのパラメーター値の割り当てイベント。</span><span class="sxs-lookup"><span data-stu-id="b537a-155">**Using an ObjectDataSource Control for Selecting, but Updating and Deleting Directly Against the BLL** when using option 2, we need to write a bit of code in the `UpdateCommand` event, assigning parameter values and so on.</span></span> <span data-ttu-id="b537a-156">代わりに、ObjectDataSource を使用して、選択するためのオプションを使用しましたが、BLL (と同じように 1 をオプションと共に使用) に対して直接更新と削除の呼び出しを行います。</span><span class="sxs-lookup"><span data-stu-id="b537a-156">Instead, we can stick with using the ObjectDataSource for selecting, but make the updating and deleting calls directly against the BLL (like with option 1).</span></span> <span data-ttu-id="b537a-157">筆者の意見で BLL と直接やり取りによりデータの更新、ObjectDataSource s を割り当てるよりも読みやすいコードに潜在顧客`UpdateParameters`を呼び出すと、`Update()`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="b537a-157">In my opinion, updating data by interfacing directly with the BLL leads to more readable code than assigning the ObjectDataSource s `UpdateParameters` and calling its `Update()` method.</span></span>
4. <span data-ttu-id="b537a-158">**複数 ObjectDataSources を通じて宣言的な手段を使用して**すべて前の 3 つの方法は、少量のコードを必要とします。</span><span class="sxs-lookup"><span data-stu-id="b537a-158">**Using Declarative Means through Multiple ObjectDataSources** the previous three approaches all require a bit of code.</span></span> <span data-ttu-id="b537a-159">使用する場合 d ではなく保持可能なかなりの宣言の構文として、最後のオプション ページでの複数の ObjectDataSources を含めるを開始します。</span><span class="sxs-lookup"><span data-stu-id="b537a-159">If you d rather keep using as much declarative syntax as possible, a final option is to include multiple ObjectDataSources on the page.</span></span> <span data-ttu-id="b537a-160">最初の ObjectDataSource は BLL からデータを取得し、DataList にバインドします。</span><span class="sxs-lookup"><span data-stu-id="b537a-160">The first ObjectDataSource retrieves the data from the BLL and binds it to the DataList.</span></span> <span data-ttu-id="b537a-161">別の ObjectDataSource の追加しますが、DataList s 内に直接追加の更新、`EditItemTemplate`です。</span><span class="sxs-lookup"><span data-stu-id="b537a-161">For updating, another ObjectDataSource is added, but added directly within the DataList s `EditItemTemplate`.</span></span> <span data-ttu-id="b537a-162">サポートの削除は、まだ別 ObjectDataSource 本来必要で、`ItemTemplate`です。</span><span class="sxs-lookup"><span data-stu-id="b537a-162">To include deleting support, yet another ObjectDataSource would be needed in the `ItemTemplate`.</span></span> <span data-ttu-id="b537a-163">この方法でこれらの埋め込まれた ObjectDataSource の使用`ControlParameters`宣言によって ObjectDataSource のパラメーターをユーザーの入力コントロールにバインドする (DataList s でプログラムで指定する必要はなく`UpdateCommand`イベント ハンドラー)。</span><span class="sxs-lookup"><span data-stu-id="b537a-163">With this approach, these embedded ObjectDataSource s use `ControlParameters` to declaratively bind the ObjectDataSource s parameters to the user input controls (rather than having to specify them programmatically in the DataList s `UpdateCommand` event handler).</span></span> <span data-ttu-id="b537a-164">このアプローチには少量のコードを埋め込み、ObjectDataSource s を呼び出す必要がありますが必要である`Update()`または`Delete()`3 つのアプローチを他のより小さい値までのコマンドが必要です。</span><span class="sxs-lookup"><span data-stu-id="b537a-164">This approach still requires a bit of code we need to call the embedded ObjectDataSource s `Update()` or `Delete()` command but requires far less than with the other three approaches.</span></span> <span data-ttu-id="b537a-165">欠点は、ここでは、こと複数 ObjectDataSources は塞ぎ、ページ全体の読みやすさが低下します。</span><span class="sxs-lookup"><span data-stu-id="b537a-165">The downside here is that the multiple ObjectDataSources do clutter up the page, detracting from the overall readability.</span></span>

<span data-ttu-id="b537a-166">強制された場合だけこれらのアプローチのいずれかを使用する、d を選択オプション 1 に、このパターンに合わせて設計された、DataList、最大限の柔軟性を提供するためです。</span><span class="sxs-lookup"><span data-stu-id="b537a-166">If forced to only ever use one of these approaches, I d choose option 1 because it provides the most flexibility and because the DataList was originally designed to accommodate this pattern.</span></span> <span data-ttu-id="b537a-167">DataList は、ASP.NET 2.0 のデータ ソース コントロールを使用する拡張された、すべての機能拡張ポイントまたは正式な ASP.NET 2.0 のデータ (GridView、DetailsView、およびフォーム ビュー) の Web コントロールの機能にはありません。</span><span class="sxs-lookup"><span data-stu-id="b537a-167">While the DataList was extended to work with the ASP.NET 2.0 data source controls, it does not have all of the extensibility points or features of the official ASP.NET 2.0 data Web controls (the GridView, DetailsView, and FormView).</span></span> <span data-ttu-id="b537a-168">オプション 2. ~ 4. いない価値、せずただしされます。</span><span class="sxs-lookup"><span data-stu-id="b537a-168">Options 2 through 4 are not without merit, though.</span></span>

<span data-ttu-id="b537a-169">これと、今後編集および削除のチュートリアルは使用、ObjectDataSource データを取得する表示し、データ (オプション 3) を更新および削除 BLL への呼び出しを指示します。</span><span class="sxs-lookup"><span data-stu-id="b537a-169">This and the future editing and deleting tutorials will use an ObjectDataSource for retrieving the data to display and direct calls to the BLL to update and delete data (option 3).</span></span>

## <a name="step-3-adding-the-datalist-and-configuring-its-objectdatasource"></a><span data-ttu-id="b537a-170">手順 3: DataList を追加して、ObjectDataSource を構成します。</span><span class="sxs-lookup"><span data-stu-id="b537a-170">Step 3: Adding the DataList and Configuring its ObjectDataSource</span></span>

<span data-ttu-id="b537a-171">このチュートリアルでは、DataList 製品情報を一覧表示し、各製品の機能を提供、ユーザーの名前と価格を編集し、製品を完全に削除することを作成します。</span><span class="sxs-lookup"><span data-stu-id="b537a-171">In this tutorial we will create a DataList that lists product information and, for each product, provides the user the ability to edit the name and price and to delete the product altogether.</span></span> <span data-ttu-id="b537a-172">具体的には、おは取得、ObjectDataSource を使用して表示するレコードが更新を実行し、BLL と直接やり取りしてアクションを削除します。</span><span class="sxs-lookup"><span data-stu-id="b537a-172">In particular, we will retrieve the records to display using an ObjectDataSource, but perform the update and delete actions by interfacing directly with the BLL.</span></span> <span data-ttu-id="b537a-173">DataList を編集および削除する機能を実装する心配し、前に読み取り専用のインターフェイスに製品を表示するページをまず取得 s を使用できます。</span><span class="sxs-lookup"><span data-stu-id="b537a-173">Before we worry about implementing the editing and deleting capabilities to the DataList, let s first get the page to display the products in a read-only interface.</span></span> <span data-ttu-id="b537a-174">以降お ve が次の手順を調べる前のチュートリアルではあります続行それらを簡単にします。</span><span class="sxs-lookup"><span data-stu-id="b537a-174">Since we ve examined these steps in previous tutorials, I'll proceed through them quickly.</span></span>

<span data-ttu-id="b537a-175">開いて開始、 `Basics.aspx`  ページで、`EditDeleteDataList`フォルダーと、デザイン ビューから、DataList をページに追加します。</span><span class="sxs-lookup"><span data-stu-id="b537a-175">Start by opening the `Basics.aspx` page in the `EditDeleteDataList` folder and, from the Design view, add a DataList to the page.</span></span> <span data-ttu-id="b537a-176">次に、DataList s のスマート タグから新しい ObjectDataSource を作成します。</span><span class="sxs-lookup"><span data-stu-id="b537a-176">Next, from the DataList s smart tag, create a new ObjectDataSource.</span></span> <span data-ttu-id="b537a-177">製品データを使用している、のでするように構成を使用して、`ProductsBLL`クラスです。</span><span class="sxs-lookup"><span data-stu-id="b537a-177">Since we are working with product data, configure it to use the `ProductsBLL` class.</span></span> <span data-ttu-id="b537a-178">取得する*すべて*、製品を選択、`GetProducts()`メソッドを選択 タブにします。</span><span class="sxs-lookup"><span data-stu-id="b537a-178">To retrieve *all* products, choose the `GetProducts()` method in the SELECT tab.</span></span>


<span data-ttu-id="b537a-179">[![構成、ObjectDataSource ProductsBLL クラスを使用するには](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image7.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="b537a-179">[![Configure the ObjectDataSource to Use the ProductsBLL Class](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image7.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image6.png)</span></span>

<span data-ttu-id="b537a-180">**図 4**: 構成を使用する ObjectDataSource、`ProductsBLL`クラス ([フルサイズのイメージを表示するをクリックして](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="b537a-180">**Figure 4**: Configure the ObjectDataSource to Use the `ProductsBLL` Class ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image8.png))</span></span>


<span data-ttu-id="b537a-181">[![GetProducts() メソッドを使用して製品情報を返す](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image10.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="b537a-181">[![Return the Product Information Using the GetProducts() Method](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image10.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image9.png)</span></span>

<span data-ttu-id="b537a-182">**図 5**: 製品を使用して情報を返す、`GetProducts()`メソッド ([フルサイズのイメージを表示するをクリックして](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="b537a-182">**Figure 5**: Return the Product Information Using the `GetProducts()` Method ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image11.png))</span></span>


<span data-ttu-id="b537a-183">GridView のように、DataList ものではありません。 新しいデータを挿入します。このため、挿入 タブで、ドロップダウン リストからオプション (なし)。(なし)、UPDATE および DELETE のタブのため、更新および削除は、BLL 経由でプログラムによって実行されます。</span><span class="sxs-lookup"><span data-stu-id="b537a-183">The DataList, like the GridView, is not designed for inserting new data; therefore, select the (None) option from the drop-down list in the INSERT tab. Also choose (None) for the UPDATE and DELETE tabs since the updates and deletes will be performed programmatically through the BLL.</span></span>


<span data-ttu-id="b537a-184">[![(なし) に ObjectDataSource の挿入のドロップダウンを一覧表示、更新、および削除のタブを設定することを確認します。](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image13.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="b537a-184">[![Confirm that the Drop-Down Lists in the ObjectDataSource s INSERT, UPDATE, and DELETE Tabs are Set to (None)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image13.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image12.png)</span></span>

<span data-ttu-id="b537a-185">**図 6**: ObjectDataSource の INSERT、UPDATE、および削除のタブで、ドロップダウン リストは、(なし) に設定されていることを確認 ([フルサイズのイメージを表示するをクリックして](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="b537a-185">**Figure 6**: Confirm that the Drop-Down Lists in the ObjectDataSource s INSERT, UPDATE, and DELETE Tabs are Set to (None) ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image14.png))</span></span>


<span data-ttu-id="b537a-186">ObjectDataSource を構成した後、デザイナーに戻る、[完了] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="b537a-186">After configuring the ObjectDataSource, click Finish, returning to the Designer.</span></span> <span data-ttu-id="b537a-187">おとして自動的に Visual Studio、ObjectDataSource 構成を完了するときに、過去の例で見てきましたが作成、`ItemTemplate`の DropDownList の各データ フィールドを表示します。</span><span class="sxs-lookup"><span data-stu-id="b537a-187">As we ve seen in past examples, when completing the ObjectDataSource configuration, Visual Studio automatically creates an `ItemTemplate` for the DropDownList, displaying each of the data fields.</span></span> <span data-ttu-id="b537a-188">これを置き換える`ItemTemplate`製品の名前と価格を表示するものとします。</span><span class="sxs-lookup"><span data-stu-id="b537a-188">Replace this `ItemTemplate` with one that displays only the product s name and price.</span></span> <span data-ttu-id="b537a-189">また、設定、`RepeatColumns`プロパティを 2 です。</span><span class="sxs-lookup"><span data-stu-id="b537a-189">Also, set the `RepeatColumns` property to 2.</span></span>

> [!NOTE]
> <span data-ttu-id="b537a-190">説明したように、*の概要の挿入、更新、およびデータの削除*チュートリアルでは、当社アーキテクチャでは、削除する必要があります ObjectDataSource を使用してデータを変更するときに、 `OldValuesParameterFormatString` ObjectDataSource s からプロパティ宣言型マークアップ (またはその既定値にリセット`{0}`)。</span><span class="sxs-lookup"><span data-stu-id="b537a-190">As discussed in the *Overview of Inserting, Updating, and Deleting Data* tutorial, when modifying data using the ObjectDataSource our architecture requires that we remove the `OldValuesParameterFormatString` property from the ObjectDataSource s declarative markup (or reset it to its default value, `{0}`).</span></span> <span data-ttu-id="b537a-191">このチュートリアルでただし、使用している、ObjectDataSource のみデータを取得します。</span><span class="sxs-lookup"><span data-stu-id="b537a-191">In this tutorial, however, we are using the ObjectDataSource only for retrieving data.</span></span> <span data-ttu-id="b537a-192">そのため、お ObjectDataSource s を変更する必要はありません`OldValuesParameterFormatString`プロパティの値 (ですが、これを行うには t を低下させる可能性)。</span><span class="sxs-lookup"><span data-stu-id="b537a-192">Therefore, we do not need to modify the ObjectDataSource s `OldValuesParameterFormatString` property value (although it doesn t hurt to do so).</span></span>


<span data-ttu-id="b537a-193">既定値 DataList に置き換えた後に`ItemTemplate`カスタマイズされたもので、ページの宣言型マークアップは、次のようななります。</span><span class="sxs-lookup"><span data-stu-id="b537a-193">After replacing the default DataList `ItemTemplate` with a customized one, the declarative markup on your page should look similar to the following:</span></span>


[!code-aspx[Main](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/samples/sample2.aspx)]

<span data-ttu-id="b537a-194">ブラウザーを使って作業の進行状況を表示するのにはしばらくを実行します。</span><span class="sxs-lookup"><span data-stu-id="b537a-194">Take a moment to view our progress through a browser.</span></span> <span data-ttu-id="b537a-195">図 7 に示す、DataList は 2 つの列に各製品の製品名および単価を表示します。</span><span class="sxs-lookup"><span data-stu-id="b537a-195">As Figure 7 shows, the DataList displays the product name and unit price for each product in two columns.</span></span>


<span data-ttu-id="b537a-196">[![製品の名前と価格は、2 つの列 DataList に表示されます。](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image16.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="b537a-196">[![The Products Names and Prices are Displayed in a Two-Column DataList](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image16.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image15.png)</span></span>

<span data-ttu-id="b537a-197">**図 7**: 2 つの列 DataList に、製品名および価格が表示されます ([フルサイズのイメージを表示するをクリックして](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="b537a-197">**Figure 7**: The Products Names and Prices are Displayed in a Two-Column DataList ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image17.png))</span></span>


> [!NOTE]
> <span data-ttu-id="b537a-198">DataList はさまざまな更新と削除プロセスでは、必要なプロパティを持ち、ビュー ステートにこれらの値が格納されています。</span><span class="sxs-lookup"><span data-stu-id="b537a-198">The DataList has a number of properties that are required for the updating and deleting process, and these values are stored in view state.</span></span> <span data-ttu-id="b537a-199">したがって、DataList の構築をサポートしている編集またはデータを削除するときに、DataList のビュー ステートを有効にする必要です。</span><span class="sxs-lookup"><span data-stu-id="b537a-199">Therefore, when building a DataList that supports editing or deleting data, it is essential that the DataList s view state be enabled.</span></span>  
>   
>  <span data-ttu-id="b537a-200">絶好のリーダーはでした。 編集可能な Gridview、DetailsViews、および FormViews を作成するときに、ビュー ステートを無効にすることを注意してください。</span><span class="sxs-lookup"><span data-stu-id="b537a-200">The astute reader may recall that we were able to disable view state when creating editable GridViews, DetailsViews, and FormViews.</span></span> <span data-ttu-id="b537a-201">これは、ASP.NET 2.0 Web コントロールを含めることができますので*状態の制御*、どのビュー ステートがみなし essential のようなポストバック間で状態が保持します。</span><span class="sxs-lookup"><span data-stu-id="b537a-201">This is because ASP.NET 2.0 Web controls can include *control state*, which is state persisted across postbacks like view state, but deemed essential.</span></span>


<span data-ttu-id="b537a-202">無効にする GridView で状態だけで、単純な状態情報を省略が、コントロールの状態 (を編集および削除するために必要な状態を含む) を保持します。</span><span class="sxs-lookup"><span data-stu-id="b537a-202">Disabling view state in the GridView merely omits trivial state information, but maintains the control state (which includes the state necessary for editing and deleting).</span></span> <span data-ttu-id="b537a-203">ASP.NET 1.x 時期に作成されている、DataList コントロールの状態を使用しないと、したがって、ビュー ステートを有効になっている必要があります。</span><span class="sxs-lookup"><span data-stu-id="b537a-203">The DataList, having been created in the ASP.NET 1.x timeframe, does not utilize control state and therefore must have view state enabled.</span></span> <span data-ttu-id="b537a-204">参照してください[コントロールの状態とします。ビュー ステート](https://msdn.microsoft.com/en-us/library/1whwt1k7.aspx)について、目的のコントロールの状態と表示状態とは異なる方法です。</span><span class="sxs-lookup"><span data-stu-id="b537a-204">See [Control State vs. View State](https://msdn.microsoft.com/en-us/library/1whwt1k7.aspx) for more information on the purpose of control state and how it differs from view state.</span></span>

## <a name="step-4-adding-an-editing-user-interface"></a><span data-ttu-id="b537a-205">手順 4: 編集のユーザー インターフェイスの追加</span><span class="sxs-lookup"><span data-stu-id="b537a-205">Step 4: Adding an Editing User Interface</span></span>

<span data-ttu-id="b537a-206">GridView コントロールは、フィールド (BoundFields CheckBoxFields、TemplateFields、やなど) のコレクションで構成されます。</span><span class="sxs-lookup"><span data-stu-id="b537a-206">The GridView control is composed of a collection of fields (BoundFields, CheckBoxFields, TemplateFields, and so on).</span></span> <span data-ttu-id="b537a-207">これらのフィールドには、そのモードによって、レンダリングされるマークアップを調整できます。</span><span class="sxs-lookup"><span data-stu-id="b537a-207">These fields can adjust their rendered markup depending on their mode.</span></span> <span data-ttu-id="b537a-208">たとえば、読み取り専用モードのときに、BoundField、データ フィールドの値テキストとして表示;編集モードで表示 ボックスに Web いるコントロール`Text`プロパティには、データ フィールドの値が割り当てられます。</span><span class="sxs-lookup"><span data-stu-id="b537a-208">For example, when in read-only mode, a BoundField displays its data field value as text; when in edit mode, it renders a TextBox Web control whose `Text` property is assigned the data field value.</span></span>

<span data-ttu-id="b537a-209">DataList は、その一方で、テンプレートを使用してその項目をレンダリングします。</span><span class="sxs-lookup"><span data-stu-id="b537a-209">The DataList, on the other hand, renders its items using templates.</span></span> <span data-ttu-id="b537a-210">読み取り専用の項目を表示するを使用して、`ItemTemplate`経由で編集モードでのアイテムがレンダリングされる一方、`EditItemTemplate`です。</span><span class="sxs-lookup"><span data-stu-id="b537a-210">Read-only items are rendered using the `ItemTemplate` whereas items in edit mode are rendered via the `EditItemTemplate`.</span></span> <span data-ttu-id="b537a-211">この時点で、DataList はのみが、`ItemTemplate`です。</span><span class="sxs-lookup"><span data-stu-id="b537a-211">At this point, our DataList has only an `ItemTemplate`.</span></span> <span data-ttu-id="b537a-212">項目レベルの編集機能を追加する必要がありますをサポートするために、`EditItemTemplate`編集可能な項目を表示するマークアップを格納しています。</span><span class="sxs-lookup"><span data-stu-id="b537a-212">To support item-level editing functionality we need to add an `EditItemTemplate` that contains the markup to be displayed for the editable item.</span></span> <span data-ttu-id="b537a-213">このチュートリアルを秒の製品名および単価を編集するため、TextBox Web コントロールを使用します。</span><span class="sxs-lookup"><span data-stu-id="b537a-213">For this tutorial, we'll use TextBox Web controls for editing the product s name and unit price.</span></span>

<span data-ttu-id="b537a-214">`EditItemTemplate` (オプションを選択して、テンプレートの編集、DataList s のスマート タグから) 宣言的またはデザイナーのいずれかに作成できます。</span><span class="sxs-lookup"><span data-stu-id="b537a-214">The `EditItemTemplate` can be created either declaratively or through the Designer (by selecting the Edit Templates option from the DataList s smart tag).</span></span> <span data-ttu-id="b537a-215">テンプレートの編集オプションを使用する 最初にスマート タグのテンプレートの編集リンクをクリックし、選択、`EditItemTemplate`ドロップダウン リストから項目。</span><span class="sxs-lookup"><span data-stu-id="b537a-215">To use the Edit Templates option, first click the Edit Templates link in the smart tag and then select the `EditItemTemplate` item from the drop-down list.</span></span>


<span data-ttu-id="b537a-216">[![DataList の EditItemTemplate で作業することを選択します。](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image19.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="b537a-216">[![Opt to Work with the DataList s EditItemTemplate](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image19.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image18.png)</span></span>

<span data-ttu-id="b537a-217">**図 8**: DataList s で作業することを選択`EditItemTemplate`([フルサイズのイメージを表示するをクリックして](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="b537a-217">**Figure 8**: Opt to Work with the DataList s `EditItemTemplate` ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image20.png))</span></span>


<span data-ttu-id="b537a-218">次に、製品名を入力: と価格: ツールボックスから 2 つのテキスト ボックス コントロールをドラッグし、`EditItemTemplate`デザイナー上のインターフェイスです。</span><span class="sxs-lookup"><span data-stu-id="b537a-218">Next, type in Product name: and Price: and then drag two TextBox controls from the Toolbox into the `EditItemTemplate` interface on the Designer.</span></span> <span data-ttu-id="b537a-219">テキスト ボックスの設定`ID`プロパティ`ProductName`と`UnitPrice`です。</span><span class="sxs-lookup"><span data-stu-id="b537a-219">Set the TextBoxes `ID` properties to `ProductName` and `UnitPrice`.</span></span>


<span data-ttu-id="b537a-220">[![製品の名前と価格のテキスト ボックスを追加します。](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image22.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="b537a-220">[![Add a TextBox for the Product s Name and Price](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image22.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image21.png)</span></span>

<span data-ttu-id="b537a-221">**図 9**: 製品名をテキスト ボックスと価格の追加 ([フルサイズのイメージを表示するをクリックして](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="b537a-221">**Figure 9**: Add a TextBox for the Product s Name and Price ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image23.png))</span></span>


<span data-ttu-id="b537a-222">対応する製品データ フィールドの値をバインドする必要があります、`Text`の 2 つのテキスト ボックスのプロパティです。</span><span class="sxs-lookup"><span data-stu-id="b537a-222">We need to bind the corresponding product data field values to the `Text` properties of the two TextBoxes.</span></span> <span data-ttu-id="b537a-223">テキスト ボックスのスマート タグから databindings の編集 リンクをクリックし、適切なデータ フィールドを関連付ける、`Text`プロパティ、図 10 に示すようにします。</span><span class="sxs-lookup"><span data-stu-id="b537a-223">From the TextBoxes smart tags, click on the Edit DataBindings link and then associate the appropriate data field with the `Text` property, as shown in Figure 10.</span></span>

> [!NOTE]
> <span data-ttu-id="b537a-224">バインドするときに、`UnitPrice`データ フィールド ボックスに秒の価格を`Text`フィールド、可能性があります形式にすると、通貨の値 (`{0:C}`) は通常の数値 (`{0:N}`)、書式設定なしのままにします。</span><span class="sxs-lookup"><span data-stu-id="b537a-224">When binding the `UnitPrice` data field to the price TextBox s `Text` field, you may format it as a currency value (`{0:C}`), a general number (`{0:N}`), or leave it unformatted.</span></span>


![ProductName と UnitPrice データ フィールドをテキスト ボックスのテキストのプロパティにバインドします。](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image24.png)

<span data-ttu-id="b537a-226">**図 10**: バインド、`ProductName`と`UnitPrice`データ フィールドを`Text`のテキスト ボックスのプロパティ</span><span class="sxs-lookup"><span data-stu-id="b537a-226">**Figure 10**: Bind the `ProductName` and `UnitPrice` Data Fields to the `Text` Properties of the TextBoxes</span></span>


<span data-ttu-id="b537a-227">図 10 で databindings の編集 ダイアログ ボックスでは方法に注意してください*いない*GridView または DetailsView、TemplateField または FormView でテンプレートを編集するときに表示される双方向データ バインドのチェック ボックスが含まれます。</span><span class="sxs-lookup"><span data-stu-id="b537a-227">Notice how the Edit DataBindings dialog box in Figure 10 does *not* include the Two-way databinding checkbox that is present when editing a TemplateField in the GridView or DetailsView, or a template in the FormView.</span></span> <span data-ttu-id="b537a-228">双方向データ バインド機能に対応する ObjectDataSource 秒に自動的に割り当てられる入力 Web コントロールに入力した値が許可されている`InsertParameters`または`UpdateParameters`挿入またはデータを更新する場合。</span><span class="sxs-lookup"><span data-stu-id="b537a-228">The two-way databinding feature allowed the value entered into the input Web control to be automatically assigned to the corresponding ObjectDataSource s `InsertParameters` or `UpdateParameters` when inserting or updating data.</span></span> <span data-ttu-id="b537a-229">DataList が双方向データ バインドをサポートするいないと思います後でこのチュートリアルで変更し、データを更新する準備が自分のユーザーが後に、プログラムによってこれらのテキスト ボックスにアクセスする必要があります`Text`プロパティとそれらの値にパスします。適切な`UpdateProduct`メソッドで、`ProductsBLL`クラスです。</span><span class="sxs-lookup"><span data-stu-id="b537a-229">The DataList does not support two-way databinding as we'll see later on in this tutorial, after the user makes her changes and is ready to update the data, we will need to programmatically access these TextBoxes `Text` properties and pass in their values to the appropriate `UpdateProduct` method in the `ProductsBLL` class.</span></span>

<span data-ttu-id="b537a-230">最後に、更新プログラムを追加する必要がありますとキャンセルするボタン、`EditItemTemplate`です。</span><span class="sxs-lookup"><span data-stu-id="b537a-230">Finally, we need to add Update and Cancel buttons to the `EditItemTemplate`.</span></span> <span data-ttu-id="b537a-231">示したように、[マスター/詳細レコードを使用して、箇条書きリストのマスター詳細 DataList で](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md)チュートリアルでは、ボタン、LinkButton、または ImageButton が`CommandName`プロパティが設定されてリピータまたは DataList、内からのクリックしてが、リピータまたは DataList の`ItemCommand`イベントが発生します。</span><span class="sxs-lookup"><span data-stu-id="b537a-231">As we saw in the [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) tutorial, when a Button, LinkButton, or ImageButton whose `CommandName` property is set is clicked from within a Repeater or DataList, the Repeater or DataList s `ItemCommand` event is raised.</span></span> <span data-ttu-id="b537a-232">DataList の場合、`CommandName`プロパティが特定の値に設定、追加のイベントはも発生する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="b537a-232">For the DataList, if the `CommandName` property is set to a certain value, an additional event may be raised as well.</span></span> <span data-ttu-id="b537a-233">特別な`CommandName`の他のプロパティの値が含まれます。</span><span class="sxs-lookup"><span data-stu-id="b537a-233">The special `CommandName` property values include, among others:</span></span>

- <span data-ttu-id="b537a-234">キャンセルが発生し、`CancelCommand`イベント</span><span class="sxs-lookup"><span data-stu-id="b537a-234">Cancel raises the `CancelCommand` event</span></span>
- <span data-ttu-id="b537a-235">編集が発生し、`EditCommand`イベント</span><span class="sxs-lookup"><span data-stu-id="b537a-235">Edit raises the `EditCommand` event</span></span>
- <span data-ttu-id="b537a-236">更新が発生し、`UpdateCommand`イベント</span><span class="sxs-lookup"><span data-stu-id="b537a-236">Update raises the `UpdateCommand` event</span></span>

<span data-ttu-id="b537a-237">これらのイベントが発生したことに注意してください*に加えて*、`ItemCommand`イベント。</span><span class="sxs-lookup"><span data-stu-id="b537a-237">Keep in mind that these events are raised *in addition to* the `ItemCommand` event.</span></span>

<span data-ttu-id="b537a-238">追加、 `EditItemTemplate` 2 つのボタンの Web コントロール、1 つ持つ`CommandName`更新と [キャンセル] を設定、他の秒に設定されています。</span><span class="sxs-lookup"><span data-stu-id="b537a-238">Add to the `EditItemTemplate` two Button Web controls, one whose `CommandName` is set to Update and the other s set to Cancel.</span></span> <span data-ttu-id="b537a-239">これら 2 つのボタンの Web コントロールを追加した後、デザイナーは、次のようになります。</span><span class="sxs-lookup"><span data-stu-id="b537a-239">After adding these two Button Web controls the Designer should look similar to the following:</span></span>


<span data-ttu-id="b537a-240">[![更新プログラムを追加し、キャンセル、EditItemTemplate するボタン](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image26.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="b537a-240">[![Add Update and Cancel Buttons to the EditItemTemplate](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image26.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image25.png)</span></span>

<span data-ttu-id="b537a-241">**図 11**: 更新プログラムの追加とキャンセル ボタン、 `EditItemTemplate` ([フルサイズのイメージを表示するをクリックして](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="b537a-241">**Figure 11**: Add Update and Cancel Buttons to the `EditItemTemplate` ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image27.png))</span></span>


<span data-ttu-id="b537a-242">`EditItemTemplate`完了、DataList s 宣言型マークアップのようになります次。</span><span class="sxs-lookup"><span data-stu-id="b537a-242">With the `EditItemTemplate` complete your DataList s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/samples/sample3.aspx)]

## <a name="step-5-adding-the-plumbing-to-enter-edit-mode"></a><span data-ttu-id="b537a-243">手順 5: 編集モードに組み込みの追加</span><span class="sxs-lookup"><span data-stu-id="b537a-243">Step 5: Adding the Plumbing to Enter Edit Mode</span></span>

<span data-ttu-id="b537a-244">この時点で編集インターフェイスによって定義されているは、DataList その`EditItemTemplate`。 ただし、ある s 現在方法がありませんのユーザーが、ページを訪問した製品の情報を編集することを示すためにします。</span><span class="sxs-lookup"><span data-stu-id="b537a-244">At this point our DataList has an editing interface defined via its `EditItemTemplate`; however, there s currently no way for a user visiting our page to indicate that he wants to edit a product s information.</span></span> <span data-ttu-id="b537a-245">をクリックすると、レンダリングその DataList 項目される編集モードで各製品に [編集] ボタンを追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b537a-245">We need to add an Edit button to each product that, when clicked, renders that DataList item in edit mode.</span></span> <span data-ttu-id="b537a-246">[編集] ボタンを追加して、開始、 `ItemTemplate`、デザイナーを通じて、または宣言します。</span><span class="sxs-lookup"><span data-stu-id="b537a-246">Start by adding an Edit button to the `ItemTemplate`, either through the Designer or declaratively.</span></span> <span data-ttu-id="b537a-247">S [編集] ボタンを設定する`CommandName`プロパティを編集します。</span><span class="sxs-lookup"><span data-stu-id="b537a-247">Be certain to set the Edit button s `CommandName` property to Edit .</span></span>

<span data-ttu-id="b537a-248">この編集 ボタンを追加した後は、すぐブラウザーでページを表示します。</span><span class="sxs-lookup"><span data-stu-id="b537a-248">After you have added this Edit button, take a moment to view the page through a browser.</span></span> <span data-ttu-id="b537a-249">このさらに、各製品の一覧項目は [編集] ボタンを含める必要があります。</span><span class="sxs-lookup"><span data-stu-id="b537a-249">With this addition, each product listing should include an Edit button.</span></span>


<span data-ttu-id="b537a-250">[![更新プログラムを追加し、キャンセル、EditItemTemplate するボタン](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image29.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="b537a-250">[![Add Update and Cancel Buttons to the EditItemTemplate](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image29.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image28.png)</span></span>

<span data-ttu-id="b537a-251">**図 12**: 更新プログラムの追加とキャンセル ボタン、 `EditItemTemplate` ([フルサイズのイメージを表示するをクリックして](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="b537a-251">**Figure 12**: Add Update and Cancel Buttons to the `EditItemTemplate` ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image30.png))</span></span>


<span data-ttu-id="b537a-252">ボタンをクリックすると、ポストバックを発生させるが、*いない*リストを編集モードに製品を表示します。</span><span class="sxs-lookup"><span data-stu-id="b537a-252">Clicking the button causes a postback, but does *not* bring the product listing into edit mode.</span></span> <span data-ttu-id="b537a-253">製品を編集可能にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="b537a-253">To make the product editable, we need to:</span></span>

1. <span data-ttu-id="b537a-254">DataList s 設定[`EditItemIndex`プロパティ](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.datalist.edititemindex.aspx)のインデックスに、`DataListItem`の編集 ボタンがクリックされただけです。</span><span class="sxs-lookup"><span data-stu-id="b537a-254">Set the DataList s [`EditItemIndex` property](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.datalist.edititemindex.aspx) to the index of the `DataListItem` whose Edit button was just clicked.</span></span>
2. <span data-ttu-id="b537a-255">DataList にデータをバインドします。</span><span class="sxs-lookup"><span data-stu-id="b537a-255">Rebind the data to the DataList.</span></span> <span data-ttu-id="b537a-256">DataList は再レンダリングされたときに、`DataListItem`が`ItemIndex`DataList s に対応する`EditItemIndex`を使用して表示されます、`EditItemTemplate`です。</span><span class="sxs-lookup"><span data-stu-id="b537a-256">When the DataList is re-rendered, the `DataListItem` whose `ItemIndex` corresponds with the DataList s `EditItemIndex` will render using its `EditItemTemplate`.</span></span>

<span data-ttu-id="b537a-257">DataList s 以降`EditCommand`[編集] ボタンがクリックされたときにイベントが発生した、作成、`EditCommand`イベント ハンドラーを次のコードで。</span><span class="sxs-lookup"><span data-stu-id="b537a-257">Since the DataList s `EditCommand` event is fired when the Edit button is clicked, create an `EditCommand` event handler with the following code:</span></span>


[!code-vb[Main](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/samples/sample4.vb)]

<span data-ttu-id="b537a-258">`EditCommand`型のオブジェクトに渡されるイベント ハンドラー`DataListCommandEventArgs`への参照が含まれますが、2 番目の入力パラメーターとして、`DataListItem`の編集 ボタンがクリックしてされました (`e.Item`)。</span><span class="sxs-lookup"><span data-stu-id="b537a-258">The `EditCommand` event handler is passed in an object of type `DataListCommandEventArgs` as its second input parameter, which includes a reference to the `DataListItem` whose Edit button was clicked (`e.Item`).</span></span> <span data-ttu-id="b537a-259">最初に、イベント ハンドラーは、DataList s を設定`EditItemIndex`を`ItemIndex`の編集可能な`DataListItem`DataList s を呼び出すことによって、DataList にデータを再バインドおよび`DataBind()`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="b537a-259">The event handler first sets the DataList s `EditItemIndex` to the `ItemIndex` of the editable `DataListItem` and then rebinds the data to the DataList by calling the DataList s `DataBind()` method.</span></span>

<span data-ttu-id="b537a-260">このイベント ハンドラーを追加すると、ブラウザーでページを再表示します。</span><span class="sxs-lookup"><span data-stu-id="b537a-260">After adding this event handler, revisit the page in a browser.</span></span> <span data-ttu-id="b537a-261">クリックした製品編集可能な (参照図 13) は、今すぐ編集ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="b537a-261">Clicking the Edit button now makes the clicked product editable (see Figure 13).</span></span>


<span data-ttu-id="b537a-262">[![編集ボタンは編集可能な製品をクリックして](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image32.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="b537a-262">[![Clicking the Edit Button Makes the Product Editable](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image32.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image31.png)</span></span>

<span data-ttu-id="b537a-263">**図 13**: 製品編集可能な [編集] ボタンをクリックすると、([フルサイズのイメージを表示するをクリックして](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="b537a-263">**Figure 13**: Clicking the Edit Button Makes the Product Editable ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image33.png))</span></span>


## <a name="step-6-saving-the-user-s-changes"></a><span data-ttu-id="b537a-264">手順 6: ユーザーの変更を保存します。</span><span class="sxs-lookup"><span data-stu-id="b537a-264">Step 6: Saving the User s Changes</span></span>

<span data-ttu-id="b537a-265">編集した製品の更新プログラムまたは [キャンセル] ボタンをクリックするとは何もこの時点でです。DataList s のイベント ハンドラーを作成する必要があります。 この機能を追加する`UpdateCommand`と`CancelCommand`イベント。</span><span class="sxs-lookup"><span data-stu-id="b537a-265">Clicking the edited product s Update or Cancel buttons does nothing at this point; to add this functionality we need to create event handlers for the DataList s `UpdateCommand` and `CancelCommand` events.</span></span> <span data-ttu-id="b537a-266">まずを作成して、`CancelCommand`イベント ハンドラーは、編集した製品 s [キャンセル] ボタンをクリックして、編集済みの状態、DataList を返す際に、よう課されたときに実行されます。</span><span class="sxs-lookup"><span data-stu-id="b537a-266">Start by creating the `CancelCommand` event handler, which will execute when the edited product s Cancel button is clicked and it tasked with returning the DataList to its pre-editing state.</span></span>

<span data-ttu-id="b537a-267">すべての読み取り専用モードで項目をレンダリング DataList は、する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b537a-267">To have the DataList render all of its items in the read-only mode, we need to:</span></span>

1. <span data-ttu-id="b537a-268">DataList s 設定[`EditItemIndex`プロパティ](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.datalist.edititemindex.aspx)の存在しないインデックスを`DataListItem`インデックス。</span><span class="sxs-lookup"><span data-stu-id="b537a-268">Set the DataList s [`EditItemIndex` property](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.datalist.edititemindex.aspx) to the index of a non-existent `DataListItem` index.</span></span> <span data-ttu-id="b537a-269">`-1`安全な選択肢のためは、`DataListItem`インデックスから始まります`0`です。</span><span class="sxs-lookup"><span data-stu-id="b537a-269">`-1` is a safe choice, since the `DataListItem` indexes start at `0`.</span></span>
2. <span data-ttu-id="b537a-270">DataList にデータをバインドします。</span><span class="sxs-lookup"><span data-stu-id="b537a-270">Rebind the data to the DataList.</span></span> <span data-ttu-id="b537a-271">No 以降`DataListItem` `ItemIndex` DataList s に対応している es `EditItemIndex`、DataList 全体が読み取り専用モードでレンダリングされます。</span><span class="sxs-lookup"><span data-stu-id="b537a-271">Since no `DataListItem` `ItemIndex` es correspond to the DataList s `EditItemIndex`, the entire DataList will be rendered in a read-only mode.</span></span>

<span data-ttu-id="b537a-272">次のイベント ハンドラーのコードでは、次の手順を実行できます。</span><span class="sxs-lookup"><span data-stu-id="b537a-272">These steps can be accomplished with the following event handler code:</span></span>


[!code-vb[Main](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/samples/sample5.vb)]

<span data-ttu-id="b537a-273">この追加、編集済みの状態は [キャンセル] ボタンを返します、DataList をクリックします。</span><span class="sxs-lookup"><span data-stu-id="b537a-273">With this addition, clicking the Cancel button returns the DataList to its pre-editing state.</span></span>

<span data-ttu-id="b537a-274">最後のイベント ハンドラーが完了する必要がありますが、`UpdateCommand`イベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="b537a-274">The last event handler we need to complete is the `UpdateCommand` event handler.</span></span> <span data-ttu-id="b537a-275">このイベント ハンドラーは、する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b537a-275">This event handler needs to:</span></span>

1. <span data-ttu-id="b537a-276">製品のユーザーが入力した名前と価格だけでなく、編集した製品 s をプログラムでアクセス`ProductID`です。</span><span class="sxs-lookup"><span data-stu-id="b537a-276">Programmatically access the user-entered product name and price as well as the edited product s `ProductID`.</span></span>
2. <span data-ttu-id="b537a-277">呼び出して、適切な更新プロセスを開始`UpdateProduct`でオーバー ロード、`ProductsBLL`クラスです。</span><span class="sxs-lookup"><span data-stu-id="b537a-277">Initiate the update process by calling the appropriate `UpdateProduct` overload in the `ProductsBLL` class.</span></span>
3. <span data-ttu-id="b537a-278">DataList s 設定[`EditItemIndex`プロパティ](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.datalist.edititemindex.aspx)の存在しないインデックスを`DataListItem`インデックス。</span><span class="sxs-lookup"><span data-stu-id="b537a-278">Set the DataList s [`EditItemIndex` property](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.datalist.edititemindex.aspx) to the index of a non-existent `DataListItem` index.</span></span> <span data-ttu-id="b537a-279">`-1`安全な選択肢のためは、`DataListItem`インデックスから始まります`0`です。</span><span class="sxs-lookup"><span data-stu-id="b537a-279">`-1` is a safe choice, since the `DataListItem` indexes start at `0`.</span></span>
4. <span data-ttu-id="b537a-280">DataList にデータをバインドします。</span><span class="sxs-lookup"><span data-stu-id="b537a-280">Rebind the data to the DataList.</span></span> <span data-ttu-id="b537a-281">No 以降`DataListItem` `ItemIndex` DataList s に対応している es `EditItemIndex`、DataList 全体が読み取り専用モードでレンダリングされます。</span><span class="sxs-lookup"><span data-stu-id="b537a-281">Since no `DataListItem` `ItemIndex` es correspond to the DataList s `EditItemIndex`, the entire DataList will be rendered in a read-only mode.</span></span>

<span data-ttu-id="b537a-282">手順 1. と 2. はユーザーの変更を保存するため、します。手順 3. および 4. 状態に戻す DataList 事前編集、変更が保存されてされ後で実行した手順と同じ、`CancelCommand`イベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="b537a-282">Steps 1 and 2 are responsible for saving the user s changes; steps 3 and 4 return the DataList to its pre-editing state after the changes have been saved and are identical to the steps performed in the `CancelCommand` event handler.</span></span>

<span data-ttu-id="b537a-283">更新された製品の名前と価格を取得する必要がありますを使用する、`FindControl`メソッド内でテキスト ボックス、Web の制御参照プログラムを`EditItemTemplate`です。</span><span class="sxs-lookup"><span data-stu-id="b537a-283">To get the updated product name and price, we need to use the `FindControl` method to programmatically reference the TextBox Web controls within the `EditItemTemplate`.</span></span> <span data-ttu-id="b537a-284">また、編集した製品 s を取得する必要があります`ProductID`値。</span><span class="sxs-lookup"><span data-stu-id="b537a-284">We also need to get the edited product s `ProductID` value.</span></span> <span data-ttu-id="b537a-285">Visual Studio に DataList s が割り当てられている最初にバインドされている場合、ObjectDataSource DataList を`DataKeyField`プロパティは、主キーの値をデータ ソースから (`ProductID`)。</span><span class="sxs-lookup"><span data-stu-id="b537a-285">When we initially bound the ObjectDataSource to the DataList, Visual Studio assigned the DataList s `DataKeyField` property to the primary key value from the data source (`ProductID`).</span></span> <span data-ttu-id="b537a-286">DataList 秒から、この値を取得し、できる`DataKeys`コレクション。</span><span class="sxs-lookup"><span data-stu-id="b537a-286">This value can then be retrieved from the DataList s `DataKeys` collection.</span></span> <span data-ttu-id="b537a-287">確実に少し時間を取って、`DataKeyField`プロパティが実際に設定されている`ProductID`です。</span><span class="sxs-lookup"><span data-stu-id="b537a-287">Take a moment to ensure that the `DataKeyField` property is indeed set to `ProductID`.</span></span>

<span data-ttu-id="b537a-288">次のコードでは、4 つの手順を実装します。</span><span class="sxs-lookup"><span data-stu-id="b537a-288">The following code implements the four steps:</span></span>


[!code-vb[Main](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/samples/sample6.vb)]

<span data-ttu-id="b537a-289">編集した製品 s で読み取ることによって、イベント ハンドラーが起動`ProductID`から、`DataKeys`コレクション。</span><span class="sxs-lookup"><span data-stu-id="b537a-289">The event handler starts by reading in the edited product s `ProductID` from the `DataKeys` collection.</span></span> <span data-ttu-id="b537a-290">次に、2 つのテキスト ボックス、`EditItemTemplate`が参照され、その`Text`ローカル変数に格納されているプロパティ`productNameValue`と`unitPriceValue`です。</span><span class="sxs-lookup"><span data-stu-id="b537a-290">Next, the two TextBoxes in the `EditItemTemplate` are referenced and their `Text` properties stored in local variables, `productNameValue` and `unitPriceValue`.</span></span> <span data-ttu-id="b537a-291">使用して、`Decimal.Parse()`から値を読み取るためのメソッド、`UnitPrice`ようにする場合、値を入力 ボックスに、通貨記号には、まだ正常に変換できる、`Decimal`値。</span><span class="sxs-lookup"><span data-stu-id="b537a-291">We use the `Decimal.Parse()` method to read the value from the `UnitPrice` TextBox so that if the value entered has a currency symbol, it can still be correctly converted into a `Decimal` value.</span></span>

> [!NOTE]
> <span data-ttu-id="b537a-292">値を`ProductName`と`UnitPrice`テキスト ボックスのみ割り当てられている productNameValue と unitPriceValue 変数にテキスト ボックスのテキストのプロパティが指定された値を持つ場合です。</span><span class="sxs-lookup"><span data-stu-id="b537a-292">The values from the `ProductName` and `UnitPrice` TextBoxes are only assigned to the productNameValue and unitPriceValue variables if the TextBoxes Text properties have a value specified.</span></span> <span data-ttu-id="b537a-293">それ以外の場合、値は`Nothing`、変数の使用によるデータベース、データの更新の影響は`NULL`値。</span><span class="sxs-lookup"><span data-stu-id="b537a-293">Otherwise, a value of `Nothing` is used for the variables, which has the effect of updating the data with a database `NULL` value.</span></span> <span data-ttu-id="b537a-294">コードが変換を処理するは、データベースへの文字列を空にする`NULL`GridView、DetailsView、フォーム ビュー コントロール内にある編集インターフェイスの既定の動作は、の値。</span><span class="sxs-lookup"><span data-stu-id="b537a-294">That is, our code treats converts empty strings to database `NULL` values, which is the default behavior of the editing interface in the GridView, DetailsView, and FormView controls.</span></span>


<span data-ttu-id="b537a-295">値が読み取られた後、`ProductsBLL`クラス s`UpdateProduct`メソッドが呼び出されると、価格、製品の名前で渡すことと`ProductID`です。</span><span class="sxs-lookup"><span data-stu-id="b537a-295">After reading the values, the `ProductsBLL` class s `UpdateProduct` method is called, passing in the product s name, price, and `ProductID`.</span></span> <span data-ttu-id="b537a-296">編集済みの状態で正確な同じロジックを使用して、DataList を返すことによって、イベント ハンドラーが完了する、`CancelCommand`イベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="b537a-296">The event handler completes by returning the DataList to its pre-editing state using the exact same logic as in the `CancelCommand` event handler.</span></span>

<span data-ttu-id="b537a-297">`EditCommand`、 `CancelCommand`、および`UpdateCommand`イベント ハンドラーの完了、訪問者が製品の価格と名前を編集できます。</span><span class="sxs-lookup"><span data-stu-id="b537a-297">With the `EditCommand`, `CancelCommand`, and `UpdateCommand` event handlers complete, a visitor can edit the name and price of a product.</span></span> <span data-ttu-id="b537a-298">図 14-16 では、アクションの編集このワークフローを表示します。</span><span class="sxs-lookup"><span data-stu-id="b537a-298">Figures 14-16 show this editing workflow in action.</span></span>


<span data-ttu-id="b537a-299">[![最初のページへのアクセス、すべての製品は読み取り専用モードで](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image35.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="b537a-299">[![When First Visiting the Page, All Products are in Read-Only Mode](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image35.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image34.png)</span></span>

<span data-ttu-id="b537a-300">**図 14**: すべての製品が読み取り専用モードでは最初のページへのアクセス、ときに ([フルサイズのイメージを表示するをクリックして](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="b537a-300">**Figure 14**: When First Visiting the Page, All Products are in Read-Only Mode ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image36.png))</span></span>


<span data-ttu-id="b537a-301">[![製品名の価格を更新するには、編集ボタンをクリックします。](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image38.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="b537a-301">[![To Update a Product s Name or Price, Click the Edit Button](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image38.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image37.png)</span></span>

<span data-ttu-id="b537a-302">**図 15**: 更新するには、製品名または価格編集 をクリックします ([フルサイズのイメージを表示するをクリックして](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="b537a-302">**Figure 15**: To Update a Product s Name or Price, Click the Edit Button ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image39.png))</span></span>


<span data-ttu-id="b537a-303">[![値を変更した後、読み取り専用モードに戻るに更新 をクリックして](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image41.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="b537a-303">[![After Changing the Value, Click Update to Return to the Read-Only Mode](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image41.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image40.png)</span></span>

<span data-ttu-id="b537a-304">**図 16**: 値を変更した後、更新、読み取り専用モードに戻る をクリックして ([フルサイズのイメージを表示するをクリックして](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="b537a-304">**Figure 16**: After Changing the Value, Click Update to Return to the Read-Only Mode ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image42.png))</span></span>


## <a name="step-7-adding-delete-capabilities"></a><span data-ttu-id="b537a-305">手順 7: 削除機能を追加します。</span><span class="sxs-lookup"><span data-stu-id="b537a-305">Step 7: Adding Delete Capabilities</span></span>

<span data-ttu-id="b537a-306">DataList に削除の機能を追加するための手順は、編集機能を追加するためのものに似ています。</span><span class="sxs-lookup"><span data-stu-id="b537a-306">The steps for adding delete capabilities to a DataList are similar to those for adding editing capabilities.</span></span> <span data-ttu-id="b537a-307">つまりを削除 ボタンを追加する必要があります、`ItemTemplate`クリックされたときに。</span><span class="sxs-lookup"><span data-stu-id="b537a-307">In short, we need to add a Delete button to the `ItemTemplate` that, when clicked:</span></span>

1. <span data-ttu-id="b537a-308">対応する製品の s で読み取り`ProductID`を介して、`DataKeys`コレクション。</span><span class="sxs-lookup"><span data-stu-id="b537a-308">Reads in the corresponding product s `ProductID` via the `DataKeys` collection.</span></span>
2. <span data-ttu-id="b537a-309">呼び出して、削除を実行、`ProductsBLL`クラスの`DeleteProduct`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="b537a-309">Performs the delete by calling the `ProductsBLL` class s `DeleteProduct` method.</span></span>
3. <span data-ttu-id="b537a-310">DataList にデータをバインドします。</span><span class="sxs-lookup"><span data-stu-id="b537a-310">Rebinds the data to the DataList.</span></span>

<span data-ttu-id="b537a-311">%S を削除 ボタンを追加することによって開始できるように、`ItemTemplate`です。</span><span class="sxs-lookup"><span data-stu-id="b537a-311">Let s start by adding a Delete button to the `ItemTemplate`.</span></span>

<span data-ttu-id="b537a-312">ボタンをクリックしたときに`CommandName`編集、更新、または [キャンセル] を DataList s を発生させます`ItemCommand`と共に追加のイベントのイベント (Edit を使用する場合など、`EditCommand`もイベントは)。</span><span class="sxs-lookup"><span data-stu-id="b537a-312">When clicked, a Button whose `CommandName` is Edit, Update, or Cancel raises the DataList s `ItemCommand` event along with an additional event (for example, when using Edit the `EditCommand` event is raised as well).</span></span> <span data-ttu-id="b537a-313">同様に、すべてのボタン、LinkButton、または DataList の ImageButton が`CommandName`原因を削除するプロパティが設定されて、`DeleteCommand`イベントを発生させる (と共に`ItemCommand`)。</span><span class="sxs-lookup"><span data-stu-id="b537a-313">Similarly, any Button, LinkButton, or ImageButton in the DataList whose `CommandName` property is set to Delete causes the `DeleteCommand` event to fire (along with `ItemCommand`).</span></span>

<span data-ttu-id="b537a-314">[編集] ボタンの横にある [削除] ボタンを追加、 `ItemTemplate`、設定、`CommandName`プロパティを削除します。</span><span class="sxs-lookup"><span data-stu-id="b537a-314">Add a Delete button next to the Edit button in the `ItemTemplate`, setting its `CommandName` property to Delete.</span></span> <span data-ttu-id="b537a-315">追加した後、このボタンを制御、DataList の`ItemTemplate`宣言構文のようになります。</span><span class="sxs-lookup"><span data-stu-id="b537a-315">After adding this Button control your DataList s `ItemTemplate` declarative syntax should look like:</span></span>


[!code-aspx[Main](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/samples/sample7.aspx)]

<span data-ttu-id="b537a-316">DataList s のイベント ハンドラーを次に、作成`DeleteCommand`イベントは、次のコードを使用します。</span><span class="sxs-lookup"><span data-stu-id="b537a-316">Next, create an event handler for the DataList s `DeleteCommand` event, using the following code:</span></span>


[!code-vb[Main](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/samples/sample8.vb)]

<span data-ttu-id="b537a-317">[削除] ボタンをクリックするとポストバックを発生させるし、DataList s を発生させる`DeleteCommand`イベント。</span><span class="sxs-lookup"><span data-stu-id="b537a-317">Clicking the Delete button causes a postback and fires the DataList s `DeleteCommand` event.</span></span> <span data-ttu-id="b537a-318">イベント ハンドラー、クリックした製品 s で`ProductID`値がからアクセスされる、`DataKeys`コレクション。</span><span class="sxs-lookup"><span data-stu-id="b537a-318">In the event handler, the clicked product s `ProductID` value is accessed from the `DataKeys` collection.</span></span> <span data-ttu-id="b537a-319">呼び出すことによって、製品を削除する次に、`ProductsBLL`クラスの`DeleteProduct`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="b537a-319">Next, the product is deleted by calling the `ProductsBLL` class s `DeleteProduct` method.</span></span>

<span data-ttu-id="b537a-320">製品を削除した後、DataList にデータを再バインドおことが重要 (`DataList1.DataBind()`)、それ以外の場合、DataList は引き続きが削除されるだけで、製品を表示します。</span><span class="sxs-lookup"><span data-stu-id="b537a-320">After deleting the product, it s important that we rebind the data to the DataList (`DataList1.DataBind()`), otherwise the DataList will continue to show the product that was just deleted.</span></span>

## <a name="summary"></a><span data-ttu-id="b537a-321">概要</span><span class="sxs-lookup"><span data-stu-id="b537a-321">Summary</span></span>

<span data-ttu-id="b537a-322">DataList では、ポイントがないし、編集および GridView で楽しんでサポートの削除 をクリックして、中にコードの短いビットを使用して、拡張にこれらの機能を含めます。</span><span class="sxs-lookup"><span data-stu-id="b537a-322">While the DataList lacks the point and click editing and deleting support enjoyed by the GridView, with a short bit of code it can be enhanced to include these features.</span></span> <span data-ttu-id="b537a-323">このチュートリアルでは、2 つの列を削除できませんでした、名前と価格を編集することが製品の一覧を作成する方法を説明しました。</span><span class="sxs-lookup"><span data-stu-id="b537a-323">In this tutorial we saw how to create a two-column listing of products that could be deleted and whose name and price could be edited.</span></span> <span data-ttu-id="b537a-324">適切な Web コントロールを含むは、編集および削除のサポートを追加する、`ItemTemplate`と`EditItemTemplate`対応するイベント ハンドラーの作成、読み取り、ユーザーが入力したとプライマリ キーの値、およびビジネスとのやり取り層のロジックです。</span><span class="sxs-lookup"><span data-stu-id="b537a-324">Adding editing and deleting support is a matter of including the appropriate Web controls in the `ItemTemplate` and `EditItemTemplate`, creating the corresponding event handlers, reading the user-entered and primary key values, and interfacing with the Business Logic Layer.</span></span>

<span data-ttu-id="b537a-325">基本的な編集および削除 DataList に機能が追加されましたが、中には、高度な機能が不足しています。</span><span class="sxs-lookup"><span data-stu-id="b537a-325">While we have added basic editing and deleting capabilities to the DataList, it lacks more advanced features.</span></span> <span data-ttu-id="b537a-326">たとえばはありません入力フィールドの検証 - ユーザーが多すぎますの価格を入力した場合高価な例外がスローされますが`Decimal.Parse`すぎますを変換しようとするときに高価な`Decimal`です。</span><span class="sxs-lookup"><span data-stu-id="b537a-326">For example, there is no input field validation - if a user enters a price of Too expensive, an exception will be thrown by `Decimal.Parse` when attempting to convert Too expensive into a `Decimal`.</span></span> <span data-ttu-id="b537a-327">同様に、ビジネス ロジックでのデータまたはデータ アクセス層を更新中に問題がある場合、ユーザーは、標準的なエラー画面で表示されます。</span><span class="sxs-lookup"><span data-stu-id="b537a-327">Similarly, if there is a problem in updating the data at the Business Logic or Data Access Layers the user will be presented with the standard error screen.</span></span> <span data-ttu-id="b537a-328">何らかの削除 ボタンで確認メッセージなしは、誤って削除したり、製品すべてすぎる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="b537a-328">Without any sort of confirmation on the Delete button, accidentally deleting a product is all too likely.</span></span>

<span data-ttu-id="b537a-329">後で編集のユーザーを向上させるために手順を説明するチュートリアルが発生します。</span><span class="sxs-lookup"><span data-stu-id="b537a-329">In future tutorials we'll see how to improve the editing user experience.</span></span>

<span data-ttu-id="b537a-330">満足プログラミング!</span><span class="sxs-lookup"><span data-stu-id="b537a-330">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="b537a-331">作成者について</span><span class="sxs-lookup"><span data-stu-id="b537a-331">About the Author</span></span>

<span data-ttu-id="b537a-332">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)、7 つ受け取りますブックとの創設者の作成者[4GuysFromRolla.com](http://www.4guysfromrolla.com)、1998 年からマイクロソフトの Web テクノロジで取り組んできました。</span><span class="sxs-lookup"><span data-stu-id="b537a-332">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="b537a-333">Scott は、コンサルタント、トレーナー、ライターとして機能します。</span><span class="sxs-lookup"><span data-stu-id="b537a-333">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="b537a-334">最新の著書[ *Sam 学べる自分で ASP.NET 2.0 が 24 時間以内に*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)です。</span><span class="sxs-lookup"><span data-stu-id="b537a-334">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="b537a-335">彼に到達できる[ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)彼のブログを使用して含まれているのか[http://ScottOnWriting.NET](http://ScottOnWriting.NET)です。</span><span class="sxs-lookup"><span data-stu-id="b537a-335">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="b537a-336">感謝の特別な</span><span class="sxs-lookup"><span data-stu-id="b537a-336">Special Thanks To</span></span>

<span data-ttu-id="b537a-337">このチュートリアルの系列は既に多くの便利なレビュー担当者によって確認済みです。</span><span class="sxs-lookup"><span data-stu-id="b537a-337">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="b537a-338">このチュートリアルの潜在顧客レビュー担当者には、Zack Jones、Ken Pespisa ものです。 Schmidt がされていました。</span><span class="sxs-lookup"><span data-stu-id="b537a-338">Lead reviewers for this tutorial were Zack Jones, Ken Pespisa, and Randy Schmidt.</span></span> <span data-ttu-id="b537a-339">今後、MSDN の記事を確認することに関心のあるですか。</span><span class="sxs-lookup"><span data-stu-id="b537a-339">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="b537a-340">場合は、ドロップ me 一度に 1 行ずつ[mitchell@4GuysFromRolla.comです。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="b537a-340">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="b537a-341">[前へ](customizing-the-datalist-s-editing-interface-cs.md)
[次へ](performing-batch-updates-vb.md)</span><span class="sxs-lookup"><span data-stu-id="b537a-341">[Previous](customizing-the-datalist-s-editing-interface-cs.md)
[Next](performing-batch-updates-vb.md)</span></span>
