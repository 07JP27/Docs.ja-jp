---
uid: web-forms/overview/data-access/filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs
title: "詳細 DataList (c#) のマスター レコードの箇条書きリストを使用してマスター/詳細 |Microsoft ドキュメント"
author: rick-anderson
description: "このチュートリアルでを前のチュートリアルの 2 ページ マスター/詳細レポートを単一のページに圧縮お t にカテゴリ名の箇条書きリストを表示しています."
ms.author: aspnetcontent
manager: wpickett
ms.date: 10/17/2006
ms.topic: article
ms.assetid: c727bb73-7b59-41a1-8dc3-623c6d69e7c2
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs
msc.type: authoredcontent
ms.openlocfilehash: 91b8139f082704c5b5964087cc1887454c081f09
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/10/2017
---
<a name="masterdetail-using-a-bulleted-list-of-master-records-with-a-details-datalist-c"></a><span data-ttu-id="c29a7-103">マスター/詳細詳細 DataList (c#) でマスター レコードの箇条書きリストの使い方</span><span class="sxs-lookup"><span data-stu-id="c29a7-103">Master/Detail Using a Bulleted List of Master Records with a Details DataList (C#)</span></span>
====================
<span data-ttu-id="c29a7-104">によって[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="c29a7-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="c29a7-105">[サンプル アプリをダウンロード](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_35_CS.exe)または[PDF のダウンロード](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/datatutorial35cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="c29a7-105">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_35_CS.exe) or [Download PDF](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/datatutorial35cs1.pdf)</span></span>

> <span data-ttu-id="c29a7-106">このチュートリアルでを前のチュートリアルの 2 ページ マスター/詳細レポートを単一のページに圧縮お画面と、画面の右側に、選択したカテゴリの製品の左側にあるカテゴリ名の箇条書きリストを表示します。</span><span class="sxs-lookup"><span data-stu-id="c29a7-106">In this tutorial we'll compress the two-page master/detail report of the previous tutorial into a single page, showing a bulleted list of category names on the left side of the screen and the selected category's products on the right of the screen.</span></span>


## <a name="introduction"></a><span data-ttu-id="c29a7-107">はじめに</span><span class="sxs-lookup"><span data-stu-id="c29a7-107">Introduction</span></span>

<span data-ttu-id="c29a7-108">[前のチュートリアル](master-detail-filtering-acess-two-pages-datalist-cs.md)2 つのページ間でマスター/詳細レポートを分離する方法について説明しました。</span><span class="sxs-lookup"><span data-stu-id="c29a7-108">In the [preceding tutorial](master-detail-filtering-acess-two-pages-datalist-cs.md) we looked at how to separate a master/detail report across two pages.</span></span> <span data-ttu-id="c29a7-109">マスター ページでは、Repeater コントロールを使用して、カテゴリの箇条書きリストを表示します。</span><span class="sxs-lookup"><span data-stu-id="c29a7-109">In the master page we used a Repeater control to render a bulleted list of categories.</span></span> <span data-ttu-id="c29a7-110">各カテゴリ名が、ハイパーリンク、クリックするが実行の詳細ページで、2 つの列 DataList がこれらの製品を表示するユーザーに属している、選択したカテゴリ。</span><span class="sxs-lookup"><span data-stu-id="c29a7-110">Each category name was a hyperlink that, when clicked, would take the user to the details page, where a two-column DataList showed those products belonging to the selected category.</span></span>

<span data-ttu-id="c29a7-111">このチュートリアルでを 2 ページ チュートリアルを単一のページに圧縮お LinkButton としてレンダリングの各カテゴリ名と、画面の左側にあるカテゴリ名の箇条書きリストを表示します。</span><span class="sxs-lookup"><span data-stu-id="c29a7-111">In this tutorial we'll compress the two-page tutorial into a single page, showing a bulleted list of category names on the left side of the screen with each category name rendered as a LinkButton.</span></span> <span data-ttu-id="c29a7-112">あるカテゴリ名のいずれかをクリックし、ポストバックを発生させる、選択したカテゴリの製品を画面の右側に 2 つの列 DataList にバインドします。</span><span class="sxs-lookup"><span data-stu-id="c29a7-112">Clicking one of the category name LinkButtons induces a postback and binds the selected category s products to a two-column DataList on the right of the screen.</span></span> <span data-ttu-id="c29a7-113">各カテゴリの名前を表示するだけでなく、左側にリピータを示しています合計製品数は、1 つのカテゴリ (図 1 を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="c29a7-113">In addition to displaying each category s name, the Repeater on the left shows how many total products there are for a given category (see Figure 1).</span></span>


<span data-ttu-id="c29a7-114">[![カテゴリ名と製品の合計数が、左側に表示されます。](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image2.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="c29a7-114">[![The Category s Name and Total Number of Products are Displayed on the Left](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image2.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image1.png)</span></span>

<span data-ttu-id="c29a7-115">**図 1**: カテゴリ名と製品の合計数が、左側に表示されます ([フルサイズのイメージを表示するをクリックして](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="c29a7-115">**Figure 1**: The Category s Name and Total Number of Products are Displayed on the Left ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image3.png))</span></span>


## <a name="step-1-displaying-a-repeater-in-the-left-portion-of-the-screen"></a><span data-ttu-id="c29a7-116">手順 1: 画面の左側の部分にリピータを表示します。</span><span class="sxs-lookup"><span data-stu-id="c29a7-116">Step 1: Displaying a Repeater in the Left Portion of the Screen</span></span>

<span data-ttu-id="c29a7-117">このチュートリアルでは、選択したカテゴリの製品の左側に表示されるカテゴリの行頭文字付き一覧を持つ必要があります。</span><span class="sxs-lookup"><span data-stu-id="c29a7-117">For this tutorial we need to have the bulleted list of categories appear to the left of the selected category s products.</span></span> <span data-ttu-id="c29a7-118">標準の HTML 要素の段落タグ、改行しないスペースを使用して web ページ内のコンテンツを配置することができます`<table>`秒、およびなまたはカスケード スタイル シート (CSS) 手法を使用します。</span><span class="sxs-lookup"><span data-stu-id="c29a7-118">Content within a web page can be positioned using standard HTML elements paragraph tags, non-breaking spaces, `<table>` s, and so on or through cascading stylesheet (CSS) techniques.</span></span> <span data-ttu-id="c29a7-119">すべてチュートリアルのこれまでが使用 CSS 手法の位置を決定します。</span><span class="sxs-lookup"><span data-stu-id="c29a7-119">All of our tutorials thus far have used CSS techniques for positioning.</span></span> <span data-ttu-id="c29a7-120">マスター ページで、ナビゲーションのユーザー インターフェイスを構築お、[マスター ページとサイト ナビゲーション](../introduction/master-pages-and-site-navigation-cs.md)を使用したチュートリアル*絶対配置*ナビゲーションのピクセル単位のオフセットを示すリストとメイン コンテンツ。</span><span class="sxs-lookup"><span data-stu-id="c29a7-120">When we built the navigation user interface in our master page in the [Master Pages and Site Navigation](../introduction/master-pages-and-site-navigation-cs.md) tutorial we used *absolute positioning*, indicating the precise pixel offset for the navigation list and the main content.</span></span> <span data-ttu-id="c29a7-121">CSS を使用して、右または左を介して別の 1 つの要素を配置する代わりに、*浮動*です。</span><span class="sxs-lookup"><span data-stu-id="c29a7-121">Alternatively, CSS can be used to position one element to the right or left of another through *floating*.</span></span> <span data-ttu-id="c29a7-122">DataList の左側にリピータを浮動小数点では、選択したカテゴリ製品の左側に表示カテゴリの箇条書きリストがあっても</span><span class="sxs-lookup"><span data-stu-id="c29a7-122">We can have the bulleted list of categories appear to the left of the selected category s products by floating the Repeater to the left of the DataList</span></span>

<span data-ttu-id="c29a7-123">開く、`CategoriesAndProducts.aspx`ページから、`DataListRepeaterFiltering`フォルダー リピータと DataList のページに追加します。</span><span class="sxs-lookup"><span data-stu-id="c29a7-123">Open the `CategoriesAndProducts.aspx` page from the `DataListRepeaterFiltering` folder and add to the page a Repeater and a DataList.</span></span> <span data-ttu-id="c29a7-124">リピータ s を設定`ID`に`Categories`およびを DataList の`CategoryProducts`です。</span><span class="sxs-lookup"><span data-stu-id="c29a7-124">Set the Repeater s `ID` to `Categories` and the DataList s to `CategoryProducts`.</span></span> <span data-ttu-id="c29a7-125">ソース ビューに移動し、独自にリピータおよび DataList コントロールを配置`<div>`要素。</span><span class="sxs-lookup"><span data-stu-id="c29a7-125">Go to the Source view and put the Repeater and DataList controls within their own `<div>` elements.</span></span> <span data-ttu-id="c29a7-126">つまりにリピータを囲む、`<div>`要素最初およびそれ自体の DataList し`<div>`リピータのすぐ後に要素。</span><span class="sxs-lookup"><span data-stu-id="c29a7-126">That is, enclose the Repeater within a `<div>` element first and then the DataList in its own `<div>` element directly after the Repeater.</span></span> <span data-ttu-id="c29a7-127">マークアップにこの時点でなります次のような。</span><span class="sxs-lookup"><span data-stu-id="c29a7-127">Your markup at this point should look similar to the following:</span></span>


[!code-aspx[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/samples/sample1.aspx)]

<span data-ttu-id="c29a7-128">DataList の左側にリピータを float、する必要がありますを使用する、 `float` CSS スタイル属性では、次のようにします。</span><span class="sxs-lookup"><span data-stu-id="c29a7-128">To float the Repeater to the left of the DataList, we need to use the `float` CSS style attribute, like so:</span></span>


[!code-html[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/samples/sample2.html)]

<span data-ttu-id="c29a7-129">`float: left;`最初を寄せて配置`<div>`要素、2 つ目の左側にします。</span><span class="sxs-lookup"><span data-stu-id="c29a7-129">The `float: left;` floats the first `<div>` element to the left of the second one.</span></span> <span data-ttu-id="c29a7-130">`width`と`padding-right`設定による最初`<div>`s`width`の間に余白を追加し、`<div>`要素 %s のコンテンツとその右余白。</span><span class="sxs-lookup"><span data-stu-id="c29a7-130">The `width` and `padding-right` settings indicate the first `<div>` s `width` and how much padding is added between the `<div>` element s content and its right margin.</span></span> <span data-ttu-id="c29a7-131">CSS で要素をフローティング状態の詳細については、チェック アウト、 [Floatutorial](http://css.maxdesign.com.au/floatutorial/)です。</span><span class="sxs-lookup"><span data-stu-id="c29a7-131">For more information on floating elements in CSS check out the [Floatutorial](http://css.maxdesign.com.au/floatutorial/).</span></span>

<span data-ttu-id="c29a7-132">最初から直接スタイル設定を指定するのではなく`<p>`要素 s`style`属性、s の代わりに、新しい CSS クラスを作成できるように`Styles.css`という`FloatLeft`:</span><span class="sxs-lookup"><span data-stu-id="c29a7-132">Rather than specify the style setting directly through the first `<p>` element s `style` attribute, let s instead create a new CSS class in `Styles.css` named `FloatLeft`:</span></span>


[!code-css[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/samples/sample3.css)]

<span data-ttu-id="c29a7-133">置き換えることができ、`<div>`で`<div class="FloatLeft">`です。</span><span class="sxs-lookup"><span data-stu-id="c29a7-133">Then we can replace the `<div>` with `<div class="FloatLeft">`.</span></span>

<span data-ttu-id="c29a7-134">CSS クラスを追加して、内のマークアップを構成した後、 `CategoriesAndProducts.aspx`  ページで、デザイナーに移動します。</span><span class="sxs-lookup"><span data-stu-id="c29a7-134">After adding the CSS class and configuring the markup in the `CategoriesAndProducts.aspx` page, go to the Designer.</span></span> <span data-ttu-id="c29a7-135">(右両方だけに表示されます灰色のボックスお以降、データ ソースまたはテンプレートを構成するには、まだ ve) には、DataList の左側に浮動小数点リピータが表示されます。</span><span class="sxs-lookup"><span data-stu-id="c29a7-135">You should see the Repeater floating to the left of the DataList (although right now both just appear as gray boxes since we ve yet to configure their data sources or templates).</span></span>


<span data-ttu-id="c29a7-136">[![リピータは、DataList の左にフロートします。](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image5.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="c29a7-136">[![The Repeater is Floated to the Left of the DataList](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image5.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image4.png)</span></span>

<span data-ttu-id="c29a7-137">**図 2**:「リピータは、DataList 左にフロート ([フルサイズのイメージを表示するには、をクリックして](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="c29a7-137">**Figure 2**: The Repeater is Floated to the Left of the DataList ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image6.png))</span></span>


## <a name="step-2-determining-the-number-of-products-for-each-category"></a><span data-ttu-id="c29a7-138">手順 2: 各カテゴリの製品の数を決定します。</span><span class="sxs-lookup"><span data-stu-id="c29a7-138">Step 2: Determining the Number of Products for Each Category</span></span>

<span data-ttu-id="c29a7-139">完全なマークアップを囲むリピータおよび DataList s、おリピータにカテゴリ データをバインドする準備ができたら、次の操作を制御します。</span><span class="sxs-lookup"><span data-stu-id="c29a7-139">With the Repeater and DataList s surrounding markup complete, we re ready to bind the category data to the Repeater control.</span></span> <span data-ttu-id="c29a7-140">ただし、図 1 内のカテゴリの箇条書きリストでは、各カテゴリの名前だけでなくも必要がありますをカテゴリに関連付けられている製品の数を表示します。</span><span class="sxs-lookup"><span data-stu-id="c29a7-140">However, as the bulleted list of categories in Figure 1 shows, in addition to each category s name we also need to display the number of products associated with the category.</span></span> <span data-ttu-id="c29a7-141">この情報にアクセスできますか。</span><span class="sxs-lookup"><span data-stu-id="c29a7-141">To access this information we can either:</span></span>

- <span data-ttu-id="c29a7-142">**ASP.NET ページの分離コード クラスのこの情報を決定します。**</span><span class="sxs-lookup"><span data-stu-id="c29a7-142">**Determine this information from the ASP.NET page s code-behind class.**</span></span> <span data-ttu-id="c29a7-143">指定された特定の *`categoryID`* ところを呼び出して関連付けられている製品の数を判断することができます、`ProductsBLL`クラスの`GetProductsByCategoryID(categoryID)`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="c29a7-143">Given a particular *`categoryID`* we can determine the number of associated products by calling the `ProductsBLL` class s `GetProductsByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="c29a7-144">このメソッドが戻る、`ProductsDataTable`オブジェクト`Count`プロパティを示します数`ProductsRow`%s に存在して、指定した製品の数は *`categoryID`*です。</span><span class="sxs-lookup"><span data-stu-id="c29a7-144">This method returns a `ProductsDataTable` object whose `Count` property indicates how many `ProductsRow` s exists, which is the number of products for the specified *`categoryID`*.</span></span> <span data-ttu-id="c29a7-145">作成できるよう、 `ItemDataBound` Repeater を呼び出し、リピータにバインドされている各カテゴリのイベント ハンドラー、`ProductsBLL`クラスの`GetProductsByCategoryID(categoryID)`メソッドの出力に、カウントが含まれています。</span><span class="sxs-lookup"><span data-stu-id="c29a7-145">We can create an `ItemDataBound` event handler for the Repeater that, for each category bound to the Repeater, calls the `ProductsBLL` class s `GetProductsByCategoryID(categoryID)` method and includes its count in the output.</span></span>
- <span data-ttu-id="c29a7-146">**更新プログラム、`CategoriesDataTable`に含める型指定されたデータセットで、`NumberOfProducts`列です。**</span><span class="sxs-lookup"><span data-stu-id="c29a7-146">**Update the `CategoriesDataTable` in the Typed DataSet to include a `NumberOfProducts` column.**</span></span> <span data-ttu-id="c29a7-147">更新することが、`GetCategories()`メソッドで、`CategoriesDataTable`を含めることがこの情報、または、`GetCategories()`として-を新規作成は、`CategoriesDataTable`呼び出されるメソッド`GetCategoriesAndNumberOfProducts()`です。</span><span class="sxs-lookup"><span data-stu-id="c29a7-147">We can then update the `GetCategories()` method in the `CategoriesDataTable` to include this information or, alternatively, leave `GetCategories()` as-is and create a new `CategoriesDataTable` method called `GetCategoriesAndNumberOfProducts()`.</span></span>

<span data-ttu-id="c29a7-148">S、これらの手法の両方のシナリオを使用できます。</span><span class="sxs-lookup"><span data-stu-id="c29a7-148">Let s explore both of these techniques.</span></span> <span data-ttu-id="c29a7-149">最初の方法は、データ アクセス層; を更新する必要ありませんので、実装に簡単です。ただし、データベースと複数の通信が必要です。</span><span class="sxs-lookup"><span data-stu-id="c29a7-149">The first approach is simpler to implement since we don t need to update the Data Access Layer; however, it requires more communications with the database.</span></span> <span data-ttu-id="c29a7-150">呼び出し、`ProductsBLL`クラス s`GetProductsByCategoryID(categoryID)`メソッドで、`ItemDataBound`リピータに表示されるカテゴリごとに、追加のデータベース呼び出しをイベント ハンドラーに追加します。</span><span class="sxs-lookup"><span data-stu-id="c29a7-150">The call to the `ProductsBLL` class s `GetProductsByCategoryID(categoryID)` method in the `ItemDataBound` event handler adds an extra database call for each category displayed in the Repeater.</span></span> <span data-ttu-id="c29a7-151">この手法では*N* + 1 つのデータベース呼び出し、ここで*N*リピータに表示されるカテゴリの数です。</span><span class="sxs-lookup"><span data-stu-id="c29a7-151">With this technique there are *N* + 1 database calls, where *N* is the number of categories displayed in the Repeater.</span></span> <span data-ttu-id="c29a7-152">各カテゴリに関する情報を 2 番目の方法で製品の数が返される、`CategoriesBLL`クラス s `GetCategories()` (または`GetCategoriesAndNumberOfProducts()`) メソッドを招き、1 つだけのトリップで結果としてデータベースにします。</span><span class="sxs-lookup"><span data-stu-id="c29a7-152">With the second approach, the product count is returned with information about each category from the `CategoriesBLL` class s `GetCategories()` (or `GetCategoriesAndNumberOfProducts()`) method, thereby resulting in just one trip to the database.</span></span>

## <a name="determining-the-number-of-products-in-the-itemdatabound-event-handler"></a><span data-ttu-id="c29a7-153">ItemDataBound イベント ハンドラー内の製品の数を決定します。</span><span class="sxs-lookup"><span data-stu-id="c29a7-153">Determining the Number of Products in the ItemDataBound Event Handler</span></span>

<span data-ttu-id="c29a7-154">リピータ s 内の各カテゴリの製品の数を決定する`ItemDataBound`イベント ハンドラーは、既存のデータ アクセス層に変更を加える必要ありません。</span><span class="sxs-lookup"><span data-stu-id="c29a7-154">Determining the number of products for each category in the Repeater s `ItemDataBound` event handler does not require any modifications to our existing Data Access Layer.</span></span> <span data-ttu-id="c29a7-155">直下にあるすべての変更ができるように、`CategoriesAndProducts.aspx`ページ。</span><span class="sxs-lookup"><span data-stu-id="c29a7-155">All modifications can be made directly within the `CategoriesAndProducts.aspx` page.</span></span> <span data-ttu-id="c29a7-156">という名前の新しい ObjectDataSource を追加することによって開始`CategoriesDataSource`リピータ s のスマート タグを使用しています。</span><span class="sxs-lookup"><span data-stu-id="c29a7-156">Start by adding a new ObjectDataSource named `CategoriesDataSource` via the Repeater s smart tag.</span></span> <span data-ttu-id="c29a7-157">次に、構成、 `CategoriesDataSource` ObjectDataSource it からのデータの取得のため、`CategoriesBLL`クラスの`GetCategories()`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="c29a7-157">Next, configure the `CategoriesDataSource` ObjectDataSource so that it retrieves its data from the `CategoriesBLL` class s `GetCategories()` method.</span></span>


<span data-ttu-id="c29a7-158">[![構成、ObjectDataSource CategoriesBLL クラスの GetCategories() メソッドを使用するには](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image8.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="c29a7-158">[![Configure the ObjectDataSource to Use the CategoriesBLL class s GetCategories() Method](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image8.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image7.png)</span></span>

<span data-ttu-id="c29a7-159">**図 3**: 構成を使用する ObjectDataSource、`CategoriesBLL`クラス s`GetCategories()`メソッド ([フルサイズのイメージを表示するをクリックして](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="c29a7-159">**Figure 3**: Configure the ObjectDataSource to Use the `CategoriesBLL` class s `GetCategories()` Method ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image9.png))</span></span>


<span data-ttu-id="c29a7-160">内の各項目、`Categories`リピータに必要がありますクリック可能なクリックすると、原因、 `CategoryProducts` DataList を選択したカテゴリの製品を表示します。</span><span class="sxs-lookup"><span data-stu-id="c29a7-160">Each item in the `Categories` Repeater needs to be clickable and, when clicked, cause the `CategoryProducts` DataList to display those products for the selected category.</span></span> <span data-ttu-id="c29a7-161">これには、各カテゴリをハイパーリンクは、このページにリンクすることで (`CategoriesAndProducts.aspx`) を渡して、`CategoryID`前のチュートリアルで説明したのと同様に、クエリ文字列を通じてします。</span><span class="sxs-lookup"><span data-stu-id="c29a7-161">This can be accomplished by making each category a hyperlink, linking back to this same page (`CategoriesAndProducts.aspx`), but passing the `CategoryID` through the querystring, much like we saw in the previous tutorial.</span></span> <span data-ttu-id="c29a7-162">このアプローチの利点は、特定のカテゴリの製品を表示するページのブックマークが付けられたおよび検索エンジンによってインデックス設定されることです。</span><span class="sxs-lookup"><span data-stu-id="c29a7-162">The advantage of this approach is that a page displaying a particular category s products can be bookmarked and indexed by a search engine.</span></span>

<span data-ttu-id="c29a7-163">また、お寄せください各カテゴリ LinkButton、これは、このチュートリアルの使用方法です。</span><span class="sxs-lookup"><span data-stu-id="c29a7-163">Alternatively, we can make each category a LinkButton, which is the approach we'll use for this tutorial.</span></span> <span data-ttu-id="c29a7-164">LinkButton がハイパーリンクとしてユーザーのブラウザーで表示されますが、クリックされたときに即して、ポストバックポストバックで DataList の ObjectDataSource 更新する必要が、選択したカテゴリに属する製品を表示します。</span><span class="sxs-lookup"><span data-stu-id="c29a7-164">The LinkButton renders in the user s browser as a hyperlink but, when clicked, induces a postback; on postback, the DataList s ObjectDataSource needs to be refreshed to display those products belonging to the selected category.</span></span> <span data-ttu-id="c29a7-165">このチュートリアルでは、ハイパーリンクを使用する方が有意義 LinkButton; を使用するよりもただし、LinkButton を使用して複数のメリットがあるその他のシナリオがあります。</span><span class="sxs-lookup"><span data-stu-id="c29a7-165">For this tutorial, using a hyperlink makes more sense than using a LinkButton; however, there may be other scenarios where using a LinkButton is more advantageous.</span></span> <span data-ttu-id="c29a7-166">この例の理想的ながあるは、ハイパーリンク方法、中に s の LinkButton を使用する代わりに探索を使用できます。</span><span class="sxs-lookup"><span data-stu-id="c29a7-166">While the hyperlink approach would be ideal for this example, let s instead explore using the LinkButton.</span></span> <span data-ttu-id="c29a7-167">おわかりのよう LinkButton を使用していないそれ以外の場合に発生する、ハイパーリンクと課題がいくつか導入されています。</span><span class="sxs-lookup"><span data-stu-id="c29a7-167">As we'll see, using a LinkButton introduces some challenges that would not otherwise arise with a hyperlink.</span></span> <span data-ttu-id="c29a7-168">そのため、このチュートリアルでは、LinkButton を使用してこれらの課題を強調表示されハイパーリンクではなく、LinkButton を使用して必要のあるシナリオのソリューションを実現するのに役立つされます。</span><span class="sxs-lookup"><span data-stu-id="c29a7-168">Therefore, using a LinkButton in this tutorial will highlight these challenges and help provide solutions for those scenarios where we may want to use a LinkButton instead of a hyperlink.</span></span>

> [!NOTE]
> <span data-ttu-id="c29a7-169">ハイパーリンク コントロールを使用してこのチュートリアルを繰り返すことをお勧めまたは`<a>`代わりに、LinkButton 要素。</span><span class="sxs-lookup"><span data-stu-id="c29a7-169">You are encouraged to repeat this tutorial using a HyperLink control or `<a>` element in lieu of the LinkButton.</span></span>


<span data-ttu-id="c29a7-170">次のマークアップでは、リピータと、ObjectDataSource 宣言の構文を示します。</span><span class="sxs-lookup"><span data-stu-id="c29a7-170">The following markup shows the declarative syntax for the Repeater and the ObjectDataSource.</span></span> <span data-ttu-id="c29a7-171">リピータのテンプレートが LinkButton として各項目に行頭文字付きリストをレンダリングすることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="c29a7-171">Note that the Repeater s templates render a bulleted list with each item as a LinkButton:</span></span>


[!code-aspx[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/samples/sample4.aspx)]

> [!NOTE]
> <span data-ttu-id="c29a7-172">このチュートリアルでは、リピータのビュー ステートを有効になっている必要があります (の省略を注意してください、`EnableViewState="False"`リピータ s 宣言構文から)。</span><span class="sxs-lookup"><span data-stu-id="c29a7-172">For this tutorial the Repeater must have its view state enabled (note the omission of the `EnableViewState="False"` from the Repeater s declarative syntax).</span></span> <span data-ttu-id="c29a7-173">手順 3. で作成するイベント ハンドラー リピータ s の`ItemCommand`イベントで更新 DataList の ObjectDataSource の`SelectParameters`コレクション。</span><span class="sxs-lookup"><span data-stu-id="c29a7-173">In step 3 we'll be creating an event handler for the Repeater s `ItemCommand` event in which we'll be updating the DataList s ObjectDataSource s `SelectParameters` collection.</span></span> <span data-ttu-id="c29a7-174">リピータの`ItemCommand`、ただし、ビュー ステートが無効になっている場合、t 火災を優先します。</span><span class="sxs-lookup"><span data-stu-id="c29a7-174">The Repeater s `ItemCommand`, however, won t fire if view state is disabled.</span></span> <span data-ttu-id="c29a7-175">参照してください[ASP.NET 質問の A Stumper](http://scottonwriting.net/sowblog/posts/1263.aspx)と[そのソリューション](http://scottonwriting.net/sowBlog/posts/1268.aspx)理由についての詳細ビュー ステートを有効にするリピータの`ItemCommand`イベントが発生します。</span><span class="sxs-lookup"><span data-stu-id="c29a7-175">See [A Stumper of an ASP.NET Question](http://scottonwriting.net/sowblog/posts/1263.aspx) and [its solution](http://scottonwriting.net/sowBlog/posts/1268.aspx) for more information on why view state must be enabled for a Repeater s `ItemCommand` event to fire.</span></span>


<span data-ttu-id="c29a7-176">LinkButton を`ID`のプロパティの値`ViewCategory`がその`Text`プロパティ セットです。</span><span class="sxs-lookup"><span data-stu-id="c29a7-176">The LinkButton with the `ID` property value of `ViewCategory` does not have its `Text` property set.</span></span> <span data-ttu-id="c29a7-177">だけにする場合、カテゴリ名を表示、おが Text プロパティを設定宣言によって、データ バインドの構文を次のようにします。</span><span class="sxs-lookup"><span data-stu-id="c29a7-177">If we had just wanted to display the category name, we would have set the Text property declaratively, through databinding syntax, like so:</span></span>


[!code-aspx[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/samples/sample5.aspx)]

<span data-ttu-id="c29a7-178">ただし、カテゴリの名前を表示する*と*そのカテゴリに属している製品の数。</span><span class="sxs-lookup"><span data-stu-id="c29a7-178">However, we want to show both the category s name *and* the number of products belonging to that category.</span></span> <span data-ttu-id="c29a7-179">リピータ s からこの情報を取得することができます`ItemDataBound`イベント ハンドラーを呼び出すことによって、`ProductBLL`クラス s`GetCategoriesByProductID(categoryID)`メソッドと、その結果で返されるレコードの数を決定する`ProductsDataTable`、次のコードとして示しています。</span><span class="sxs-lookup"><span data-stu-id="c29a7-179">This information can be retrieved from the Repeater s `ItemDataBound` event handler by making a call to the `ProductBLL` class s `GetCategoriesByProductID(categoryID)` method and determining how many records are returned in the resulting `ProductsDataTable`, as the following code illustrates:</span></span>


[!code-csharp[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/samples/sample6.cs)]

<span data-ttu-id="c29a7-180">確認することから始めましょうデータ項目で作業して (1 つが`ItemType`は`Item`または`AlternatingItem`) し、参照、`CategoriesRow`だけが、現在にバインドされているインスタンス`RepeaterItem`です。</span><span class="sxs-lookup"><span data-stu-id="c29a7-180">We start out by ensuring that we re working with a data item (one whose `ItemType` is `Item` or `AlternatingItem`) and then reference the `CategoriesRow` instance that has just been bound to the current `RepeaterItem`.</span></span> <span data-ttu-id="c29a7-181">次のインスタンスを作成することでこのカテゴリの製品の数を決定したら、`ProductsBLL`クラス、呼び出し、`GetCategoriesByProductID(categoryID)`メソッド、および使用して返されるレコードの数を決定する、`Count`プロパティです。</span><span class="sxs-lookup"><span data-stu-id="c29a7-181">Next, we determine the number of products for this category by creating an instance of the `ProductsBLL` class, calling its `GetCategoriesByProductID(categoryID)` method, and determining the number of records returned using the `Count` property.</span></span> <span data-ttu-id="c29a7-182">最後に、 `ViewCategory` ItemTemplate の LinkButton が参照とその`Text`プロパティに設定されている*CategoryName* (*NumberOfProductsInCategory*) ここで、 *NumberOfProductsInCategory*がゼロの小数点以下桁数を表す数値として書式設定します。</span><span class="sxs-lookup"><span data-stu-id="c29a7-182">Finally, the `ViewCategory` LinkButton in the ItemTemplate is references and its `Text` property is set to *CategoryName* (*NumberOfProductsInCategory*), where *NumberOfProductsInCategory* is formatted as a number with zero decimal places.</span></span>

> [!NOTE]
> <span data-ttu-id="c29a7-183">または、でしたが追加されました、*関数の書式設定*ASP.NET ページの分離コード クラスをカテゴリ s を受け付ける`CategoryName`と`CategoryID`、値を返します、`CategoryName`の数を連結しました。カテゴリの製品 (呼び出しによって決定される、`GetCategoriesByProductID(categoryID)`メソッド)。</span><span class="sxs-lookup"><span data-stu-id="c29a7-183">Alternatively, we could have added a *formatting function* to the ASP.NET page s code-behind class that accepts a category s `CategoryName` and `CategoryID` values and returns the `CategoryName` concatenated with the number of products in the category (as determined by calling the `GetCategoriesByProductID(categoryID)` method).</span></span> <span data-ttu-id="c29a7-184">このような書式設定関数の結果は LinkButton s の必要性を置き換えるテキスト プロパティを宣言によって割り当て可能、`ItemDataBound`イベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="c29a7-184">The results of such a formatting function could be declaratively assigned to the LinkButton s Text property replacing the need for the `ItemDataBound` event handler.</span></span> <span data-ttu-id="c29a7-185">参照してください、 [GridView コントロールを使用して TemplateFields](../custom-formatting/using-templatefields-in-the-gridview-control-cs.md)または[DataList とリピータ ベース時のデータの書式設定](../displaying-data-with-the-datalist-and-repeater/formatting-the-datalist-and-repeater-based-upon-data-cs.md)書式設定関数を使用する方法についてのチュートリアルです。</span><span class="sxs-lookup"><span data-stu-id="c29a7-185">Refer to the [Using TemplateFields in the GridView Control](../custom-formatting/using-templatefields-in-the-gridview-control-cs.md) or [Formatting the DataList and Repeater Based Upon Data](../displaying-data-with-the-datalist-and-repeater/formatting-the-datalist-and-repeater-based-upon-data-cs.md) tutorials for more information on using formatting functions.</span></span>


<span data-ttu-id="c29a7-186">このイベント ハンドラーを追加すると、すぐをブラウザーでページをテストします。</span><span class="sxs-lookup"><span data-stu-id="c29a7-186">After adding this event handler, take a moment to test the page through a browser.</span></span> <span data-ttu-id="c29a7-187">各カテゴリ、カテゴリの名前とカテゴリに関連付けられている製品の数を表示する、箇条書きリストに表示する方法 (図 4 を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="c29a7-187">Note how each category is listed in a bulleted list, displaying the category s name and the number of products associated with the category (see Figure 4).</span></span>


<span data-ttu-id="c29a7-188">[![各カテゴリ名と製品の数が表示されます。](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image11.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="c29a7-188">[![Each Category s Name and Number of Products are Displayed](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image11.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image10.png)</span></span>

<span data-ttu-id="c29a7-189">**図 4**: 各カテゴリ名と製品の数が表示されます ([フルサイズのイメージを表示するをクリックして](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="c29a7-189">**Figure 4**: Each Category s Name and Number of Products are Displayed ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image12.png))</span></span>


## <a name="updating-thecategoriesdatatableandcategoriestableadapterto-include-the-number-of-products-for-each-category"></a><span data-ttu-id="c29a7-190">更新、`CategoriesDataTable`と`CategoriesTableAdapter`に各カテゴリの製品の数を含める</span><span class="sxs-lookup"><span data-stu-id="c29a7-190">Updating the`CategoriesDataTable`and`CategoriesTableAdapter`to Include the Number of Products for Each Category</span></span>

<span data-ttu-id="c29a7-191">リピータには、各カテゴリの製品の数を決定するのではなく s がバインドされている調整することでこのプロセスを合理化お、`CategoriesDataTable`と`CategoriesTableAdapter`情報が含まれるこのネイティブ データ アクセス層にします。</span><span class="sxs-lookup"><span data-stu-id="c29a7-191">Rather than determining the number of products for each category as it s bound to the Repeater, we can streamline this process by adjusting the `CategoriesDataTable` and `CategoriesTableAdapter` in the Data Access Layer to include this information natively.</span></span> <span data-ttu-id="c29a7-192">これを実現するの新しい列を追加します`CategoriesDataTable`関連付けられている製品の数を保持します。</span><span class="sxs-lookup"><span data-stu-id="c29a7-192">To achieve this, we must add a new column to `CategoriesDataTable` to hold the number of associated products.</span></span> <span data-ttu-id="c29a7-193">DataTable に新しい列を追加するに型指定されたデータセットを開きます (`App_Code\DAL\Northwind.xsd`) を変更するデータ テーブルを右クリックし、追加/列です。</span><span class="sxs-lookup"><span data-stu-id="c29a7-193">To add a new column to a DataTable, open the Typed DataSet (`App_Code\DAL\Northwind.xsd`), right-click on the DataTable to modify, and choose Add / Column.</span></span> <span data-ttu-id="c29a7-194">新しい列を追加、 `CategoriesDataTable` (図 5 を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="c29a7-194">Add a new column to the `CategoriesDataTable` (see Figure 5).</span></span>


<span data-ttu-id="c29a7-195">[![CategoriesDataSource に新しい列を追加します。](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image14.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="c29a7-195">[![Add a New Column to the CategoriesDataSource](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image14.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image13.png)</span></span>

<span data-ttu-id="c29a7-196">**図 5**: 新しい列を追加、 `CategoriesDataSource` ([フルサイズのイメージを表示するをクリックして](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="c29a7-196">**Figure 5**: Add a New Column to the `CategoriesDataSource` ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image15.png))</span></span>


<span data-ttu-id="c29a7-197">これによりという名前の新しい列が追加されます`Column1`、これは、別の名前を入力するだけで変更できます。</span><span class="sxs-lookup"><span data-stu-id="c29a7-197">This will add a new column named `Column1`, which you can change by simply typing in a different name.</span></span> <span data-ttu-id="c29a7-198">この新しい列の名前を変更`NumberOfProducts`です。</span><span class="sxs-lookup"><span data-stu-id="c29a7-198">Rename this new column to `NumberOfProducts`.</span></span> <span data-ttu-id="c29a7-199">次に、この列のプロパティを構成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="c29a7-199">Next, we need to configure this column s properties.</span></span> <span data-ttu-id="c29a7-200">新しい列をクリックし、[プロパティ] ウィンドウに移動します。</span><span class="sxs-lookup"><span data-stu-id="c29a7-200">Click on the new column and go to the Properties window.</span></span> <span data-ttu-id="c29a7-201">S 列を変更する`DataType`プロパティから`System.String`に`System.Int32`設定と、`ReadOnly`プロパティを`True`図 6 に示すように、します。</span><span class="sxs-lookup"><span data-stu-id="c29a7-201">Change the column s `DataType` property from `System.String` to `System.Int32` and set the `ReadOnly` property to `True`, as shown in Figure 6.</span></span>


![データ型と新しい列の ReadOnly プロパティを設定します。](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image16.png)

<span data-ttu-id="c29a7-203">**図 6**: 設定、`DataType`と`ReadOnly`新しい列のプロパティ</span><span class="sxs-lookup"><span data-stu-id="c29a7-203">**Figure 6**: Set the `DataType` and `ReadOnly` Properties of the New Column</span></span>


<span data-ttu-id="c29a7-204">中に、`CategoriesDataTable`ようになりました、`NumberOfProducts`列で、その値が設定されていない対応する TableAdapter のクエリのいずれか。</span><span class="sxs-lookup"><span data-stu-id="c29a7-204">While the `CategoriesDataTable` now has a `NumberOfProducts` column, its value is not set by any of the corresponding TableAdapter s queries.</span></span> <span data-ttu-id="c29a7-205">更新することが、`GetCategories()`カテゴリ情報を取得するたびなどの情報をたい場合は、この情報を返すメソッドが返されます。</span><span class="sxs-lookup"><span data-stu-id="c29a7-205">We can update the `GetCategories()` method to return this information if we want such information returned every time category information is retrieved.</span></span> <span data-ttu-id="c29a7-206">、ただし、まれに (このチュートリアル用になど)、カテゴリに関連付けられている製品の数を取得するだけで済む場合しなくてもかまいません`GetCategories()`としてでは、この情報を返す新しいメソッドを作成します。</span><span class="sxs-lookup"><span data-stu-id="c29a7-206">If, however, we only need to grab the number of associated products for the categories in rare instances (such as just for this tutorial), then we can leave `GetCategories()` as-is and create a new method that returns this information.</span></span> <span data-ttu-id="c29a7-207">Let s という名前の新しいメソッドを作成するこの後者のアプローチを使用して`GetCategoriesAndNumberOfProducts()`です。</span><span class="sxs-lookup"><span data-stu-id="c29a7-207">Let s use this latter approach, creating a new method named `GetCategoriesAndNumberOfProducts()`.</span></span>

<span data-ttu-id="c29a7-208">これを新規に追加する`GetCategoriesAndNumberOfProducts()`メソッドを右クリックし、`CategoriesTableAdapter`新しいクエリを選択します。</span><span class="sxs-lookup"><span data-stu-id="c29a7-208">To add this new `GetCategoriesAndNumberOfProducts()` method, right-click on the `CategoriesTableAdapter` and choose New Query.</span></span> <span data-ttu-id="c29a7-209">これにより、TableAdapter クエリ構成ウィザードで、どのお何回前のチュートリアルで使用するアップされます。</span><span class="sxs-lookup"><span data-stu-id="c29a7-209">This brings up the TableAdapter Query Configuration Wizard, which we ve used numerous times in previous tutorials.</span></span> <span data-ttu-id="c29a7-210">このメソッドでクエリが行を返す、アドホック SQL ステートメントを使用していることを示すウィザードを起動します。</span><span class="sxs-lookup"><span data-stu-id="c29a7-210">For this method, start the wizard by indicating that the query uses an ad-hoc SQL statement that returns rows.</span></span>


<span data-ttu-id="c29a7-211">[![アドホック SQL ステートメントを使用するメソッドを作成します。](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image18.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="c29a7-211">[![Create the Method Using an Ad-Hoc SQL Statement](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image18.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image17.png)</span></span>

<span data-ttu-id="c29a7-212">**図 7**: アドホック SQL ステートメントを使用してメソッドを作成 ([フルサイズのイメージを表示するをクリックして](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image19.png))</span><span class="sxs-lookup"><span data-stu-id="c29a7-212">**Figure 7**: Create the Method Using an Ad-Hoc SQL Statement ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image19.png))</span></span>


<span data-ttu-id="c29a7-213">[![SQL ステートメントには、行が返されます。](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image21.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="c29a7-213">[![The SQL Statement Returns Rows](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image21.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image20.png)</span></span>

<span data-ttu-id="c29a7-214">**図 8**:、行の SQL ステートメントを返します ([フルサイズのイメージを表示するをクリックして](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="c29a7-214">**Figure 8**: The SQL Statement Returns Rows ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image22.png))</span></span>


<span data-ttu-id="c29a7-215">次のウィザード画面では、使用するクエリの場合、us ように求められます。</span><span class="sxs-lookup"><span data-stu-id="c29a7-215">The next wizard screen prompts us for the query to use.</span></span> <span data-ttu-id="c29a7-216">各カテゴリの s を返す`CategoryID`、 `CategoryName`、および`Description`、カテゴリに関連付けられている製品の数と共に、フィールドは、次を使用して`SELECT`ステートメント。</span><span class="sxs-lookup"><span data-stu-id="c29a7-216">To return each category s `CategoryID`, `CategoryName`, and `Description` fields, along with the number of products associated with the category, use the following `SELECT` statement:</span></span>


[!code-sql[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/samples/sample7.sql)]


<span data-ttu-id="c29a7-217">[![使用するクエリを指定します。](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image24.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="c29a7-217">[![Specify the Query to Use](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image24.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image23.png)</span></span>

<span data-ttu-id="c29a7-218">**図 9**: 使用するクエリを指定 ([フルサイズのイメージを表示するをクリックして](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="c29a7-218">**Figure 9**: Specify the Query to Use ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image25.png))</span></span>


<span data-ttu-id="c29a7-219">カテゴリに関連付けられている製品の数を計算するサブクエリは、別名として`NumberOfProducts`です。</span><span class="sxs-lookup"><span data-stu-id="c29a7-219">Note that the subquery that computes the number of products associated with the category is aliased as `NumberOfProducts`.</span></span> <span data-ttu-id="c29a7-220">この名前付けの一致とを関連付けるには、このサブクエリによって返される値、 `CategoriesDataTable` s`NumberOfProducts`列です。</span><span class="sxs-lookup"><span data-stu-id="c29a7-220">This naming match causes the value returned by this subquery to be associated with the `CategoriesDataTable` s `NumberOfProducts` column.</span></span>

<span data-ttu-id="c29a7-221">このクエリを入力するは、最後の手順は、新しいメソッドの名前を選択します。</span><span class="sxs-lookup"><span data-stu-id="c29a7-221">After entering this query, the last step is to choose the name for the new method.</span></span> <span data-ttu-id="c29a7-222">使用して`FillWithNumberOfProducts`と`GetCategoriesAndNumberOfProducts`塗りつぶしの DataTable と戻り値、データ テーブルのパターンをそれぞれします。</span><span class="sxs-lookup"><span data-stu-id="c29a7-222">Use `FillWithNumberOfProducts` and `GetCategoriesAndNumberOfProducts` for the Fill a DataTable and Return a DataTable patterns, respectively.</span></span>


<span data-ttu-id="c29a7-223">[![名前の新しい TableAdapter のメソッド FillWithNumberOfProducts と GetCategoriesAndNumberOfProducts](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image27.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="c29a7-223">[![Name the New TableAdapter s Methods FillWithNumberOfProducts and GetCategoriesAndNumberOfProducts](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image27.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image26.png)</span></span>

<span data-ttu-id="c29a7-224">**図 10**: 新しい tableadapter のメソッドの名前を付けます`FillWithNumberOfProducts`と`GetCategoriesAndNumberOfProducts`([フルサイズのイメージを表示するをクリックして](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="c29a7-224">**Figure 10**: Name the New TableAdapter s Methods `FillWithNumberOfProducts` and `GetCategoriesAndNumberOfProducts` ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image28.png))</span></span>


<span data-ttu-id="c29a7-225">この時点で、データ アクセス層が拡張されてカテゴリごとに製品の数が含まれます。</span><span class="sxs-lookup"><span data-stu-id="c29a7-225">At this point the Data Access Layer has been extended to include the number of products per category.</span></span> <span data-ttu-id="c29a7-226">対応するを追加する必要がありますので、すべてのプレゼンテーション層が、個別のビジネス ロジック層を介して、DAL にすべての呼び出しをルーティング`GetCategoriesAndNumberOfProducts`メソッドを`CategoriesBLL`クラス。</span><span class="sxs-lookup"><span data-stu-id="c29a7-226">Since all our presentation layer routes all calls to the DAL through a separate Business Logic Layer we need to add a corresponding `GetCategoriesAndNumberOfProducts` method to the `CategoriesBLL` class:</span></span>


[!code-csharp[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/samples/sample8.cs)]

<span data-ttu-id="c29a7-227">このデータをバインドする準備 re お DAL BLL 完了と、`Categories`でリピータ`CategoriesAndProducts.aspx`!</span><span class="sxs-lookup"><span data-stu-id="c29a7-227">With the DAL and BLL complete, we re ready to bind this data to the `Categories` Repeater in `CategoriesAndProducts.aspx`!</span></span> <span data-ttu-id="c29a7-228">いる、決定から Repeater をまだ作成して、ObjectDataSource 場合の製品の数、`ItemDataBound`イベント ハンドラー セクションで、この ObjectDataSource およびリピータ s を削除`DataSourceID`プロパティ unwire; の設定も、リピータ s`ItemDataBound`イベント、イベント ハンドラーを削除してから、 `Handles Categories.OnItemDataBound` ASP.NET 分離コード クラスの構文。</span><span class="sxs-lookup"><span data-stu-id="c29a7-228">If you ve already created an ObjectDataSource for the Repeater from the Determining the Number of Products in the `ItemDataBound` Event Handler section, delete this ObjectDataSource and remove the Repeater s `DataSourceID` property setting; also unwire the Repeater s `ItemDataBound` event from the event handler by removing the `Handles Categories.OnItemDataBound` syntax in the ASP.NET code-behind class.</span></span>

<span data-ttu-id="c29a7-229">元の状態に戻りますリピータ、追加という名前の新しい ObjectDataSource`CategoriesDataSource`リピータ s のスマート タグを使用しています。</span><span class="sxs-lookup"><span data-stu-id="c29a7-229">With the Repeater back in its original state, add a new ObjectDataSource named `CategoriesDataSource` via the Repeater s smart tag.</span></span> <span data-ttu-id="c29a7-230">構成を使用する ObjectDataSource、`CategoriesBLL`クラスが使用するのではなく、`GetCategories()`メソッドが使用する必要が`GetCategoriesAndNumberOfProducts()`代わりに (図 11 を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="c29a7-230">Configure the ObjectDataSource to use the `CategoriesBLL` class, but instead of having it use the `GetCategories()` method, have it use `GetCategoriesAndNumberOfProducts()` instead (see Figure 11).</span></span>


<span data-ttu-id="c29a7-231">[![ObjectDataSource GetCategoriesAndNumberOfProducts メソッドを使用して構成します。](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image30.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="c29a7-231">[![Configure the ObjectDataSource to Use the GetCategoriesAndNumberOfProducts Method](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image30.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image29.png)</span></span>

<span data-ttu-id="c29a7-232">**図 11**: 構成を使用する ObjectDataSource、`GetCategoriesAndNumberOfProducts`メソッド ([フルサイズのイメージを表示するをクリックして](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="c29a7-232">**Figure 11**: Configure the ObjectDataSource to Use the `GetCategoriesAndNumberOfProducts` Method ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image31.png))</span></span>


<span data-ttu-id="c29a7-233">次に、更新、`ItemTemplate`ように LinkButton s`Text`プロパティが、データ バインドの構文を使用してを宣言によって割り当てられ、両方が含まれる、`CategoryName`と`NumberOfProducts`データ フィールドです。</span><span class="sxs-lookup"><span data-stu-id="c29a7-233">Next, update the `ItemTemplate` so that the LinkButton s `Text` property is declaratively assigned using databinding syntax and includes both the `CategoryName` and `NumberOfProducts` data fields.</span></span> <span data-ttu-id="c29a7-234">リピータの完全な宣言型マークアップと`CategoriesDataSource`ObjectDataSource に従ってください。</span><span class="sxs-lookup"><span data-stu-id="c29a7-234">The complete declarative markup for the Repeater and the `CategoriesDataSource` ObjectDataSource follow:</span></span>


[!code-aspx[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/samples/sample9.aspx)]

<span data-ttu-id="c29a7-235">含める、DAL を更新することによって表示される出力、`NumberOfProducts`列は、同じを使用して、`ItemDataBound`イベント ハンドラーのアプローチ (画面を表示する図 4 に戻ってカテゴリ名と製品の数を示す中継ぎ局のショット)。</span><span class="sxs-lookup"><span data-stu-id="c29a7-235">The output rendered by updating the DAL to include a `NumberOfProducts` column is the same as using the `ItemDataBound` event handler approach (refer back to Figure 4 to see a screen shot of the Repeater showing the category names and number of products).</span></span>

## <a name="step-3-displaying-the-selected-category-s-products"></a><span data-ttu-id="c29a7-236">手順 3: 選択したカテゴリの製品を表示します。</span><span class="sxs-lookup"><span data-stu-id="c29a7-236">Step 3: Displaying the Selected Category s Products</span></span>

<span data-ttu-id="c29a7-237">この時点である、`Categories`リピータ各カテゴリの製品の数と共にカテゴリの一覧を表示します。</span><span class="sxs-lookup"><span data-stu-id="c29a7-237">At this point we have the `Categories` Repeater displaying the list of categories along with the number of products in each category.</span></span> <span data-ttu-id="c29a7-238">リピータ、クリックすると、問題が発生する、ポストバック ポイントは、各カテゴリの LinkButton を使用して、選択したカテゴリでのそれらの製品を表示する必要があります、 `CategoryProducts` DataList です。</span><span class="sxs-lookup"><span data-stu-id="c29a7-238">The Repeater uses a LinkButton for each category that, when clicked, causes a postback, at which point we need to display those products for the selected category in the `CategoryProducts` DataList.</span></span>

<span data-ttu-id="c29a7-239">私たちが直面する 1 つの課題は、DataList、選択したカテゴリの製品だけを表示する方法を示します。</span><span class="sxs-lookup"><span data-stu-id="c29a7-239">One challenge facing us is how to have the DataList display just those products for the selected category.</span></span> <span data-ttu-id="c29a7-240">[マスター/詳細 DetailsView で選択可能なマスター GridView の使用について詳しく説明](../masterdetail/master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md)行が GridView を構築する方法を説明しましたチュートリアルを選択することが、選択した行 s 詳細は同じページ上の DetailsView に表示されています。</span><span class="sxs-lookup"><span data-stu-id="c29a7-240">In the [Master/Detail Using a Selectable Master GridView with a Details DetailsView](../masterdetail/master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md) tutorial we saw how to build a GridView whose rows could be selected, with the selected row s details being displayed in a DetailsView on the same page.</span></span> <span data-ttu-id="c29a7-241">GridView の ObjectDataSource が返される情報を使用してすべての製品について、 `ProductsBLL` s `GetProducts()` DetailsView の ObjectDataSource 中にメソッドを使用して、選択した製品に関する情報を取得する、`GetProductsByProductID(productID)`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="c29a7-241">The GridView s ObjectDataSource returned information about all products using the `ProductsBLL` s `GetProducts()` method while the DetailsView s ObjectDataSource retrieved information about the selected product using the `GetProductsByProductID(productID)` method.</span></span> <span data-ttu-id="c29a7-242"> *`productID`*  GridView 秒の値に関連付けることにより宣言によって指定されたがパラメーター値`SelectedValue`プロパティです。</span><span class="sxs-lookup"><span data-stu-id="c29a7-242">The *`productID`* parameter value was provided declaratively by associating it with the value of the GridView s `SelectedValue` property.</span></span> <span data-ttu-id="c29a7-243">残念ながら、リピータはありません、`SelectedValue`プロパティおよびパラメーターのソースとして使用できません。</span><span class="sxs-lookup"><span data-stu-id="c29a7-243">Unfortunately, the Repeater does not have a `SelectedValue` property and cannot serve as a parameter source.</span></span>

> [!NOTE]
> <span data-ttu-id="c29a7-244">これは、リピータ内の LinkButton を使用するときに表示されるこれらの課題の 1 つです。</span><span class="sxs-lookup"><span data-stu-id="c29a7-244">This is one of those challenges that appear when using the LinkButton in a Repeater.</span></span> <span data-ttu-id="c29a7-245">使用して、ハイパーリンクに渡す、`CategoryID`クエリ文字列を通じて代わりに、お QueryString フィールド ソースとして使用、パラメーターの値。</span><span class="sxs-lookup"><span data-stu-id="c29a7-245">Had we used a hyperlink to pass in the `CategoryID` through the querystring instead, we could use that QueryString field as the source for the parameter s value.</span></span>


<span data-ttu-id="c29a7-246">欠如に関する心配する前に、`SelectedValue`リピータのプロパティは、使用できます s 最初、ObjectDataSource を DataList をバインドし、指定の`ItemTemplate`します。</span><span class="sxs-lookup"><span data-stu-id="c29a7-246">Before we worry about the lack of a `SelectedValue` property for the Repeater, though, let s first bind the DataList to an ObjectDataSource and specify its `ItemTemplate`.</span></span>

<span data-ttu-id="c29a7-247">という名前の新しい ObjectDataSource を追加することを選択、DataList s のスマート タグから`CategoryProductsDataSource`を使用するように構成し、`ProductsBLL`クラスの`GetProductsByCategoryID(categoryID)`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="c29a7-247">From the DataList s smart tag, opt to add a new ObjectDataSource named `CategoryProductsDataSource` and configure it to use the `ProductsBLL` class s `GetProductsByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="c29a7-248">このチュートリアルでは、DataList は読み取り専用のインターフェイスを提供するため自由、insert、UPDATE、ドロップダウン リストを設定し、(なし) タブを削除してください。</span><span class="sxs-lookup"><span data-stu-id="c29a7-248">Since the DataList in this tutorial offers a read-only interface, feel free to set the drop-down lists in the INSERT, UPDATE, and DELETE tabs to (None).</span></span>


<span data-ttu-id="c29a7-249">[![ObjectDataSource ProductsBLL クラスの GetProductsByCategoryID(categoryID) メソッドを使用して構成します。](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image33.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="c29a7-249">[![Configure the ObjectDataSource to Use ProductsBLL Class s GetProductsByCategoryID(categoryID) Method](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image33.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image32.png)</span></span>

<span data-ttu-id="c29a7-250">**図 12**: 構成を使用する ObjectDataSource`ProductsBLL`クラス s`GetProductsByCategoryID(categoryID)`メソッド ([フルサイズのイメージを表示するをクリックして](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image34.png))</span><span class="sxs-lookup"><span data-stu-id="c29a7-250">**Figure 12**: Configure the ObjectDataSource to Use `ProductsBLL` Class s `GetProductsByCategoryID(categoryID)` Method ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image34.png))</span></span>


<span data-ttu-id="c29a7-251">以降、`GetProductsByCategoryID(categoryID)`メソッドが入力パラメーターが必要です (*`categoryID`*)、データ ソース構成ウィザードにより、パラメーターのソースを指定します。</span><span class="sxs-lookup"><span data-stu-id="c29a7-251">Since the `GetProductsByCategoryID(categoryID)` method expects an input parameter (*`categoryID`*), the Configure Data Source wizard allows us to specify the parameter s source.</span></span> <span data-ttu-id="c29a7-252">カテゴリは、GridView、DataList に指定されていた、d 設定パラメーターのソースのドロップダウン リスト コントロールを処理する、 `ID` Web コントロールのデータのです。</span><span class="sxs-lookup"><span data-stu-id="c29a7-252">Had the categories been listed in a GridView or a DataList, we d set the Parameter source drop-down list to Control and the ControlID to the `ID` of the data Web control.</span></span> <span data-ttu-id="c29a7-253">ただし、リピータ欠如以降、`SelectedValue`プロパティ パラメーターのソースとして使用することはできません。</span><span class="sxs-lookup"><span data-stu-id="c29a7-253">However, since the Repeater lacks a `SelectedValue` property it cannot be used as a parameter source.</span></span> <span data-ttu-id="c29a7-254">チェックする場合、できたら、ControlID ドロップダウン リストに 1 つのコントロールにはのみが含まれている`ID``CategoryProducts`、 `ID` DataList のです。</span><span class="sxs-lookup"><span data-stu-id="c29a7-254">If you check, you'll find that the ControlID drop-down list only contains one control `ID``CategoryProducts`, the `ID` of the DataList.</span></span>

<span data-ttu-id="c29a7-255">ここでは、パラメーターのソースのドロップダウン リストを None に設定します。</span><span class="sxs-lookup"><span data-stu-id="c29a7-255">For now, set the Parameter source drop-down list to None.</span></span> <span data-ttu-id="c29a7-256">プログラムでこのカテゴリでリピータ LinkButton がクリックされたときに、パラメーターの値を割り当てることになります。</span><span class="sxs-lookup"><span data-stu-id="c29a7-256">We'll end up programmatically assigning this parameter value when a category LinkButton is clicked in the Repeater.</span></span>


<span data-ttu-id="c29a7-257">[![CategoryID パラメーターのパラメーターのソースを指定しないをしないでください。](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image36.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="c29a7-257">[![Do Not Specify a Parameter Source for the categoryID Parameter](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image36.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image35.png)</span></span>

<span data-ttu-id="c29a7-258">**図 13**: パラメーターのソースを指定しない、  *`categoryID`* パラメーター ([フルサイズのイメージを表示するをクリックして](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image37.png))</span><span class="sxs-lookup"><span data-stu-id="c29a7-258">**Figure 13**: Do Not Specify a Parameter Source for the *`categoryID`* Parameter ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image37.png))</span></span>


<span data-ttu-id="c29a7-259">データ ソース構成ウィザードを完了すると、Visual Studio 自動生成 DataList の`ItemTemplate`です。</span><span class="sxs-lookup"><span data-stu-id="c29a7-259">After completing the Configure Data Source wizard, Visual Studio auto-generates the DataList s `ItemTemplate`.</span></span> <span data-ttu-id="c29a7-260">この既定値を置き換える`ItemTemplate`テンプレートを使用して前のチュートリアルで使用されている以外の場合は DataList s を設定しても、`RepeatColumns`プロパティを 2 です。</span><span class="sxs-lookup"><span data-stu-id="c29a7-260">Replace this default `ItemTemplate` with the template we used in the preceding tutorial; also, set the DataList s `RepeatColumns` property to 2.</span></span> <span data-ttu-id="c29a7-261">これらの変更を行った後は、DataList および関連付けられている、ObjectDataSource の宣言型マークアップは、次のようになります。</span><span class="sxs-lookup"><span data-stu-id="c29a7-261">After making these changes the declarative markup for your DataList and its associated ObjectDataSource should look like the following:</span></span>


[!code-aspx[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/samples/sample10.aspx)]

<span data-ttu-id="c29a7-262">現時点では、 `CategoryProductsDataSource` ObjectDataSource s  *`categoryID`* パラメーターは設定されません、ページを表示するときに製品が表示されないようにします。</span><span class="sxs-lookup"><span data-stu-id="c29a7-262">Currently, the `CategoryProductsDataSource` ObjectDataSource s *`categoryID`* parameter is never set, so no products are displayed when viewing the page.</span></span> <span data-ttu-id="c29a7-263">このパラメーター値が設定されてに基づいて行う必要がありますが、`CategoryID`リピータでクリックしたカテゴリのです。</span><span class="sxs-lookup"><span data-stu-id="c29a7-263">What we need to do is have this parameter value set based on the `CategoryID` of the clicked category in the Repeater.</span></span> <span data-ttu-id="c29a7-264">これにより、2 つの課題: 最初は方針ときリピータ s の LinkButton`ItemTemplate`が行われてクリックした 2 番目、どのように確認する、`CategoryID`の LinkButton がクリックされた、対応するカテゴリのですか?。</span><span class="sxs-lookup"><span data-stu-id="c29a7-264">This introduces two challenges: first, how do we determine when a LinkButton in the Repeater s `ItemTemplate` has been clicked; and second, how can we determine the `CategoryID` of the corresponding category whose LinkButton was clicked?</span></span>

<span data-ttu-id="c29a7-265">ボタンおよび ImageButton コントロールと同様の LinkButton が、`Click`イベントおよび[`Command`イベント](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.linkbutton.command.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="c29a7-265">The LinkButton like the Button and ImageButton controls has a `Click` event and a [`Command` event](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.linkbutton.command.aspx).</span></span> <span data-ttu-id="c29a7-266">`Click`イベントの目的だけの LinkButton がクリックしてされたことに注意してください。</span><span class="sxs-lookup"><span data-stu-id="c29a7-266">The `Click` event is designed to simply note that the LinkButton has been clicked.</span></span> <span data-ttu-id="c29a7-267">ときに、ただし、に加えて、LinkButton がクリックしてされたことに注意してくださいもが必要な追加情報をイベント ハンドラーに渡します。</span><span class="sxs-lookup"><span data-stu-id="c29a7-267">At times, however, in addition to noting that the LinkButton has been clicked we also need to pass some extra information to the event handler.</span></span> <span data-ttu-id="c29a7-268">このような LinkButton s 場合[ `CommandName` ](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.linkbutton.commandname.aspx)と[ `CommandArgument` ](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.linkbutton.commandargument.aspx)プロパティにこの追加情報を割り当てることができます。</span><span class="sxs-lookup"><span data-stu-id="c29a7-268">If this is the case, the LinkButton s [`CommandName`](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.linkbutton.commandname.aspx) and [`CommandArgument`](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.linkbutton.commandargument.aspx) properties can be assigned this extra information.</span></span> <span data-ttu-id="c29a7-269">LinkButton がクリックされたときにし、その`Command`イベントの起動 (の代わりにその`Click`イベント) でイベント ハンドラーには、値が渡され、`CommandName`と`CommandArgument`プロパティ。</span><span class="sxs-lookup"><span data-stu-id="c29a7-269">Then, when the LinkButton is clicked, its `Command` event fires (instead of its `Click` event) and the event handler is passed the values of the `CommandName` and `CommandArgument` properties.</span></span>

<span data-ttu-id="c29a7-270">ときに、`Command`リピータ、リピータ s でテンプレート内のイベントは[`ItemCommand`イベント](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.repeater.itemcommand.aspx)が起動し、渡される、`CommandName`と`CommandArgument`クリックされた LinkButton の値 (またはボタンまたはImageButton)。</span><span class="sxs-lookup"><span data-stu-id="c29a7-270">When a `Command` event is raised from within a template in the Repeater, the Repeater s [`ItemCommand` event](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.repeater.itemcommand.aspx) fires and is passed the `CommandName` and `CommandArgument` values of the clicked LinkButton (or Button or ImageButton).</span></span> <span data-ttu-id="c29a7-271">そのため、カテゴリ、リピータ LinkButton がクリックしてされたときを特定するのには、次のお必要があります。</span><span class="sxs-lookup"><span data-stu-id="c29a7-271">Therefore, to determine when a category LinkButton in the Repeater has been clicked, we need to do the following:</span></span>

1. <span data-ttu-id="c29a7-272">設定、`CommandName`リピータ s の LinkButton のプロパティ`ItemTemplate`になんらかの値 (すれば ListProducts も使用しました)。</span><span class="sxs-lookup"><span data-stu-id="c29a7-272">Set the `CommandName` property of the LinkButton in the Repeater s `ItemTemplate` to some value (I ve used ListProducts ).</span></span> <span data-ttu-id="c29a7-273">これを設定して`CommandName`値、LinkButton の`Command`の LinkButton がクリックされたときにイベントが発生します。</span><span class="sxs-lookup"><span data-stu-id="c29a7-273">By setting this `CommandName` value, the LinkButton s `Command` event fires when the LinkButton is clicked.</span></span>
2. <span data-ttu-id="c29a7-274">集合 LinkButton s`CommandArgument`プロパティを現在のアイテムの秒の値に`CategoryID`です。</span><span class="sxs-lookup"><span data-stu-id="c29a7-274">Set the LinkButton s `CommandArgument` property to the value of the current item s `CategoryID`.</span></span>
3. <span data-ttu-id="c29a7-275">リピータ s のイベント ハンドラーを作成する`ItemCommand`イベント。</span><span class="sxs-lookup"><span data-stu-id="c29a7-275">Create an event handler for the Repeater s `ItemCommand` event.</span></span> <span data-ttu-id="c29a7-276">イベント ハンドラー、セットに、 `CategoryProductsDataSource` ObjectDataSource s`CategoryID`パラメーターの値が渡されたの`CommandArgument`します。</span><span class="sxs-lookup"><span data-stu-id="c29a7-276">In the event handler, set the `CategoryProductsDataSource` ObjectDataSource s `CategoryID` parameter to the value of the passed-in `CommandArgument`.</span></span>

<span data-ttu-id="c29a7-277">次`ItemTemplate`カテゴリ リピータのマークアップを手順 1. と 2. を実装します。</span><span class="sxs-lookup"><span data-stu-id="c29a7-277">The following `ItemTemplate` markup for the Categories Repeater implements steps 1 and 2.</span></span> <span data-ttu-id="c29a7-278">注方法、`CommandArgument`値には、データ項目の s が割り当てられる`CategoryID`databinding 構文を使用します。</span><span class="sxs-lookup"><span data-stu-id="c29a7-278">Note how the `CommandArgument` value is assigned the data item s `CategoryID` using databinding syntax:</span></span>


[!code-aspx[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/samples/sample11.aspx)]

<span data-ttu-id="c29a7-279">作成されるたびに、`ItemCommand`イベント ハンドラーが常に、まず受信を確認することは賢明`CommandName`ので値*任意*`Command`によってイベントが発生した*任意*ボタン、LinkButton、またはリピータ内の ImageButton がなります、`ItemCommand`イベントが発生します。</span><span class="sxs-lookup"><span data-stu-id="c29a7-279">Whenever creating an `ItemCommand` event handler it is prudent to always first check the incoming `CommandName` value because *any* `Command` event raised by *any* Button, LinkButton, or ImageButton within the Repeater will cause the `ItemCommand` event to fire.</span></span> <span data-ttu-id="c29a7-280">お現在のみがこのような 1 つの LinkButton これで、今後お (または、チームの他の開発者) 可能性があります ボタンが追加 Web コントロールを追加、リピータをクリックすると、同じを発生させます。`ItemCommand`イベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="c29a7-280">While we currently only have one such LinkButton now, in the future we (or another developer on our team) might add additional button Web controls to the Repeater that, when clicked, raises the same `ItemCommand` event handler.</span></span> <span data-ttu-id="c29a7-281">そのため、常に確認してくださいことをお勧め、`CommandName`プロパティのみ想定される値に一致した場合、プログラム ロジックを続行します。</span><span class="sxs-lookup"><span data-stu-id="c29a7-281">Therefore, it s best to always make sure you check the `CommandName` property and only proceed with your programmatic logic if it matches up to the value expected.</span></span>

<span data-ttu-id="c29a7-282">渡されたことを確認した後は`CommandName`ListProducts の値が、イベント ハンドラーを割り当てます、 `CategoryProductsDataSource` ObjectDataSource s`CategoryID`パラメーターの値が渡されたの`CommandArgument`します。</span><span class="sxs-lookup"><span data-stu-id="c29a7-282">After ensuring that the passed-in `CommandName` value equals ListProducts, the event handler then assigns the `CategoryProductsDataSource` ObjectDataSource s `CategoryID` parameter to the value of the passed-in `CommandArgument`.</span></span> <span data-ttu-id="c29a7-283">この変更に、ObjectDataSource の`SelectParameters`に自体を新しく選択したカテゴリの製品を表示、データ ソースにバインドし直す DataList を自動的に発生します。</span><span class="sxs-lookup"><span data-stu-id="c29a7-283">This modification to the ObjectDataSource s `SelectParameters` automatically causes the DataList to rebind itself to the data source, showing the products for the newly selected category.</span></span>


[!code-csharp[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/samples/sample12.cs)]

<span data-ttu-id="c29a7-284">これらの項目を追加します。 このチュートリアルが完了しました。</span><span class="sxs-lookup"><span data-stu-id="c29a7-284">With these additions, our tutorial is complete!</span></span> <span data-ttu-id="c29a7-285">すぐをブラウザーでテストしてみましょう。</span><span class="sxs-lookup"><span data-stu-id="c29a7-285">Take a moment to test it out in a browser.</span></span> <span data-ttu-id="c29a7-286">図 14 は、最初のページにアクセスしたときの画面を示しています。</span><span class="sxs-lookup"><span data-stu-id="c29a7-286">Figure 14 shows the screen when first visiting the page.</span></span> <span data-ttu-id="c29a7-287">カテゴリにまだへを選択するための製品は表示されません。</span><span class="sxs-lookup"><span data-stu-id="c29a7-287">Since a category has yet to be selected, no products are displayed.</span></span> <span data-ttu-id="c29a7-288">2 つの列ビューで、製品カテゴリでこれらの製品生成などのカテゴリをクリックすると表示されます (図 15 を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="c29a7-288">Clicking on a category, such as Produce, displays those products in the Product category in a two-column view (see Figure 15).</span></span>


<span data-ttu-id="c29a7-289">[![表示されるときに最初にアクセス ページを要求している製品がありません。](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image39.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="c29a7-289">[![No Products are Displayed When First Visiting the Page](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image39.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image38.png)</span></span>

<span data-ttu-id="c29a7-290">**図 14**: いいえの製品が表示されるときに最初にアクセス ページ ([フルサイズのイメージを表示するをクリックして](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image40.png))</span><span class="sxs-lookup"><span data-stu-id="c29a7-290">**Figure 14**: No Products are Displayed When First Visiting the Page ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image40.png))</span></span>


<span data-ttu-id="c29a7-291">[![生成カテゴリの一覧を右に一致する製品をクリックして](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image42.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image41.png)</span><span class="sxs-lookup"><span data-stu-id="c29a7-291">[![Clicking the Produce Category Lists the Matching Products to the Right](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image42.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image41.png)</span></span>

<span data-ttu-id="c29a7-292">**図 15**: 右側に一致する製品を一覧表示生成カテゴリをクリックすると ([フルサイズのイメージを表示するをクリックして](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image43.png))</span><span class="sxs-lookup"><span data-stu-id="c29a7-292">**Figure 15**: Clicking the Produce Category Lists the Matching Products to the Right ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image43.png))</span></span>


## <a name="summary"></a><span data-ttu-id="c29a7-293">概要</span><span class="sxs-lookup"><span data-stu-id="c29a7-293">Summary</span></span>

<span data-ttu-id="c29a7-294">このチュートリアルを上記で説明したとおりは、1 つに統合もまたはマスター/詳細レポートは 2 つのページに分散させることができます。</span><span class="sxs-lookup"><span data-stu-id="c29a7-294">As we saw in this tutorial and the preceding one, master/detail reports can be spread out across two pages, or consolidated on one.</span></span> <span data-ttu-id="c29a7-295">マスター/詳細レポートを表示する、1 つのページで、ただしが導入されて 方法のいくつかの課題最適なマスターのレイアウトやページの詳細レコード。</span><span class="sxs-lookup"><span data-stu-id="c29a7-295">Displaying a master/details report on a single page, however, introduces some challenges on how best to layout the master and details records on the page.</span></span> <span data-ttu-id="c29a7-296">*マスター/詳細 DetailsView で選択可能なマスター GridView の使用について詳しく説明*が発生しました詳細レコードがマスター レコード上に表示されます。 このチュートリアルでは、マスター レコードする浮動小数点数に CSS 手法を使用おチュートリアル、。詳細の左側です。</span><span class="sxs-lookup"><span data-stu-id="c29a7-296">In the *Master/Detail Using a Selectable Master GridView with a Details DetailsView* tutorial we had the details records appear above the master records; in this tutorial we used CSS techniques to have the master records float to the left of the details.</span></span>

<span data-ttu-id="c29a7-297">マスター/詳細レポートを表示するには、と共にもありました内からクリック LinkButton (またはボタンまたは ImageButton) ときに、サーバー側ロジックを実行する方法と同様に、各カテゴリに関連付けられている製品の数を取得する方法を調査する機会をリピータします。</span><span class="sxs-lookup"><span data-stu-id="c29a7-297">Along with displaying master/details reports, we also had the opportunity to explore how to retrieve the number of products associated with each category as well as how to perform server-side logic when a LinkButton (or Button or ImageButton) is clicked from within a Repeater.</span></span>

<span data-ttu-id="c29a7-298">このチュートリアルでは、DataList リピータとマスター/詳細レポートのマイクロソフトの調査を完了します。</span><span class="sxs-lookup"><span data-stu-id="c29a7-298">This tutorial completes our examination of master/detail reports with the DataList and Repeater.</span></span> <span data-ttu-id="c29a7-299">次の一連のチュートリアルでは、編集、および削除 DataList コントロールする機能を追加する方法を示します。</span><span class="sxs-lookup"><span data-stu-id="c29a7-299">Our next set of tutorials will illustrate how to add editing and deleting capabilities to the DataList control.</span></span>

<span data-ttu-id="c29a7-300">満足プログラミング!</span><span class="sxs-lookup"><span data-stu-id="c29a7-300">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="c29a7-301">関連項目</span><span class="sxs-lookup"><span data-stu-id="c29a7-301">Further Reading</span></span>

<span data-ttu-id="c29a7-302">このチュートリアルで説明したトピックの詳細については、次の情報を参照してください。</span><span class="sxs-lookup"><span data-stu-id="c29a7-302">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- <span data-ttu-id="c29a7-303">[Floatutorial](http://css.maxdesign.com.au/floatutorial/)フローティング CSS と CSS 要素に関するチュートリアル</span><span class="sxs-lookup"><span data-stu-id="c29a7-303">[Floatutorial](http://css.maxdesign.com.au/floatutorial/) a tutorial on floating CSS elements with CSS</span></span>
- <span data-ttu-id="c29a7-304">[CSS 配置](http://www.brainjar.com/css/positioning/)CSS を使用して要素の配置の詳細について</span><span class="sxs-lookup"><span data-stu-id="c29a7-304">[CSS Positioning](http://www.brainjar.com/css/positioning/) more information on positioning elements with CSS</span></span>
- <span data-ttu-id="c29a7-305">[Html には、「コンテンツをレイアウトに使用する](http://www.w3schools.com/html/html_layout.asp)を使用して`<table>`s およびその他の HTML 要素位置を決定</span><span class="sxs-lookup"><span data-stu-id="c29a7-305">[Laying Out Content with HTML](http://www.w3schools.com/html/html_layout.asp) using `<table>` s and other HTML elements for positioning</span></span>

## <a name="about-the-author"></a><span data-ttu-id="c29a7-306">作成者について</span><span class="sxs-lookup"><span data-stu-id="c29a7-306">About the Author</span></span>

<span data-ttu-id="c29a7-307">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)、7 つ受け取りますブックとの創設者の作成者[4GuysFromRolla.com](http://www.4guysfromrolla.com)、1998 年からマイクロソフトの Web テクノロジで取り組んできました。</span><span class="sxs-lookup"><span data-stu-id="c29a7-307">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="c29a7-308">Scott は、コンサルタント、トレーナー、ライターとして機能します。</span><span class="sxs-lookup"><span data-stu-id="c29a7-308">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="c29a7-309">最新の著書[ *Sam 学べる自分で ASP.NET 2.0 が 24 時間以内に*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)です。</span><span class="sxs-lookup"><span data-stu-id="c29a7-309">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="c29a7-310">彼に到達できる[ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)彼のブログを使用して含まれているのか[http://ScottOnWriting.NET](http://ScottOnWriting.NET)です。</span><span class="sxs-lookup"><span data-stu-id="c29a7-310">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="c29a7-311">感謝の特別な</span><span class="sxs-lookup"><span data-stu-id="c29a7-311">Special Thanks To</span></span>

<span data-ttu-id="c29a7-312">このチュートリアルの系列は既に多くの便利なレビュー担当者によって確認済みです。</span><span class="sxs-lookup"><span data-stu-id="c29a7-312">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="c29a7-313">このチュートリアルのレビュー担当者の潜在顧客が Zack Jones しました。</span><span class="sxs-lookup"><span data-stu-id="c29a7-313">Lead reviewer for this tutorial was Zack Jones.</span></span> <span data-ttu-id="c29a7-314">今後、MSDN の記事を確認することに関心のあるですか。</span><span class="sxs-lookup"><span data-stu-id="c29a7-314">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="c29a7-315">場合は、ドロップ me 一度に 1 行ずつ[mitchell@4GuysFromRolla.comです。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="c29a7-315">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="c29a7-316">[前へ](master-detail-filtering-acess-two-pages-datalist-cs.md)
[次へ](master-detail-filtering-with-a-dropdownlist-datalist-vb.md)</span><span class="sxs-lookup"><span data-stu-id="c29a7-316">[Previous](master-detail-filtering-acess-two-pages-datalist-cs.md)
[Next](master-detail-filtering-with-a-dropdownlist-datalist-vb.md)</span></span>
