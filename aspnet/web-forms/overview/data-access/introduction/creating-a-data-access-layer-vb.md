---
uid: web-forms/overview/data-access/introduction/creating-a-data-access-layer-vb
title: データ アクセス層 (VB) の作成 |Microsoft ドキュメント
author: rick-anderson
description: このチュートリアルでは、最初から開始をデータ アクセス レイヤー (DAL)、型指定されたデータセットを使用して、データベース内の情報にアクセスを作成します。
ms.author: aspnetcontent
manager: wpickett
ms.date: 04/05/2010
ms.topic: article
ms.assetid: 6227233a-6254-4b6b-9a89-947efef22330
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/introduction/creating-a-data-access-layer-vb
msc.type: authoredcontent
ms.openlocfilehash: 5cf1a430d6fe94174a877beb04b930409bdbf084
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/06/2018
---
<a name="creating-a-data-access-layer-vb"></a><span data-ttu-id="2f07f-103">データ アクセス層 (VB) の作成</span><span class="sxs-lookup"><span data-stu-id="2f07f-103">Creating a Data Access Layer (VB)</span></span>
====================
<span data-ttu-id="2f07f-104">によって[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="2f07f-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="2f07f-105">[サンプル アプリをダウンロード](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_1_VB.exe)または[PDF のダウンロード](creating-a-data-access-layer-vb/_static/datatutorial01vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="2f07f-105">[Download Sample App](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_1_VB.exe) or [Download PDF](creating-a-data-access-layer-vb/_static/datatutorial01vb1.pdf)</span></span>

> <span data-ttu-id="2f07f-106">このチュートリアルでは、最初から開始をデータ アクセス レイヤー (DAL)、型指定されたデータセットを使用して、データベース内の情報にアクセスを作成します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-106">In this tutorial we'll start from the very beginning and create the Data Access Layer (DAL), using typed DataSets, to access the information in a database.</span></span>


## <a name="introduction"></a><span data-ttu-id="2f07f-107">はじめに</span><span class="sxs-lookup"><span data-stu-id="2f07f-107">Introduction</span></span>

<span data-ttu-id="2f07f-108">Web 開発者は、生活中心となるデータを操作します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-108">As web developers, our lives revolve around working with data.</span></span> <span data-ttu-id="2f07f-109">データの取得し、し、web ページを収集して集計を変更するためのコードを格納するデータベースを作成します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-109">We create databases to store the data, code to retrieve and modify it, and web pages to collect and summarize it.</span></span> <span data-ttu-id="2f07f-110">これは、時間のかかるを ASP.NET 2.0 ではこれらの一般的なパターンを実装するテクニックを紹介する一連の最初のチュートリアルです。</span><span class="sxs-lookup"><span data-stu-id="2f07f-110">This is the first tutorial in a lengthy series that will explore techniques for implementing these common patterns in ASP.NET 2.0.</span></span> <span data-ttu-id="2f07f-111">まず始めに作成する、[ソフトウェア アーキテクチャ](http://en.wikipedia.org/wiki/Software_architecture)のデータ アクセス層 (DAL) に型指定されたデータセット、ビジネス ロジック層 (BLL) を使用してを構成するカスタム ビジネス ルール実行し、プレゼンテーション層が ASP.NET の構成ページ共通のページ レイアウトを共有します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-111">We'll start with creating a [software architecture](http://en.wikipedia.org/wiki/Software_architecture) composed of a Data Access Layer (DAL) using Typed DataSets, a Business Logic Layer (BLL) that enforces custom business rules, and a presentation layer composed of ASP.NET pages that share a common page layout.</span></span> <span data-ttu-id="2f07f-112">一度このバックエンド築く構築、レポートに移動しますを表示する方法を示す集計、収集、および web アプリケーションからデータを検証します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-112">Once this backend groundwork has been laid, we'll move into reporting, showing how to display, summarize, collect, and validate data from a web application.</span></span> <span data-ttu-id="2f07f-113">これらのチュートリアルは、簡潔なは、スクリーン ショットが多いプロセスを視覚的に順番の詳細な手順についての提供に特化しています。</span><span class="sxs-lookup"><span data-stu-id="2f07f-113">These tutorials are geared to be concise and provide step-by-step instructions with plenty of screen shots to walk you through the process visually.</span></span> <span data-ttu-id="2f07f-114">各チュートリアルは、c# および Visual Basic バージョンで利用可能な使用される完全なコードのダウンロードが含まれています。</span><span class="sxs-lookup"><span data-stu-id="2f07f-114">Each tutorial is available in C# and Visual Basic versions and includes a download of the complete code used.</span></span> <span data-ttu-id="2f07f-115">(最初のチュートリアルは非常に長くなるですが、残りの部分がはるかにという事実チャンク単位で表示されます)。</span><span class="sxs-lookup"><span data-stu-id="2f07f-115">(This first tutorial is quite lengthy, but the rest are presented in much more digestible chunks.)</span></span>

<span data-ttu-id="2f07f-116">Microsoft SQL Server 2005 Express Edition バージョンに Northwind データベースのこれらのチュートリアルを使用する、`App_Data`ディレクトリ。</span><span class="sxs-lookup"><span data-stu-id="2f07f-116">For these tutorials we'll be using a Microsoft SQL Server 2005 Express Edition version of the Northwind database placed in the `App_Data` directory.</span></span> <span data-ttu-id="2f07f-117">データベース ファイルに加え、`App_Data`別のデータベース バージョンを使用する場合にフォルダーが、データベースを作成するための SQL スクリプトにも含まれます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-117">In addition to the database file, the `App_Data` folder also contains the SQL scripts for creating the database, in case you want to use a different database version.</span></span> <span data-ttu-id="2f07f-118">これらのスクリプトですることもできます[マイクロソフトから直接ダウンロード](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en)、希望する場合。</span><span class="sxs-lookup"><span data-stu-id="2f07f-118">These scripts can be also be [downloaded directly from Microsoft](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en), if you'd prefer.</span></span> <span data-ttu-id="2f07f-119">Northwind データベースの別の SQL Server バージョンを使用する場合は、更新する必要があります、`NORTHWNDConnectionString`アプリケーションの設定`Web.config`ファイル。</span><span class="sxs-lookup"><span data-stu-id="2f07f-119">If you use a different SQL Server version of the Northwind database, you will need to update the `NORTHWNDConnectionString` setting in the application's `Web.config` file.</span></span> <span data-ttu-id="2f07f-120">Web アプリケーションが Visual Studio 2005 Professional Edition を使用して、ファイル システムに基づいた Web サイト プロジェクトとしてビルドします。</span><span class="sxs-lookup"><span data-stu-id="2f07f-120">The web application was built using Visual Studio 2005 Professional Edition as a file system-based Web site project.</span></span> <span data-ttu-id="2f07f-121">ただし、チュートリアルのすべての作業は、Visual Studio 2005 の無料版と同様[Visual Web Developer](https://msdn.microsoft.com/vstudio/express/vwd/)です。</span><span class="sxs-lookup"><span data-stu-id="2f07f-121">However, all of the tutorials will work equally well with the free version of Visual Studio 2005, [Visual Web Developer](https://msdn.microsoft.com/vstudio/express/vwd/).</span></span>

<span data-ttu-id="2f07f-122">このチュートリアルではおを最初から開始し、データ アクセス レイヤー (DAL)、作成後に作成、[ビジネス ロジック層 (BLL)](creating-a-business-logic-layer-vb.md)は 2 番目のチュートリアルでは、取り組んで[ページ レイアウトとナビゲーション](master-pages-and-site-navigation-vb.md) 、3 番目にします。</span><span class="sxs-lookup"><span data-stu-id="2f07f-122">In this tutorial we'll start from the very beginning and create the Data Access Layer (DAL), followed by creating the [Business Logic Layer (BLL)](creating-a-business-logic-layer-vb.md) in the second tutorial, and working on [page layout and navigation](master-pages-and-site-navigation-vb.md) in the third.</span></span> <span data-ttu-id="2f07f-123">チュートリアルでは、3 番目の 1 つが基盤に構築した後は、最初の 3 つに配置されます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-123">The tutorials after the third one will build upon the foundation laid in the first three.</span></span> <span data-ttu-id="2f07f-124">この最初のチュートリアルで説明、そのため、Visual Studio を起動および始めましょう多くしました!</span><span class="sxs-lookup"><span data-stu-id="2f07f-124">We've got a lot to cover in this first tutorial, so fire up Visual Studio and let's get started!</span></span>

## <a name="step-1-creating-a-web-project-and-connecting-to-the-database"></a><span data-ttu-id="2f07f-125">手順 1: Web プロジェクトを作成して、データベースに接続します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-125">Step 1: Creating a Web Project and Connecting to the Database</span></span>

<span data-ttu-id="2f07f-126">データ アクセス層 (DAL) を作成するには、web サイトを作成し、データベースのセットアップには必要があります。</span><span class="sxs-lookup"><span data-stu-id="2f07f-126">Before we can create our Data Access Layer (DAL), we first need to create a web site and setup our database.</span></span> <span data-ttu-id="2f07f-127">まず、新しいファイル システムに基づいた ASP.NET web サイトを作成します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-127">Start by creating a new file system-based ASP.NET web site.</span></span> <span data-ttu-id="2f07f-128">これを実現するには、ファイル メニューに移動し、新しい Web サイトを新しい Web サイト ダイアログ ボックスの表示を選択します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-128">To accomplish this, go to the File menu and choose New Web Site, displaying the New Web Site dialog box.</span></span> <span data-ttu-id="2f07f-129">ASP.NET Web サイト テンプレートを選択して、場所ドロップダウン リストをファイル システムに設定、web サイトを配置するフォルダーを選択および Visual Basic 言語に設定します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-129">Choose the ASP.NET Web Site template, set the Location drop-down list to File System, choose a folder to place the web site, and set the language to Visual Basic.</span></span>


<span data-ttu-id="2f07f-130">[![新しいファイル システムに基づいた Web サイトを作成します。](creating-a-data-access-layer-vb/_static/image2.png)](creating-a-data-access-layer-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="2f07f-130">[![Create a New File System-Based Web Site](creating-a-data-access-layer-vb/_static/image2.png)](creating-a-data-access-layer-vb/_static/image1.png)</span></span>

<span data-ttu-id="2f07f-131">**図 1**: New File System-Based Web サイトの作成 ([フルサイズのイメージを表示するをクリックして](creating-a-data-access-layer-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="2f07f-131">**Figure 1**: Create a New File System-Based Web Site ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image3.png))</span></span>


<span data-ttu-id="2f07f-132">これで新しい web サイトが作成されます、 `Default.aspx` ASP.NET ページ、`App_Data`フォルダー、および`Web.config`ファイル。</span><span class="sxs-lookup"><span data-stu-id="2f07f-132">This will create a new web site with a `Default.aspx` ASP.NET page, an `App_Data` folder, and a `Web.config` file.</span></span>

<span data-ttu-id="2f07f-133">Web サイトを作成では、次の手順は、Visual Studio のサーバー エクスプ ローラーで、データベースへの参照を追加するは。</span><span class="sxs-lookup"><span data-stu-id="2f07f-133">With the web site created, the next step is to add a reference to the database in Visual Studio's Server Explorer.</span></span> <span data-ttu-id="2f07f-134">サーバー エクスプ ローラーにデータベースを追加するには、テーブル、ストアド プロシージャ、ビュー、および Visual Studio 内からのすべてを追加できます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-134">By adding a database to the Server Explorer you can add tables, stored procedures, views, and so on all from within Visual Studio.</span></span> <span data-ttu-id="2f07f-135">テーブル データを表示したり、クエリ ビルダーを使用して手動でまたは視覚的に独自のクエリを作成できます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-135">You can also view table data or create your own queries either by hand or graphically via the Query Builder.</span></span> <span data-ttu-id="2f07f-136">さらに、DAL の型指定されたデータセットを構築するときに型指定されたデータセットを構築するためのデータベースへのポイント Visual Studio には必要があります。</span><span class="sxs-lookup"><span data-stu-id="2f07f-136">Furthermore, when we build the Typed DataSets for the DAL we'll need to point Visual Studio to the database from which the Typed DataSets should be constructed.</span></span> <span data-ttu-id="2f07f-137">その時点では、この接続情報を提供することができます、Visual Studio でサーバー エクスプ ローラーで既に登録されているデータベースのボックスの一覧が自動的に設定されます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-137">While we can provide this connection information at that point in time, Visual Studio automatically populates a drop-down list of the databases already registered in the Server Explorer.</span></span>

<span data-ttu-id="2f07f-138">サーバー エクスプ ローラーに、Northwind データベースを追加するための手順で SQL Server 2005 Express Edition のデータベースを使用するかどうかに依存、`App_Data`フォルダーまたは Microsoft SQL Server 2000 または 2005年データベース サーバーのセットアップを使用することがあるかどうかその代わりに。</span><span class="sxs-lookup"><span data-stu-id="2f07f-138">The steps for adding the Northwind database to the Server Explorer depend on whether you want to use the SQL Server 2005 Express Edition database in the `App_Data` folder or if you have a Microsoft SQL Server 2000 or 2005 database server setup that you want to use instead.</span></span>

## <a name="using-a-database-in-theappdatafolder"></a><span data-ttu-id="2f07f-139">データベースを使用して、`App_Data`フォルダー</span><span class="sxs-lookup"><span data-stu-id="2f07f-139">Using a Database in the`App_Data`Folder</span></span>

<span data-ttu-id="2f07f-140">ダウンロードした websit に配置されている Northwind データベースの SQL Server 2005 Express Edition のバージョンを使用することができる場合に接続するには、SQL Server 2000 または 2005年データベース サーバーがないか、データベース サーバーにデータベースを追加する必要があるようにするだけで、杯`App_Data`フォルダー (`NORTHWND.MDF`)。</span><span class="sxs-lookup"><span data-stu-id="2f07f-140">If you do not have a SQL Server 2000 or 2005 database server to connect to, or you simply want to avoid having to add the database to a database server, you can use the SQL Server 2005 Express Edition version of the Northwind database that is located in the downloaded website's `App_Data` folder (`NORTHWND.MDF`).</span></span>

<span data-ttu-id="2f07f-141">データベースの配置で、`App_Data`フォルダーは、サーバー エクスプ ローラーに自動的に追加します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-141">A database placed in the `App_Data` folder is automatically added to the Server Explorer.</span></span> <span data-ttu-id="2f07f-142">SQL Server 2005 Express Edition がコンピューターにインストールがあると仮定して NORTHWND をという名前のノードが表示されます。サーバー エクスプ ローラーで MDF これを拡張し、そのテーブル、ビュー、ストアド プロシージャ、およびよびな (図 2 を参照してください) を調査することができます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-142">Assuming you have SQL Server 2005 Express Edition installed on your machine you should see a node named NORTHWND.MDF in the Server Explorer, which you can expand and explore its tables, views, stored procedure, and so on (see Figure 2).</span></span>

<span data-ttu-id="2f07f-143">`App_Data`フォルダーは、Microsoft Access にも格納できる`.mdb`SQL Server の対応するように自動的に追加サーバー エクスプ ローラーになるファイル。</span><span class="sxs-lookup"><span data-stu-id="2f07f-143">The `App_Data` folder can also hold Microsoft Access `.mdb` files, which, like their SQL Server counterparts, are automatically added to the Server Explorer.</span></span> <span data-ttu-id="2f07f-144">常にすることが SQL Server のオプションのいずれかを使用しない場合は、 [Microsoft Access バージョンの Northwind データベース ファイルをダウンロード](https://www.microsoft.com/downloads/details.aspx?FamilyID=C6661372-8DBE-422B-8676-C632D66C529C&amp;displaylang=EN)にドロップし、`App_Data`ディレクトリ。</span><span class="sxs-lookup"><span data-stu-id="2f07f-144">If you don't want to use any of the SQL Server options, you can always [download a Microsoft Access version of the Northwind database file](https://www.microsoft.com/downloads/details.aspx?FamilyID=C6661372-8DBE-422B-8676-C632D66C529C&amp;displaylang=EN) and drop into the `App_Data` directory.</span></span> <span data-ttu-id="2f07f-145">注意して、ただし、Access データベースがないと機能が豊富で SQL Server と web サイトのシナリオで処理するために設計されていないとします。</span><span class="sxs-lookup"><span data-stu-id="2f07f-145">Keep in mind, however, that Access databases aren't as feature-rich as SQL Server, and aren't designed to be used in web site scenarios.</span></span> <span data-ttu-id="2f07f-146">さらに、いくつかの 35 + チュートリアルでは、Access によってサポートされていない特定のデータベース レベルの機能が使用されます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-146">Furthermore, a couple of the 35+ tutorials will utilize certain database-level features that aren't supported by Access.</span></span>

## <a name="connecting-to-the-database-in-a-microsoft-sql-server-2000-or-2005-database-server"></a><span data-ttu-id="2f07f-147">Microsoft SQL Server 2000 または 2005 のデータベース サーバーでデータベースに接続します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-147">Connecting to the Database in a Microsoft SQL Server 2000 or 2005 Database Server</span></span>

<span data-ttu-id="2f07f-148">また、データベース サーバーにインストールされている Northwind データベースに接続することがあります。</span><span class="sxs-lookup"><span data-stu-id="2f07f-148">Alternatively, you may connect to a Northwind database installed on a database server.</span></span> <span data-ttu-id="2f07f-149">データベース サーバーにまだインストールされている Northwind データベースがない場合最初にする必要がありますに追加するデータベース サーバーに含まれているこのチュートリアルのダウンロード、インストール スクリプトを実行して[Northwind の SQL Server 2000 バージョンのダウンロードインストール スクリプト](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en)Microsoft の web サイトから直接です。</span><span class="sxs-lookup"><span data-stu-id="2f07f-149">If the database server does not already have the Northwind database installed, you first must add it to database server by running the installation script included in this tutorial's download or by [downloading the SQL Server 2000 version of Northwind and installation script](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en) directly from Microsoft's web site.</span></span>

<span data-ttu-id="2f07f-150">インストールされているデータベースを作成したら、Visual Studio の [サーバー エクスプ ローラーには、データ接続] ノードを右クリックし、接続の追加を移動します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-150">Once you have the database installed, go to the Server Explorer in Visual Studio, right-click on the Data Connections node, and choose Add Connection.</span></span> <span data-ttu-id="2f07f-151">表示されないかどうかは、ビューに移動して、サーバー エクスプ ローラー/サーバー エクスプ ローラー、またはヒット Ctrl + Alt + S。</span><span class="sxs-lookup"><span data-stu-id="2f07f-151">If you don't see the Server Explorer go to the View / Server Explorer, or hit Ctrl+Alt+S.</span></span> <span data-ttu-id="2f07f-152">これには、認証情報とデータベース名への接続にサーバーを指定できる接続の追加 ダイアログ ボックスが表示されます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-152">This will bring up the Add Connection dialog box, where you can specify the server to connect to, the authentication information, and the database name.</span></span> <span data-ttu-id="2f07f-153">データベースの接続情報を構成し、ok ボタンをクリックしてしました、一度データベースが、データ接続 ノードの下にノードとして追加されます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-153">Once you have successfully configured the database connection information and clicked the OK button, the database will be added as a node underneath the Data Connections node.</span></span> <span data-ttu-id="2f07f-154">そのテーブル、ビュー、ストアド プロシージャ、およびなどを調べるデータベース ノードを展開することができます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-154">You can expand the database node to explore its tables, views, stored procedures, and so on.</span></span>


![データベース サーバーの Northwind データベースへの接続を追加します。](creating-a-data-access-layer-vb/_static/image4.png)

<span data-ttu-id="2f07f-156">**図 2**: に、データベース サーバーの Northwind データベースへの接続の追加</span><span class="sxs-lookup"><span data-stu-id="2f07f-156">**Figure 2**: Add a Connection to Your Database Server's Northwind Database</span></span>


## <a name="step-2-creating-the-data-access-layer"></a><span data-ttu-id="2f07f-157">手順 2: データ アクセス層の作成</span><span class="sxs-lookup"><span data-stu-id="2f07f-157">Step 2: Creating the Data Access Layer</span></span>

<span data-ttu-id="2f07f-158">使用するときにデータの 1 つのオプション データに固有のロジックに直接埋め込むプレゼンテーション層で web アプリケーションでは、プレゼンテーション層を ASP.NET ページの構成) を開始します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-158">When working with data one option is to embed the data-specific logic directly into the presentation layer (in a web application, the ASP.NET pages make up the presentation layer).</span></span> <span data-ttu-id="2f07f-159">ASP.NET ページのコード部分で ADO.NET コードを記述またはマークアップの部分から SqlDataSource コントロールを使用する形式の時間がかかります。</span><span class="sxs-lookup"><span data-stu-id="2f07f-159">This may take the form of writing ADO.NET code in the ASP.NET page's code portion or using the SqlDataSource control from the markup portion.</span></span> <span data-ttu-id="2f07f-160">どちらの場合、このアプローチと密データ アクセス ロジック プレゼンテーション層です。</span><span class="sxs-lookup"><span data-stu-id="2f07f-160">In either case, this approach tightly couples the data access logic with the presentation layer.</span></span> <span data-ttu-id="2f07f-161">プレゼンテーション層から、データ アクセス ロジックを分離するただしは、方法をお勧めします。</span><span class="sxs-lookup"><span data-stu-id="2f07f-161">The recommended approach, however, is to separate the data access logic from the presentation layer.</span></span> <span data-ttu-id="2f07f-162">この別のレイヤーし、呼ばれ、データ アクセス層、略して、DAL は通常、別のクラス ライブラリ プロジェクトとして実装します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-162">This separate layer is referred to as the Data Access Layer, DAL for short, and is typically implemented as a separate Class Library project.</span></span> <span data-ttu-id="2f07f-163">このレイヤーのアーキテクチャの利点はも記載されています (これらの利点については、このチュートリアルの最後に、「これ以上の測定値」セクションを参照してください) がこのシリーズの取得方法とします。</span><span class="sxs-lookup"><span data-stu-id="2f07f-163">The benefits of this layered architecture are well documented (see the "Further Readings" section at the end of this tutorial for information on these advantages) and is the approach we will take in this series.</span></span>

<span data-ttu-id="2f07f-164">データベースへの接続の作成など、基になるデータ ソースに固有のすべてのコードを発行する`SELECT`、 `INSERT`、 `UPDATE`、および`DELETE`コマンド、およびなどを DAL に配置する必要があります。</span><span class="sxs-lookup"><span data-stu-id="2f07f-164">All code that is specific to the underlying data source such as creating a connection to the database, issuing `SELECT`, `INSERT`, `UPDATE`, and `DELETE` commands, and so on should be located in the DAL.</span></span> <span data-ttu-id="2f07f-165">プレゼンテーション層は、このようなデータ アクセス コードへの参照を含めることはできませんが、すべてのデータ要求、DAL に呼び出しを行う代わりにする必要があります。</span><span class="sxs-lookup"><span data-stu-id="2f07f-165">The presentation layer should not contain any references to such data access code, but should instead make calls into the DAL for any and all data requests.</span></span> <span data-ttu-id="2f07f-166">通常、データ アクセス レイヤーには、基になるデータベースのデータにアクセスするためのメソッドが含まれます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-166">Data Access Layers typically contain methods for accessing the underlying database data.</span></span> <span data-ttu-id="2f07f-167">たとえば、Northwind データベースには`Products`と`Categories`販売およびが所属するカテゴリの製品を記録するテーブル。</span><span class="sxs-lookup"><span data-stu-id="2f07f-167">The Northwind database, for example, has `Products` and `Categories` tables that record the products for sale and the categories to which they belong.</span></span> <span data-ttu-id="2f07f-168">DAL などのメソッドをが。</span><span class="sxs-lookup"><span data-stu-id="2f07f-168">In our DAL we will have methods like:</span></span>

- <span data-ttu-id="2f07f-169">`GetCategories(),` これには、すべてのカテゴリに関する情報を返します</span><span class="sxs-lookup"><span data-stu-id="2f07f-169">`GetCategories(),` which will return information about all of the categories</span></span>
- <span data-ttu-id="2f07f-170">`GetProducts()`、これには、すべての製品に関する情報を返します</span><span class="sxs-lookup"><span data-stu-id="2f07f-170">`GetProducts()`, which will return information about all of the products</span></span>
- <span data-ttu-id="2f07f-171">`GetProductsByCategoryID(categoryID)`、するには、指定したカテゴリに属しているすべての製品を返します</span><span class="sxs-lookup"><span data-stu-id="2f07f-171">`GetProductsByCategoryID(categoryID)`, which will return all products that belong to a specified category</span></span>
- <span data-ttu-id="2f07f-172">`GetProductByProductID(productID)`、これは、特定の製品に関する情報を返します</span><span class="sxs-lookup"><span data-stu-id="2f07f-172">`GetProductByProductID(productID)`, which will return information about a particular product</span></span>

<span data-ttu-id="2f07f-173">呼び出されると、これらのメソッドはデータベースへの接続、適切なクエリを発行し、結果を返します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-173">These methods, when invoked, will connect to the database, issue the appropriate query, and return the results.</span></span> <span data-ttu-id="2f07f-174">これらの結果を返すどのようにすることが重要です。</span><span class="sxs-lookup"><span data-stu-id="2f07f-174">How we return these results is important.</span></span> <span data-ttu-id="2f07f-175">データセットまたは DataReader データベース クエリによって設定されますが、これらのメソッドに返されるだけでしたが、理想的にはこれらの結果を返すを使用して*オブジェクトの厳密に型指定された*です。</span><span class="sxs-lookup"><span data-stu-id="2f07f-175">These methods could simply return a DataSet or DataReader populated by the database query, but ideally these results should be returned using *strongly-typed objects*.</span></span> <span data-ttu-id="2f07f-176">厳密に型指定されたオブジェクトは、コンパイル時にスキーマを持つが定義されている厳密反対に、厳密に型のオブジェクトは 1 つのスキーマが実行時まで不明です。</span><span class="sxs-lookup"><span data-stu-id="2f07f-176">A strongly-typed object is one whose schema is rigidly defined at compile time, whereas the opposite, a loosely-typed object, is one whose schema is not known until runtime.</span></span>

<span data-ttu-id="2f07f-177">たとえば、DataReader し (既定) のデータセットは弱い型指定オブジェクトによってそれらの設定に使用されるデータベース クエリによって返される列のスキーマが定義されているためです。</span><span class="sxs-lookup"><span data-stu-id="2f07f-177">For example, the DataReader and the DataSet (by default) are loosely-typed objects since their schema is defined by the columns returned by the database query used to populate them.</span></span> <span data-ttu-id="2f07f-178">ような構文を使用する必要があります、弱い型指定の DataTable から特定の列にアクセスする:`DataTable.Rows(index)("columnName")`です。</span><span class="sxs-lookup"><span data-stu-id="2f07f-178">To access a particular column from a loosely-typed DataTable we need to use syntax like: `DataTable.Rows(index)("columnName")`.</span></span> <span data-ttu-id="2f07f-179">DataTable のこの例で柔軟な型指定は文字列または序数インデックスを使用して、列名にアクセスする必要がありますという事実によって行われます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-179">The DataTable's loose typing in this example is exhibited by the fact that we need to access the column name using a string or ordinal index.</span></span> <span data-ttu-id="2f07f-180">厳密に型指定された DataTable では、その一方が、プロパティとして実装されたその列のそれぞれ次のようなコードで結果として得られる:`DataTable.Rows(index).columnName`です。</span><span class="sxs-lookup"><span data-stu-id="2f07f-180">A strongly-typed DataTable, on the other hand, will have each of its columns implemented as properties, resulting in code that looks like: `DataTable.Rows(index).columnName`.</span></span>

<span data-ttu-id="2f07f-181">厳密に型指定されたオブジェクトを返すには、開発者は、独自のカスタム ビジネス オブジェクトを作成するか、型指定されたデータセットを使用することができます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-181">To return strongly-typed objects, developers can either create their own custom business objects or use Typed DataSets.</span></span> <span data-ttu-id="2f07f-182">ビジネス オブジェクトは、プロパティを持つは通常、基になるデータベース テーブル、ビジネス オブジェクトの列を反映してクラスを表します。 開発者によって実装されます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-182">A business object is implemented by the developer as a class whose properties typically reflect the columns of the underlying database table the business object represents.</span></span> <span data-ttu-id="2f07f-183">型指定されたデータセットは、データベース スキーマとそのメンバーが厳密に型指定されたこのスキーマによるに基づいて Visual Studio によって生成したクラスです。</span><span class="sxs-lookup"><span data-stu-id="2f07f-183">A Typed DataSet is a class generated for you by Visual Studio based on a database schema and whose members are strongly-typed according to this schema.</span></span> <span data-ttu-id="2f07f-184">型指定されたデータセット自体は、ADO.NET DataSet、DataTable、および DataRow クラスを拡張するクラスで構成されます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-184">The Typed DataSet itself consists of classes that extend the ADO.NET DataSet, DataTable, and DataRow classes.</span></span> <span data-ttu-id="2f07f-185">データ テーブルの厳密に型指定されただけでなく型指定されたデータセット今すぐ含めることも、Tableadapter はデータセットのデータ テーブルを設定し、データベースにデータ テーブル内の変更を反映するためのメソッドを持つクラス。</span><span class="sxs-lookup"><span data-stu-id="2f07f-185">In addition to strongly-typed DataTables, Typed DataSets now also include TableAdapters, which are classes with methods for populating the DataSet's DataTables and propagating modifications within the DataTables back to the database.</span></span>

> [!NOTE]
> <span data-ttu-id="2f07f-186">長所と短所を型指定されたデータセットを使用するカスタム ビジネス オブジェクトとの比較の詳細についてを参照してください[データ層のコンポーネントを設計し、層間のデータを渡す](https://msdn.microsoft.com/library/ms978496.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="2f07f-186">For more information on the advantages and disadvantages of using Typed DataSets versus custom business objects, refer to [Designing Data Tier Components and Passing Data Through Tiers](https://msdn.microsoft.com/library/ms978496.aspx).</span></span>


<span data-ttu-id="2f07f-187">これらのチュートリアルのアーキテクチャ用に厳密に型指定されたデータセットを使用します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-187">We'll use strongly-typed DataSets for these tutorials' architecture.</span></span> <span data-ttu-id="2f07f-188">図 3 は、型指定されたデータセットを使用するアプリケーションのさまざまな層間のワークフローを示しています。</span><span class="sxs-lookup"><span data-stu-id="2f07f-188">Figure 3 illustrates the workflow between the different layers of an application that uses Typed DataSets.</span></span>


<span data-ttu-id="2f07f-189">[![すべてのデータ アクセス コードは、DAL に移行します。](creating-a-data-access-layer-vb/_static/image6.png)](creating-a-data-access-layer-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="2f07f-189">[![All Data Access Code is Relegated to the DAL](creating-a-data-access-layer-vb/_static/image6.png)](creating-a-data-access-layer-vb/_static/image5.png)</span></span>

<span data-ttu-id="2f07f-190">**図 3**: すべてのデータ アクセス コードは、DAL に移行 ([フルサイズのイメージを表示するをクリックして](creating-a-data-access-layer-vb/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="2f07f-190">**Figure 3**: All Data Access Code is Relegated to the DAL ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image7.png))</span></span>


## <a name="creating-a-typed-dataset-and-table-adapter"></a><span data-ttu-id="2f07f-191">型指定されたデータセットとテーブル アダプターを作成します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-191">Creating a Typed DataSet and Table Adapter</span></span>

<span data-ttu-id="2f07f-192">DAL を作成するには、型指定されたデータセットをプロジェクトに追加することで開始します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-192">To begin creating our DAL, we start by adding a Typed DataSet to our project.</span></span> <span data-ttu-id="2f07f-193">これを実現するには、ソリューション エクスプ ローラーでプロジェクト ノードを右クリックし、新しい項目の追加を選択します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-193">To accomplish this, right-click on the project node in the Solution Explorer and choose Add a New Item.</span></span> <span data-ttu-id="2f07f-194">テンプレートの一覧からデータセット オプションを選択し、名前を付けます`Northwind.xsd`です。</span><span class="sxs-lookup"><span data-stu-id="2f07f-194">Select the DataSet option from the list of templates and name it `Northwind.xsd`.</span></span>


<span data-ttu-id="2f07f-195">[![プロジェクトに新しいデータセットを追加します。](creating-a-data-access-layer-vb/_static/image9.png)](creating-a-data-access-layer-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="2f07f-195">[![Choose to Add a New DataSet to Your Project](creating-a-data-access-layer-vb/_static/image9.png)](creating-a-data-access-layer-vb/_static/image8.png)</span></span>

<span data-ttu-id="2f07f-196">**図 4**: プロジェクトに新しいデータセットを追加する ([フルサイズのイメージを表示するをクリックして](creating-a-data-access-layer-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="2f07f-196">**Figure 4**: Choose to Add a New DataSet to Your Project ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image10.png))</span></span>


<span data-ttu-id="2f07f-197">データセットを追加するように求められたら、追加のクリックして後、`App_Code`フォルダーで、はい を選択します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-197">After clicking Add, when prompted to add the DataSet to the `App_Code` folder, choose Yes.</span></span> <span data-ttu-id="2f07f-198">型指定されたデータセットをデザイナーが表示されます、および、TableAdapter 構成ウィザードが開始、型指定されたデータセットに、最初の TableAdapter を追加することができます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-198">The Designer for the Typed DataSet will then be displayed, and the TableAdapter Configuration Wizard will start, allowing you to add your first TableAdapter to the Typed DataSet.</span></span>

<span data-ttu-id="2f07f-199">データの厳密に型指定されたコレクションとして型指定されたデータセットの機能します。厳密に型指定された DataTable インスタンス、それぞれがさらにから成る厳密に型指定された DataRow インスタンスで構成されます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-199">A Typed DataSet serves as a strongly-typed collection of data; it is composed of strongly-typed DataTable instances, each of which is in turn composed of strongly-typed DataRow instances.</span></span> <span data-ttu-id="2f07f-200">このチュートリアルの一連の操作に必要な基になるデータベース テーブルの列ごと厳密に型指定された DataTable を作成します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-200">We will create a strongly-typed DataTable for each of the underlying database tables that we need to work with in this tutorials series.</span></span> <span data-ttu-id="2f07f-201">データ テーブルの作成を始めましょう、`Products`テーブル。</span><span class="sxs-lookup"><span data-stu-id="2f07f-201">Let's start with creating a DataTable for the `Products` table.</span></span>

<span data-ttu-id="2f07f-202">厳密に型指定された Datatable には、その基になるデータベース テーブルからデータにアクセスする方法の情報が含まれていないことに注意してください。</span><span class="sxs-lookup"><span data-stu-id="2f07f-202">Keep in mind that strongly-typed DataTables do not include any information on how to access data from their underlying database table.</span></span> <span data-ttu-id="2f07f-203">データ ソースの列にデータを取得するためには、データ アクセス層として機能する TableAdapter クラスを使用します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-203">In order to retrieve the data to populate the DataTable, we use a TableAdapter class, which functions as our Data Access Layer.</span></span> <span data-ttu-id="2f07f-204">`Products` DataTable、TableAdapter にはメソッドが含まれて、 `GetProducts()`、`GetProductByCategoryID(categoryID)`プレゼンテーション層からおを起動します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-204">For our `Products` DataTable, the TableAdapter will contain the methods `GetProducts()`, `GetProductByCategoryID(categoryID)`, and so on that we'll invoke from the presentation layer.</span></span> <span data-ttu-id="2f07f-205">DataTable の役割では、データ、レイヤー間で受け渡すに使用される厳密に型指定されたオブジェクトとして機能です。</span><span class="sxs-lookup"><span data-stu-id="2f07f-205">The DataTable's role is to serve as the strongly-typed objects used to pass data between the layers.</span></span>

<span data-ttu-id="2f07f-206">TableAdapter 構成ウィザードを使用するデータベースを選択するように求められますが開始されます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-206">The TableAdapter Configuration Wizard begins by prompting you to select which database to work with.</span></span> <span data-ttu-id="2f07f-207">ドロップダウン リストでは、サーバー エクスプ ローラーでそれらのデータベースを示します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-207">The drop-down list shows those databases in the Server Explorer.</span></span> <span data-ttu-id="2f07f-208">サーバー エクスプ ローラーに、Northwind データベースを追加しなかった場合は、これを行うには、この時点で新しい接続ボタンをクリックすることができます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-208">If you did not add the Northwind database to the Server Explorer, you can click the New Connection button at this time to do so.</span></span>


<span data-ttu-id="2f07f-209">[![ドロップダウン リストから、Northwind データベースを選択します。](creating-a-data-access-layer-vb/_static/image12.png)](creating-a-data-access-layer-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="2f07f-209">[![Choose the Northwind Database from the Drop-Down List](creating-a-data-access-layer-vb/_static/image12.png)](creating-a-data-access-layer-vb/_static/image11.png)</span></span>

<span data-ttu-id="2f07f-210">**図 5**: ドロップダウン リストから、Northwind データベースを選択 ([フルサイズのイメージを表示するをクリックして](creating-a-data-access-layer-vb/_static/image13.png))</span><span class="sxs-lookup"><span data-stu-id="2f07f-210">**Figure 5**: Choose the Northwind Database from the Drop-Down List ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image13.png))</span></span>


<span data-ttu-id="2f07f-211">データベースを選択し、[次へ] をクリックして、後にするよう求められます内の接続文字列を保存するかどうか、`Web.config`ファイル。</span><span class="sxs-lookup"><span data-stu-id="2f07f-211">After selecting the database and clicking Next, you'll be asked if you want to save the connection string in the `Web.config` file.</span></span> <span data-ttu-id="2f07f-212">接続文字列を保存することによってされます必要があるがハード コード化された TableAdapter のクラスが接続文字列が変更された場合、将来の処理を簡素化されます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-212">By saving the connection string you'll avoid having it hard coded in the TableAdapter classes, which simplifies things if the connection string information changes in the future.</span></span> <span data-ttu-id="2f07f-213">配置されている構成ファイルに接続文字列を保存することを選択する場合、`<connectionStrings>`可能性があるセクション[オプションで暗号化された](http://aspnet.4guysfromrolla.com/articles/021506-1.aspx)セキュリティの向上や、新しい ASP.NET 2.0 プロパティ ページ内で後で変更IIS GUI 管理ツール、管理者にとってより適切なであります。</span><span class="sxs-lookup"><span data-stu-id="2f07f-213">If you opt to save the connection string in the configuration file it's placed in the `<connectionStrings>` section, which can be [optionally encrypted](http://aspnet.4guysfromrolla.com/articles/021506-1.aspx) for improved security or modified later through the new ASP.NET 2.0 Property Page within the IIS GUI Admin Tool, which is more ideal for administrators.</span></span>


<span data-ttu-id="2f07f-214">[![Web.config への接続文字列を保存します。](creating-a-data-access-layer-vb/_static/image15.png)](creating-a-data-access-layer-vb/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="2f07f-214">[![Save the Connection String to Web.config](creating-a-data-access-layer-vb/_static/image15.png)](creating-a-data-access-layer-vb/_static/image14.png)</span></span>

<span data-ttu-id="2f07f-215">**図 6**: への接続文字列を保存`Web.config`([フルサイズのイメージを表示するをクリックして](creating-a-data-access-layer-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="2f07f-215">**Figure 6**: Save the Connection String to `Web.config` ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image16.png))</span></span>


<span data-ttu-id="2f07f-216">次に、最初の厳密に型指定された DataTable のスキーマを定義し、厳密に型指定されたデータセットのデータ設定時に使用する、TableAdapter の最初のメソッドを提供する必要があります。</span><span class="sxs-lookup"><span data-stu-id="2f07f-216">Next, we need to define the schema for the first strongly-typed DataTable and provide the first method for our TableAdapter to use when populating the strongly-typed DataSet.</span></span> <span data-ttu-id="2f07f-217">これら 2 つの手順は、データ テーブルに反映すること、テーブルから列を返すクエリを作成することで同時に実行されます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-217">These two steps are accomplished simultaneously by creating a query that returns the columns from the table that we want reflected in our DataTable.</span></span> <span data-ttu-id="2f07f-218">ウィザードの最後にこのクエリに対するメソッドの名前を付けます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-218">At the end of the wizard we'll give a method name to this query.</span></span> <span data-ttu-id="2f07f-219">化は、後であれば、プレゼンテーション層からこのメソッドを呼び出すことができます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-219">Once that's been accomplished, this method can be invoked from our presentation layer.</span></span> <span data-ttu-id="2f07f-220">メソッドは、定義済みのクエリを実行し、厳密に型指定された DataTable を設定します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-220">The method will execute the defined query and populate a strongly-typed DataTable.</span></span>

<span data-ttu-id="2f07f-221">作業を開始する、TableAdapter にクエリを発行する方法を示す必要があります最初、SQL クエリを定義します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-221">To get started defining the SQL query we must first indicate how we want the TableAdapter to issue the query.</span></span> <span data-ttu-id="2f07f-222">おアドホック SQL ステートメントを使用して、ストアド プロシージャの新規作成したり既存のストアド プロシージャを使用できます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-222">We can use an ad-hoc SQL statement, create a new stored procedure, or use an existing stored procedure.</span></span> <span data-ttu-id="2f07f-223">これらのチュートリアルは、アドホック SQL ステートメントを使用します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-223">For these tutorials we'll use ad-hoc SQL statements.</span></span> <span data-ttu-id="2f07f-224">参照してください[Brian 認識](http://briannoyes.net/)記事 's [Visual Studio 2005 のデータセット デザイナーでのデータ アクセス層のビルド](http://www.theserverside.net/articles/showarticle.tss?id=DataSetDesigner)ストアド プロシージャを使用する例についてはします。</span><span class="sxs-lookup"><span data-stu-id="2f07f-224">Refer to [Brian Noyes](http://briannoyes.net/)'s article, [Build a Data Access Layer with the Visual Studio 2005 DataSet Designer](http://www.theserverside.net/articles/showarticle.tss?id=DataSetDesigner) for an example of using stored procedures.</span></span>


<span data-ttu-id="2f07f-225">[![アドホック SQL ステートメントを使用してデータをクエリします。](creating-a-data-access-layer-vb/_static/image18.png)](creating-a-data-access-layer-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="2f07f-225">[![Query the Data Using an Ad-Hoc SQL Statement](creating-a-data-access-layer-vb/_static/image18.png)](creating-a-data-access-layer-vb/_static/image17.png)</span></span>

<span data-ttu-id="2f07f-226">**図 7**: アドホック SQL ステートメントを使用してデータのクエリ ([フルサイズのイメージを表示するをクリックして](creating-a-data-access-layer-vb/_static/image19.png))</span><span class="sxs-lookup"><span data-stu-id="2f07f-226">**Figure 7**: Query the Data Using an Ad-Hoc SQL Statement ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image19.png))</span></span>


<span data-ttu-id="2f07f-227">この時点でを手動で SQL クエリで入力できます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-227">At this point we can type in the SQL query by hand.</span></span> <span data-ttu-id="2f07f-228">TableAdapter の最初のメソッドを作成するときに通常する対応する DataTable で表現する必要があるこれらの列を返すクエリです。</span><span class="sxs-lookup"><span data-stu-id="2f07f-228">When creating the first method in the TableAdapter you typically want to have the query return those columns that need to be expressed in the corresponding DataTable.</span></span> <span data-ttu-id="2f07f-229">これを行うすべての列とのすべての行を返すクエリを作成して、`Products`テーブル。</span><span class="sxs-lookup"><span data-stu-id="2f07f-229">We can accomplish this by creating a query that returns all columns and all rows from the `Products` table:</span></span>


<span data-ttu-id="2f07f-230">[![テキスト ボックスに、SQL クエリを入力してください。](creating-a-data-access-layer-vb/_static/image21.png)](creating-a-data-access-layer-vb/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="2f07f-230">[![Enter the SQL Query Into the Textbox](creating-a-data-access-layer-vb/_static/image21.png)](creating-a-data-access-layer-vb/_static/image20.png)</span></span>

<span data-ttu-id="2f07f-231">**図 8**: SQL クエリに、テキスト ボックスの入力 ([フルサイズのイメージを表示するをクリックして](creating-a-data-access-layer-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="2f07f-231">**Figure 8**: Enter the SQL Query Into the Textbox ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image22.png))</span></span>


<span data-ttu-id="2f07f-232">または、クエリ ビルダーを使用し、図 9 に示すように、クエリを視覚的に構築します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-232">Alternatively, use the Query Builder and graphically construct the query, as shown in Figure 9.</span></span>


<span data-ttu-id="2f07f-233">[![クエリをグラフィカルに作成、クエリ エディターを使用](creating-a-data-access-layer-vb/_static/image24.png)](creating-a-data-access-layer-vb/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="2f07f-233">[![Create the Query Graphically, through the Query Editor](creating-a-data-access-layer-vb/_static/image24.png)](creating-a-data-access-layer-vb/_static/image23.png)</span></span>

<span data-ttu-id="2f07f-234">**図 9**: クエリをグラフィカルに作成、クエリ エディターを使用 ([フルサイズのイメージを表示するをクリックして](creating-a-data-access-layer-vb/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="2f07f-234">**Figure 9**: Create the Query Graphically, through the Query Editor ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image25.png))</span></span>


<span data-ttu-id="2f07f-235">クエリを作成した後は、次の画面上に移動する前に、詳細オプション ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="2f07f-235">After creating the query, but before moving onto the next screen, click the Advanced Options button.</span></span> <span data-ttu-id="2f07f-236">Web サイト プロジェクトに「を生成する挿入、更新、および Delete ステートメント」はのみ、既定で選択したオプションの詳細クラス ライブラリまたは Windows プロジェクトからこのウィザードを実行する場合は、"オプティミスティック同時実行制御を使う オプションも選択されます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-236">In Web Site Projects, "Generate Insert, Update, and Delete statements" is the only advanced option selected by default; if you run this wizard from a Class Library or a Windows Project the "Use optimistic concurrency" option will also be selected.</span></span> <span data-ttu-id="2f07f-237">ここでは"オプティミスティック同時実行制御を使う オプションをオンにせずには。</span><span class="sxs-lookup"><span data-stu-id="2f07f-237">Leave the "Use optimistic concurrency" option unchecked for now.</span></span> <span data-ttu-id="2f07f-238">今後のチュートリアルでは、オプティミスティック同時実行制御を説明します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-238">We'll examine optimistic concurrency in future tutorials.</span></span>


<span data-ttu-id="2f07f-239">[![生成する Insert、Update、および Delete ステートメントのみオプションを選択します。](creating-a-data-access-layer-vb/_static/image27.png)](creating-a-data-access-layer-vb/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="2f07f-239">[![Select Only the Generate Insert, Update, and Delete statements Option](creating-a-data-access-layer-vb/_static/image27.png)](creating-a-data-access-layer-vb/_static/image26.png)</span></span>

<span data-ttu-id="2f07f-240">**図 10**: のみ生成する Insert、Update、および Delete ステートメント オプションを選択 ([フルサイズのイメージを表示するをクリックして](creating-a-data-access-layer-vb/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="2f07f-240">**Figure 10**: Select Only the Generate Insert, Update, and Delete statements Option ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image28.png))</span></span>


<span data-ttu-id="2f07f-241">高度なオプションを確認した後は、最終画面に進むには [次へ] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="2f07f-241">After verifying the advanced options, click Next to proceed to the final screen.</span></span> <span data-ttu-id="2f07f-242">ここで、TableAdapter に追加するメソッドを選択するように求められます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-242">Here we are asked to select which methods to add to the TableAdapter.</span></span> <span data-ttu-id="2f07f-243">データを設定するための 2 つのパターンがあります。</span><span class="sxs-lookup"><span data-stu-id="2f07f-243">There are two patterns for populating data:</span></span>

- <span data-ttu-id="2f07f-244">**Datatable**クエリの結果に基づいて、メソッドが作成を受け取り、パラメーターとして DataTable を設定するこの方法でします。</span><span class="sxs-lookup"><span data-stu-id="2f07f-244">**Fill a DataTable** with this approach a method is created that takes in a DataTable as a parameter and populates it based on the results of the query.</span></span> <span data-ttu-id="2f07f-245">ADO.NET データ アダプター クラスは、たとえば、このパターンを実装、`Fill()`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="2f07f-245">The ADO.NET DataAdapter class, for example, implements this pattern with its `Fill()` method.</span></span>
- <span data-ttu-id="2f07f-246">**DataTable を返す**この方法でメソッドを作成する DataTable を入力およびメソッドの戻り値として返します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-246">**Return a DataTable** with this approach the method creates and fills the DataTable for you and returns it as the methods return value.</span></span>

<span data-ttu-id="2f07f-247">これらのパターンの一方または両方を実装して、TableAdapter を持つことができます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-247">You can have the TableAdapter implement one or both of these patterns.</span></span> <span data-ttu-id="2f07f-248">ここで提供されるメソッドの名前を変更することもできます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-248">You can also rename the methods provided here.</span></span> <span data-ttu-id="2f07f-249">みましょうのままにして両方のチェック ボックスがオンになっている場合でも、後者のパターンをこれらのチュートリアル全体で使用するだけです。</span><span class="sxs-lookup"><span data-stu-id="2f07f-249">Let's leave both checkboxes checked, even though we'll only be using the latter pattern throughout these tutorials.</span></span> <span data-ttu-id="2f07f-250">また、名前ではなくジェネリック`GetData`メソッドを`GetProducts`です。</span><span class="sxs-lookup"><span data-stu-id="2f07f-250">Also, let's rename the rather generic `GetData` method to `GetProducts`.</span></span>

<span data-ttu-id="2f07f-251">オンになっている場合、最終的なチェック ボックスを"GenerateDBDirectMethods、"が作成されます`Insert()`、 `Update()`、および`Delete()`TableAdapter のメソッドです。</span><span class="sxs-lookup"><span data-stu-id="2f07f-251">If checked, the final checkbox, "GenerateDBDirectMethods," creates `Insert()`, `Update()`, and `Delete()` methods for the TableAdapter.</span></span> <span data-ttu-id="2f07f-252">このオプションをオフのままにすると、すべての更新する必要があります操作には、TableAdapter の唯一`Update()`メソッド、型指定された DataSet、DataTable、単一の DataRow または Datarow の配列を取得します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-252">If you leave this option unchecked, all updates will need to be done through the TableAdapter's sole `Update()` method, which takes in the Typed DataSet, a DataTable, a single DataRow, or an array of DataRows.</span></span> <span data-ttu-id="2f07f-253">(した場合、このチェック ボックスのオプション図 9 で高度なプロパティをオンになっていない「を生成する挿入、更新、および Delete ステートメント」設定には影響はありません)。このチェック ボックスをオンのままにしてみましょう。</span><span class="sxs-lookup"><span data-stu-id="2f07f-253">(If you've unchecked the "Generate Insert, Update, and Delete statements" option from the advanced properties in Figure 9 this checkbox's setting will have no effect.) Let's leave this checkbox selected.</span></span>


<span data-ttu-id="2f07f-254">[![GetData から GetProducts にメソッド名を変更します。](creating-a-data-access-layer-vb/_static/image30.png)](creating-a-data-access-layer-vb/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="2f07f-254">[![Change the Method Name from GetData to GetProducts](creating-a-data-access-layer-vb/_static/image30.png)](creating-a-data-access-layer-vb/_static/image29.png)</span></span>

<span data-ttu-id="2f07f-255">**図 11**: からメソッド名を変更`GetData`に`GetProducts`([フルサイズのイメージを表示するをクリックして](creating-a-data-access-layer-vb/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="2f07f-255">**Figure 11**: Change the Method Name from `GetData` to `GetProducts` ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image31.png))</span></span>


<span data-ttu-id="2f07f-256">[完了] をクリックして、ウィザードを完了します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-256">Complete the wizard by clicking Finish.</span></span> <span data-ttu-id="2f07f-257">ウィザードを閉じた後、データ テーブルを示し、先ほど作成したデータセット デザイナーに戻ります。</span><span class="sxs-lookup"><span data-stu-id="2f07f-257">After the wizard closes we are returned to the DataSet Designer which shows the DataTable we just created.</span></span> <span data-ttu-id="2f07f-258">内の列の一覧を表示することができます、 `Products` DataTable (`ProductID`、`ProductName`など) のメソッドだけでなく、 `ProductsTableAdapter` (`Fill()`と`GetProducts()`)。</span><span class="sxs-lookup"><span data-stu-id="2f07f-258">You can see the list of columns in the `Products` DataTable (`ProductID`, `ProductName`, and so on), as well as the methods of the `ProductsTableAdapter` (`Fill()` and `GetProducts()`).</span></span>


<span data-ttu-id="2f07f-259">[![製品の DataTable と ProductsTableAdapter が型指定されたデータセットに追加されました](creating-a-data-access-layer-vb/_static/image33.png)](creating-a-data-access-layer-vb/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="2f07f-259">[![The Products DataTable and ProductsTableAdapter have been Added to the Typed DataSet](creating-a-data-access-layer-vb/_static/image33.png)](creating-a-data-access-layer-vb/_static/image32.png)</span></span>

<span data-ttu-id="2f07f-260">**図 12**: `Products` DataTable と`ProductsTableAdapter`型指定されたデータセットに追加されている ([フルサイズのイメージを表示するをクリックして](creating-a-data-access-layer-vb/_static/image34.png))</span><span class="sxs-lookup"><span data-stu-id="2f07f-260">**Figure 12**: The `Products` DataTable and `ProductsTableAdapter` have been Added to the Typed DataSet ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image34.png))</span></span>


<span data-ttu-id="2f07f-261">この時点で 1 つの DataTable に型指定されたデータセットがある (`Northwind.Products`) と厳密に型指定されたデータ アダプター クラス (`NorthwindTableAdapters.ProductsTableAdapter`) で、`GetProducts()`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="2f07f-261">At this point we have a Typed DataSet with a single DataTable (`Northwind.Products`) and a strongly-typed DataAdapter class (`NorthwindTableAdapters.ProductsTableAdapter`) with a `GetProducts()` method.</span></span> <span data-ttu-id="2f07f-262">これらのオブジェクトは、リストにアクセスする、すべての製品のようなコードから使用できます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-262">These objects can be used to access a list of all products from code like:</span></span>

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample1.vb)]

<span data-ttu-id="2f07f-263">このコードでは、データ アクセスに固有のコードの 1 つのビットを記述する必要ありませんでした。</span><span class="sxs-lookup"><span data-stu-id="2f07f-263">This code did not require us to write one bit of data access-specific code.</span></span> <span data-ttu-id="2f07f-264">すべての ADO.NET クラスのインスタンスを作成する必要がない、任意の SQL クエリでは、接続文字列を参照する必要がありませんでしたまたはストアド プロシージャおです。</span><span class="sxs-lookup"><span data-stu-id="2f07f-264">We did not have to instantiate any ADO.NET classes, we didn't have to refer to any connection strings, SQL queries, or stored procedures.</span></span> <span data-ttu-id="2f07f-265">代わりに、TableAdapter は、ご利用の米国の下位レベルのデータ アクセス コードを提供します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-265">Instead, the TableAdapter provides the low-level data access code for us.</span></span>

<span data-ttu-id="2f07f-266">この例で使用される各オブジェクトは、厳密に型指定された、Visual Studio IntelliSense およびコンパイル時の型チェックを提供できるようにもします。</span><span class="sxs-lookup"><span data-stu-id="2f07f-266">Each object used in this example is also strongly-typed, allowing Visual Studio to provide IntelliSense and compile-time type checking.</span></span> <span data-ttu-id="2f07f-267">TableAdapter によって返されるすべてのデータ テーブルの最適な ASP.NET データなど、GridView、DetailsView、DropDownList、CheckBoxList、およびその他のいくつかの Web コントロールにバインドできます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-267">And best of all the DataTables returned by the TableAdapter can be bound to ASP.NET data Web controls, such as the GridView, DetailsView, DropDownList, CheckBoxList, and several others.</span></span> <span data-ttu-id="2f07f-268">によって返される DataTable をバインドする例を紹介します`GetProducts()`だけの十分な 3 行のコード内での GridView にメソッド、`Page_Load`イベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="2f07f-268">The following example illustrates binding the DataTable returned by the `GetProducts()` method to a GridView in just a scant three lines of code within the `Page_Load` event handler.</span></span>

<span data-ttu-id="2f07f-269">AllProducts.aspx</span><span class="sxs-lookup"><span data-stu-id="2f07f-269">AllProducts.aspx</span></span>

[!code-aspx[Main](creating-a-data-access-layer-vb/samples/sample2.aspx)]

<span data-ttu-id="2f07f-270">AllProducts.aspx.vb</span><span class="sxs-lookup"><span data-stu-id="2f07f-270">AllProducts.aspx.vb</span></span>

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample3.vb)]


<span data-ttu-id="2f07f-271">[![GridView には、製品の一覧を表示してください。](creating-a-data-access-layer-vb/_static/image36.png)](creating-a-data-access-layer-vb/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="2f07f-271">[![The List of Products is Displayed in a GridView](creating-a-data-access-layer-vb/_static/image36.png)](creating-a-data-access-layer-vb/_static/image35.png)</span></span>

<span data-ttu-id="2f07f-272">**図 13**: GridView に、製品の一覧が表示されます ([フルサイズのイメージを表示するをクリックして](creating-a-data-access-layer-vb/_static/image37.png))</span><span class="sxs-lookup"><span data-stu-id="2f07f-272">**Figure 13**: The List of Products is Displayed in a GridView ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image37.png))</span></span>


<span data-ttu-id="2f07f-273">この例は、ASP.NET ページの次の 3 つの行のコードに記述したことを必須`Page_Load`イベント ハンドラー、将来のチュートリアル、ObjectDataSource を使用して宣言によって、DAL からデータを取得する方法について確認します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-273">While this example required that we write three lines of code in our ASP.NET page's `Page_Load` event handler, in future tutorials we'll examine how to use the ObjectDataSource to declaratively retrieve the data from the DAL.</span></span> <span data-ttu-id="2f07f-274">ObjectDataSource おコードを記述する必要がありますいないとページングや並べ替えのサポートもが表示されます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-274">With the ObjectDataSource we'll not have to write any code and will get paging and sorting support as well!</span></span>

## <a name="step-3-adding-parameterized-methods-to-the-data-access-layer"></a><span data-ttu-id="2f07f-275">手順 3:、メソッド、データ アクセス レイヤーを追加するパラメーター化されました。</span><span class="sxs-lookup"><span data-stu-id="2f07f-275">Step 3: Adding Parameterized Methods to the Data Access Layer</span></span>

<span data-ttu-id="2f07f-276">この時点で、`ProductsTableAdapter`クラスには 1 つのメソッドが`GetProducts()`データベース内のすべての製品が返されます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-276">At this point our `ProductsTableAdapter` class has but one method, `GetProducts()`, which returns all of the products in the database.</span></span> <span data-ttu-id="2f07f-277">すべての製品を使用することは明らかに便利ですが、特定の製品、または特定のカテゴリに属しているすべての製品に関する情報を取得する場合はありますがあります。</span><span class="sxs-lookup"><span data-stu-id="2f07f-277">While being able to work with all products is definitely useful, there are times when we'll want to retrieve information about a specific product, or all products that belong to a particular category.</span></span> <span data-ttu-id="2f07f-278">データ アクセス層にこのような機能を追加するには、メソッドのパラメーター化された TableAdapter に追加できます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-278">To add such functionality to our Data Access Layer we can add parameterized methods to the TableAdapter.</span></span>

<span data-ttu-id="2f07f-279">追加してみましょう。、`GetProductsByCategoryID(categoryID)`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="2f07f-279">Let's add the `GetProductsByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="2f07f-280">データセット デザイナーに戻り、DAL に新しいメソッドを追加するのには右クリック、`ProductsTableAdapter`セクション、およびクエリの追加を選択します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-280">To add a new method to the DAL, return to the DataSet Designer, right-click in the `ProductsTableAdapter` section, and choose Add Query.</span></span>


![TableAdapter を右クリックして、クエリを追加](creating-a-data-access-layer-vb/_static/image38.png)

<span data-ttu-id="2f07f-282">**図 14**: TableAdapter を右クリックして、クエリを追加</span><span class="sxs-lookup"><span data-stu-id="2f07f-282">**Figure 14**: Right-Click on the TableAdapter and Choose Add Query</span></span>


<span data-ttu-id="2f07f-283">最初に、アドホック SQL ステートメントまたは新規または既存のストアド プロシージャを使用してデータベースにアクセスするかどうかについてお求められます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-283">We are first prompted about whether we want to access the database using an ad-hoc SQL statement or a new or existing stored procedure.</span></span> <span data-ttu-id="2f07f-284">もう一度、アドホック SQL ステートメントを使用するを選択します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-284">Let's choose to use an ad-hoc SQL statement again.</span></span> <span data-ttu-id="2f07f-285">次に、SQL クエリの種類ようを使用することが求められます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-285">Next, we are asked what type of SQL query we'd like to use.</span></span> <span data-ttu-id="2f07f-286">記述する、指定したカテゴリに属しているすべての製品を取得するため、`SELECT`ステートメントの行が返されます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-286">Since we want to return all products that belong to a specified category, we want to write a `SELECT` statement which returns rows.</span></span>


<span data-ttu-id="2f07f-287">[![行を返す SELECT ステートメントを作成します。](creating-a-data-access-layer-vb/_static/image40.png)](creating-a-data-access-layer-vb/_static/image39.png)</span><span class="sxs-lookup"><span data-stu-id="2f07f-287">[![Choose to Create a SELECT Statement Which Returns Rows](creating-a-data-access-layer-vb/_static/image40.png)](creating-a-data-access-layer-vb/_static/image39.png)</span></span>

<span data-ttu-id="2f07f-288">**図 15**: 作成 を選択して、`SELECT`ステートメントが行を返します ([フルサイズのイメージを表示するをクリックして](creating-a-data-access-layer-vb/_static/image41.png))</span><span class="sxs-lookup"><span data-stu-id="2f07f-288">**Figure 15**: Choose to Create a `SELECT` Statement Which Returns Rows ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image41.png))</span></span>


<span data-ttu-id="2f07f-289">次の手順では、データにアクセスするために使用する SQL クエリを定義します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-289">The next step is to define the SQL query used to access the data.</span></span> <span data-ttu-id="2f07f-290">同じ使用を特定のカテゴリに属する製品だけを返すので、`SELECT`ステートメントから`GetProducts()`、次の追加が`WHERE`句:`WHERE CategoryID = @CategoryID`です。</span><span class="sxs-lookup"><span data-stu-id="2f07f-290">Since we want to return only those products that belong to a particular category, I use the same `SELECT` statement from `GetProducts()`, but add the following `WHERE` clause: `WHERE CategoryID = @CategoryID`.</span></span> <span data-ttu-id="2f07f-291">`@CategoryID`メソッドを作成していますが、対応する型 (つまり、null 許容の整数) の入力パラメーターを必要とする、TableAdapter ウィザードにパラメーターを示します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-291">The `@CategoryID` parameter indicates to the TableAdapter wizard that the method we're creating will require an input parameter of the corresponding type (namely, a nullable integer).</span></span>


<span data-ttu-id="2f07f-292">[![指定されたカテゴリの製品を返すだけにクエリを入力します](creating-a-data-access-layer-vb/_static/image43.png)](creating-a-data-access-layer-vb/_static/image42.png)</span><span class="sxs-lookup"><span data-stu-id="2f07f-292">[![Enter a Query to Only Return Products in a Specified Category](creating-a-data-access-layer-vb/_static/image43.png)](creating-a-data-access-layer-vb/_static/image42.png)</span></span>

<span data-ttu-id="2f07f-293">**図 16**: に指定されたカテゴリの製品をのみを返すクエリを入力します ([フルサイズのイメージを表示するをクリックして](creating-a-data-access-layer-vb/_static/image44.png))</span><span class="sxs-lookup"><span data-stu-id="2f07f-293">**Figure 16**: Enter a Query to Only Return Products in a Specified Category ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image44.png))</span></span>


<span data-ttu-id="2f07f-294">最後の手順で選択できますデータ アクセス パターンを使用して、できるだけでなく、生成されたメソッドの名前をカスタマイズします。</span><span class="sxs-lookup"><span data-stu-id="2f07f-294">In the final step we can choose which data access patterns to use, as well as customize the names of the methods generated.</span></span> <span data-ttu-id="2f07f-295">塗りつぶしのパターンの名前を変更してみましょう`FillByCategoryID`および戻り値の DataTable 戻りパターン (、`GetX`メソッド) を使ってみましょう`GetProductsByCategoryID`です。</span><span class="sxs-lookup"><span data-stu-id="2f07f-295">For the Fill pattern, let's change the name to `FillByCategoryID` and for the return a DataTable return pattern (the `GetX` methods), let's use `GetProductsByCategoryID`.</span></span>


<span data-ttu-id="2f07f-296">[![TableAdapter のメソッドの名前を選択します。](creating-a-data-access-layer-vb/_static/image46.png)](creating-a-data-access-layer-vb/_static/image45.png)</span><span class="sxs-lookup"><span data-stu-id="2f07f-296">[![Choose the Names for the TableAdapter Methods](creating-a-data-access-layer-vb/_static/image46.png)](creating-a-data-access-layer-vb/_static/image45.png)</span></span>

<span data-ttu-id="2f07f-297">**図 17**: TableAdapter のメソッドの名前を選択 ([フルサイズのイメージを表示するをクリックして](creating-a-data-access-layer-vb/_static/image47.png))</span><span class="sxs-lookup"><span data-stu-id="2f07f-297">**Figure 17**: Choose the Names for the TableAdapter Methods ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image47.png))</span></span>


<span data-ttu-id="2f07f-298">ウィザードを完了すると、データセット デザイナーには、新しい TableAdapter のメソッドが含まれています。</span><span class="sxs-lookup"><span data-stu-id="2f07f-298">After completing the wizard, the DataSet Designer includes the new TableAdapter methods.</span></span>


![カテゴリは、照会する、製品できるようになりました](creating-a-data-access-layer-vb/_static/image48.png)

<span data-ttu-id="2f07f-300">**図 18**:、製品ことによってクエリ カテゴリ</span><span class="sxs-lookup"><span data-stu-id="2f07f-300">**Figure 18**: The Products Can Now be Queried by Category</span></span>


<span data-ttu-id="2f07f-301">追加する、`GetProductByProductID(productID)`メソッドと同じ手法を使用します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-301">Take a moment to add a `GetProductByProductID(productID)` method using the same technique.</span></span>

<span data-ttu-id="2f07f-302">データセット デザイナーから直接、これらのパラメーター化クエリをテストできます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-302">These parameterized queries can be tested directly from the DataSet Designer.</span></span> <span data-ttu-id="2f07f-303">TableAdapter のメソッドを右クリックし、データのプレビューを選択します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-303">Right-click on the method in the TableAdapter and choose Preview Data.</span></span> <span data-ttu-id="2f07f-304">次に、パラメーターを使用し、[プレビュー] をクリックする値を入力します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-304">Next, enter the values to use for the parameters and click Preview.</span></span>


<span data-ttu-id="2f07f-305">[![これらの製品属する飲み物のカテゴリが表示されます。](creating-a-data-access-layer-vb/_static/image50.png)](creating-a-data-access-layer-vb/_static/image49.png)</span><span class="sxs-lookup"><span data-stu-id="2f07f-305">[![Those Products Belonging to the Beverages Category are Shown](creating-a-data-access-layer-vb/_static/image50.png)](creating-a-data-access-layer-vb/_static/image49.png)</span></span>

<span data-ttu-id="2f07f-306">**図 19**: これらの製品に属する飲み物のカテゴリが表示されます ([フルサイズのイメージを表示するをクリックして](creating-a-data-access-layer-vb/_static/image51.png))</span><span class="sxs-lookup"><span data-stu-id="2f07f-306">**Figure 19**: Those Products Belonging to the Beverages Category are Shown ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image51.png))</span></span>


<span data-ttu-id="2f07f-307">`GetProductsByCategoryID(categoryID)` DAL のメソッドは、指定されたカテゴリの製品のみを表示するための ASP.NET ページ今すぐ作成できます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-307">With the `GetProductsByCategoryID(categoryID)` method in our DAL, we can now create an ASP.NET page that displays only those products in a specified category.</span></span> <span data-ttu-id="2f07f-308">次の例では、すべての製品、飲料カテゴリ内にあるである必要が、`CategoryID`は 1 です。</span><span class="sxs-lookup"><span data-stu-id="2f07f-308">The following example shows all products that are in the Beverages category, which have a `CategoryID` of 1.</span></span>

<span data-ttu-id="2f07f-309">Beverages.aspx</span><span class="sxs-lookup"><span data-stu-id="2f07f-309">Beverages.aspx</span></span>

[!code-aspx[Main](creating-a-data-access-layer-vb/samples/sample4.aspx)]

<span data-ttu-id="2f07f-310">Beverages.aspx.vb</span><span class="sxs-lookup"><span data-stu-id="2f07f-310">Beverages.aspx.vb</span></span>

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample5.vb)]


<span data-ttu-id="2f07f-311">[![飲料カテゴリの製品が表示されます。](creating-a-data-access-layer-vb/_static/image53.png)](creating-a-data-access-layer-vb/_static/image52.png)</span><span class="sxs-lookup"><span data-stu-id="2f07f-311">[![Those Products in the Beverages Category are Displayed](creating-a-data-access-layer-vb/_static/image53.png)](creating-a-data-access-layer-vb/_static/image52.png)</span></span>

<span data-ttu-id="2f07f-312">**図 20**: もの、飲料カテゴリの製品が表示されます ([フルサイズのイメージを表示するをクリックして](creating-a-data-access-layer-vb/_static/image54.png))</span><span class="sxs-lookup"><span data-stu-id="2f07f-312">**Figure 20**: Those Products in the Beverages Category are Displayed ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image54.png))</span></span>


## <a name="step-4-inserting-updating-and-deleting-data"></a><span data-ttu-id="2f07f-313">手順 4: 挿入、更新、およびデータを削除します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-313">Step 4: Inserting, Updating, and Deleting Data</span></span>

<span data-ttu-id="2f07f-314">一般的な用途の挿入、更新、およびデータを削除する 2 つのパターンがあります。</span><span class="sxs-lookup"><span data-stu-id="2f07f-314">There are two patterns commonly used for inserting, updating, and deleting data.</span></span> <span data-ttu-id="2f07f-315">最初のパターンは、データベースの直接パターンと呼んでするには、メソッドを作成する、呼び出されたときに、問題、 `INSERT`、 `UPDATE`、または`DELETE`コマンドを 1 つのデータベース レコードの適用対象となるデータベースにします。</span><span class="sxs-lookup"><span data-stu-id="2f07f-315">The first pattern, which I'll call the database direct pattern, involves creating methods that, when invoked, issue an `INSERT`, `UPDATE`, or `DELETE` command to the database that operates on a single database record.</span></span> <span data-ttu-id="2f07f-316">このようなメソッドが通常に渡されます、一連のスカラー値 (整数、文字列、ブール値、DateTimes、およびなど) 対応する値を挿入、更新、または削除します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-316">Such methods are typically passed in a series of scalar values (integers, strings, Booleans, DateTimes, and so on) that correspond to the values to insert, update, or delete.</span></span> <span data-ttu-id="2f07f-317">たとえばのこのパターンで、`Products`整数パラメーターでは delete メソッドを要しますテーブルを示す、`ProductID`の文字列に挿入メソッドがかかるときは、削除するレコードの`ProductName`、の10進数`UnitPrice`、整数、`UnitsOnStock`のようにします。</span><span class="sxs-lookup"><span data-stu-id="2f07f-317">For example, with this pattern for the `Products` table the delete method would take in an integer parameter, indicating the `ProductID` of the record to delete, while the insert method would take in a string for the `ProductName`, a decimal for the `UnitPrice`, an integer for the `UnitsOnStock`, and so on.</span></span>


<span data-ttu-id="2f07f-318">[![各挿入、更新、および削除要求がすぐにデータベースに送信されます。](creating-a-data-access-layer-vb/_static/image56.png)](creating-a-data-access-layer-vb/_static/image55.png)</span><span class="sxs-lookup"><span data-stu-id="2f07f-318">[![Each Insert, Update, and Delete Request is Sent to the Database Immediately](creating-a-data-access-layer-vb/_static/image56.png)](creating-a-data-access-layer-vb/_static/image55.png)</span></span>

<span data-ttu-id="2f07f-319">**図 21**: 各挿入、更新、および削除要求がすぐにデータベースに送信される ([フルサイズのイメージを表示するをクリックして](creating-a-data-access-layer-vb/_static/image57.png))</span><span class="sxs-lookup"><span data-stu-id="2f07f-319">**Figure 21**: Each Insert, Update, and Delete Request is Sent to the Database Immediately ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image57.png))</span></span>


<span data-ttu-id="2f07f-320">バッチとしてパターンを更新する呼ぶことに、その他のパターンでは、全体の DataSet、DataTable、または 1 つのメソッドの呼び出しで Datarow のコレクションを更新します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-320">The other pattern, which I'll refer to as the batch update pattern, is to update an entire DataSet, DataTable, or collection of DataRows in one method call.</span></span> <span data-ttu-id="2f07f-321">このパターンを持つ開発者削除挿入、および DataTable に Datarow を変更し、update メソッドにそれらの Datarow または DataTable を渡します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-321">With this pattern a developer deletes, inserts, and modifies the DataRows in a DataTable and then passes those DataRows or DataTable into an update method.</span></span> <span data-ttu-id="2f07f-322">このメソッドに渡された Datarow の列挙、決定かどうかがいる変更、追加、または削除されました (DataRow のを介して[RowState プロパティ](https://msdn.microsoft.com/library/system.data.datarow.rowstate.aspx)値)、し、各レコードの適切なデータベースの要求を発行します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-322">This method then enumerates the DataRows passed in, determines whether or not they've been modified, added, or deleted (via the DataRow's [RowState property](https://msdn.microsoft.com/library/system.data.datarow.rowstate.aspx) value), and issues the appropriate database request for each record.</span></span>


<span data-ttu-id="2f07f-323">[![更新メソッドが呼び出されたときに、すべての変更がデータベースと同期されます。](creating-a-data-access-layer-vb/_static/image59.png)](creating-a-data-access-layer-vb/_static/image58.png)</span><span class="sxs-lookup"><span data-stu-id="2f07f-323">[![All Changes are Synchronized with the Database When the Update Method is Invoked](creating-a-data-access-layer-vb/_static/image59.png)](creating-a-data-access-layer-vb/_static/image58.png)</span></span>

<span data-ttu-id="2f07f-324">**図 22**: 更新メソッドが呼び出されたときに、すべての変更がデータベースと同期されます ([フルサイズのイメージを表示するをクリックして](creating-a-data-access-layer-vb/_static/image60.png))</span><span class="sxs-lookup"><span data-stu-id="2f07f-324">**Figure 22**: All Changes are Synchronized with the Database When the Update Method is Invoked ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image60.png))</span></span>


<span data-ttu-id="2f07f-325">TableAdapter では、既定では、バッチ更新パターンを使用しますも DB 直接パターンをサポートします。</span><span class="sxs-lookup"><span data-stu-id="2f07f-325">The TableAdapter uses the batch update pattern by default, but also supports the DB direct pattern.</span></span> <span data-ttu-id="2f07f-326">TableAdapter を作成するときに、詳細プロパティから「を生成する挿入、更新、および Delete ステートメント」オプションを選択おため、`ProductsTableAdapter`が含まれています、`Update()`メソッドで、バッチ更新パターンを実装します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-326">Since we selected the "Generate Insert, Update, and Delete statements" option from the Advanced Properties when creating our TableAdapter, the `ProductsTableAdapter` contains an `Update()` method, which implements the batch update pattern.</span></span> <span data-ttu-id="2f07f-327">具体的には、TableAdapter が含まれています、`Update()`型指定されたデータセットを厳密に型指定された DataTable、または 1 つまたは複数の Datarow に渡すことができるメソッドです。</span><span class="sxs-lookup"><span data-stu-id="2f07f-327">Specifically, the TableAdapter contains an `Update()` method that can be passed the Typed DataSet, a strongly-typed DataTable, or one or more DataRows.</span></span> <span data-ttu-id="2f07f-328">中断した場合、"GenerateDBDirectMethods"チェック ボックスと DB 直接パターン、TableAdapter を作成してもによって実装されて`Insert()`、 `Update()`、および`Delete()`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="2f07f-328">If you left the "GenerateDBDirectMethods" checkbox checked when first creating the TableAdapter the DB direct pattern will also be implemented via `Insert()`, `Update()`, and `Delete()` methods.</span></span>

<span data-ttu-id="2f07f-329">両方のデータ変更のパターンを使用、TableAdapter の`InsertCommand`、 `UpdateCommand`、および`DeleteCommand`を発行するプロパティ、 `INSERT`、 `UPDATE`、および`DELETE`コマンドをデータベースにします。</span><span class="sxs-lookup"><span data-stu-id="2f07f-329">Both data modification patterns use the TableAdapter's `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties to issue their `INSERT`, `UPDATE`, and `DELETE` commands to the database.</span></span> <span data-ttu-id="2f07f-330">検査および変更できる、 `InsertCommand`、 `UpdateCommand`、および`DeleteCommand`TableAdapter はデータセット デザイナーでをクリックし、[プロパティ] ウィンドウでプロパティをします。</span><span class="sxs-lookup"><span data-stu-id="2f07f-330">You can inspect and modify the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties by clicking on the TableAdapter in the DataSet Designer and then going to the Properties window.</span></span> <span data-ttu-id="2f07f-331">(、TableAdapter とを選択するかどうかを確認、`ProductsTableAdapter`オブジェクトが 1 つのプロパティ ウィンドウで、ドロップダウン リストで選択します)。</span><span class="sxs-lookup"><span data-stu-id="2f07f-331">(Make sure you have selected the TableAdapter, and that the `ProductsTableAdapter` object is the one selected in the drop-down list in the Properties window.)</span></span>


<span data-ttu-id="2f07f-332">[![TableAdapter が InsertCommand、UpdateCommand、および DeleteCommand プロパティ](creating-a-data-access-layer-vb/_static/image62.png)](creating-a-data-access-layer-vb/_static/image61.png)</span><span class="sxs-lookup"><span data-stu-id="2f07f-332">[![The TableAdapter has InsertCommand, UpdateCommand, and DeleteCommand Properties](creating-a-data-access-layer-vb/_static/image62.png)](creating-a-data-access-layer-vb/_static/image61.png)</span></span>

<span data-ttu-id="2f07f-333">**図 23**:、TableAdapter が`InsertCommand`、 `UpdateCommand`、および`DeleteCommand`プロパティ ([フルサイズのイメージを表示するをクリックして](creating-a-data-access-layer-vb/_static/image63.png))</span><span class="sxs-lookup"><span data-stu-id="2f07f-333">**Figure 23**: The TableAdapter has `InsertCommand`, `UpdateCommand`, and `DeleteCommand` Properties ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image63.png))</span></span>


<span data-ttu-id="2f07f-334">これらのデータベース コマンド プロパティを変更または確認して、をクリックして、`CommandText`サブプロパティで、クエリ ビルダーが表示されます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-334">To examine or modify any of these database command properties, click on the `CommandText` subproperty, which will bring up the Query Builder.</span></span>


<span data-ttu-id="2f07f-335">[![クエリ ビルダーでの挿入、更新、および DELETE ステートメントを構成します。](creating-a-data-access-layer-vb/_static/image65.png)](creating-a-data-access-layer-vb/_static/image64.png)</span><span class="sxs-lookup"><span data-stu-id="2f07f-335">[![Configure the INSERT, UPDATE, and DELETE Statements in the Query Builder](creating-a-data-access-layer-vb/_static/image65.png)](creating-a-data-access-layer-vb/_static/image64.png)</span></span>

<span data-ttu-id="2f07f-336">**図 24**: 構成、 `INSERT`、 `UPDATE`、および`DELETE`クエリ ビルダー内のステートメント ([フルサイズのイメージを表示するをクリックして](creating-a-data-access-layer-vb/_static/image66.png))</span><span class="sxs-lookup"><span data-stu-id="2f07f-336">**Figure 24**: Configure the `INSERT`, `UPDATE`, and `DELETE` Statements in the Query Builder ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image66.png))</span></span>


<span data-ttu-id="2f07f-337">次のコード例では、パターンを使用して、バッチ更新は廃止されましたいないおよび在庫以下 25 ユニットがあるすべての製品の価格を倍にする方法を示します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-337">The following code example shows how to use the batch update pattern to double the price of all products that are not discontinued and that have 25 units in stock or less:</span></span>

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample6.vb)]

<span data-ttu-id="2f07f-338">次のコードでは、プログラムによって特定の製品を削除してから、1 つを更新する DB 直接パターンを使用し、新しいを追加する方法を示します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-338">The code below illustrates how to use the DB direct pattern to programmatically delete a particular product, then update one, and then add a new one:</span></span>

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample7.vb)]

## <a name="creating-custom-insert-update-and-delete-methods"></a><span data-ttu-id="2f07f-339">作成するカスタム Insert、Update、および Delete メソッド</span><span class="sxs-lookup"><span data-stu-id="2f07f-339">Creating Custom Insert, Update, and Delete Methods</span></span>

<span data-ttu-id="2f07f-340">`Insert()`、 `Update()`、および`Delete()`DB 直接メソッドによって作成されたメソッドを扱い、特に多くの列を含むテーブルのことができます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-340">The `Insert()`, `Update()`, and `Delete()` methods created by the DB direct method can be a bit cumbersome, especially for tables with many columns.</span></span> <span data-ttu-id="2f07f-341">IntelliSense のヘルプが明確ではない特に何せず、上記のコード例を見て`Products`テーブル列に各入力パラメーターに対応する、`Update()`と`Insert()`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="2f07f-341">Looking at the previous code example, without IntelliSense's help it's not particularly clear what `Products` table column maps to each input parameter to the `Update()` and `Insert()` methods.</span></span> <span data-ttu-id="2f07f-342">ときにのみが必要する 1 つの列または 2、更新、カスタマイズされた時間がある可能性があります`Insert()`は、おそらく、メソッドは、新しく挿入されるレコードの値を返す`IDENTITY`(自動インクリメント) フィールドです。</span><span class="sxs-lookup"><span data-stu-id="2f07f-342">There may be times when we only want to update a single column or two, or want a customized `Insert()` method that will, perhaps, return the value of the newly inserted record's `IDENTITY` (auto-increment) field.</span></span>

<span data-ttu-id="2f07f-343">このようなカスタム メソッドを作成するには、データセット デザイナーに戻ります。</span><span class="sxs-lookup"><span data-stu-id="2f07f-343">To create such a custom method, return to the DataSet Designer.</span></span> <span data-ttu-id="2f07f-344">TableAdapter を右クリックし、TableAdapter ウィザードに戻って、追加のクエリを選択します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-344">Right-click on the TableAdapter and choose Add Query, returning to the TableAdapter wizard.</span></span> <span data-ttu-id="2f07f-345">2 番目の画面には、作成するクエリの種類おを示します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-345">On the second screen we can indicate the type of query to create.</span></span> <span data-ttu-id="2f07f-346">新しい製品を追加し、後の新しく追加されたレコードの値を返すメソッドを作成しましょう`ProductID`です。</span><span class="sxs-lookup"><span data-stu-id="2f07f-346">Let's create a method that adds a new product and then returns the value of the newly added record's `ProductID`.</span></span> <span data-ttu-id="2f07f-347">そのため、作成すること、`INSERT`クエリ。</span><span class="sxs-lookup"><span data-stu-id="2f07f-347">Therefore, opt to create an `INSERT` query.</span></span>


<span data-ttu-id="2f07f-348">[![Products テーブルに新しい行を追加するメソッドを作成します。](creating-a-data-access-layer-vb/_static/image68.png)](creating-a-data-access-layer-vb/_static/image67.png)</span><span class="sxs-lookup"><span data-stu-id="2f07f-348">[![Create a Method to Add a New Row to the Products Table](creating-a-data-access-layer-vb/_static/image68.png)](creating-a-data-access-layer-vb/_static/image67.png)</span></span>

<span data-ttu-id="2f07f-349">**図 25**: 新規行を追加するメソッドを作成、`Products`テーブル ([フルサイズのイメージを表示するをクリックして](creating-a-data-access-layer-vb/_static/image69.png))</span><span class="sxs-lookup"><span data-stu-id="2f07f-349">**Figure 25**: Create a Method to Add a New Row to the `Products` Table ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image69.png))</span></span>


<span data-ttu-id="2f07f-350">次の画面で、`InsertCommand`の`CommandText`が表示されます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-350">On the next screen the `InsertCommand`'s `CommandText` appears.</span></span> <span data-ttu-id="2f07f-351">このクエリを追加することによって拡張`SELECT SCOPE_IDENTITY()`に挿入された最後の id 値を返しますクエリの最後に、`IDENTITY`同じスコープ内の列です。</span><span class="sxs-lookup"><span data-stu-id="2f07f-351">Augment this query by adding `SELECT SCOPE_IDENTITY()` at the end of the query, which will return the last identity value inserted into an `IDENTITY` column in the same scope.</span></span> <span data-ttu-id="2f07f-352">(を参照してください、[のテクニカル ドキュメント](https://msdn.microsoft.com/library/ms190315.aspx)の詳細については`SCOPE_IDENTITY()`と多くの場合にその理由[スコープを使用して\_の代わりに @ IDENTITY()@IDENTITY](http://weblogs.sqlteam.com/travisl/archive/2003/10/29/405.aspx))。終了するかどうかを確認、`INSERT`ステートメントをセミコロンを追加する前に、`SELECT`ステートメントです。</span><span class="sxs-lookup"><span data-stu-id="2f07f-352">(See the [technical documentation](https://msdn.microsoft.com/library/ms190315.aspx) for more information about `SCOPE_IDENTITY()` and why you probably want to [use SCOPE\_IDENTITY() in lieu of @@IDENTITY](http://weblogs.sqlteam.com/travisl/archive/2003/10/29/405.aspx).) Make sure that you end the `INSERT` statement with a semi-colon before adding the `SELECT` statement.</span></span>


<span data-ttu-id="2f07f-353">[![SCOPE_IDENTITY() 値を返すクエリを拡張します。](creating-a-data-access-layer-vb/_static/image71.png)](creating-a-data-access-layer-vb/_static/image70.png)</span><span class="sxs-lookup"><span data-stu-id="2f07f-353">[![Augment the Query to Return the SCOPE_IDENTITY() Value](creating-a-data-access-layer-vb/_static/image71.png)](creating-a-data-access-layer-vb/_static/image70.png)</span></span>

<span data-ttu-id="2f07f-354">**図 26**: 戻り値にクエリを拡張したり、`SCOPE_IDENTITY()`値 ([フルサイズのイメージを表示するをクリックして](creating-a-data-access-layer-vb/_static/image72.png))</span><span class="sxs-lookup"><span data-stu-id="2f07f-354">**Figure 26**: Augment the Query to Return the `SCOPE_IDENTITY()` Value ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image72.png))</span></span>


<span data-ttu-id="2f07f-355">新しいメソッドの名前を最後に、`InsertProduct`です。</span><span class="sxs-lookup"><span data-stu-id="2f07f-355">Finally, name the new method `InsertProduct`.</span></span>


<span data-ttu-id="2f07f-356">[![InsertProduct に新しいメソッドの名前を設定します。](creating-a-data-access-layer-vb/_static/image74.png)](creating-a-data-access-layer-vb/_static/image73.png)</span><span class="sxs-lookup"><span data-stu-id="2f07f-356">[![Set the New Method Name to InsertProduct](creating-a-data-access-layer-vb/_static/image74.png)](creating-a-data-access-layer-vb/_static/image73.png)</span></span>

<span data-ttu-id="2f07f-357">**図 27**: 新しいメソッド名を設定します`InsertProduct`([フルサイズのイメージを表示するをクリックして](creating-a-data-access-layer-vb/_static/image75.png))</span><span class="sxs-lookup"><span data-stu-id="2f07f-357">**Figure 27**: Set the New Method Name to `InsertProduct` ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image75.png))</span></span>


<span data-ttu-id="2f07f-358">戻ったら、データセット デザイナーに表示される、`ProductsTableAdapter`新しいメソッドが含まれています`InsertProduct`です。</span><span class="sxs-lookup"><span data-stu-id="2f07f-358">When you return to the DataSet Designer you'll see that the `ProductsTableAdapter` contains a new method, `InsertProduct`.</span></span> <span data-ttu-id="2f07f-359">この新しいメソッドがそれぞれの列にパラメーターがないかどうか、`Products`テーブル、という事態が終了を忘れた場合、`INSERT`をセミコロンでステートメント。</span><span class="sxs-lookup"><span data-stu-id="2f07f-359">If this new method doesn't have a parameter for each column in the `Products` table, chances are you forgot to terminate the `INSERT` statement with a semi-colon.</span></span> <span data-ttu-id="2f07f-360">構成、`InsertProduct`メソッド、セミコロン区切りがあることを確認し、`INSERT`と`SELECT`ステートメントです。</span><span class="sxs-lookup"><span data-stu-id="2f07f-360">Configure the `InsertProduct` method and ensure you have a semi-colon delimiting the `INSERT` and `SELECT` statements.</span></span>

<span data-ttu-id="2f07f-361">既定では、メソッドの問題クエリ以外メソッドであり、影響を受けた行の数を返すことを挿入します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-361">By default, insert methods issue non-query methods, meaning that they return the number of affected rows.</span></span> <span data-ttu-id="2f07f-362">ただし、場合、`InsertProduct`影響を受ける行の数ではなく、クエリによって返される値を返すメソッド。</span><span class="sxs-lookup"><span data-stu-id="2f07f-362">However, we want the `InsertProduct` method to return the value returned by the query, not the number of rows affected.</span></span> <span data-ttu-id="2f07f-363">これを実現する、調整、`InsertProduct`メソッドの`ExecuteMode`プロパティを`Scalar`です。</span><span class="sxs-lookup"><span data-stu-id="2f07f-363">To accomplish this, adjust the `InsertProduct` method's `ExecuteMode` property to `Scalar`.</span></span>


<span data-ttu-id="2f07f-364">[![スカラーの ExecuteMode プロパティを変更します。](creating-a-data-access-layer-vb/_static/image77.png)](creating-a-data-access-layer-vb/_static/image76.png)</span><span class="sxs-lookup"><span data-stu-id="2f07f-364">[![Change the ExecuteMode Property to Scalar](creating-a-data-access-layer-vb/_static/image77.png)](creating-a-data-access-layer-vb/_static/image76.png)</span></span>

<span data-ttu-id="2f07f-365">**図 28**: 変更、`ExecuteMode`プロパティを`Scalar`([フルサイズのイメージを表示するをクリックして](creating-a-data-access-layer-vb/_static/image78.png))</span><span class="sxs-lookup"><span data-stu-id="2f07f-365">**Figure 28**: Change the `ExecuteMode` Property to `Scalar` ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image78.png))</span></span>


<span data-ttu-id="2f07f-366">次のコードはこの新しい`InsertProduct`メソッドの動作。</span><span class="sxs-lookup"><span data-stu-id="2f07f-366">The following code shows this new `InsertProduct` method in action:</span></span>

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample8.vb)]

## <a name="step-5-completing-the-data-access-layer"></a><span data-ttu-id="2f07f-367">手順 5: データ アクセス層の完了</span><span class="sxs-lookup"><span data-stu-id="2f07f-367">Step 5: Completing the Data Access Layer</span></span>

<span data-ttu-id="2f07f-368">注意してください、`ProductsTableAdapters`クラスを返します、`CategoryID`と`SupplierID`値から、`Products`テーブルしますが、含まれていない、`CategoryName`列から、`Categories`テーブルまたは`CompanyName`列から、 `Suppliers`テーブル、製品情報を表示するときに表示したいが、これらの列では可能性があります。</span><span class="sxs-lookup"><span data-stu-id="2f07f-368">Note that the `ProductsTableAdapters` class returns the `CategoryID` and `SupplierID` values from the `Products` table, but doesn't include the `CategoryName` column from the `Categories` table or the `CompanyName` column from the `Suppliers` table, although these are likely the columns we want to display when showing product information.</span></span> <span data-ttu-id="2f07f-369">TableAdapter の最初のメソッドを補強できます。 お`GetProducts()`、両方を含める、`CategoryName`と`CompanyName`列の値は、これらの新しい列を含めるに厳密に型指定された DataTable が更新されます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-369">We can augment the TableAdapter's initial method, `GetProducts()`, to include both the `CategoryName` and `CompanyName` column values, which will update the strongly-typed DataTable to include these new columns as well.</span></span>

<span data-ttu-id="2f07f-370">これで問題が発生、ただしを挿入するため、TableAdapter のメソッドとして、更新され、データの削除は、この最初のメソッドから基づいています。</span><span class="sxs-lookup"><span data-stu-id="2f07f-370">This can present a problem, however, as the TableAdapter's methods for inserting, updating, and deleting data are based off of this initial method.</span></span> <span data-ttu-id="2f07f-371">幸いにも、自動生成されたメソッドの挿入、更新、および削除されないために影響を受けた内のサブクエリ、`SELECT`句。</span><span class="sxs-lookup"><span data-stu-id="2f07f-371">Fortunately, the auto-generated methods for inserting, updating, and deleting are not affected by subqueries in the `SELECT` clause.</span></span> <span data-ttu-id="2f07f-372">によって、クエリに追加するよう注意して`Categories`と`Suppliers`サブクエリとしてではなく`JOIN`s おをせずに済むようデータを変更するため、これらのメソッドを再作成します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-372">By taking care to add our queries to `Categories` and `Suppliers` as subqueries, rather than `JOIN` s, we'll avoid having to rework those methods for modifying data.</span></span> <span data-ttu-id="2f07f-373">右クリックし、`GetProducts()`メソッドで、`ProductsTableAdapter`構成を選択します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-373">Right-click on the `GetProducts()` method in the `ProductsTableAdapter` and choose Configure.</span></span> <span data-ttu-id="2f07f-374">次に、調整、`SELECT`次のような句。</span><span class="sxs-lookup"><span data-stu-id="2f07f-374">Then, adjust the `SELECT` clause so that it looks like:</span></span>

[!code-sql[Main](creating-a-data-access-layer-vb/samples/sample9.sql)]


<span data-ttu-id="2f07f-375">[![GetProducts() メソッド用の更新プログラム、SELECT ステートメント](creating-a-data-access-layer-vb/_static/image80.png)](creating-a-data-access-layer-vb/_static/image79.png)</span><span class="sxs-lookup"><span data-stu-id="2f07f-375">[![Update the SELECT Statement for the GetProducts() Method](creating-a-data-access-layer-vb/_static/image80.png)](creating-a-data-access-layer-vb/_static/image79.png)</span></span>

<span data-ttu-id="2f07f-376">**図 29**: 更新プログラム、`SELECT`のステートメント、`GetProducts()`メソッド ([フルサイズのイメージを表示するをクリックして](creating-a-data-access-layer-vb/_static/image81.png))</span><span class="sxs-lookup"><span data-stu-id="2f07f-376">**Figure 29**: Update the `SELECT` Statement for the `GetProducts()` Method ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image81.png))</span></span>


<span data-ttu-id="2f07f-377">更新した後、 `GetProducts()` DataTable には、次の 2 つの新しい列が含まれます新しいクエリを使用する方法:`CategoryName`と`SupplierName`です。</span><span class="sxs-lookup"><span data-stu-id="2f07f-377">After updating the `GetProducts()` method to use this new query the DataTable will include two new columns: `CategoryName` and `SupplierName`.</span></span>


![製品 DataTable が 2 つの新しい列](creating-a-data-access-layer-vb/_static/image82.png)

<span data-ttu-id="2f07f-379">**図 30**: `Products` DataTable が 2 つの新しい列</span><span class="sxs-lookup"><span data-stu-id="2f07f-379">**Figure 30**: The `Products` DataTable has Two New Columns</span></span>


<span data-ttu-id="2f07f-380">更新する、`SELECT`句、`GetProductsByCategoryID(categoryID)`メソッドもします。</span><span class="sxs-lookup"><span data-stu-id="2f07f-380">Take a moment to update the `SELECT` clause in the `GetProductsByCategoryID(categoryID)` method as well.</span></span>

<span data-ttu-id="2f07f-381">更新する場合、 `GetProducts()` `SELECT`を使用して`JOIN`構文データセット デザイナーことはできませんを挿入する方法を自動生成を更新して、DB を使用してデータベース データの削除がパターンを転送します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-381">If you update the `GetProducts()` `SELECT` using `JOIN` syntax the DataSet Designer won't be able to auto-generate the methods for inserting, updating, and deleting database data using the DB direct pattern.</span></span> <span data-ttu-id="2f07f-382">代わりに、手動で作成するかなりと同じようにする必要があります、`InsertProduct`このチュートリアルで先ほどメソッドです。</span><span class="sxs-lookup"><span data-stu-id="2f07f-382">Instead, you'll have to manually create them much like we did with the `InsertProduct` method earlier in this tutorial.</span></span> <span data-ttu-id="2f07f-383">さらに、手動でする必要がありますを指定、 `InsertCommand`、 `UpdateCommand`、および`DeleteCommand`パターンの更新バッチを使用するプロパティの値します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-383">Furthermore, you'll manually have to provide the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` property values if you want to use the batch updating pattern.</span></span>

## <a name="adding-the-remaining-tableadapters"></a><span data-ttu-id="2f07f-384">残りの Tableadapter を追加します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-384">Adding the Remaining TableAdapters</span></span>

<span data-ttu-id="2f07f-385">ここでは、までのみを説明しました、単一データベース テーブルの 1 つの TableAdapter を使用します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-385">Up until now, we've only looked at working with a single TableAdapter for a single database table.</span></span> <span data-ttu-id="2f07f-386">ただし、Northwind データベースには、web アプリケーションで使用する必要がありますをいくつかの関連テーブルが含まれています。</span><span class="sxs-lookup"><span data-stu-id="2f07f-386">However, the Northwind database contains several related tables that we'll need to work with in our web application.</span></span> <span data-ttu-id="2f07f-387">データ テーブルに関連する型指定されたデータセットを複数含めることができます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-387">A Typed DataSet can contain multiple, related DataTables.</span></span> <span data-ttu-id="2f07f-388">そのため、当社 DAL を完了するこれらのチュートリアルで使用する他のテーブルのデータ テーブルを追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="2f07f-388">Therefore, to complete our DAL we need to add DataTables for the other tables we'll be using in these tutorials.</span></span> <span data-ttu-id="2f07f-389">型指定されたデータセットに新しい TableAdapter を追加するにはデータセット デザイナーを開く、デザイナーを右クリックし、追加 を選択/TableAdapter。</span><span class="sxs-lookup"><span data-stu-id="2f07f-389">To add a new TableAdapter to a Typed DataSet, open the DataSet Designer, right-click in the Designer, and choose Add / TableAdapter.</span></span> <span data-ttu-id="2f07f-390">新しい DataTable と TableAdapter が作成され、このチュートリアルで前に検査して、ウィザードの手順がこれです。</span><span class="sxs-lookup"><span data-stu-id="2f07f-390">This will create a new DataTable and TableAdapter and walk you through the wizard we examined earlier in this tutorial.</span></span>

<span data-ttu-id="2f07f-391">次の Tableadapter と次のクエリを使用してメソッドを作成するのには数分を取得します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-391">Take a few minutes to create the following TableAdapters and methods using the following queries.</span></span> <span data-ttu-id="2f07f-392">なお内のクエリ、`ProductsTableAdapter`各製品のカテゴリおよび仕入先名を取得するサブクエリを含めます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-392">Note that the queries in the `ProductsTableAdapter` include the subqueries to grab each product's category and supplier names.</span></span> <span data-ttu-id="2f07f-393">さらに、に従ってしたら、追加している場合既に、`ProductsTableAdapter`クラスの`GetProducts()`と`GetProductsByCategoryID(categoryID)`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="2f07f-393">Additionally, if you've been following along, you've already added the `ProductsTableAdapter` class's `GetProducts()` and `GetProductsByCategoryID(categoryID)` methods.</span></span>

- <span data-ttu-id="2f07f-394">**ProductsTableAdapter**</span><span class="sxs-lookup"><span data-stu-id="2f07f-394">**ProductsTableAdapter**</span></span>

  - <span data-ttu-id="2f07f-395">**GetProducts**:</span><span class="sxs-lookup"><span data-stu-id="2f07f-395">**GetProducts**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample10.sql)]
  - <span data-ttu-id="2f07f-396">**GetProductsByCategoryID**:</span><span class="sxs-lookup"><span data-stu-id="2f07f-396">**GetProductsByCategoryID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample11.sql)]
  - <span data-ttu-id="2f07f-397">**GetProductsBySupplierID**:</span><span class="sxs-lookup"><span data-stu-id="2f07f-397">**GetProductsBySupplierID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample12.sql)]
  - <span data-ttu-id="2f07f-398">**GetProductByProductID**:</span><span class="sxs-lookup"><span data-stu-id="2f07f-398">**GetProductByProductID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample13.sql)]
- <span data-ttu-id="2f07f-399">**CategoriesTableAdapter**</span><span class="sxs-lookup"><span data-stu-id="2f07f-399">**CategoriesTableAdapter**</span></span>

  - <span data-ttu-id="2f07f-400">**GetCategories**:</span><span class="sxs-lookup"><span data-stu-id="2f07f-400">**GetCategories**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample14.sql)]
  - <span data-ttu-id="2f07f-401">**GetCategoryByCategoryID**:</span><span class="sxs-lookup"><span data-stu-id="2f07f-401">**GetCategoryByCategoryID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample15.sql)]
- <span data-ttu-id="2f07f-402">**SuppliersTableAdapter**</span><span class="sxs-lookup"><span data-stu-id="2f07f-402">**SuppliersTableAdapter**</span></span>

  - <span data-ttu-id="2f07f-403">**GetSuppliers**:</span><span class="sxs-lookup"><span data-stu-id="2f07f-403">**GetSuppliers**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample16.sql)]
  - <span data-ttu-id="2f07f-404">**GetSuppliersByCountry**:</span><span class="sxs-lookup"><span data-stu-id="2f07f-404">**GetSuppliersByCountry**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample17.sql)]
  - <span data-ttu-id="2f07f-405">**GetSupplierBySupplierID**:</span><span class="sxs-lookup"><span data-stu-id="2f07f-405">**GetSupplierBySupplierID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample18.sql)]
- <span data-ttu-id="2f07f-406">**EmployeesTableAdapter**</span><span class="sxs-lookup"><span data-stu-id="2f07f-406">**EmployeesTableAdapter**</span></span>

  - <span data-ttu-id="2f07f-407">**GetEmployees**:</span><span class="sxs-lookup"><span data-stu-id="2f07f-407">**GetEmployees**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample19.sql)]
  - <span data-ttu-id="2f07f-408">**GetEmployeesByManager**:</span><span class="sxs-lookup"><span data-stu-id="2f07f-408">**GetEmployeesByManager**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample20.sql)]
  - <span data-ttu-id="2f07f-409">**GetEmployeeByEmployeeID**:</span><span class="sxs-lookup"><span data-stu-id="2f07f-409">**GetEmployeeByEmployeeID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample21.sql)]


<span data-ttu-id="2f07f-410">[![次の 4 つの Tableadapter を追加した後、データセット デザイナー](creating-a-data-access-layer-vb/_static/image84.png)](creating-a-data-access-layer-vb/_static/image83.png)</span><span class="sxs-lookup"><span data-stu-id="2f07f-410">[![The DataSet Designer After the Four TableAdapters Have Been Added](creating-a-data-access-layer-vb/_static/image84.png)](creating-a-data-access-layer-vb/_static/image83.png)</span></span>

<span data-ttu-id="2f07f-411">**図 31**:、データセット デザイナーの後に、次の 4 つ Tableadapter が追加されました ([フルサイズのイメージを表示するをクリックして](creating-a-data-access-layer-vb/_static/image85.png))</span><span class="sxs-lookup"><span data-stu-id="2f07f-411">**Figure 31**: The DataSet Designer After the Four TableAdapters Have Been Added ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image85.png))</span></span>


## <a name="adding-custom-code-to-the-dal"></a><span data-ttu-id="2f07f-412">DAL にカスタム コードを追加します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-412">Adding Custom Code to the DAL</span></span>

<span data-ttu-id="2f07f-413">Tableadapter と型指定されたデータセットに追加された Datatable は XML スキーマ定義ファイルとして表されます (`Northwind.xsd`)。</span><span class="sxs-lookup"><span data-stu-id="2f07f-413">The TableAdapters and DataTables added to the Typed DataSet are expressed as an XML Schema Definition file (`Northwind.xsd`).</span></span> <span data-ttu-id="2f07f-414">右クリックしてこのスキーマ情報を表示することができます、`Northwind.xsd`ソリューション エクスプ ローラーでファイルし、コードの表示を選択します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-414">You can view this schema information by right-clicking on the `Northwind.xsd` file in the Solution Explorer and choosing View Code.</span></span>


<span data-ttu-id="2f07f-415">[![型指定されたデータセットを Northwinds の XML スキーマ定義 (XSD) ファイル](creating-a-data-access-layer-vb/_static/image87.png)](creating-a-data-access-layer-vb/_static/image86.png)</span><span class="sxs-lookup"><span data-stu-id="2f07f-415">[![The XML Schema Definition (XSD) File for the Northwinds Typed DataSet](creating-a-data-access-layer-vb/_static/image87.png)](creating-a-data-access-layer-vb/_static/image86.png)</span></span>

<span data-ttu-id="2f07f-416">**図 32**: Northwinds 型指定されたデータセットの XML スキーマ定義 (XSD) ファイル ([フルサイズのイメージを表示するをクリックして](creating-a-data-access-layer-vb/_static/image88.png))</span><span class="sxs-lookup"><span data-stu-id="2f07f-416">**Figure 32**: The XML Schema Definition (XSD) File for the Northwinds Typed DataSet ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image88.png))</span></span>


<span data-ttu-id="2f07f-417">このスキーマ情報はデザイン時に c# または Visual Basic のコードに変換のコンパイル時または実行時に (必要な場合)、デバッガーでは、この時点でしてステップことができます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-417">This schema information is translated into C# or Visual Basic code at design time when compiled or at runtime (if needed), at which point you can step through it with the debugger.</span></span> <span data-ttu-id="2f07f-418">表示するには、この自動生成されたコードに移動クラス ビューおよびドリル、TableAdapter または型指定されたデータセット クラスにします。</span><span class="sxs-lookup"><span data-stu-id="2f07f-418">To view this auto-generated code go to the Class View and drill down to the TableAdapter or Typed DataSet classes.</span></span> <span data-ttu-id="2f07f-419">場合は、画面に、クラス ビューが表示されない、表示 メニューに移動し、そこから、選択または Ctrl + Shift + C をヒットします。</span><span class="sxs-lookup"><span data-stu-id="2f07f-419">If you don't see the Class View on your screen, go to the View menu and select it from there, or hit Ctrl+Shift+C.</span></span> <span data-ttu-id="2f07f-420">クラス ビューから、プロパティ、メソッド、および型指定されたデータセットと TableAdapter のクラスのイベントを表示できます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-420">From the Class View you can see the properties, methods, and events of the Typed DataSet and TableAdapter classes.</span></span> <span data-ttu-id="2f07f-421">特定のメソッドのコードを表示するには、クラス ビューでメソッド名をダブルクリックまたは上を右クリックし、定義へ移動します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-421">To view the code for a particular method, double-click the method name in the Class View or right-click on it and choose Go To Definition.</span></span>


![クラス ビューからの定義を選択すると、Go によって自動生成されたコードを調べる](creating-a-data-access-layer-vb/_static/image89.png)

<span data-ttu-id="2f07f-423">**図 33**: クラス ビューからの定義を選択すると、Go によって自動生成されたコードを調べる</span><span class="sxs-lookup"><span data-stu-id="2f07f-423">**Figure 33**: Inspect the Auto-Generated Code by Selecting Go To Definition from the Class View</span></span>


<span data-ttu-id="2f07f-424">自動生成されたコードは、最適な時間の節約が、コードは、多くの場合、非常に一般的なは、アプリケーションのニーズに合わせてカスタマイズする必要があります。</span><span class="sxs-lookup"><span data-stu-id="2f07f-424">While auto-generated code can be a great time saver, the code is often very generic and needs to be customized to meet the unique needs of an application.</span></span> <span data-ttu-id="2f07f-425">リスクを自動生成されたコードでは、拡張は、「再生成」と、カスタマイズの内容を上書きするときにコードを生成したツールが決定可能性があります。</span><span class="sxs-lookup"><span data-stu-id="2f07f-425">The risk of extending auto-generated code, though, is that the tool that generated the code might decide it's time to "regenerate" and overwrite your customizations.</span></span> <span data-ttu-id="2f07f-426">.NET 2.0 の新しい部分クラスの概念が簡単に複数のファイル、クラスを分割します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-426">With .NET 2.0's new partial class concept, it's easy to split a class across multiple files.</span></span> <span data-ttu-id="2f07f-427">これにより、自動生成されたクラスに、カスタマイズ設定を上書きしてクトリについて心配することがなく、独自のメソッド、プロパティ、およびイベントを追加することができます。</span><span class="sxs-lookup"><span data-stu-id="2f07f-427">This enables us to add our own methods, properties, and events to the auto-generated classes without having to worry about Visual Studio overwriting our customizations.</span></span>

<span data-ttu-id="2f07f-428">DAL をカスタマイズする方法を示すためには、追加、`GetProducts()`メソッドを`SuppliersRow`クラスです。</span><span class="sxs-lookup"><span data-stu-id="2f07f-428">To demonstrate how to customize the DAL, let's add a `GetProducts()` method to the `SuppliersRow` class.</span></span> <span data-ttu-id="2f07f-429">`SuppliersRow`クラスを表します。 1 つのレコード、`Suppliers`テーブル; 各仕入先のことができますプロバイダー 0、多くの製品にように`GetProducts()`は指定された業者の製品を返します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-429">The `SuppliersRow` class represents a single record in the `Suppliers` table; each supplier can provider zero to many products, so `GetProducts()` will return those products of the specified supplier.</span></span> <span data-ttu-id="2f07f-430">これを実現するクラスの新しいファイルが作成、`App_Code`という名前のフォルダー`SuppliersRow.vb`し、次のコードを追加します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-430">To accomplish this create a new class file in the `App_Code` folder named `SuppliersRow.vb` and add the following code:</span></span>

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample22.vb)]

<span data-ttu-id="2f07f-431">この部分クラスがコンパイラに指示する場合を構築、`Northwind.SuppliersRow`クラスを含める、`GetProducts()`定義したメソッド。</span><span class="sxs-lookup"><span data-stu-id="2f07f-431">This partial class instructs the compiler that when building the `Northwind.SuppliersRow` class to include the `GetProducts()` method we just defined.</span></span> <span data-ttu-id="2f07f-432">プロジェクトをビルドして、クラス ビューに戻るかどうかわかります`GetProducts()`のメソッドとして表示されるようになりました`Northwind.SuppliersRow`です。</span><span class="sxs-lookup"><span data-stu-id="2f07f-432">If you build your project and then return to the Class View you'll see `GetProducts()` now listed as a method of `Northwind.SuppliersRow`.</span></span>


![GetProducts() メソッドは、Northwind.SuppliersRow クラスの一部ようになりました](creating-a-data-access-layer-vb/_static/image90.png)

<span data-ttu-id="2f07f-434">**図 34**:`GetProducts()`メソッドの一部ではこれで、`Northwind.SuppliersRow`クラス</span><span class="sxs-lookup"><span data-stu-id="2f07f-434">**Figure 34**: The `GetProducts()` Method is Now Part of the `Northwind.SuppliersRow` Class</span></span>


<span data-ttu-id="2f07f-435">`GetProducts()`として、次のコードに示す特定の業者の製品のセットを列挙するメソッドを使用するようになりました。</span><span class="sxs-lookup"><span data-stu-id="2f07f-435">The `GetProducts()` method can now be used to enumerate the set of products for a particular supplier, as the following code shows:</span></span>

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample23.vb)]

<span data-ttu-id="2f07f-436">このデータは、ASP のいずれかにも表示されることができます。NET のデータの Web コントロールです。</span><span class="sxs-lookup"><span data-stu-id="2f07f-436">This data can also be displayed in any of ASP.NET's data Web controls.</span></span> <span data-ttu-id="2f07f-437">次のページは、2 つのフィールドの GridView コントロールを使用します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-437">The following page uses a GridView control with two fields:</span></span>

- <span data-ttu-id="2f07f-438">各仕入先の名前を表示する BoundField と</span><span class="sxs-lookup"><span data-stu-id="2f07f-438">A BoundField that displays the name of each supplier, and</span></span>
- <span data-ttu-id="2f07f-439">によって返される結果にバインドされている BulletedList コントロールを含む TemplateField、`GetProducts()`各仕入先のメソッドです。</span><span class="sxs-lookup"><span data-stu-id="2f07f-439">A TemplateField that contains a BulletedList control that is bound to the results returned by the `GetProducts()` method for each supplier.</span></span>

<span data-ttu-id="2f07f-440">今後のチュートリアルでこのようなマスター/詳細レポートを表示する方法について確認します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-440">We'll examine how to display such master-detail reports in future tutorials.</span></span> <span data-ttu-id="2f07f-441">追加するカスタム メソッドを使用して説明するためにここでは、この例の目的は、`Northwind.SuppliersRow`クラスです。</span><span class="sxs-lookup"><span data-stu-id="2f07f-441">For now, this example is designed to illustrate using the custom method added to the `Northwind.SuppliersRow` class.</span></span>

<span data-ttu-id="2f07f-442">SuppliersAndProducts.aspx</span><span class="sxs-lookup"><span data-stu-id="2f07f-442">SuppliersAndProducts.aspx</span></span>

[!code-aspx[Main](creating-a-data-access-layer-vb/samples/sample24.aspx)]

<span data-ttu-id="2f07f-443">SuppliersAndProducts.aspx.vb</span><span class="sxs-lookup"><span data-stu-id="2f07f-443">SuppliersAndProducts.aspx.vb</span></span>

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample25.vb)]


<span data-ttu-id="2f07f-444">[![左の列、右側にその製品に、業者の会社の名前が表示されません。](creating-a-data-access-layer-vb/_static/image92.png)](creating-a-data-access-layer-vb/_static/image91.png)</span><span class="sxs-lookup"><span data-stu-id="2f07f-444">[![The Supplier's Company Name is Listed in the Left Column, Their Products in the Right](creating-a-data-access-layer-vb/_static/image92.png)](creating-a-data-access-layer-vb/_static/image91.png)</span></span>

<span data-ttu-id="2f07f-445">**図 35**: の左側の列で、右側にその製品の仕入先の会社名が表示されている ([フルサイズのイメージを表示するをクリックして](creating-a-data-access-layer-vb/_static/image93.png))</span><span class="sxs-lookup"><span data-stu-id="2f07f-445">**Figure 35**: The Supplier's Company Name is Listed in the Left Column, Their Products in the Right ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image93.png))</span></span>


## <a name="summary"></a><span data-ttu-id="2f07f-446">まとめ</span><span class="sxs-lookup"><span data-stu-id="2f07f-446">Summary</span></span>

<span data-ttu-id="2f07f-447">ときに、DAL を作成する web アプリケーションを構築する必要があります、プレゼンテーション層の作成を開始する前に発生している、最初の手順のいずれか。</span><span class="sxs-lookup"><span data-stu-id="2f07f-447">When building a web application creating the DAL should be one of your first steps, occurring before you start creating your presentation layer.</span></span> <span data-ttu-id="2f07f-448">Visual studio とは、行のコードを記述することがなく、10 ~ 15 分単位で実行できるタスクには型指定されたデータセットに基づく DAL の作成です。</span><span class="sxs-lookup"><span data-stu-id="2f07f-448">With Visual Studio, creating a DAL based on Typed DataSets is a task that can be accomplished in 10-15 minutes without writing a line of code.</span></span> <span data-ttu-id="2f07f-449">進むチュートリアルは、この DAL に基づいて構築します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-449">The tutorials moving forward will build upon this DAL.</span></span> <span data-ttu-id="2f07f-450">[次のチュートリアル](creating-a-business-logic-layer-vb.md)うまくビジネス ルールの数を定義し、別のビジネス ロジック層でそれらを実装する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-450">In the [next tutorial](creating-a-business-logic-layer-vb.md) we'll define a number of business rules and see how to implement them in a separate Business Logic Layer.</span></span>

<span data-ttu-id="2f07f-451">満足プログラミング!</span><span class="sxs-lookup"><span data-stu-id="2f07f-451">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="2f07f-452">関連項目</span><span class="sxs-lookup"><span data-stu-id="2f07f-452">Further Reading</span></span>

<span data-ttu-id="2f07f-453">このチュートリアルで説明したトピックの詳細については、次の情報を参照してください。</span><span class="sxs-lookup"><span data-stu-id="2f07f-453">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="2f07f-454">厳密に型指定された Tableadapter と VS 2005 と ASP.NET 2.0 でのデータ テーブルを使用して、DAL の構築</span><span class="sxs-lookup"><span data-stu-id="2f07f-454">Building a DAL using Strongly Typed TableAdapters and DataTables in VS 2005 and ASP.NET 2.0</span></span>](https://weblogs.asp.net/scottgu/435498)
- [<span data-ttu-id="2f07f-455">データ層のコンポーネントを設計し、層間のデータを渡す</span><span class="sxs-lookup"><span data-stu-id="2f07f-455">Designing Data Tier Components and Passing Data Through Tiers</span></span>](https://msdn.microsoft.com/library/ms978496.aspx)
- [<span data-ttu-id="2f07f-456">Visual Studio 2005 のデータセット デザイナーでのデータ アクセス層をビルドします。</span><span class="sxs-lookup"><span data-stu-id="2f07f-456">Build a Data Access Layer with the Visual Studio 2005 DataSet Designer</span></span>](http://www.theserverside.net/articles/showarticle.tss?id=DataSetDesigner)
- [<span data-ttu-id="2f07f-457">ASP.NET 2.0 の構成情報の暗号化アプリケーション</span><span class="sxs-lookup"><span data-stu-id="2f07f-457">Encrypting Configuration Information in ASP.NET 2.0 Applications</span></span>](http://aspnet.4guysfromrolla.com/articles/021506-1.aspx)
- [<span data-ttu-id="2f07f-458">TableAdapter の概要</span><span class="sxs-lookup"><span data-stu-id="2f07f-458">TableAdapter Overview</span></span>](https://msdn.microsoft.com/library/bz9tthwx.aspx)
- [<span data-ttu-id="2f07f-459">指定されたデータセットの操作</span><span class="sxs-lookup"><span data-stu-id="2f07f-459">Working with a Typed DataSet</span></span>](https://msdn.microsoft.com/library/esbykkzb.aspx)
- [<span data-ttu-id="2f07f-460">Visual Studio 2005 と ASP.NET 2.0 での厳密に型指定されたデータ アクセスを使用します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-460">Using Strongly-Typed Data Access in Visual Studio 2005 and ASP.NET 2.0</span></span>](http://aspnet.4guysfromrolla.com/articles/020806-1.aspx)
- [<span data-ttu-id="2f07f-461">TableAdapter のメソッドを拡張する方法</span><span class="sxs-lookup"><span data-stu-id="2f07f-461">How to Extend TableAdapter Methods</span></span>](https://blogs.msdn.com/vbteam/archive/2005/05/04/ExtendingTableAdapters.aspx)
- [<span data-ttu-id="2f07f-462">ストアド プロシージャからのスカラー データの取得</span><span class="sxs-lookup"><span data-stu-id="2f07f-462">Retrieving Scalar Data from a Stored Procedure</span></span>](http://aspnet.4guysfromrolla.com/articles/062905-1.aspx)

### <a name="video-training-on-topics-contained-in-this-tutorial"></a><span data-ttu-id="2f07f-463">このチュートリアルに含まれるトピックに関するビデオ トレーニング</span><span class="sxs-lookup"><span data-stu-id="2f07f-463">Video Training on Topics Contained in this Tutorial</span></span>

- [<span data-ttu-id="2f07f-464">ASP.NET アプリケーションのデータ アクセス層</span><span class="sxs-lookup"><span data-stu-id="2f07f-464">Data Access Layers in ASP.NET Applications</span></span>](../../../videos/data-access/adonet-data-services/data-access-layers-in-aspnet-applications.md)
- [<span data-ttu-id="2f07f-465">データ グリッドに、データセットを手動でバインドする方法</span><span class="sxs-lookup"><span data-stu-id="2f07f-465">How to Manually Bind a Dataset to a Datagrid</span></span>](../../../videos/data-access/adonet-data-services/how-to-manually-bind-a-dataset-to-a-datagrid.md)
- [<span data-ttu-id="2f07f-466">ASP アプリケーションからのデータセットとフィルターを操作する方法</span><span class="sxs-lookup"><span data-stu-id="2f07f-466">How to Work with Datasets and Filters from an ASP Application</span></span>](../../../videos/data-access/adonet-data-services/how-to-work-with-datasets-and-filters-from-an-asp-application.md)

## <a name="about-the-author"></a><span data-ttu-id="2f07f-467">作成者について</span><span class="sxs-lookup"><span data-stu-id="2f07f-467">About the Author</span></span>

<span data-ttu-id="2f07f-468">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)、7 つ受け取りますブックとの創設者の作成者[4GuysFromRolla.com](http://www.4guysfromrolla.com)、1998 年からマイクロソフトの Web テクノロジで取り組んできました。</span><span class="sxs-lookup"><span data-stu-id="2f07f-468">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="2f07f-469">Scott は、コンサルタント、トレーナー、ライターとして機能します。</span><span class="sxs-lookup"><span data-stu-id="2f07f-469">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="2f07f-470">最新の著書[ *Sam 学べる自分で ASP.NET 2.0 が 24 時間以内に*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)です。</span><span class="sxs-lookup"><span data-stu-id="2f07f-470">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="2f07f-471">彼に到達できる[ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)彼のブログを使用して含まれているのか[ http://ScottOnWriting.NET](http://ScottOnWriting.NET)です。</span><span class="sxs-lookup"><span data-stu-id="2f07f-471">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="2f07f-472">感謝の特別な</span><span class="sxs-lookup"><span data-stu-id="2f07f-472">Special Thanks To</span></span>

<span data-ttu-id="2f07f-473">このチュートリアルの系列は既に多くの便利なレビュー担当者によって確認済みです。</span><span class="sxs-lookup"><span data-stu-id="2f07f-473">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="2f07f-474">このチュートリアルの潜在顧客レビュー担当者は、Ron 緑、Hilton Giesenow、Dennis Patterson、Liz Shulok、Abel Gomez、および Carlos Santos でした。</span><span class="sxs-lookup"><span data-stu-id="2f07f-474">Lead reviewers for this tutorial were Ron Green, Hilton Giesenow, Dennis Patterson, Liz Shulok, Abel Gomez, and Carlos Santos.</span></span> <span data-ttu-id="2f07f-475">今後、MSDN の記事を確認することに関心のあるですか。</span><span class="sxs-lookup"><span data-stu-id="2f07f-475">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="2f07f-476">場合は、ドロップ me 一度に 1 行ずつ[mitchell@4GuysFromRolla.comです。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="2f07f-476">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="2f07f-477">[前へ](master-pages-and-site-navigation-cs.md)
> [次へ](creating-a-business-logic-layer-vb.md)</span><span class="sxs-lookup"><span data-stu-id="2f07f-477">[Previous](master-pages-and-site-navigation-cs.md)
[Next](creating-a-business-logic-layer-vb.md)</span></span>
