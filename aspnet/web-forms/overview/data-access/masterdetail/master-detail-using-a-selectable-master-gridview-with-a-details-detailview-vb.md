---
uid: web-forms/overview/data-access/masterdetail/master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb
title: "マスター/詳細詳細 DetailView (VB) で選択可能なマスター GridView の使用 |Microsoft ドキュメント"
author: rick-anderson
description: "このチュートリアルでは、行が選択ボタンと共に、各製品の価格と名前を含む GridView があります。 A particu の選択 ボタンをクリックするとしています."
ms.author: aspnetcontent
manager: wpickett
ms.date: 03/31/2010
ms.topic: article
ms.assetid: 1d1a7c93-971d-4690-9c5e-dac0e5014a09
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/masterdetail/master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb
msc.type: authoredcontent
ms.openlocfilehash: 0db9bf25ce61c31dd8258aaebadf42e7738473ab
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/10/2017
---
<a name="masterdetail-using-a-selectable-master-gridview-with-a-details-detailview-vb"></a><span data-ttu-id="3d5f3-104">マスター/詳細詳細 DetailView (VB) で選択可能なマスター GridView の使用</span><span class="sxs-lookup"><span data-stu-id="3d5f3-104">Master/Detail Using a Selectable Master GridView with a Details DetailView (VB)</span></span>
====================
<span data-ttu-id="3d5f3-105">によって[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="3d5f3-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="3d5f3-106">[サンプル アプリをダウンロード](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_10_VB.exe)または[PDF のダウンロード](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/datatutorial10vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="3d5f3-106">[Download Sample App](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_10_VB.exe) or [Download PDF](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/datatutorial10vb1.pdf)</span></span>

> <span data-ttu-id="3d5f3-107">このチュートリアルでは、行が選択ボタンと共に、各製品の価格と名前を含む GridView があります。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-107">This tutorial will have a GridView whose rows include the name and price of each product along with a Select button.</span></span> <span data-ttu-id="3d5f3-108">特定の製品を選択 ボタンをクリックすると、同じページ上の DetailsView コントロールに表示される、完全な詳細情報が発生します。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-108">Clicking the Select button for a particular product will cause its full details to be displayed in a DetailsView control on the same page.</span></span>


## <a name="introduction"></a><span data-ttu-id="3d5f3-109">はじめに</span><span class="sxs-lookup"><span data-stu-id="3d5f3-109">Introduction</span></span>

<span data-ttu-id="3d5f3-110">[前のチュートリアル](master-detail-filtering-across-two-pages-vb.md)2 つの web ページを使用してマスター/詳細レポートを作成する方法を説明しました"マスター"web ページが、suppliers; の一覧を表示お元となると、選択したによって提供されるこれらの製品を一覧表示"details"web ページ。供給業者です。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-110">In the [previous tutorial](master-detail-filtering-across-two-pages-vb.md) we saw how to create a master/detail report using two web pages: a "master" web page, from which we displayed the list of suppliers; and a "details" web page that listed those products provided by the selected supplier.</span></span> <span data-ttu-id="3d5f3-111">この 2 つのページのレポート形式は、1 つのページに凝縮ことができます。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-111">This two page report format can be condensed into one page.</span></span> <span data-ttu-id="3d5f3-112">このチュートリアルでは、行が選択ボタンと共に、各製品の価格と名前を含む GridView があります。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-112">This tutorial will have a GridView whose rows include the name and price of each product along with a Select button.</span></span> <span data-ttu-id="3d5f3-113">特定の製品を選択 ボタンをクリックすると、同じページ上の DetailsView コントロールに表示される、完全な詳細情報が発生します。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-113">Clicking the Select button for a particular product will cause its full details to be displayed in a DetailsView control on the same page.</span></span>


<span data-ttu-id="3d5f3-114">[![[選択] ボタンをクリックするとには、製品の詳細が表示されます。](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image2.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="3d5f3-114">[![Clicking the Select Button Displays the Product's Details](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image2.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image1.png)</span></span>

<span data-ttu-id="3d5f3-115">**図 1**: 製品の詳細を表示する [選択] ボタンをクリックすると ([フルサイズのイメージを表示するをクリックして](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="3d5f3-115">**Figure 1**: Clicking the Select Button Displays the Product's Details ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image3.png))</span></span>


## <a name="step-1-creating-a-selectable-gridview"></a><span data-ttu-id="3d5f3-116">手順 1: 選択可能な GridView の作成</span><span class="sxs-lookup"><span data-stu-id="3d5f3-116">Step 1: Creating a Selectable GridView</span></span>

<span data-ttu-id="3d5f3-117">マスター/詳細の 2 ページにハイパーリンクが master の各レコードに含まれていることを報告する取り消しをクリックすると、ユーザーをクリックした行を渡すことの詳細 ページに送信される`SupplierID`クエリ文字列の値。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-117">Recall that in the two-page master/detail report that each master record included a hyperlink that, when clicked, sent the user to the details page passing the clicked row's `SupplierID` value in the querystring.</span></span> <span data-ttu-id="3d5f3-118">このようなハイパーリンクは、内を使用して GridView 行ごとに追加されました。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-118">Such a hyperlink was added to each GridView row using a HyperLinkField.</span></span> <span data-ttu-id="3d5f3-119">1 つのページのマスター/詳細レポートは必要があります、ボタンをクリックすると、各 GridView 行の詳細が表示されます。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-119">For the single page master/details report, we will need a Button for each GridView row that, when clicked, shows the details.</span></span> <span data-ttu-id="3d5f3-120">GridView コントロールは、ポストバックを発生させるし、その行を GridView のとしてマークする各行の選択 ボタンを含めるように構成できる[SelectedRow](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.selectedrow.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-120">The GridView control can be configured to include a Select button for each row that causes a postback and marks that row as the GridView's [SelectedRow](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.selectedrow.aspx).</span></span>

<span data-ttu-id="3d5f3-121">GridView コントロールを追加することで開始、 `DetailsBySelecting.aspx`  ページで、`Filtering`設定、フォルダー、`ID`プロパティを`ProductsGrid`です。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-121">Start by adding a GridView control to the `DetailsBySelecting.aspx` page in the `Filtering` folder, setting its `ID` property to `ProductsGrid`.</span></span> <span data-ttu-id="3d5f3-122">次に、追加という名前の新しい ObjectDataSource`AllProductsDataSource`を呼び出す、`ProductsBLL`クラスの`GetProducts()`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-122">Next, add a new ObjectDataSource named `AllProductsDataSource` that invokes the `ProductsBLL` class's `GetProducts()` method.</span></span>


<span data-ttu-id="3d5f3-123">[![ObjectDataSource AllProductsDataSource をという名前の作成します。](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image5.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="3d5f3-123">[![Create an ObjectDataSource Named AllProductsDataSource](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image5.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image4.png)</span></span>

<span data-ttu-id="3d5f3-124">**図 2**: 名前付き、ObjectDataSource 作成`AllProductsDataSource`([フルサイズのイメージを表示するをクリックして](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="3d5f3-124">**Figure 2**: Create an ObjectDataSource Named `AllProductsDataSource` ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image6.png))</span></span>


<span data-ttu-id="3d5f3-125">[![ProductsBLL クラスを使用します。](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image8.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="3d5f3-125">[![Use the ProductsBLL Class](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image8.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image7.png)</span></span>

<span data-ttu-id="3d5f3-126">**図 3**: を使用して、`ProductsBLL`クラス ([フルサイズのイメージを表示するをクリックして](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="3d5f3-126">**Figure 3**: Use the `ProductsBLL` Class ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image9.png))</span></span>


<span data-ttu-id="3d5f3-127">[![ObjectDataSource GetProducts() メソッドを呼び出すための構成します。](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image11.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="3d5f3-127">[![Configure the ObjectDataSource to Invoke the GetProducts() Method](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image11.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image10.png)</span></span>

<span data-ttu-id="3d5f3-128">**図 4**: 構成 invoke ObjectDataSource、`GetProducts()`メソッド ([フルサイズのイメージを表示するをクリックして](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="3d5f3-128">**Figure 4**: Configure the ObjectDataSource to Invoke the `GetProducts()` Method ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image12.png))</span></span>


<span data-ttu-id="3d5f3-129">削除する GridView のフィールドを編集以外のすべての`ProductName`と`UnitPrice`BoundFields です。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-129">Edit the GridView's fields removing all but the `ProductName` and `UnitPrice` BoundFields.</span></span> <span data-ttu-id="3d5f3-130">また、自由に書式設定など、必要に応じてこれら BoundFields をカスタマイズする、`UnitPrice`通貨として BoundField を変更して、 `HeaderText` BoundFields のプロパティです。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-130">Also, feel free to customize these BoundFields as needed, such as formatting the `UnitPrice` BoundField as a currency and changing the `HeaderText` properties of the BoundFields.</span></span> <span data-ttu-id="3d5f3-131">次の手順は、GridView のスマート タグからの列の編集リンクをクリックするか、宣言の構文を手動で構成することによって、視覚的に、実現できます。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-131">These steps can be accomplished graphically, by clicking the Edit Columns link from the GridView's smart tag, or by manually configuring the declarative syntax.</span></span>


<span data-ttu-id="3d5f3-132">[![ProductName および UnitPrice BoundFields 以外はすべて削除します。](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image14.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="3d5f3-132">[![Remove All But the ProductName and UnitPrice BoundFields](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image14.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image13.png)</span></span>

<span data-ttu-id="3d5f3-133">**図 5**: 削除が、`ProductName`と`UnitPrice`BoundFields ([フルサイズのイメージを表示するをクリックして](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="3d5f3-133">**Figure 5**: Remove All But the `ProductName` and `UnitPrice` BoundFields ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image15.png))</span></span>


<span data-ttu-id="3d5f3-134">GridView の最終的なマークアップは次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-134">The final markup for the GridView is:</span></span>


[!code-aspx[Main](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/samples/sample1.aspx)]

<span data-ttu-id="3d5f3-135">次に、それぞれの行に [選択] ボタンを追加、選択可能として GridView をマークする必要があります。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-135">Next, we need to mark the GridView as selectable, which will add a Select button to each row.</span></span> <span data-ttu-id="3d5f3-136">これを実現するには、GridView のスマート タグの選択を有効にするチェック ボックスを簡単にチェックします。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-136">To accomplish this, simply check the Enable Selection checkbox in the GridView's smart tag.</span></span>


<span data-ttu-id="3d5f3-137">[![GridView の行を選択できるように](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image17.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="3d5f3-137">[![Make the GridView's Rows Selectable](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image17.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image16.png)</span></span>

<span data-ttu-id="3d5f3-138">**図 6**: GridView の行を選択できるように ([フルサイズのイメージを表示するをクリックして](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="3d5f3-138">**Figure 6**: Make the GridView's Rows Selectable ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image18.png))</span></span>


<span data-ttu-id="3d5f3-139">CommandField を追加、選択範囲を有効にする チェック、 `ProductsGrid` GridView その`ShowSelectButton`プロパティを True に設定します。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-139">Checking the Enabling Selection option adds a CommandField to the `ProductsGrid` GridView with its `ShowSelectButton` property set to True.</span></span> <span data-ttu-id="3d5f3-140">これは、結果 [選択] ボタン、GridView の行ごとに図 6 に示すようになります。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-140">This results in a Select button for each row of the GridView, as Figure 6 illustrates.</span></span> <span data-ttu-id="3d5f3-141">既定では、選択ボタンがある、としてレンダリングされますが使用できるボタンまたは ImageButtons 代わりに CommandField のを通じて`ButtonType`プロパティです。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-141">By default, the Select buttons are rendered as LinkButtons, but you can use Buttons or ImageButtons instead through the CommandField's `ButtonType` property.</span></span>


[!code-aspx[Main](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/samples/sample2.aspx)]

<span data-ttu-id="3d5f3-142">ポストバックに陥ります GridView 行の選択 ボタンがクリックされたときに、GridView の`SelectedRow`プロパティを更新します。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-142">When a GridView row's Select button is clicked a postback ensues and the GridView's `SelectedRow` property is updated.</span></span> <span data-ttu-id="3d5f3-143">加え、`SelectedRow`プロパティ、GridView のでは、 [SelectedIndex](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.selectedindex%28VS.80%29.aspx)、 [SelectedValue](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.selectedvalue%28VS.80%29.aspx)、および[SelectedDataKey](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.selecteddatakey%28VS.80%29.aspx)プロパティです。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-143">In addition to the `SelectedRow` property, the GridView provides the [SelectedIndex](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.selectedindex%28VS.80%29.aspx), [SelectedValue](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.selectedvalue%28VS.80%29.aspx), and [SelectedDataKey](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.selecteddatakey%28VS.80%29.aspx) properties.</span></span> <span data-ttu-id="3d5f3-144">`SelectedIndex`一方、プロパティが選択した行のインデックスを返します、`SelectedValue`と`SelectedDataKey`プロパティ GridView のに基づいて値を返します[DataKeyNames プロパティ](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.datakeynames%28VS.80%29.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-144">The `SelectedIndex` property returns the index of the selected row, whereas the `SelectedValue` and `SelectedDataKey` properties return values based upon the GridView's [DataKeyNames property](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.datakeynames%28VS.80%29.aspx).</span></span>

<span data-ttu-id="3d5f3-145">`DataKeyNames`に関連付けるプロパティを使用または複数のデータ フィールド、各行の値を GridView の各行と基になるデータから一意に識別する情報を属性に一般的に使用します。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-145">The `DataKeyNames` property is used to associate one or more data field values with each row and is commonly used to attribute uniquely identifying information from the underlying data with each GridView row.</span></span> <span data-ttu-id="3d5f3-146">`SelectedValue`プロパティは、最初の値を返します`DataKeyNames`選択した行のデータ フィールドが該当します、`SelectedDataKey`プロパティは、選択した行を返します`DataKey`オブジェクトで、すべての指定されたデータのキー フィールドの値が含まれます。該当する行。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-146">The `SelectedValue` property returns the value of the first `DataKeyNames` data field for the selected row where as the `SelectedDataKey` property returns the selected row's `DataKey` object, which contains all of the values for the specified data key fields for that row.</span></span>

<span data-ttu-id="3d5f3-147">`DataKeyNames`プロパティは、GridView、DetailsView、または、デザイナーによる FormView をデータ ソースをバインドすると、自動的に一意に識別するデータ フィールドに設定します。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-147">The `DataKeyNames` property is automatically set to the uniquely-identifying data field(s) when you bind a data source to a GridView, DetailsView, or FormView through the Designer.</span></span> <span data-ttu-id="3d5f3-148">このプロパティが設定されてうえで自動的に前のチュートリアルで中の例が操作していたせず、`DataKeyNames`指定されたプロパティ。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-148">While this property has been set for us automatically in the preceding tutorials, the examples would have worked without the `DataKeyNames` property specified.</span></span> <span data-ttu-id="3d5f3-149">ただし、このチュートリアルでは選択可能な GridView のだけでなくをおを確認する挿入、更新、および削除すると、今後のチュートリアルについては、`DataKeyNames`プロパティを適切に設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-149">However, for the selectable GridView in this tutorial, as well as for future tutorials in which we'll be examining inserting, updating, and deleting, the `DataKeyNames` property must be set properly.</span></span> <span data-ttu-id="3d5f3-150">GridView を確実に少し時間を取って`DataKeyNames`プロパティに設定されている`ProductID`です。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-150">Take a moment to ensure that your GridView's `DataKeyNames` property is set to `ProductID`.</span></span>

<span data-ttu-id="3d5f3-151">ブラウザーを使ってこれまで、進行状況を表示します。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-151">Let's view our progress thus far through a browser.</span></span> <span data-ttu-id="3d5f3-152">GridView には、すべての選択の LinkButton と共に製品の価格と名前が一覧表示されるに注意してください。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-152">Note that the GridView lists the name and price for all of the products along with a Select LinkButton.</span></span> <span data-ttu-id="3d5f3-153">[選択] ボタンをクリックすると、ポストバックが発生します。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-153">Clicking the Select button causes a postback.</span></span> <span data-ttu-id="3d5f3-154">手順 2. で選択した製品の詳細を表示することによってこのポストバックに DetailsView 応答する方法を会いしましょう。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-154">In Step 2 we'll see how to have a DetailsView respond to this postback by displaying the details for the selected product.</span></span>


<span data-ttu-id="3d5f3-155">[![各製品の行には、Select LinkButton が含まれています。](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image20.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="3d5f3-155">[![Each Product Row Contains a Select LinkButton](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image20.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image19.png)</span></span>

<span data-ttu-id="3d5f3-156">**図 7**: 各製品の行には、選択の LinkButton が含まれています ([フルサイズのイメージを表示するをクリックして](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="3d5f3-156">**Figure 7**: Each Product Row Contains a Select LinkButton ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image21.png))</span></span>


## <a name="highlighting-the-selected-row"></a><span data-ttu-id="3d5f3-157">選択した行の強調表示</span><span class="sxs-lookup"><span data-stu-id="3d5f3-157">Highlighting the Selected Row</span></span>

<span data-ttu-id="3d5f3-158">`ProductsGrid` GridView は、`SelectedRowStyle`プロパティが選択した行の visual スタイルをディクテーションを使用できます。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-158">The `ProductsGrid` GridView has a `SelectedRowStyle` property that can be used to dictate the visual style for the selected row.</span></span> <span data-ttu-id="3d5f3-159">正しく使用すると、詳細を明確に示す GridView の行が現在選択されているで、ユーザーのエクスペリエンスを向上このできます。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-159">Used properly, this can improve the user's experience by more clearly showing which row of the GridView is currently selected.</span></span> <span data-ttu-id="3d5f3-160">このチュートリアルでは、黄色の背景色で強調表示する、選択した行があてみましょう。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-160">For this tutorial, let's have the selected row be highlighted with a yellow background.</span></span>

<span data-ttu-id="3d5f3-161">同様に、前のチュートリアルは、CSS クラスとして定義されている美しさに関連する設定をそのまま目指していましてみましょう。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-161">As with our earlier tutorials, let's strive to keep the aesthetic-related settings defined as CSS classes.</span></span> <span data-ttu-id="3d5f3-162">そのため、クラスを作成、新しい CSS`Styles.css`という`SelectedRowStyle`です。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-162">Therefore, create a new CSS class in `Styles.css` named `SelectedRowStyle`.</span></span>


[!code-css[Main](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/samples/sample3.css)]

<span data-ttu-id="3d5f3-163">この CSS クラスを適用する、`SelectedRowStyle`プロパティの*すべて*シリーズでは、チュートリアル、Gridview の編集、`GridView.skin`のスキン、`DataWebControls`に含めるテーマ、`SelectedRowStyle`次に示すように設定。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-163">To apply this CSS class to the `SelectedRowStyle` property of *all* GridViews in our tutorial series, edit the `GridView.skin` Skin in the `DataWebControls` Theme to include the `SelectedRowStyle` settings as shown below:</span></span>


[!code-aspx[Main](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/samples/sample4.aspx)]

<span data-ttu-id="3d5f3-164">このさらに、選択された GridView 行は今すぐ黄色の背景色で強調表示されます。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-164">With this addition, the selected GridView row is now highlighted with a yellow background color.</span></span>


<span data-ttu-id="3d5f3-165">[![GridView の SelectedRowStyle プロパティを使用して、選択した行の外観をカスタマイズします。](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image23.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="3d5f3-165">[![Customize the Selected Row's Appearance Using the GridView's SelectedRowStyle Property](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image23.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image22.png)</span></span>

<span data-ttu-id="3d5f3-166">**図 8**: GridView のカスタマイズ、選択した行の外観を使用して`SelectedRowStyle`プロパティ ([フルサイズのイメージを表示するをクリックして](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="3d5f3-166">**Figure 8**: Customize the Selected Row's Appearance Using the GridView's `SelectedRowStyle` Property ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image24.png))</span></span>


## <a name="step-2-displaying-the-selected-products-details-in-a-detailsview"></a><span data-ttu-id="3d5f3-167">手順 2: DetailsView で選択した製品の詳細を表示します。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-167">Step 2: Displaying the Selected Product's Details in a DetailsView</span></span>

<span data-ttu-id="3d5f3-168">`ProductsGrid` GridView すべてを完了、選択した特定の製品に関する情報を表示する DetailsView を追加しています。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-168">With the `ProductsGrid` GridView complete, all that remains is to add a DetailsView that displays information about the particular product selected.</span></span> <span data-ttu-id="3d5f3-169">GridView 上 DetailsView コントロールを追加し、作成という名前の新しい ObjectDataSource`ProductDetailsDataSource`です。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-169">Add a DetailsView control above the GridView and create a new ObjectDataSource named `ProductDetailsDataSource`.</span></span> <span data-ttu-id="3d5f3-170">選択した製品に関する特定の情報を表示するには、この DetailsView ので、構成、`ProductDetailsDataSource`を使用する、`ProductsBLL`クラスの`GetProductByProductID(productID)`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-170">Since we want this DetailsView to display particular information about the selected product, configure the `ProductDetailsDataSource` to use the `ProductsBLL` class's `GetProductByProductID(productID)` method.</span></span>


<span data-ttu-id="3d5f3-171">[![ProductsBLL クラスの GetProductByProductID(productID) メソッドを呼び出す](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image26.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="3d5f3-171">[![Invoke the ProductsBLL Class's GetProductByProductID(productID) Method](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image26.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image25.png)</span></span>

<span data-ttu-id="3d5f3-172">**図 9**: 呼び出し、`ProductsBLL`クラスの`GetProductByProductID(productID)`メソッド ([フルサイズのイメージを表示するをクリックして](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="3d5f3-172">**Figure 9**: Invoke the `ProductsBLL` Class's `GetProductByProductID(productID)` Method ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image27.png))</span></span>


<span data-ttu-id="3d5f3-173"> *`productID`*  GridView コントロールから得られたパラメーターの値`SelectedValue`プロパティです。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-173">Have the *`productID`* parameter's value obtained from the GridView control's `SelectedValue` property.</span></span> <span data-ttu-id="3d5f3-174">以前、GridView に説明したよう`SelectedValue`プロパティは、最初のデータ キーの選択した行の値を返します。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-174">As we discussed earlier, the GridView's `SelectedValue` property returns the first data key value for the selected row.</span></span> <span data-ttu-id="3d5f3-175">そのため、命令型を GridView の`DataKeyNames`プロパティに設定されている`ProductID`いるため、選択した行の`ProductID`によって値が返される`SelectedValue`です。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-175">Therefore, it's imperative that the GridView's `DataKeyNames` property is set to `ProductID`, so that the selected row's `ProductID` value is returned by `SelectedValue`.</span></span>


<span data-ttu-id="3d5f3-176">[![GridView の SelectedValue プロパティに、productID パラメーターを設定します。](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image29.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="3d5f3-176">[![Set the productID Parameter to the GridView's SelectedValue Property](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image29.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image28.png)</span></span>

<span data-ttu-id="3d5f3-177">**図 10**: 設定、  *`productID`* パラメーターを GridView の`SelectedValue`プロパティ ([フルサイズのイメージを表示するをクリックして](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="3d5f3-177">**Figure 10**: Set the *`productID`* Parameter to the GridView's `SelectedValue` Property ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image30.png))</span></span>


<span data-ttu-id="3d5f3-178">1 回、 `productDetailsDataSource` ObjectDataSource を正しく構成されていて、DetailsView にバインドされている、このチュートリアルは終了です。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-178">Once the `productDetailsDataSource` ObjectDataSource has been configured correctly and bound to the DetailsView, this tutorial is complete!</span></span> <span data-ttu-id="3d5f3-179">ページが初めてアクセスしたときに行が選択されていないため、GridView の`SelectedValue`プロパティから返される`Nothing`です。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-179">When the page is first visited no row is selected, so the GridView's `SelectedValue` property returns `Nothing`.</span></span> <span data-ttu-id="3d5f3-180">製品ではないため、 `NULL` `ProductID`値、レコードは返されませんでしたが、 `GetProductByProductID(productID)` DetailsView が表示されていないことを意味しているメソッド (図 11 を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-180">Since there are no products with a `NULL` `ProductID` value, no records are returned by the `GetProductByProductID(productID)` method, meaning that the DetailsView isn't displayed (see Figure 11).</span></span> <span data-ttu-id="3d5f3-181">GridView の行の選択 ボタンをクリックすると、ポストバックに陥ります、DetailsView は更新されます。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-181">Upon clicking a GridView row's Select button, a postback ensues and the DetailsView is refreshed.</span></span> <span data-ttu-id="3d5f3-182">今回は、GridView の`SelectedValue`プロパティから返される、`ProductID`選択した行の`GetProductByProductID(productID)`メソッドを返します。、`ProductsDataTable`に関する情報を特定の製品、および DetailsView には、これらの詳細を示しています (図 12 を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-182">This time the GridView's `SelectedValue` property returns the `ProductID` of the selected row, the `GetProductByProductID(productID)` method returns a `ProductsDataTable` with information about that particular product, and the DetailsView shows these details (see Figure 12).</span></span>


<span data-ttu-id="3d5f3-183">[![最初の閲覧、GridView のみが表示される場合](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image32.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="3d5f3-183">[![When First Visited, Only the GridView is Displayed](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image32.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image31.png)</span></span>

<span data-ttu-id="3d5f3-184">**図 11**: 最初にアクセスされる GridView のみが表示されます ([フルサイズのイメージを表示するをクリックして](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="3d5f3-184">**Figure 11**: When First Visited, Only the GridView is Displayed ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image33.png))</span></span>


<span data-ttu-id="3d5f3-185">[![行を選択すると、製品の詳細が表示されます。](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image35.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="3d5f3-185">[![Upon Selecting a Row, the Product's Details are Displayed](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image35.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image34.png)</span></span>

<span data-ttu-id="3d5f3-186">**図 12**: 行を選択すると、製品の詳細が表示されます ([フルサイズのイメージを表示するをクリックして](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="3d5f3-186">**Figure 12**: Upon Selecting a Row, the Product's Details are Displayed ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image36.png))</span></span>


## <a name="summary"></a><span data-ttu-id="3d5f3-187">概要</span><span class="sxs-lookup"><span data-stu-id="3d5f3-187">Summary</span></span>

<span data-ttu-id="3d5f3-188">この例と前述の 3 つのチュートリアルは、マスター/詳細レポートを表示するための手法の数を見たです。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-188">In this and the preceding three tutorials we've seen a number of techniques for displaying master/detail reports.</span></span> <span data-ttu-id="3d5f3-189">検査はこのチュートリアルでは選択可能な GridView を使用して、マスター レコードと同じページに、選択したマスター レコードに関する詳細を表示する DetailsView を格納します。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-189">In this tutorial we examined using a selectable GridView to house the master records and a DetailsView to display details about the selected master record on the same page.</span></span> <span data-ttu-id="3d5f3-190">前のチュートリアルでは、DropDownLists を使用して、および 1 つの web ページと詳細レコードを別のマスター レコードを表示するマスター/詳細レポートを表示する方法を説明しました。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-190">In the earlier tutorials we looked at how to display master/details reports using DropDownLists and displaying master records on one web page and detail records on another.</span></span>

<span data-ttu-id="3d5f3-191">このチュートリアルでは、マスター/詳細レポートの検査で終了します。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-191">This tutorial concludes our examination of master/detail reports.</span></span> <span data-ttu-id="3d5f3-192">次のチュートリアルで始まるまず、探索の GridView、DetailsView、フォーム ビューとカスタマイズされた書式設定します。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-192">Starting with the next tutorial we'll begin our exploration of customized formatting with the GridView, DetailsView, and FormView.</span></span> <span data-ttu-id="3d5f3-193">ここにバインドされたデータに基づくこれらのコントロールの外観をカスタマイズする方法、GridView のフッター内のデータを集計する方法、およびテンプレートを使用してより多くのレイアウトを制御を取得する方法が表示されます。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-193">We'll see how to customize the appearance of these controls based on the data bound to them, how to summarize data in the GridView's footer, and how to use templates to obtain a greater degree of control over the layout.</span></span>

<span data-ttu-id="3d5f3-194">満足プログラミング!</span><span class="sxs-lookup"><span data-stu-id="3d5f3-194">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="3d5f3-195">作成者について</span><span class="sxs-lookup"><span data-stu-id="3d5f3-195">About the Author</span></span>

<span data-ttu-id="3d5f3-196">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)、7 つ受け取りますブックとの創設者の作成者[4GuysFromRolla.com](http://www.4guysfromrolla.com)、1998 年からマイクロソフトの Web テクノロジで取り組んできました。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-196">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="3d5f3-197">Scott は、コンサルタント、トレーナー、ライターとして機能します。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-197">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="3d5f3-198">最新の著書[ *Sam 学べる自分で ASP.NET 2.0 が 24 時間以内に*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)です。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-198">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="3d5f3-199">彼に到達できる[ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)彼のブログを使用して含まれているのか[http://ScottOnWriting.NET](http://ScottOnWriting.NET)です。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-199">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="3d5f3-200">感謝の特別な</span><span class="sxs-lookup"><span data-stu-id="3d5f3-200">Special Thanks To</span></span>

<span data-ttu-id="3d5f3-201">このチュートリアルの系列は既に多くの便利なレビュー担当者によって確認済みです。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-201">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="3d5f3-202">このチュートリアルのレビュー担当者の潜在顧客が Hilton Giesenow しました。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-202">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="3d5f3-203">今後、MSDN の記事を確認することに関心のあるですか。</span><span class="sxs-lookup"><span data-stu-id="3d5f3-203">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="3d5f3-204">場合は、ドロップ me 一度に 1 行ずつ[mitchell@4GuysFromRolla.comです。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="3d5f3-204">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

>[!div class="step-by-step"]
[<span data-ttu-id="3d5f3-205">前へ</span><span class="sxs-lookup"><span data-stu-id="3d5f3-205">Previous</span></span>](master-detail-filtering-across-two-pages-vb.md)
