---
uid: web-forms/overview/data-access/paging-and-sorting-with-the-datalist-and-repeater/sorting-data-in-a-datalist-or-repeater-control-vb
title: "DataList またはリピータ コントロール (VB) のデータの並べ替え |Microsoft ドキュメント"
author: rick-anderson
description: "このチュートリアルではあります、DataList およびリピータでのサポートの並べ替えをインクルードする方法とデータを含むことができます、DataList または Repeater を構築する方法を確認しています."
ms.author: aspnetcontent
manager: wpickett
ms.date: 11/13/2006
ms.topic: article
ms.assetid: 97c13898-0741-45f9-b3fa-7540ab1679e6
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/paging-and-sorting-with-the-datalist-and-repeater/sorting-data-in-a-datalist-or-repeater-control-vb
msc.type: authoredcontent
ms.openlocfilehash: 0133a74454a7754f4f7087e2121c7387a1aef8a8
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/24/2018
---
<a name="sorting-data-in-a-datalist-or-repeater-control-vb"></a><span data-ttu-id="a1659-103">DataList またはリピータ コントロール (VB) のデータの並べ替え</span><span class="sxs-lookup"><span data-stu-id="a1659-103">Sorting Data in a DataList or Repeater Control (VB)</span></span>
====================
<span data-ttu-id="a1659-104">によって[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="a1659-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="a1659-105">[サンプル アプリをダウンロード](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_45_VB.exe)または[PDF のダウンロード](sorting-data-in-a-datalist-or-repeater-control-vb/_static/datatutorial45vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="a1659-105">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_45_VB.exe) or [Download PDF](sorting-data-in-a-datalist-or-repeater-control-vb/_static/datatutorial45vb1.pdf)</span></span>

> <span data-ttu-id="a1659-106">このチュートリアルではあります、DataList およびリピータでのサポートの並べ替えをインクルードする方法と、DataList またはリピータがデータをページングされ並べ替えられることができますを構築する方法を確認します。</span><span class="sxs-lookup"><span data-stu-id="a1659-106">In this tutorial we'll examine how to include sorting support in the DataList and Repeater, as well as how to construct a DataList or Repeater whose data can be paged and sorted.</span></span>


## <a name="introduction"></a><span data-ttu-id="a1659-107">はじめに</span><span class="sxs-lookup"><span data-stu-id="a1659-107">Introduction</span></span>

<span data-ttu-id="a1659-108">[前のチュートリアル](paging-report-data-in-a-datalist-or-repeater-control-vb.md)DataList にページング サポートを追加する方法について説明しました。</span><span class="sxs-lookup"><span data-stu-id="a1659-108">In the [previous tutorial](paging-report-data-in-a-datalist-or-repeater-control-vb.md) we examined how to add paging support to a DataList.</span></span> <span data-ttu-id="a1659-109">新しいメソッドを作成した、`ProductsBLL`クラス (`GetProductsAsPagedDataSource`) 返される、`PagedDataSource`オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="a1659-109">We created a new method in the `ProductsBLL` class (`GetProductsAsPagedDataSource`) that returned a `PagedDataSource` object.</span></span> <span data-ttu-id="a1659-110">DataList または Repeater をバインドするとき、DataList またはリピータ表示、要求されたページのデータだけです。</span><span class="sxs-lookup"><span data-stu-id="a1659-110">When bound to a DataList or Repeater, the DataList or Repeater would display just the requested page of data.</span></span> <span data-ttu-id="a1659-111">この手法は、組み込みの既定のページング機能を提供する GridView、DetailsView、FormView コントロールによって内部的にどのような使用に似ています。</span><span class="sxs-lookup"><span data-stu-id="a1659-111">This technique is similar to what is used internally by the GridView, DetailsView, and FormView controls to provide their built-in default paging functionality.</span></span>

<span data-ttu-id="a1659-112">ページング サポートを提供するだけでなく、GridView はその並べ替えをサポートするままの状態も含まれます。</span><span class="sxs-lookup"><span data-stu-id="a1659-112">In addition to offering paging support, the GridView also includes out of the box sorting support.</span></span> <span data-ttu-id="a1659-113">DataList でも、リピータ; 組み込みの並べ替え機能を提供します。ただし、コードのビットを使用して並べ替え機能を追加することができます。</span><span class="sxs-lookup"><span data-stu-id="a1659-113">Neither the DataList nor Repeater provides built-in sorting functionality; however, sorting features can be added with a bit of code.</span></span> <span data-ttu-id="a1659-114">このチュートリアルではあります、DataList およびリピータでのサポートの並べ替えをインクルードする方法と、DataList またはリピータがデータをページングされ並べ替えられることができますを構築する方法を確認します。</span><span class="sxs-lookup"><span data-stu-id="a1659-114">In this tutorial we'll examine how to include sorting support in the DataList and Repeater, as well as how to construct a DataList or Repeater whose data can be paged and sorted.</span></span>

## <a name="a-review-of-sorting"></a><span data-ttu-id="a1659-115">並べ替えのレビュー</span><span class="sxs-lookup"><span data-stu-id="a1659-115">A Review of Sorting</span></span>

<span data-ttu-id="a1659-116">説明したとおり、[レポート データの並べ替えとページング](../paging-and-sorting/paging-and-sorting-report-data-vb.md)チュートリアルでは、並べ替えをサポートするボックス外 GridView コントロールが用意されています。</span><span class="sxs-lookup"><span data-stu-id="a1659-116">As we saw in the [Paging and Sorting Report Data](../paging-and-sorting/paging-and-sorting-report-data-vb.md) tutorial, the GridView control provides out of the box sorting support.</span></span> <span data-ttu-id="a1659-117">各 GridView フィールドが関連付けられていることが`SortExpression`データの並べ替えに使用するデータ フィールドを示します。</span><span class="sxs-lookup"><span data-stu-id="a1659-117">Each GridView field can have an associated `SortExpression`, which indicates the data field by which to sort the data.</span></span> <span data-ttu-id="a1659-118">ときに GridView s`AllowSorting`プロパティに設定されている`true`、定義されている GridView フィールド、`SortExpression`プロパティ値は、ヘッダー、LinkButton としてレンダリングされます。</span><span class="sxs-lookup"><span data-stu-id="a1659-118">When the GridView s `AllowSorting` property is set to `true`, each GridView field that has a `SortExpression` property value has its header rendered as a LinkButton.</span></span> <span data-ttu-id="a1659-119">ユーザーには、特定の GridView フィールドのヘッダーがクリックすると、ポストバックが発生し、データがクリックされたフィールド s に従って並び替え`SortExpression`です。</span><span class="sxs-lookup"><span data-stu-id="a1659-119">When a user clicks a particular GridView field s header, a postback occurs and the data is sorted according to the clicked field s `SortExpression`.</span></span>

<span data-ttu-id="a1659-120">GridView コントロールが、`SortExpression`プロパティも、格納する、`SortExpression`によって GridView フィールドのデータが並べ替えられます。</span><span class="sxs-lookup"><span data-stu-id="a1659-120">The GridView control has a `SortExpression` property as well, which stores the `SortExpression` of the GridView field the data is sorted by.</span></span> <span data-ttu-id="a1659-121">さらに、`SortDirection`プロパティは、データが、昇順または降順 (場合連続して、並べ替え順序で 2 回特定 GridView フィールドのヘッダー リンクが切り替えられると、ユーザーのクリック) の順序で並べ替えるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="a1659-121">Additionally, a `SortDirection` property indicates whether the data is to be sorted in ascending or descending order (if a user clicks a particular GridView field s header link twice in succession, the sort order is toggled).</span></span>

<span data-ttu-id="a1659-122">渡す GridView がそのデータ ソース コントロールにバインドされると、その`SortExpression`と`SortDirection`プロパティ データをソース コントロール。</span><span class="sxs-lookup"><span data-stu-id="a1659-122">When the GridView is bound to its data source control, it hands off its `SortExpression` and `SortDirection` properties to the data source control.</span></span> <span data-ttu-id="a1659-123">データ ソース コントロールのデータを取得し、指定されたに従って並べ替えます`SortExpression`と`SortDirection`プロパティです。</span><span class="sxs-lookup"><span data-stu-id="a1659-123">The data source control retrieves the data and then sorts it according to the supplied `SortExpression` and `SortDirection` properties.</span></span> <span data-ttu-id="a1659-124">データの並べ替えの後に、データ ソース コントロールは、そのを GridView に返します。</span><span class="sxs-lookup"><span data-stu-id="a1659-124">After sorting the data, the data source control returns it to the GridView.</span></span>

<span data-ttu-id="a1659-125">DataList または Repeater コントロールでこの機能をレプリケートするには、必要があります。</span><span class="sxs-lookup"><span data-stu-id="a1659-125">To replicate this functionality with the DataList or Repeater controls, we must:</span></span>

- <span data-ttu-id="a1659-126">並べ替えのインターフェイスを作成します。</span><span class="sxs-lookup"><span data-stu-id="a1659-126">Create a sorting interface</span></span>
- <span data-ttu-id="a1659-127">データ フィールドで並べ替えを行うと、昇順または降順で並べ替えるかを注意してください。</span><span class="sxs-lookup"><span data-stu-id="a1659-127">Remember the data field to sort by and whether to sort in ascending or descending order</span></span>
- <span data-ttu-id="a1659-128">特定のデータ フィールドでデータを並べ替える ObjectDataSource を指示します。</span><span class="sxs-lookup"><span data-stu-id="a1659-128">Instruct the ObjectDataSource to sort the data by a particular data field</span></span>

<span data-ttu-id="a1659-129">これら 3 つのタスク手順 3 と 4 で取り上げるです。</span><span class="sxs-lookup"><span data-stu-id="a1659-129">We'll tackle these three tasks in steps 3 and 4.</span></span> <span data-ttu-id="a1659-130">次に、ページングとサポート DataList またはリピータ内の並べ替えの両方を含める方法について確認します。</span><span class="sxs-lookup"><span data-stu-id="a1659-130">Following that, we'll examine how to include both paging and sorting support in a DataList or Repeater.</span></span>

## <a name="step-2-displaying-the-products-in-a-repeater"></a><span data-ttu-id="a1659-131">手順 2: リピータで製品を表示します。</span><span class="sxs-lookup"><span data-stu-id="a1659-131">Step 2: Displaying the Products in a Repeater</span></span>

<span data-ttu-id="a1659-132">並べ替えに関連する機能を実装する心配し、前にリピータ コントロール内の製品を一覧表示して開始 s を使用できます。</span><span class="sxs-lookup"><span data-stu-id="a1659-132">Before we worry about implementing any of the sorting-related functionality, let s start by listing the products in a Repeater control.</span></span> <span data-ttu-id="a1659-133">開いて開始、 `Sorting.aspx`  ページで、`PagingSortingDataListRepeater`フォルダーです。</span><span class="sxs-lookup"><span data-stu-id="a1659-133">Start by opening the `Sorting.aspx` page in the `PagingSortingDataListRepeater` folder.</span></span> <span data-ttu-id="a1659-134">リピータ コントロールの設定、web ページを追加、`ID`プロパティを`SortableProducts`です。</span><span class="sxs-lookup"><span data-stu-id="a1659-134">Add a Repeater control to the web page, setting its `ID` property to `SortableProducts`.</span></span> <span data-ttu-id="a1659-135">リピータ s のスマート タグからの作成という名前の新しい ObjectDataSource`ProductsDataSource`からデータを取得するように構成し、`ProductsBLL`クラスの`GetProducts()`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="a1659-135">From the Repeater s smart tag, create a new ObjectDataSource named `ProductsDataSource` and configure it to retrieve data from the `ProductsBLL` class s `GetProducts()` method.</span></span> <span data-ttu-id="a1659-136">INSERT、UPDATE、および DELETE の各タブでドロップダウン リストからオプション (なし) を選択します。</span><span class="sxs-lookup"><span data-stu-id="a1659-136">Select the (None) option from the drop-down lists in the INSERT, UPDATE, and DELETE tabs.</span></span>


<span data-ttu-id="a1659-137">[![ObjectDataSource を作成および GetProductsAsPagedDataSource() メソッドを使用するように構成します。](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image2.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="a1659-137">[![Create an ObjectDataSource and Configure it to Use the GetProductsAsPagedDataSource() Method](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image2.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image1.png)</span></span>

<span data-ttu-id="a1659-138">**図 1**: ObjectDataSource を作成し、使用するように構成、`GetProductsAsPagedDataSource()`メソッド ([フルサイズのイメージを表示するをクリックして](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="a1659-138">**Figure 1**: Create an ObjectDataSource and Configure it to Use the `GetProductsAsPagedDataSource()` Method ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image3.png))</span></span>


<span data-ttu-id="a1659-139">[![UPDATE、INSERT のドロップダウン リストを設定し、(なし) タブを削除します。](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image5.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="a1659-139">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE tabs to (None)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image5.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image4.png)</span></span>

<span data-ttu-id="a1659-140">**図 2**: 更新、挿入のドロップダウン リストを設定し、(なし) タブを削除する ([フルサイズのイメージを表示するをクリックして](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="a1659-140">**Figure 2**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE tabs to (None) ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image6.png))</span></span>


<span data-ttu-id="a1659-141">異なり、DataList で Visual Studio は自動作成されません、 `ItemTemplate` Repeater コントロール、データ ソースにバインドした後にします。</span><span class="sxs-lookup"><span data-stu-id="a1659-141">Unlike with the DataList, Visual Studio does not automatically create an `ItemTemplate` for the Repeater control after binding it to a data source.</span></span> <span data-ttu-id="a1659-142">さらに、これを追加します`ItemTemplate`宣言、リピータ コントロールのスマート タグには、テンプレートの編集 オプションで DataList s がないです。</span><span class="sxs-lookup"><span data-stu-id="a1659-142">Furthermore, we must add this `ItemTemplate` declaratively, as the Repeater control s smart tag lacks the Edit Templates option found in the DataList s.</span></span> <span data-ttu-id="a1659-143">Let s を使用して同じ`ItemTemplate`前のチュートリアルからは、s の製品名、供給業者、およびカテゴリが表示されます。</span><span class="sxs-lookup"><span data-stu-id="a1659-143">Let s use the same `ItemTemplate` from the previous tutorial, which displayed the product s name, supplier, and category.</span></span>

<span data-ttu-id="a1659-144">追加した後、`ItemTemplate`リピータと ObjectDataSource s の宣言型マークアップは、次のようになります。</span><span class="sxs-lookup"><span data-stu-id="a1659-144">After adding the `ItemTemplate`, the Repeater and ObjectDataSource s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample1.aspx)]

<span data-ttu-id="a1659-145">図 3 は、ブラウザーで表示したときに、このページを示します。</span><span class="sxs-lookup"><span data-stu-id="a1659-145">Figure 3 shows this page when viewed through a browser.</span></span>


<span data-ttu-id="a1659-146">[![各製品の名前、供給業者、およびカテゴリが表示されます。](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image8.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="a1659-146">[![Each Product s Name, Supplier, and Category is Displayed](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image8.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image7.png)</span></span>

<span data-ttu-id="a1659-147">**図 3**: 各製品名、供給業者、およびカテゴリが表示されます ([フルサイズのイメージを表示するをクリックして](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="a1659-147">**Figure 3**: Each Product s Name, Supplier, and Category is Displayed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image9.png))</span></span>


## <a name="step-3-instructing-the-objectdatasource-to-sort-the-data"></a><span data-ttu-id="a1659-148">手順 3: データの並べ替えに ObjectDataSource を指示します。</span><span class="sxs-lookup"><span data-stu-id="a1659-148">Step 3: Instructing the ObjectDataSource to Sort the Data</span></span>

<span data-ttu-id="a1659-149">リピータに表示されるデータを並べ替えるには、データの並べ替えられた、並べ替え式の ObjectDataSource を通知する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a1659-149">To sort the data displayed in the Repeater, we need to inform the ObjectDataSource of the sort expression by which the data should be sorted.</span></span> <span data-ttu-id="a1659-150">最初に発生させる、ObjectDataSource は、そのデータを取得する前にその[`Selecting`イベント](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting.aspx)並べ替え式を指定する機会を提供します。</span><span class="sxs-lookup"><span data-stu-id="a1659-150">Before the ObjectDataSource retrieves its data, it first fires its [`Selecting` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting.aspx), which provides an opportunity for us to specify a sort expression.</span></span> <span data-ttu-id="a1659-151">`Selecting`イベント ハンドラーは型のオブジェクトに渡されます[ `ObjectDataSourceSelectingEventArgs` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.aspx)、という名前のプロパティを持つ[ `Arguments` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.arguments.aspx)型の[ `DataSourceSelectArguments`](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="a1659-151">The `Selecting` event handler is passed an object of type [`ObjectDataSourceSelectingEventArgs`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.aspx), which has a property named [`Arguments`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.arguments.aspx) of type [`DataSourceSelectArguments`](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.aspx).</span></span> <span data-ttu-id="a1659-152">`DataSourceSelectArguments`クラスは、データ ソース コントロールにデータのコンシューマーからのデータ関連の要求を渡すように設計され、が含まれています、 [ `SortExpression`プロパティ](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.sortexpression.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="a1659-152">The `DataSourceSelectArguments` class is designed to pass data-related requests from a consumer of data to the data source control, and includes a [`SortExpression` property](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.sortexpression.aspx).</span></span>

<span data-ttu-id="a1659-153">ASP.NET ページから、ObjectDataSource に並べ替え情報を渡すのイベント ハンドラーを作成、`Selecting`イベントと、次のコードを使用します。</span><span class="sxs-lookup"><span data-stu-id="a1659-153">To pass sorting information from the ASP.NET page to the ObjectDataSource, create an event handler for the `Selecting` event and use the following code:</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample2.vb)]

<span data-ttu-id="a1659-154">*SortExpression*値に (ProductName) など、データの並べ替えにデータ フィールドの名前を割り当てる必要があります。</span><span class="sxs-lookup"><span data-stu-id="a1659-154">The *sortExpression* value should be assigned the name of the data field to sort the data by (such as ProductName ).</span></span> <span data-ttu-id="a1659-155">並べ替えの方向に関連するプロパティが存在しない、降順でデータを並べ替える場合が DESC 文字列を追加するために、 *sortExpression* (ProductName DESC) などの値。</span><span class="sxs-lookup"><span data-stu-id="a1659-155">There is no sort direction-related property, so if you want to sort the data in descending order, append the string DESC to the *sortExpression* value (such as ProductName DESC ).</span></span>

<span data-ttu-id="a1659-156">いくつか異なるハード コーディングされた値を再試行してください*sortExpression*およびブラウザーで結果をテストします。</span><span class="sxs-lookup"><span data-stu-id="a1659-156">Go ahead and try some different hard-coded values for *sortExpression* and test the results in a browser.</span></span> <span data-ttu-id="a1659-157">図 4 に示すとして ProductName DESC を使用する場合、 *sortExpression*製品はアルファベットの逆順で名前によって並べ替えられます。</span><span class="sxs-lookup"><span data-stu-id="a1659-157">As Figure 4 shows, when using ProductName DESC as the *sortExpression*, the products are sorted by their name in reverse alphabetical order.</span></span>


<span data-ttu-id="a1659-158">[![製品はアルファベット順の逆に、名前順に並べ替えられます。](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image11.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="a1659-158">[![The Products are Sorted by their Name in Reverse Alphabetical Order](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image11.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image10.png)</span></span>

<span data-ttu-id="a1659-159">**図 4**: この製品はアルファベット順の逆に、名前によって並べ替えられます ([フルサイズのイメージを表示するをクリックして](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="a1659-159">**Figure 4**: The Products are Sorted by their Name in Reverse Alphabetical Order ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image12.png))</span></span>


## <a name="step-4-creating-the-sorting-interface-and-remembering-the-sort-expression-and-direction"></a><span data-ttu-id="a1659-160">手順 4: 並べ替えのインターフェイスを作成して、並べ替え式および方向を記憶</span><span class="sxs-lookup"><span data-stu-id="a1659-160">Step 4: Creating the Sorting Interface and Remembering the Sort Expression and Direction</span></span>

<span data-ttu-id="a1659-161">並べ替えをサポート GridView でオンにする各並べ替え可能なフィールドのヘッダー テキストに変換 LinkButton をクリックすると、それに応じてデータを並べ替えます。</span><span class="sxs-lookup"><span data-stu-id="a1659-161">Turning on sorting support in the GridView converts each sortable field s header text into a LinkButton that, when clicked, sorts the data accordingly.</span></span> <span data-ttu-id="a1659-162">このような並べ替えインターフェイスは、ここでそのデータが整然とレイアウトの列に、GridView にかなっています。</span><span class="sxs-lookup"><span data-stu-id="a1659-162">Such a sorting interface makes sense for the GridView, where its data is neatly laid out in columns.</span></span> <span data-ttu-id="a1659-163">DataList リピータ コントロール、ただし、別の並べ替えインターフェイスが必要です。</span><span class="sxs-lookup"><span data-stu-id="a1659-163">For the DataList and Repeater controls, however, a different sorting interface is needed.</span></span> <span data-ttu-id="a1659-164">共通の並べ替えインターフェイスではなく、データのグリッド)、データの一覧については、ドロップダウン リストで、データの並べ替えに使用できるフィールドを提供します。</span><span class="sxs-lookup"><span data-stu-id="a1659-164">A common sorting interface for a list of data (as opposed to a grid of data), is a drop-down list that provides the fields by which the data can be sorted.</span></span> <span data-ttu-id="a1659-165">このチュートリアルのようなインターフェイスを実装 s を使用できます。</span><span class="sxs-lookup"><span data-stu-id="a1659-165">Let s implement such an interface for this tutorial.</span></span>

<span data-ttu-id="a1659-166">上記の DropDownList の Web コントロールを追加、`SortableProducts`リピータとその`ID`プロパティを`SortBy`です。</span><span class="sxs-lookup"><span data-stu-id="a1659-166">Add a DropDownList Web control above the `SortableProducts` Repeater and set its `ID` property to `SortBy`.</span></span> <span data-ttu-id="a1659-167">[プロパティ] ウィンドウ内の省略記号をクリックして、 `Items` ListItem コレクション エディターを表示するプロパティです。</span><span class="sxs-lookup"><span data-stu-id="a1659-167">From the Properties window, click the ellipses in the `Items` property to bring up the ListItem Collection Editor.</span></span> <span data-ttu-id="a1659-168">追加`ListItem`、データを並べ替えるには、 `ProductName`、 `CategoryName`、および`SupplierName`フィールドです。</span><span class="sxs-lookup"><span data-stu-id="a1659-168">Add `ListItem` s to sort the data by the `ProductName`, `CategoryName`, and `SupplierName` fields.</span></span> <span data-ttu-id="a1659-169">追加も、`ListItem`アルファベットの逆順で名前によって、製品の並べ替えにします。</span><span class="sxs-lookup"><span data-stu-id="a1659-169">Also add a `ListItem` to sort the products by their name in reverse alphabetical order.</span></span>

<span data-ttu-id="a1659-170">`ListItem` `Text` (名前など)、任意の値にプロパティを設定することができますが、 `Value` (ProductName) などのデータ フィールドの名前にプロパティを設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a1659-170">The `ListItem` `Text` properties can be set to any value (such as Name ), but the `Value` properties must be set to the name of the data field (such as ProductName ).</span></span> <span data-ttu-id="a1659-171">降順で結果を並べ替えるには、するには、ProductName DESC と同様に、データ フィールド名に文字列の説明を追加します。</span><span class="sxs-lookup"><span data-stu-id="a1659-171">To sort the results in descending order, append the string DESC to the data field name, like ProductName DESC .</span></span>


![並べ替え可能なデータ フィールドのそれぞれに対して、ListItem を追加します。](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image13.png)

<span data-ttu-id="a1659-173">**図 5**: 追加、`ListItem`並べ替え可能なデータ フィールドの各</span><span class="sxs-lookup"><span data-stu-id="a1659-173">**Figure 5**: Add a `ListItem` for Each of the Sortable Data Fields</span></span>


<span data-ttu-id="a1659-174">最後に、次のドロップダウン リストの右側にボタン Web コントロールを追加します。</span><span class="sxs-lookup"><span data-stu-id="a1659-174">Finally, add a Button Web control to the right of the DropDownList.</span></span> <span data-ttu-id="a1659-175">設定の`ID`に`RefreshRepeater`とその`Text`プロパティを更新します。</span><span class="sxs-lookup"><span data-stu-id="a1659-175">Set its `ID` to `RefreshRepeater` and its `Text` property to Refresh .</span></span>

<span data-ttu-id="a1659-176">作成した後、 `ListItem` s、[更新] ボタンを追加して、DropDownList とボタン s の宣言構文を次のようになります。</span><span class="sxs-lookup"><span data-stu-id="a1659-176">After creating the `ListItem` s and adding the Refresh button, the DropDownList and Button s declarative syntax should look similar to the following:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample3.aspx)]

<span data-ttu-id="a1659-177">完全な並べ替え DropDownList で次に必要があります、ObjectDataSource s を更新する`Selecting`イベント ハンドラーを使用する、選択したので`SortBy``ListItem`s`Value`ハード コーディングされた並べ替え式ではなくプロパティです。</span><span class="sxs-lookup"><span data-stu-id="a1659-177">With the sorting DropDownList complete, we next need to update the ObjectDataSource s `Selecting` event handler so that it uses the selected `SortBy``ListItem` s `Value` property as opposed to a hard-coded sort expression.</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample4.vb)]

<span data-ttu-id="a1659-178">最初のページにアクセスすると、この時点で、製品は最初に並べ替えられますが、`ProductName`データ フィールドをその s、 `SortBy` `ListItem`既定で選択されている (図 6 を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="a1659-178">At this point when first visiting the page the products will initially be sorted by the `ProductName` data field, as it s the `SortBy` `ListItem` selected by default (see Figure 6).</span></span> <span data-ttu-id="a1659-179">異なる並べ替えカテゴリなどのオプションと [更新] を選択、ポストバックを発生させるし、再、図 7 に示すように、それらのカテゴリ名で、データを並べ替えます。</span><span class="sxs-lookup"><span data-stu-id="a1659-179">Selecting a different sorting option such as Category and clicking Refresh will cause a postback and re-sort the data by the category name, as Figure 7 shows.</span></span>


<span data-ttu-id="a1659-180">[![製品は、最初にその名前で並べ替え](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image15.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="a1659-180">[![The Products are Initially Sorted by their Name](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image15.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image14.png)</span></span>

<span data-ttu-id="a1659-181">**図 6**:、製品は、最初にその名前で並べ替えられます ([フルサイズのイメージを表示するをクリックして](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="a1659-181">**Figure 6**: The Products are Initially Sorted by their Name ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image16.png))</span></span>


<span data-ttu-id="a1659-182">[![製品がカテゴリで並べ替えられます](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image18.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="a1659-182">[![The Products are Now Sorted by Category](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image18.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image17.png)</span></span>

<span data-ttu-id="a1659-183">**図 7**: この製品がカテゴリで並べ替えられます ([フルサイズのイメージを表示するをクリックして](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image19.png))</span><span class="sxs-lookup"><span data-stu-id="a1659-183">**Figure 7**: The Products are Now Sorted by Category ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image19.png))</span></span>


> [!NOTE]
> <span data-ttu-id="a1659-184">データを自動的に再度並べ替えたリピータのビュー ステートが無効になっているために原因となり、ポストバックごとにそのデータ ソースにバインドする中継ぎ局は、更新ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="a1659-184">Clicking the Refresh button causes the data to automatically be re-sorted because the Repeater s view state has been disabled, thereby causing the Repeater to rebind to its data source on every postback.</span></span> <span data-ttu-id="a1659-185">ドロップダウン並べ替えを変更する有効な場合、リピータのビュー状態のままにしている場合、並べ替え順序に影響が t が勝利した一覧にあります。</span><span class="sxs-lookup"><span data-stu-id="a1659-185">If you ve left the Repeater s view state enabled, changing the sorting drop-down list won t have any affect on the sort order.</span></span> <span data-ttu-id="a1659-186">この問題を解決するには、[更新] ボタン s のイベント ハンドラーを作成`Click`イベントおよび再バインドのデータ ソースにリピータ (リピータ s を呼び出すことによって`DataBind()`メソッド)。</span><span class="sxs-lookup"><span data-stu-id="a1659-186">To remedy this, create an event handler for the Refresh Button s `Click` event and rebind the Repeater to its data source (by calling the Repeater s `DataBind()` method).</span></span>


## <a name="remembering-the-sort-expression-and-direction"></a><span data-ttu-id="a1659-187">並べ替え式と方向を記憶</span><span class="sxs-lookup"><span data-stu-id="a1659-187">Remembering the Sort Expression and Direction</span></span>

<span data-ttu-id="a1659-188">非並べ替えに関係しているポストバックが行われ、ページの並べ替え可能な DataList または Repeater を作成するときに、s の命令型の並べ替え式と方向をポストバック間で記憶されます。</span><span class="sxs-lookup"><span data-stu-id="a1659-188">When creating a sortable DataList or Repeater on a page where non-sort related postbacks may occur, it s imperative that the sort expression and direction be remembered across postbacks.</span></span> <span data-ttu-id="a1659-189">たとえば、各商品の削除 ボタンを含めるには、このチュートリアルでは、リピータに更新されたことを想像してください。</span><span class="sxs-lookup"><span data-stu-id="a1659-189">For example, imagine that we updated the Repeater in this tutorial to include a Delete button with each product.</span></span> <span data-ttu-id="a1659-190">ユーザーが [削除] ボタンをクリックしたときに d おリピータにデータをバインドし、直す、選択した製品を削除するコードを実行します。</span><span class="sxs-lookup"><span data-stu-id="a1659-190">When the user clicks the Delete button we d run some code to delete the selected product and then rebind the data to the Repeater.</span></span> <span data-ttu-id="a1659-191">並べ替えの詳細についてはポストバック間で永続化されない場合は、画面に表示されるデータは元の並べ替え順序に戻ります。</span><span class="sxs-lookup"><span data-stu-id="a1659-191">If the sort details are not persisted across postback, the data displayed on screen will revert to the original sort order.</span></span>

<span data-ttu-id="a1659-192">このチュートリアルでは、DropDownList 暗黙的に保存、並べ替え式と方向のビュー状態でご利用の米国します。</span><span class="sxs-lookup"><span data-stu-id="a1659-192">For this tutorial, the DropDownList implicitly saves the sort expression and direction in its view state for us.</span></span> <span data-ttu-id="a1659-193">さまざまな並べ替えオプションを指定すると、あるいずれかの異なる並べ替えインターフェイスを使用していた場合は、ポストバック間での並べ替え順序を保存するように注意 d お必要があります。</span><span class="sxs-lookup"><span data-stu-id="a1659-193">If we were using a different sorting interface one with, say, LinkButtons that provided the various sorting options we d need to take care to remember the sort order across postbacks.</span></span> <span data-ttu-id="a1659-194">これは、または別の状態の永続化手法で、クエリ文字列の並べ替えのパラメーターを含めることによってページ s のビュー ステートに並べ替え、パラメーターを格納することにより実現可能性があります。</span><span class="sxs-lookup"><span data-stu-id="a1659-194">This could be accomplished by storing the sorting parameters in the page s view state, by including the sort parameter in the querystring, or through some other state persistence technique.</span></span>

<span data-ttu-id="a1659-195">このチュートリアルで将来の例では、ページのビュー状態で並べ替えの詳細を永続化する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="a1659-195">Future examples in this tutorial explore how to persist the sorting details in the page s view state.</span></span>

## <a name="step-5-adding-sorting-support-to-a-datalist-that-uses-default-paging"></a><span data-ttu-id="a1659-196">手順 5: 既定のページングを使用する DataList に並べ替えをサポートを追加します。</span><span class="sxs-lookup"><span data-stu-id="a1659-196">Step 5: Adding Sorting Support to a DataList that Uses Default Paging</span></span>

<span data-ttu-id="a1659-197">[前のチュートリアル](paging-report-data-in-a-datalist-or-repeater-control-vb.md)DataList で既定のページングを実装する方法について説明しました。</span><span class="sxs-lookup"><span data-stu-id="a1659-197">In the [preceding tutorial](paging-report-data-in-a-datalist-or-repeater-control-vb.md) we examined how to implement default paging with a DataList.</span></span> <span data-ttu-id="a1659-198">S をページングされたデータを並べ替えることは、この前の例の拡張を使用できます。</span><span class="sxs-lookup"><span data-stu-id="a1659-198">Let s extend this previous example to include the ability to sort the paged data.</span></span> <span data-ttu-id="a1659-199">開いて開始、`SortingWithDefaultPaging.aspx`と`Paging.aspx`内のページ、`PagingSortingDataListRepeater`フォルダーです。</span><span class="sxs-lookup"><span data-stu-id="a1659-199">Start by opening the `SortingWithDefaultPaging.aspx` and `Paging.aspx` pages in the `PagingSortingDataListRepeater` folder.</span></span> <span data-ttu-id="a1659-200">`Paging.aspx`  ページで、ページの宣言型マークアップを表示する ソース ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="a1659-200">From the `Paging.aspx` page, click on the Source button to view the page s declarative markup.</span></span> <span data-ttu-id="a1659-201">選択したテキストをコピー (図 8 を参照してください) の宣言型マークアップを貼り付けます`SortingWithDefaultPaging.aspx`間、`<asp:Content>`タグ。</span><span class="sxs-lookup"><span data-stu-id="a1659-201">Copy the selected text (see Figure 8) and paste it into the declarative markup of `SortingWithDefaultPaging.aspx` between the `<asp:Content>` tags.</span></span>


<span data-ttu-id="a1659-202">[![宣言型マークアップを複製、 &lt;Asp:content&gt; SortingWithDefaultPaging.aspx Paging.aspx からタグ](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image21.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="a1659-202">[![Replicate the Declarative Markup in the &lt;asp:Content&gt; Tags from Paging.aspx to SortingWithDefaultPaging.aspx](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image21.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image20.png)</span></span>

<span data-ttu-id="a1659-203">**図 8**: 内の宣言型マークアップを複製、`<asp:Content>`からタグ`Paging.aspx`に`SortingWithDefaultPaging.aspx`([フルサイズのイメージを表示するをクリックして](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="a1659-203">**Figure 8**: Replicate the Declarative Markup in the `<asp:Content>` Tags from `Paging.aspx` to `SortingWithDefaultPaging.aspx` ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image22.png))</span></span>


<span data-ttu-id="a1659-204">宣言型マークアップをコピーするには、その後メソッドとプロパティに、コピー、`Paging.aspx`ページの分離コード クラスを分離コード クラスを s`SortingWithDefaultPaging.aspx`です。</span><span class="sxs-lookup"><span data-stu-id="a1659-204">After copying the declarative markup, copy the methods and properties in the `Paging.aspx` page s code-behind class to the code-behind class for `SortingWithDefaultPaging.aspx`.</span></span> <span data-ttu-id="a1659-205">次に、すぐを表示、`SortingWithDefaultPaging.aspx`ブラウザーのページです。</span><span class="sxs-lookup"><span data-stu-id="a1659-205">Next, take a moment to view the `SortingWithDefaultPaging.aspx` page in a browser.</span></span> <span data-ttu-id="a1659-206">同じ機能ととしての外観を示す必要があります`Paging.aspx`です。</span><span class="sxs-lookup"><span data-stu-id="a1659-206">It should exhibit the same functionality and appearance as `Paging.aspx`.</span></span>

## <a name="enhancing-productsbll-to-include-a-default-paging-and-sorting-method"></a><span data-ttu-id="a1659-207">ページングや並べ替えメソッドには、既定値を含める ProductsBLL の強化</span><span class="sxs-lookup"><span data-stu-id="a1659-207">Enhancing ProductsBLL to Include a Default Paging and Sorting Method</span></span>

<span data-ttu-id="a1659-208">前のチュートリアルで作成した、`GetProductsAsPagedDataSource(pageIndex, pageSize)`メソッドで、`ProductsBLL`返されるクラス、`PagedDataSource`オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="a1659-208">In the previous tutorial we created a `GetProductsAsPagedDataSource(pageIndex, pageSize)` method in the `ProductsBLL` class that returned a `PagedDataSource` object.</span></span> <span data-ttu-id="a1659-209">これは、`PagedDataSource`オブジェクトが設定されている*すべて*の製品の (BLL s を介して`GetProducts()`メソッド) にバインドするとき、DataList を指定された対応するレコードだけが、 *pageIndex*および*pageSize*入力パラメーターが表示されます。</span><span class="sxs-lookup"><span data-stu-id="a1659-209">This `PagedDataSource` object was populated with *all* of the products (via the BLL s `GetProducts()` method), but when bound to the DataList only those records corresponding to the specified *pageIndex* and *pageSize* input parameters were displayed.</span></span>

<span data-ttu-id="a1659-210">このチュートリアルで先ほど ObjectDataSource s から並べ替え式を指定して並べ替えのサポートを追加しました`Selecting`イベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="a1659-210">Earlier in this tutorial we added sorting support by specifying the sort expression from the ObjectDataSource s `Selecting` event handler.</span></span> <span data-ttu-id="a1659-211">これは、動作は問題、ObjectDataSource に並べ替えができるように、オブジェクトが返される場合、`ProductsDataTable`によって返される、`GetProducts()`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="a1659-211">This works well when the ObjectDataSource is returned an object that can be sorted, like the `ProductsDataTable` returned by the `GetProducts()` method.</span></span> <span data-ttu-id="a1659-212">ただし、`PagedDataSource`によって返されるオブジェクト、`GetProductsAsPagedDataSource`メソッドがその内部データ ソースの並べ替えをサポートしていません。</span><span class="sxs-lookup"><span data-stu-id="a1659-212">However, the `PagedDataSource` object returned by the `GetProductsAsPagedDataSource` method does not support sorting of its inner data source.</span></span> <span data-ttu-id="a1659-213">代わりから返される結果を並べ替える必要があります、`GetProducts()`メソッド*する前に*で挿入しました、`PagedDataSource`です。</span><span class="sxs-lookup"><span data-stu-id="a1659-213">Instead, we need to sort the results returned from the `GetProducts()` method *before* we put it in the `PagedDataSource`.</span></span>

<span data-ttu-id="a1659-214">これを実現するで新しいメソッドを作成、`ProductsBLL`クラス、`GetProductsSortedAsPagedDataSource(sortExpression, pageIndex, pageSize)`です。</span><span class="sxs-lookup"><span data-stu-id="a1659-214">To accomplish this, create a new method in the `ProductsBLL` class, `GetProductsSortedAsPagedDataSource(sortExpression, pageIndex, pageSize)`.</span></span> <span data-ttu-id="a1659-215">並べ替えに、`ProductsDataTable`によって返される、`GetProducts()`メソッドを指定して、`Sort`プロパティの既定の`DataTableView`:</span><span class="sxs-lookup"><span data-stu-id="a1659-215">To sort the `ProductsDataTable` returned by the `GetProducts()` method, specify the `Sort` property of its default `DataTableView`:</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample5.vb)]

<span data-ttu-id="a1659-216">`GetProductsSortedAsPagedDataSource`メソッドの違いから、`GetProductsAsPagedDataSource`メソッドの前のチュートリアルで作成します。</span><span class="sxs-lookup"><span data-stu-id="a1659-216">The `GetProductsSortedAsPagedDataSource` method differs only slightly from the `GetProductsAsPagedDataSource` method created in the previous tutorial.</span></span> <span data-ttu-id="a1659-217">具体的には、`GetProductsSortedAsPagedDataSource`追加の入力パラメーターを受け取り`sortExpression`にこの値を代入し、`Sort`のプロパティ、 `ProductDataTable` s`DefaultView`です。</span><span class="sxs-lookup"><span data-stu-id="a1659-217">In particular, `GetProductsSortedAsPagedDataSource` accepts an additional input parameter `sortExpression` and assigns this value to the `Sort` property of the `ProductDataTable` s `DefaultView`.</span></span> <span data-ttu-id="a1659-218">数行のコードを後で、`PagedDataSource`オブジェクト データ ソースが割り当てられている、 `ProductDataTable` s`DefaultView`です。</span><span class="sxs-lookup"><span data-stu-id="a1659-218">A few lines of code later, the `PagedDataSource` object s DataSource is assigned the `ProductDataTable` s `DefaultView`.</span></span>

## <a name="calling-the-getproductssortedaspageddatasource-method-and-specifying-the-value-for-the-sortexpression-input-parameter"></a><span data-ttu-id="a1659-219">GetProductsSortedAsPagedDataSource メソッドを呼び出すと、SortExpression 入力パラメーターの値を指定します。</span><span class="sxs-lookup"><span data-stu-id="a1659-219">Calling the GetProductsSortedAsPagedDataSource Method and Specifying the Value for the SortExpression Input Parameter</span></span>

<span data-ttu-id="a1659-220">`GetProductsSortedAsPagedDataSource`メソッドが完了したら、次の手順は、このパラメーターの値を提供します。</span><span class="sxs-lookup"><span data-stu-id="a1659-220">With the `GetProductsSortedAsPagedDataSource` method complete, the next step is to provide the value for this parameter.</span></span> <span data-ttu-id="a1659-221">ObjectDataSource`SortingWithDefaultPaging.aspx`を呼び出して現在構成されている、`GetProductsAsPagedDataSource`メソッドを 2 つから 2 つの入力パラメーターで渡します`QueryStringParameters`で指定されている、`SelectParameters`コレクション。</span><span class="sxs-lookup"><span data-stu-id="a1659-221">The ObjectDataSource in `SortingWithDefaultPaging.aspx` is currently configured to call the `GetProductsAsPagedDataSource` method and passes in the two input parameters through its two `QueryStringParameters`, which are specified in the `SelectParameters` collection.</span></span> <span data-ttu-id="a1659-222">これらの 2 つ`QueryStringParameters`ことを示すための基になる、`GetProductsAsPagedDataSource`メソッド s *pageIndex*と*pageSize*パラメーターを取得するクエリ文字列フィールドから`pageIndex`と`pageSize`です。</span><span class="sxs-lookup"><span data-stu-id="a1659-222">These two `QueryStringParameters` indicate that the source for the `GetProductsAsPagedDataSource` method s *pageIndex* and *pageSize* parameters come from the querystring fields `pageIndex` and `pageSize`.</span></span>

<span data-ttu-id="a1659-223">ObjectDataSource %s 更新`SelectMethod`プロパティが新しいことを呼び出すように`GetProductsSortedAsPagedDataSource`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="a1659-223">Update the ObjectDataSource s `SelectMethod` property so that it invokes the new `GetProductsSortedAsPagedDataSource` method.</span></span> <span data-ttu-id="a1659-224">次に、追加、新しい`QueryStringParameter`できるように、 *sortExpression* querystring フィールドからの入力パラメーターにアクセス`sortExpression`です。</span><span class="sxs-lookup"><span data-stu-id="a1659-224">Then, add a new `QueryStringParameter` so that the *sortExpression* input parameter is accessed from the querystring field `sortExpression`.</span></span> <span data-ttu-id="a1659-225">設定、 `QueryStringParameter` s `DefaultValue` ProductName にします。</span><span class="sxs-lookup"><span data-stu-id="a1659-225">Set the `QueryStringParameter` s `DefaultValue` to ProductName .</span></span>

<span data-ttu-id="a1659-226">これらの変更後に、ObjectDataSource s の宣言型マークアップようになります。</span><span class="sxs-lookup"><span data-stu-id="a1659-226">After these changes, the ObjectDataSource s declarative markup should look like:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample6.aspx)]

<span data-ttu-id="a1659-227">この時点で、`SortingWithDefaultPaging.aspx`ページは、製品名、その結果をアルファベット順に並べ替えが (図 9 を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="a1659-227">At this point, the `SortingWithDefaultPaging.aspx` page will sort its results alphabetically by the product name (see Figure 9).</span></span> <span data-ttu-id="a1659-228">これは、既定では、商品の値として渡されるため、`GetProductsSortedAsPagedDataSource`メソッド s *sortExpression*パラメーター。</span><span class="sxs-lookup"><span data-stu-id="a1659-228">This is because, by default, a value of ProductName is passed in as the `GetProductsSortedAsPagedDataSource` method s *sortExpression* parameter.</span></span>


<span data-ttu-id="a1659-229">[![既定では、結果が ProductName によって並べ替えられます。](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image24.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="a1659-229">[![By Default, the Results are Sorted by ProductName](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image24.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image23.png)</span></span>

<span data-ttu-id="a1659-230">**図 9**: 既定では、結果が並べ替えられます`ProductName`([フルサイズのイメージを表示するには、をクリックして](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image25.png))。</span><span class="sxs-lookup"><span data-stu-id="a1659-230">**Figure 9**: By Default, the Results are Sorted by `ProductName` ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image25.png))</span></span>


<span data-ttu-id="a1659-231">手動で追加する場合、`sortExpression`などのクエリ文字列フィールド`SortingWithDefaultPaging.aspx?sortExpression=CategoryName`結果を並べ替えると指定`sortExpression`です。</span><span class="sxs-lookup"><span data-stu-id="a1659-231">If you manually add a `sortExpression` querystring field such as `SortingWithDefaultPaging.aspx?sortExpression=CategoryName` the results will be sorted by the specified `sortExpression`.</span></span> <span data-ttu-id="a1659-232">ただし、この`sortExpression`データの別のページに移動するときに、パラメーターは、クエリ文字列に含まれていません。</span><span class="sxs-lookup"><span data-stu-id="a1659-232">However, this `sortExpression` parameter is not included in the querystring when moving to a different page of data.</span></span> <span data-ttu-id="a1659-233">実際には、次へ、または最後のページをクリックするとボタンが配置に戻すことは`Paging.aspx`!</span><span class="sxs-lookup"><span data-stu-id="a1659-233">In fact, clicking on the Next or Last page buttons takes us back to `Paging.aspx`!</span></span> <span data-ttu-id="a1659-234">さらに、s が現在の並べ替えインターフェイスなし。</span><span class="sxs-lookup"><span data-stu-id="a1659-234">Furthermore, there s currently no sorting interface.</span></span> <span data-ttu-id="a1659-235">ユーザーは、ページングされたデータの並べ替え順序を変更できますのみ方法は、クエリ文字列を直接操作することによってです。</span><span class="sxs-lookup"><span data-stu-id="a1659-235">The only way a user can change the sort order of the paged data is by manipulating the querystring directly.</span></span>

## <a name="creating-the-sorting-interface"></a><span data-ttu-id="a1659-236">並べ替えのインターフェイスを作成します。</span><span class="sxs-lookup"><span data-stu-id="a1659-236">Creating the Sorting Interface</span></span>

<span data-ttu-id="a1659-237">最初に更新する必要があります、`RedirectUser`メソッドをユーザーに送信する`SortingWithDefaultPaging.aspx`(の代わりに`Paging.aspx`) を含めると、`sortExpression`クエリ文字列の値。</span><span class="sxs-lookup"><span data-stu-id="a1659-237">We first need to update the `RedirectUser` method to send the user to `SortingWithDefaultPaging.aspx` (instead of `Paging.aspx`) and to include the `sortExpression` value in the querystring.</span></span> <span data-ttu-id="a1659-238">読み取り専用ページ レベルの名前を追加する必要がありますもお`SortExpression`プロパティです。</span><span class="sxs-lookup"><span data-stu-id="a1659-238">We should also add a read-only, page-level named `SortExpression` property.</span></span> <span data-ttu-id="a1659-239">このプロパティは、のような`PageIndex`と`PageSize`前のチュートリアルで作成されたプロパティの値を返します、 `sortExpression` querystring フィールドが存在する場合、既定値 (ProductName) それ以外の場合。</span><span class="sxs-lookup"><span data-stu-id="a1659-239">This property, similar to the `PageIndex` and `PageSize` properties created in the previous tutorial, returns the value of the `sortExpression` querystring field if it exists, and the default value ( ProductName ) otherwise.</span></span>

<span data-ttu-id="a1659-240">現在、`RedirectUser`メソッドは 1 つ入力パラメーターを表示するページのインデックスのみを受け取ります。</span><span class="sxs-lookup"><span data-stu-id="a1659-240">Currently the `RedirectUser` method accepts only a single input parameter the index of the page to display.</span></span> <span data-ttu-id="a1659-241">ただし、クエリ文字列で指定されたどの s 以外の並べ替え式を使用してデータの特定のページにユーザーをリダイレクトする場合もあります。</span><span class="sxs-lookup"><span data-stu-id="a1659-241">However, there may be times when we want to redirect the user to a particular page of data using a sort expression other than what s specified in the querystring.</span></span> <span data-ttu-id="a1659-242">すぐにこのページは、一連の指定した列によってデータを並べ替えるためのボタンの Web コントロールを含めるの並べ替えのインターフェイスを作成します。</span><span class="sxs-lookup"><span data-stu-id="a1659-242">In a moment we'll create the sorting interface for this page, which will include a series of Button Web controls for sorting the data by a specified column.</span></span> <span data-ttu-id="a1659-243">これらのボタンのいずれかがクリックされたときに適切な並べ替え式の値を渡して、ユーザーをリダイレクトするとします。</span><span class="sxs-lookup"><span data-stu-id="a1659-243">When one of those Buttons is clicked, we want to redirect the user passing in the appropriate sort expression value.</span></span> <span data-ttu-id="a1659-244">この機能を提供する 2 つのバージョンを作成、`RedirectUser`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="a1659-244">To provide this functionality, create two versions of the `RedirectUser` method.</span></span> <span data-ttu-id="a1659-245">1 つ目は、表示するには、2 つ目がページのインデックスおよび並べ替え式を受け取るときにページのインデックスだけを受け入れる必要があります。</span><span class="sxs-lookup"><span data-stu-id="a1659-245">The first one should accept just the page index to display, while the second one accepts the page index and sort expression.</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample7.vb)]

<span data-ttu-id="a1659-246">このチュートリアルでは最初の例では、DropDownList を使用して、並べ替えのインターフェイスを作成しました。</span><span class="sxs-lookup"><span data-stu-id="a1659-246">In the first example in this tutorial, we created a sorting interface using a DropDownList.</span></span> <span data-ttu-id="a1659-247">Let s をこの例では、3 つのボタン Web コントロールでの並べ替えのいずれかの DataList 上に配置を使用して`ProductName`,、1 つの`CategoryName`とに 1 つ`SupplierName`です。</span><span class="sxs-lookup"><span data-stu-id="a1659-247">For this example, let s use three Button Web controls positioned above the DataList one for sorting by `ProductName`, one for `CategoryName`, and one for `SupplierName`.</span></span> <span data-ttu-id="a1659-248">設定、3 つのボタンの Web コントロールを追加、`ID`と`Text`プロパティ適切に。</span><span class="sxs-lookup"><span data-stu-id="a1659-248">Add the three Button Web controls, setting their `ID` and `Text` properties appropriately:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample8.aspx)]

<span data-ttu-id="a1659-249">次に、作成、`Click`ごとのイベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="a1659-249">Next, create a `Click` event handler for each.</span></span> <span data-ttu-id="a1659-250">イベント ハンドラーを呼び出す必要があります、`RedirectUser`適切な並べ替え式を使用して最初のページにユーザーを返すメソッド。</span><span class="sxs-lookup"><span data-stu-id="a1659-250">The event handlers should call the `RedirectUser` method, returning the user to the first page using the appropriate sort expression.</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample9.vb)]

<span data-ttu-id="a1659-251">最初のページへのアクセス、ときに、データはアルファベット順、製品名 (戻るは図 9 を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="a1659-251">When first visiting the page, the data is sorted by the product name alphabetically (refer back to Figure 9).</span></span> <span data-ttu-id="a1659-252">データの 2 番目のページまで進むし、カテゴリ ボタンで並べ替え をクリックするには、次へ ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="a1659-252">Click the Next button to advance to the second page of data and then click the Sort by Category button.</span></span> <span data-ttu-id="a1659-253">これは、カテゴリの名前で並べ替えられたデータの最初のページに戻ります us (図 10 参照)。</span><span class="sxs-lookup"><span data-stu-id="a1659-253">This returns us to the first page of data, sorted by category name (see Figure 10).</span></span> <span data-ttu-id="a1659-254">同様に、業者ボタンをクリックして、並べ替えをクリックするとデータの最初のページから業者によってデータを並べ替えます。</span><span class="sxs-lookup"><span data-stu-id="a1659-254">Likewise, clicking the Sort by Supplier button sorts the data by supplier starting from the first page of data.</span></span> <span data-ttu-id="a1659-255">を通じて、データをページングと並べ替えの選択肢が記憶されます。</span><span class="sxs-lookup"><span data-stu-id="a1659-255">The sort choice is remembered as the data is paged through.</span></span> <span data-ttu-id="a1659-256">図 11 では、カテゴリでの並べ替えとデータの 13 番目のページに移動し、後のページが表示されます。</span><span class="sxs-lookup"><span data-stu-id="a1659-256">Figure 11 shows the page after sorting by category and then advancing to the thirteenth page of data.</span></span>


<span data-ttu-id="a1659-257">[![製品はカテゴリ順に並べ替えられます。](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image27.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="a1659-257">[![The Products are Sorted by Category](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image27.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image26.png)</span></span>

<span data-ttu-id="a1659-258">**図 10**: この製品はカテゴリで並べ替えられます ([フルサイズのイメージを表示するをクリックして](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="a1659-258">**Figure 10**: The Products are Sorted by Category ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image28.png))</span></span>


<span data-ttu-id="a1659-259">[![並べ替え式は記憶とページング経由のデータ](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image30.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="a1659-259">[![The Sort Expression is Remembered When Paging Through the Data](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image30.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image29.png)</span></span>

<span data-ttu-id="a1659-260">**図 11**:、並べ替え式が記憶ときのページングを Data ([フルサイズのイメージを表示するをクリックして](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="a1659-260">**Figure 11**: The Sort Expression is Remembered When Paging Through the Data ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image31.png))</span></span>


## <a name="step-6-custom-paging-through-records-in-a-repeater"></a><span data-ttu-id="a1659-261">手順 6: カスタム ページングとリピータ内のレコード</span><span class="sxs-lookup"><span data-stu-id="a1659-261">Step 6: Custom Paging Through Records in a Repeater</span></span>

<span data-ttu-id="a1659-262">DataList の例では、非効率的な既定ページング技法を使用してそのデータを 5 つのページの手順に検査されます。</span><span class="sxs-lookup"><span data-stu-id="a1659-262">The DataList example examined in step 5 pages through its data using the inefficient default paging technique.</span></span> <span data-ttu-id="a1659-263">十分に大量のデータのページング、ときに、カスタム ページングを使用することが不可欠です。</span><span class="sxs-lookup"><span data-stu-id="a1659-263">When paging through sufficiently large amounts of data, it is imperative that custom paging be used.</span></span> <span data-ttu-id="a1659-264">戻り、[効率的にから大規模な量のデータのページング](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-vb.md)と[カスタム ページングされたデータの並べ替え](../paging-and-sorting/sorting-custom-paged-data-vb.md)の BLL の既定およびカスタム ページングと作成されたメソッドの違いを調べるおチュートリアルについては、カスタム ページングとカスタム ページングされたデータの並べ替えを使用しています。</span><span class="sxs-lookup"><span data-stu-id="a1659-264">Back in the [Efficiently Paging Through Large Amounts of Data](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-vb.md) and [Sorting Custom Paged Data](../paging-and-sorting/sorting-custom-paged-data-vb.md) tutorials, we examined the differences between default and custom paging and created methods in the BLL for utilizing custom paging and sorting custom paged data.</span></span> <span data-ttu-id="a1659-265">具体的には、これら 2 つの前のチュートリアルが追加されましたに次の 3 つのメソッド、`ProductsBLL`クラス。</span><span class="sxs-lookup"><span data-stu-id="a1659-265">In particular, in these two previous tutorials we added the following three methods to the `ProductsBLL` class:</span></span>

- <span data-ttu-id="a1659-266">`GetProductsPaged(startRowIndex, maximumRows)`開始位置としてレコードの特定のサブセットを返します*startRowIndex*を超えないと*maximumRows*です。</span><span class="sxs-lookup"><span data-stu-id="a1659-266">`GetProductsPaged(startRowIndex, maximumRows)` returns a particular subset of records starting at *startRowIndex* and not exceeding *maximumRows*.</span></span>
- <span data-ttu-id="a1659-267">`GetProductsPagedAndSorted(sortExpression, startRowIndex, maximumRows)`特定の順に並べ替えて、指定されたレコードのサブセットを返します*sortExpression*入力パラメーターです。</span><span class="sxs-lookup"><span data-stu-id="a1659-267">`GetProductsPagedAndSorted(sortExpression, startRowIndex, maximumRows)` returns a particular subset of records sorted by the specified *sortExpression* input parameter.</span></span>
- <span data-ttu-id="a1659-268">`TotalNumberOfProducts()`内のレコードの合計数を提供、`Products`データベース テーブルです。</span><span class="sxs-lookup"><span data-stu-id="a1659-268">`TotalNumberOfProducts()` provides the total number of records in the `Products` database table.</span></span>

<span data-ttu-id="a1659-269">ページを効率的におよび、DataList またはリピータ コントロールを使用してデータを並べ替えるには、これらのメソッドを使用できます。</span><span class="sxs-lookup"><span data-stu-id="a1659-269">These methods can be used to efficiently page and sort through data using a DataList or Repeater control.</span></span> <span data-ttu-id="a1659-270">これを示すためには、カスタム ページング サポート; Repeater コントロールを作成して開始 s を使用できます。並べ替え機能を追加します。</span><span class="sxs-lookup"><span data-stu-id="a1659-270">To illustrate this, let s start by creating a Repeater control with custom paging support; we'll then add sorting capabilities.</span></span>

<span data-ttu-id="a1659-271">開く、 `SortingWithCustomPaging.aspx`  ページで、`PagingSortingDataListRepeater`フォルダー設定 ページにリピータを追加し、その`ID`プロパティを`Products`です。</span><span class="sxs-lookup"><span data-stu-id="a1659-271">Open the `SortingWithCustomPaging.aspx` page in the `PagingSortingDataListRepeater` folder and add a Repeater to the page, setting its `ID` property to `Products`.</span></span> <span data-ttu-id="a1659-272">リピータ s のスマート タグからの作成という名前の新しい ObjectDataSource`ProductsDataSource`です。</span><span class="sxs-lookup"><span data-stu-id="a1659-272">From the Repeater s smart tag, create a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="a1659-273">データを選択するように構成、`ProductsBLL`クラスの`GetProductsPaged`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="a1659-273">Configure it to select its data from the `ProductsBLL` class s `GetProductsPaged` method.</span></span>


<span data-ttu-id="a1659-274">[![ObjectDataSource ProductsBLL クラスの GetProductsPaged メソッドを使用して構成します。](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image33.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="a1659-274">[![Configure the ObjectDataSource to Use the ProductsBLL Class s GetProductsPaged Method](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image33.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image32.png)</span></span>

<span data-ttu-id="a1659-275">**図 12**: 構成を使用する ObjectDataSource、`ProductsBLL`クラス s`GetProductsPaged`メソッド ([フルサイズのイメージを表示するをクリックして](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image34.png))</span><span class="sxs-lookup"><span data-stu-id="a1659-275">**Figure 12**: Configure the ObjectDataSource to Use the `ProductsBLL` Class s `GetProductsPaged` Method ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image34.png))</span></span>


<span data-ttu-id="a1659-276">UPDATE、INSERT でのドロップダウン リストの設定を (なし) タブを削除して、次へ ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="a1659-276">Set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) and then click the Next button.</span></span> <span data-ttu-id="a1659-277">ソースでデータ ソースの構成ウィザードの指示に従って今すぐ、`GetProductsPaged`メソッド s *startRowIndex*と*maximumRows*パラメーターを入力します。</span><span class="sxs-lookup"><span data-stu-id="a1659-277">The Configure Data Source wizard now prompts for the sources of the `GetProductsPaged` method s *startRowIndex* and *maximumRows* input parameters.</span></span> <span data-ttu-id="a1659-278">実際には、これらの入力パラメーターは無視されます。</span><span class="sxs-lookup"><span data-stu-id="a1659-278">In actuality, these input parameters are ignored.</span></span> <span data-ttu-id="a1659-279">代わりに、 *startRowIndex*と*maximumRows*経由で値が渡される、 `Arguments` ObjectDataSource s プロパティ`Selecting`お指定する方法と同じように、イベント ハンドラー、*sortExpression*このチュートリアルの最初のデモでします。</span><span class="sxs-lookup"><span data-stu-id="a1659-279">Instead, the *startRowIndex* and *maximumRows* values will be passed in through the `Arguments` property in the ObjectDataSource s `Selecting` event handler, just like how we specified the *sortExpression* in this tutorial s first demo.</span></span> <span data-ttu-id="a1659-280">そのため、パラメーターのソースを None に設定ウィザードでのドロップダウン リストままにします。</span><span class="sxs-lookup"><span data-stu-id="a1659-280">Therefore, leave the parameter source drop-down lists in the wizard set at None .</span></span>


<span data-ttu-id="a1659-281">[![パラメーターのソースになし](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image36.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="a1659-281">[![Leave the Parameter Sources Set to None](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image36.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image35.png)</span></span>

<span data-ttu-id="a1659-282">**図 13**: なし にパラメーターのソースの設定のままにして ([フルサイズのイメージを表示するをクリックして](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image37.png))</span><span class="sxs-lookup"><span data-stu-id="a1659-282">**Figure 13**: Leave the Parameter Sources Set to None ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image37.png))</span></span>


> [!NOTE]
> <span data-ttu-id="a1659-283">操作を行います*されません*集合 ObjectDataSource s`EnablePaging`プロパティを`true`です。</span><span class="sxs-lookup"><span data-stu-id="a1659-283">Do *not* set the ObjectDataSource s `EnablePaging` property to `true`.</span></span> <span data-ttu-id="a1659-284">これにより、自動的に含まれる、独自に ObjectDataSource *startRowIndex*と*maximumRows*パラメーターを`SelectMethod`s 既存のパラメーター リストです。</span><span class="sxs-lookup"><span data-stu-id="a1659-284">This will cause the ObjectDataSource to automatically include its own *startRowIndex* and *maximumRows* parameters to the `SelectMethod` s existing parameter list.</span></span> <span data-ttu-id="a1659-285">`EnablePaging`プロパティは、バインディング カスタム ページングされた DetailsView、GridView、フォーム ビューのコントロールにデータがこれらのコントロールは、ObjectDataSource s から特定の動作を想定しているためときに役立つ場合にのみ使用できます`EnablePaging`プロパティは`true`します。</span><span class="sxs-lookup"><span data-stu-id="a1659-285">The `EnablePaging` property is useful when binding custom paged data to a GridView, DetailsView, or FormView control because these controls expect certain behavior from the ObjectDataSource that s only available when `EnablePaging` property is `true`.</span></span> <span data-ttu-id="a1659-286">DataList およびリピータ ページング サポートを手動で追加するがある、のでこのプロパティ設定のままにして`false`(既定)、おを組み込むことが必要な機能で、ASP.NET ページ内で直接にします。</span><span class="sxs-lookup"><span data-stu-id="a1659-286">Since we have to manually add the paging support for the DataList and Repeater, leave this property set to `false` (the default), as we'll bake in the needed functionality directly within our ASP.NET page.</span></span>


<span data-ttu-id="a1659-287">リピータ s を最後に、定義`ItemTemplate`s の製品名、カテゴリ、および仕入先が表示されるようにします。</span><span class="sxs-lookup"><span data-stu-id="a1659-287">Finally, define the Repeater s `ItemTemplate` so that the product s name, category, and supplier are shown.</span></span> <span data-ttu-id="a1659-288">これらの変更後にリピータと ObjectDataSource s の宣言構文は次のようになります。</span><span class="sxs-lookup"><span data-stu-id="a1659-288">After these changes, the Repeater and ObjectDataSource s declarative syntax should look similar to the following:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample10.aspx)]

<span data-ttu-id="a1659-289">すぐをブラウザーでページにアクセスし、レコードが返されなかったことに注意してください。</span><span class="sxs-lookup"><span data-stu-id="a1659-289">Take a moment to visit the page through a browser and note that no records are returned.</span></span> <span data-ttu-id="a1659-290">これは、ためおを指定するには、まだ ve、 *startRowIndex*と*maximumRows*パラメーターの値の両方でそのため、値は 0 を渡されます。</span><span class="sxs-lookup"><span data-stu-id="a1659-290">This is because we ve yet to specify the *startRowIndex* and *maximumRows* parameter values; therefore, values of 0 are being passed in for both.</span></span> <span data-ttu-id="a1659-291">これらの値を指定するには、ObjectDataSource s のイベント ハンドラーを作成`Selecting`イベント、これらのパラメーター値をプログラムでが 0 で、5、ハードコード値にそれぞれ設定します。</span><span class="sxs-lookup"><span data-stu-id="a1659-291">To specify these values, create an event handler for the ObjectDataSource s `Selecting` event and set these parameters values programmatically to hard-coded values of 0 and 5, respectively:</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample11.vb)]

<span data-ttu-id="a1659-292">この変更によりは、ブラウザーを介して表示したときに、ページは、最初の 5 つの製品を表示します。</span><span class="sxs-lookup"><span data-stu-id="a1659-292">With this change, the page, when viewed through a browser, shows the first five products.</span></span>


<span data-ttu-id="a1659-293">[![最初の 5 つのレコードが表示されます。](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image39.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="a1659-293">[![The First Five Records are Displayed](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image39.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image38.png)</span></span>

<span data-ttu-id="a1659-294">**図 14**: の最初の 5 つのレコードが表示されます ([フルサイズのイメージを表示するをクリックして](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image40.png))</span><span class="sxs-lookup"><span data-stu-id="a1659-294">**Figure 14**: The First Five Records are Displayed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image40.png))</span></span>


> [!NOTE]
> <span data-ttu-id="a1659-295">図 14 に示される製品が製品名によって並べ替えするために発生する、`GetProductsPaged`効率的なカスタム ページング クエリを実行するストアド プロシージャで結果を順序付けます`ProductName`です。</span><span class="sxs-lookup"><span data-stu-id="a1659-295">The products listed in Figure 14 happen to be sorted by product name because the `GetProductsPaged` stored procedure that performs the efficient custom paging query orders the results by `ProductName`.</span></span>


<span data-ttu-id="a1659-296">手順、ページを実行するユーザーをできるようにするのには、開始行のインデックスと行の最大数を追跡し、ポストバック間でこれらの値を保存する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a1659-296">In order to allow the user to step through the pages, we need to keep track of the start row index and maximum rows and remember these values across postbacks.</span></span> <span data-ttu-id="a1659-297">ページングの既定の例で使用して、クエリ文字列フィールドにこれらの値を永続化このデモでは、s がページのビュー ステートにこの情報を永続化を使用できます。</span><span class="sxs-lookup"><span data-stu-id="a1659-297">In the default paging example we used querystring fields to persist these values; for this demo, let s persist this information in the page s view state.</span></span> <span data-ttu-id="a1659-298">次の 2 つのプロパティを作成します。</span><span class="sxs-lookup"><span data-stu-id="a1659-298">Create the following two properties:</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample12.vb)]

<span data-ttu-id="a1659-299">使用するように選択するとイベント ハンドラーでコードを次に、更新、`StartRowIndex`と`MaximumRows`0 および 5 のハードコード値ではなくプロパティ。</span><span class="sxs-lookup"><span data-stu-id="a1659-299">Next, update the code in the Selecting event handler so that it uses the `StartRowIndex` and `MaximumRows` properties instead of the hard-coded values of 0 and 5:</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample13.vb)]

<span data-ttu-id="a1659-300">この時点で、ページは、最初の 5 つのレコードだけを引き続き表示されます。</span><span class="sxs-lookup"><span data-stu-id="a1659-300">At this point our page still shows just the first five records.</span></span> <span data-ttu-id="a1659-301">ただし、これらのプロパティを同じ位置でのページング インターフェイスを作成する準備ができたらします。</span><span class="sxs-lookup"><span data-stu-id="a1659-301">However, with these properties in place, we re ready to create our paging interface.</span></span>

## <a name="adding-the-paging-interface"></a><span data-ttu-id="a1659-302">ページング インターフェイスの追加</span><span class="sxs-lookup"><span data-stu-id="a1659-302">Adding the Paging Interface</span></span>

<span data-ttu-id="a1659-303">使用すると、用途に、同じ最初、前に、次に、最後のページングのインターフェイスは、既定ページング例では、どのようなページのデータを表示するコントロールが表示されているラベル Web を含むと合計ページ数の存在で使用されます。</span><span class="sxs-lookup"><span data-stu-id="a1659-303">Let s use the same First, Previous, Next, Last paging interface used in the default paging example, including the Label Web control that displays what page of data is being viewed and how many total pages exist.</span></span> <span data-ttu-id="a1659-304">次の 4 つのボタン Web コントロールおよびリピータ下にあるラベルを追加します。</span><span class="sxs-lookup"><span data-stu-id="a1659-304">Add the four Button Web controls and Label below the Repeater.</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample14.aspx)]

<span data-ttu-id="a1659-305">次に、作成`Click`4 つのボタンのイベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="a1659-305">Next, create `Click` event handlers for the four Buttons.</span></span> <span data-ttu-id="a1659-306">これらのボタンがクリックされたときに更新する必要があります、`StartRowIndex`リピータにデータを再バインドとします。</span><span class="sxs-lookup"><span data-stu-id="a1659-306">When one of these Buttons is clicked, we need to update the `StartRowIndex` and rebind the data to the Repeater.</span></span> <span data-ttu-id="a1659-307">最初、Previous、および [次へ] ボタンのコードは単純なのでが最後のボタンの方法はおを確認するデータの最後のページの開始行のインデックスしますか。</span><span class="sxs-lookup"><span data-stu-id="a1659-307">The code for the First, Previous, and Next buttons is simple enough, but for the Last button how do we determine the start row index for the last page of data?</span></span> <span data-ttu-id="a1659-308">このインデックスだけでなくを介してページングされている合計レコードの数を知っておくべき次へ および最後のボタンを有効にするかどうかを判断できるを計算します。</span><span class="sxs-lookup"><span data-stu-id="a1659-308">To compute this index as well as being able to determine whether the Next and Last buttons should be enabled we need to know how many records in total are being paged through.</span></span> <span data-ttu-id="a1659-309">これを呼び出すことによって判断できます、`ProductsBLL`クラスの`TotalNumberOfProducts()`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="a1659-309">We can determine this by calling the `ProductsBLL` class s `TotalNumberOfProducts()` method.</span></span> <span data-ttu-id="a1659-310">Let s という名前の読み取り専用で、ページ レベルのプロパティを作成する`TotalRowCount`の結果を返す、`TotalNumberOfProducts()`メソッド。</span><span class="sxs-lookup"><span data-stu-id="a1659-310">Let s create a read-only, page-level property named `TotalRowCount` that returns the results of the `TotalNumberOfProducts()` method:</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample15.vb)]

<span data-ttu-id="a1659-311">このプロパティを持つようになりました最後のページの開始行のインデックスを判断できます。</span><span class="sxs-lookup"><span data-stu-id="a1659-311">With this property we can now determine the last page s start row index.</span></span> <span data-ttu-id="a1659-312">具体的には、その結果の整数値の秒の`TotalRowCount`で割った値 1 を引いた`MaximumRows`を掛けた`MaximumRows`です。</span><span class="sxs-lookup"><span data-stu-id="a1659-312">Specifically, it s the integer result of the `TotalRowCount` minus 1 divided by `MaximumRows`, multiplied by `MaximumRows`.</span></span> <span data-ttu-id="a1659-313">お記述できるよう、`Click`ページング インターフェイスの 4 つのボタンのイベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="a1659-313">We can now write the `Click` event handlers for the four paging interface buttons:</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample16.vb)]

<span data-ttu-id="a1659-314">最後に、最後のページを表示するときに、データと、次へと最後のボタンの最初のページを表示するときに、まず 戻る ボタン、ページング インターフェイスでを無効にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="a1659-314">Finally, we need to disable the First and Previous buttons in the paging interface when viewing the first page of data and the Next and Last buttons when viewing the last page.</span></span> <span data-ttu-id="a1659-315">これを実現する次のコードを追加、ObjectDataSource の`Selecting`イベントのハンドラー。</span><span class="sxs-lookup"><span data-stu-id="a1659-315">To accomplish this, add the following code to the ObjectDataSource s `Selecting` event handler:</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample17.vb)]

<span data-ttu-id="a1659-316">これらの追加後に`Click`イベント ハンドラーとコードが有効にするにまたは現在の開始行のインデックスに基づくページング インターフェイス要素を無効にするには、ブラウザーでページをテストします。</span><span class="sxs-lookup"><span data-stu-id="a1659-316">After adding these `Click` event handlers and the code to enable or disable the paging interface elements based on the current start row index, test the page in a browser.</span></span> <span data-ttu-id="a1659-317">図 15 示すように、まず最初のページにアクセスすると、[戻る] ボタンは無効になります。</span><span class="sxs-lookup"><span data-stu-id="a1659-317">As Figure 15 illustrates, when first visiting the page the First and Previous buttons will are disabled.</span></span> <span data-ttu-id="a1659-318">最後をクリックすると最後のページが表示されますが、データの 2 ページ目 [次へ] をクリックすると表示 (図 16、17 を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="a1659-318">Clicking Next shows the second page of data, while clicking Last displays the final page (see Figures 16 and 17).</span></span> <span data-ttu-id="a1659-319">データの最後のページを表示するときに、次へと最後のボタンは無効です。</span><span class="sxs-lookup"><span data-stu-id="a1659-319">When viewing the last page of data both the Next and Last buttons are disabled.</span></span>


<span data-ttu-id="a1659-320">[![製品の最初のページを表示するときに、前と最後のボタンが無効にします。](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image42.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image41.png)</span><span class="sxs-lookup"><span data-stu-id="a1659-320">[![The Previous and Last Buttons are Disabled When Viewing the First Page of Products](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image42.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image41.png)</span></span>

<span data-ttu-id="a1659-321">**図 15**: 製品の最初のページを表示するときに、前と最後のボタンが無効に ([フルサイズのイメージを表示するをクリックして](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image43.png))</span><span class="sxs-lookup"><span data-stu-id="a1659-321">**Figure 15**: The Previous and Last Buttons are Disabled When Viewing the First Page of Products ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image43.png))</span></span>


<span data-ttu-id="a1659-322">[![2 番目のページの製品がいないことを示す](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image45.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image44.png)</span><span class="sxs-lookup"><span data-stu-id="a1659-322">[![The Second Page of Products are Dispalyed](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image45.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image44.png)</span></span>

<span data-ttu-id="a1659-323">**図 16**: 2 番目のページの製品がいないことを示す ([フルサイズのイメージを表示するをクリックして](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image46.png))</span><span class="sxs-lookup"><span data-stu-id="a1659-323">**Figure 16**: The Second Page of Products are Dispalyed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image46.png))</span></span>


<span data-ttu-id="a1659-324">[![最後の表示データの最後のページをクリックして](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image48.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image47.png)</span><span class="sxs-lookup"><span data-stu-id="a1659-324">[![Clicking Last Displays the Final Page of Data](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image48.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image47.png)</span></span>

<span data-ttu-id="a1659-325">**図 17**: 最後のデータ ページの最後をクリックすると表示 ([フルサイズのイメージを表示するをクリックして](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image49.png))</span><span class="sxs-lookup"><span data-stu-id="a1659-325">**Figure 17**: Clicking Last Displays the Final Page of Data ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image49.png))</span></span>


## <a name="step-7-including-sorting-support-with-the-custom-paged-repeater"></a><span data-ttu-id="a1659-326">手順 7: Repeater をページング サポートをカスタムの並べ替えを含む</span><span class="sxs-lookup"><span data-stu-id="a1659-326">Step 7: Including Sorting Support with the Custom Paged Repeater</span></span>

<span data-ttu-id="a1659-327">これで、カスタム ページングを実装すると、並べ替えを含める準備ができたらがサポートされることです。</span><span class="sxs-lookup"><span data-stu-id="a1659-327">Now that custom paging has been implemented, we re ready to include sorting support.</span></span> <span data-ttu-id="a1659-328">`ProductsBLL`クラス s`GetProductsPagedAndSorted`メソッドには、同じ*startRowIndex*と*maximumRows*入力パラメーターとして`GetProductsPaged`、追加で許可されるが、 *sortExpression*入力パラメーターです。</span><span class="sxs-lookup"><span data-stu-id="a1659-328">The `ProductsBLL` class s `GetProductsPagedAndSorted` method has the same *startRowIndex* and *maximumRows* input parameters as `GetProductsPaged`, but permits an additional *sortExpression* input parameter.</span></span> <span data-ttu-id="a1659-329">使用する、`GetProductsPagedAndSorted`メソッドから`SortingWithCustomPaging.aspx`、次の手順を実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a1659-329">To use the `GetProductsPagedAndSorted` method from `SortingWithCustomPaging.aspx`, we need to perform the following steps:</span></span>

1. <span data-ttu-id="a1659-330">ObjectDataSource s を変更する`SelectMethod`プロパティから`GetProductsPaged`に`GetProductsPagedAndSorted`です。</span><span class="sxs-lookup"><span data-stu-id="a1659-330">Change the ObjectDataSource s `SelectMethod` property from `GetProductsPaged` to `GetProductsPagedAndSorted`.</span></span>
2. <span data-ttu-id="a1659-331">追加、 *sortExpression* `Parameter`オブジェクトに、ObjectDataSource の`SelectParameters`コレクション。</span><span class="sxs-lookup"><span data-stu-id="a1659-331">Add a *sortExpression* `Parameter` object to the ObjectDataSource s `SelectParameters` collection.</span></span>
3. <span data-ttu-id="a1659-332">プライベート、ページ レベルの作成`SortExpression`ページ ビュー ステートをポストバック間でその値が引き続き発生するプロパティです。</span><span class="sxs-lookup"><span data-stu-id="a1659-332">Create a private, page-level `SortExpression` property that persists its value across postbacks through the page s view state.</span></span>
4. <span data-ttu-id="a1659-333">ObjectDataSource %s 更新`Selecting`イベント ハンドラーに、ObjectDataSource s を割り当てる*sortExpression*パラメーター ページ レベルの値`SortExpression`プロパティです。</span><span class="sxs-lookup"><span data-stu-id="a1659-333">Update the ObjectDataSource s `Selecting` event handler to assign the ObjectDataSource s *sortExpression* parameter the value of the page-level `SortExpression` property.</span></span>
5. <span data-ttu-id="a1659-334">並べ替えのインターフェイスを作成します。</span><span class="sxs-lookup"><span data-stu-id="a1659-334">Create the sorting interface.</span></span>

<span data-ttu-id="a1659-335">ObjectDataSource s を更新することによって開始`SelectMethod`プロパティと追加する、 *sortExpression* `Parameter`です。</span><span class="sxs-lookup"><span data-stu-id="a1659-335">Start by updating the ObjectDataSource s `SelectMethod` property and adding a *sortExpression* `Parameter`.</span></span> <span data-ttu-id="a1659-336">確認して、 *sortExpression* `Parameter` s`Type`プロパティに設定されている`String`です。</span><span class="sxs-lookup"><span data-stu-id="a1659-336">Make sure that the *sortExpression* `Parameter` s `Type` property is set to `String`.</span></span> <span data-ttu-id="a1659-337">これらの最初の 2 つのタスクを完了すると、ObjectDataSource s の宣言型マークアップは、次のようになります。</span><span class="sxs-lookup"><span data-stu-id="a1659-337">After completing these first two tasks, the ObjectDataSource s declarative markup should look like the following:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample18.aspx)]

<span data-ttu-id="a1659-338">次に、ページ レベル必要があります`SortExpression`ビューステートにシリアル化する値を持つプロパティです。</span><span class="sxs-lookup"><span data-stu-id="a1659-338">Next, we need a page-level `SortExpression` property whose value is serialized to view state.</span></span> <span data-ttu-id="a1659-339">並べ替え式の値が設定されていない場合は、既定値として ProductName を使用します。</span><span class="sxs-lookup"><span data-stu-id="a1659-339">If no sort expression value has been set, use ProductName as the default:</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample19.vb)]

<span data-ttu-id="a1659-340">ObjectDataSource を呼び出す前に、`GetProductsPagedAndSorted`メソッドを設定する必要があります、 *sortExpression* `Parameter`の値に、`SortExpression`プロパティです。</span><span class="sxs-lookup"><span data-stu-id="a1659-340">Before the ObjectDataSource invokes the `GetProductsPagedAndSorted` method we need to set the *sortExpression* `Parameter` to the value of the `SortExpression` property.</span></span> <span data-ttu-id="a1659-341">`Selecting`イベント ハンドラーでは、次のコード行を追加します。</span><span class="sxs-lookup"><span data-stu-id="a1659-341">In the `Selecting` event handler, add the following line of code:</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample20.vb)]

<span data-ttu-id="a1659-342">並べ替えのインターフェイスを実装します。</span><span class="sxs-lookup"><span data-stu-id="a1659-342">All that remains is to implement the sorting interface.</span></span> <span data-ttu-id="a1659-343">最後の例で行ったように、製品名、カテゴリ、または供給業者によって結果の並べ替えをユーザーに許可する 3 つのボタンの Web コントロールを使用して実装されている並べ替えのインターフェイスを持っている s を使用できます。</span><span class="sxs-lookup"><span data-stu-id="a1659-343">As we did in the last example, let s have the sorting interface implemented using three Button Web controls that allow the user to sort the results by product name, category, or supplier.</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample21.aspx)]

<span data-ttu-id="a1659-344">作成`Click`これら 3 つのボタン コントロールのイベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="a1659-344">Create `Click` event handlers for these three Button controls.</span></span> <span data-ttu-id="a1659-345">イベント ハンドラー、リセット、`StartRowIndex`を 0 に設定、`SortExpression`へ rebind リピータするデータを適切な値。</span><span class="sxs-lookup"><span data-stu-id="a1659-345">In the event handler, reset the `StartRowIndex` to 0, set the `SortExpression` to the appropriate value, and rebind the data to the Repeater:</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample22.vb)]

<span data-ttu-id="a1659-346">すべてが s です!</span><span class="sxs-lookup"><span data-stu-id="a1659-346">That s all there is to it!</span></span> <span data-ttu-id="a1659-347">カスタム ページングと実装の並べ替えを取得する手順の数が、手順を実行しました既定のページングの必要なアクセス許可によく似ています。</span><span class="sxs-lookup"><span data-stu-id="a1659-347">While there were a number of steps to get custom paging and sorting implemented, the steps were very similar to those needed for default paging.</span></span> <span data-ttu-id="a1659-348">図 18 では、カテゴリで並べ替えられたデータの最後のページを表示するときに、製品が表示されます。</span><span class="sxs-lookup"><span data-stu-id="a1659-348">Figure 18 shows the products when viewing the last page of data when sorted by category.</span></span>


<span data-ttu-id="a1659-349">[![最後のページのデータ、カテゴリ別、Sorted が表示されます。](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image51.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image50.png)</span><span class="sxs-lookup"><span data-stu-id="a1659-349">[![The Last Page of Data, Sorted by Category, is Displayed](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image51.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image50.png)</span></span>

<span data-ttu-id="a1659-350">**図 18**: 最後のページのデータ、カテゴリ別、Sorted が表示されます ([フルサイズのイメージを表示するをクリックして](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image52.png))</span><span class="sxs-lookup"><span data-stu-id="a1659-350">**Figure 18**: The Last Page of Data, Sorted by Category, is Displayed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image52.png))</span></span>


> [!NOTE]
> <span data-ttu-id="a1659-351">前の例で、並べ替え式として使用されました。 選択は業者によって並べ替えるときにします。</span><span class="sxs-lookup"><span data-stu-id="a1659-351">In previous examples, when sorting by the supplier SupplierName was used as the sort expression.</span></span> <span data-ttu-id="a1659-352">ただし、カスタム ページングの実装の CompanyName を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a1659-352">However, for the custom paging implementation, we need to use CompanyName.</span></span> <span data-ttu-id="a1659-353">これはカスタム ページングの実装を担当するストアド プロシージャ`GetProductsPagedAndSorted`に並べ替え式を渡します、`ROW_NUMBER()`キーワード、`ROW_NUMBER()`キーワードは、別名ではなく、実際の列名が必要です。</span><span class="sxs-lookup"><span data-stu-id="a1659-353">This is because the stored procedure responsible for implementing custom paging `GetProductsPagedAndSorted` passes the sort expression into the `ROW_NUMBER()` keyword, The `ROW_NUMBER()` keyword requires the actual column name rather than an alias.</span></span> <span data-ttu-id="a1659-354">したがって、使用する必要があります`CompanyName`(内の列の名前、`Suppliers`テーブル) で使用される別名ではなく、`SELECT`クエリ (`SupplierName`) の並べ替え式。</span><span class="sxs-lookup"><span data-stu-id="a1659-354">Therefore, we must use `CompanyName` (the name of the column in the `Suppliers` table) rather than the alias used in the `SELECT` query (`SupplierName`) for the sort expression.</span></span>


## <a name="summary"></a><span data-ttu-id="a1659-355">まとめ</span><span class="sxs-lookup"><span data-stu-id="a1659-355">Summary</span></span>

<span data-ttu-id="a1659-356">どちらも DataList もリピータが組み込みの並べ替えのサポートを提供してがほんの少しのコードとカスタムの並べ替えインターフェイスのこのような機能を追加できます。</span><span class="sxs-lookup"><span data-stu-id="a1659-356">Neither the DataList nor Repeater offer built-in sorting support, but with a bit of code and a custom sorting interface, such functionality can be added.</span></span> <span data-ttu-id="a1659-357">を介して、並べ替え式を指定することができます、並べ替え、ページングを実装する場合、 `DataSourceSelectArguments` ObjectDataSource s にオブジェクトが渡された`Select`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="a1659-357">When implementing sorting, but not paging, the sort expression can be specified through the `DataSourceSelectArguments` object passed into the ObjectDataSource s `Select` method.</span></span> <span data-ttu-id="a1659-358">これは、`DataSourceSelectArguments`オブジェクト s `SortExpression` ObjectDataSource s でプロパティを割り当てることができます`Selecting`イベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="a1659-358">This `DataSourceSelectArguments` object s `SortExpression` property can be assigned in the ObjectDataSource s `Selecting` event handler.</span></span>

<span data-ttu-id="a1659-359">DataList またはリピータ既にページング サポートを提供するには、並べ替え機能を追加するには、最も簡単な方法は、並べ替え式を受け取るメソッドを追加するビジネス ロジック層をカスタマイズするのにです。</span><span class="sxs-lookup"><span data-stu-id="a1659-359">To add sorting capabilities to a DataList or Repeater that already provides paging support, the easiest approach is to customize the Business Logic Layer to include a method that accepts a sort expression.</span></span> <span data-ttu-id="a1659-360">この情報できますし、渡されるで ObjectDataSource s パラメーター`SelectParameters`です。</span><span class="sxs-lookup"><span data-stu-id="a1659-360">This information can then be passed in through a parameter in the ObjectDataSource s `SelectParameters`.</span></span>

<span data-ttu-id="a1659-361">このチュートリアルでは、ページングと、DataList およびリピータ コントロールの並べ替え弊社の調査を完了します。</span><span class="sxs-lookup"><span data-stu-id="a1659-361">This tutorial completes our examination of paging and sorting with the DataList and Repeater controls.</span></span> <span data-ttu-id="a1659-362">[次へ] および最後のチュートリアルでは、アイテムごとにいくつか、ユーザーによるカスタムの機能を提供するために、DataList およびリピータのテンプレートにボタンの Web コントロールを追加する方法を確認します。</span><span class="sxs-lookup"><span data-stu-id="a1659-362">Our next and final tutorial will examine how to add Button Web controls to the DataList and Repeater s templates in order to provide some custom, user-initiated functionality on a per-item basis.</span></span>

<span data-ttu-id="a1659-363">満足プログラミング!</span><span class="sxs-lookup"><span data-stu-id="a1659-363">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="a1659-364">作成者について</span><span class="sxs-lookup"><span data-stu-id="a1659-364">About the Author</span></span>

<span data-ttu-id="a1659-365">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)、7 つ受け取りますブックとの創設者の作成者[4GuysFromRolla.com](http://www.4guysfromrolla.com)、1998 年からマイクロソフトの Web テクノロジで取り組んできました。</span><span class="sxs-lookup"><span data-stu-id="a1659-365">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="a1659-366">Scott は、コンサルタント、トレーナー、ライターとして機能します。</span><span class="sxs-lookup"><span data-stu-id="a1659-366">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="a1659-367">最新の著書[ *Sam 学べる自分で ASP.NET 2.0 が 24 時間以内に*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)です。</span><span class="sxs-lookup"><span data-stu-id="a1659-367">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="a1659-368">彼に到達できる[ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)彼のブログを使用して含まれているのか[http://ScottOnWriting.NET](http://ScottOnWriting.NET)です。</span><span class="sxs-lookup"><span data-stu-id="a1659-368">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="a1659-369">感謝の特別な</span><span class="sxs-lookup"><span data-stu-id="a1659-369">Special Thanks To</span></span>

<span data-ttu-id="a1659-370">このチュートリアルの系列は既に多くの便利なレビュー担当者によって確認済みです。</span><span class="sxs-lookup"><span data-stu-id="a1659-370">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="a1659-371">このチュートリアルのレビュー担当者の潜在顧客は、David Suru をでした。</span><span class="sxs-lookup"><span data-stu-id="a1659-371">Lead reviewer for this tutorial was David Suru.</span></span> <span data-ttu-id="a1659-372">今後、MSDN の記事を確認することに関心のあるですか。</span><span class="sxs-lookup"><span data-stu-id="a1659-372">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="a1659-373">場合は、ドロップ me 一度に 1 行ずつ[mitchell@4GuysFromRolla.comです。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="a1659-373">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

>[!div class="step-by-step"]
[<span data-ttu-id="a1659-374">前へ</span><span class="sxs-lookup"><span data-stu-id="a1659-374">Previous</span></span>](paging-report-data-in-a-datalist-or-repeater-control-vb.md)
