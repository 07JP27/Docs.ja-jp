---
uid: web-forms/overview/data-access/working-with-batched-data/batch-updating-vb
title: 一括更新 (VB) |Microsoft ドキュメント
author: rick-anderson
description: 単一の操作で複数のデータベース レコードを更新する方法を説明します。 ユーザー インターフェイス レイヤーは、各行が編集可能 GridView を構築します。 データにしています.
ms.author: aspnetcontent
manager: wpickett
ms.date: 06/26/2007
ms.topic: article
ms.assetid: d191a204-d7ea-458d-b81c-0b9049ecb55f
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/working-with-batched-data/batch-updating-vb
msc.type: authoredcontent
ms.openlocfilehash: 2c5119410057b39e7b9a03eca3a2dbdbc315ce00
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/06/2018
---
<a name="batch-updating-vb"></a><span data-ttu-id="a499f-105">一括更新 (VB)</span><span class="sxs-lookup"><span data-stu-id="a499f-105">Batch Updating (VB)</span></span>
====================
<span data-ttu-id="a499f-106">によって[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="a499f-106">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="a499f-107">[コードをダウンロードする](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_64_VB.zip)または[PDF のダウンロード](batch-updating-vb/_static/datatutorial64vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="a499f-107">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_64_VB.zip) or [Download PDF](batch-updating-vb/_static/datatutorial64vb1.pdf)</span></span>

> <span data-ttu-id="a499f-108">単一の操作で複数のデータベース レコードを更新する方法を説明します。</span><span class="sxs-lookup"><span data-stu-id="a499f-108">Learn how to update multiple database records in a single operation.</span></span> <span data-ttu-id="a499f-109">ユーザー インターフェイス レイヤーは、各行が編集可能 GridView を構築します。</span><span class="sxs-lookup"><span data-stu-id="a499f-109">In the User Interface Layer we build a GridView where each row is editable.</span></span> <span data-ttu-id="a499f-110">データ アクセス層は、すべての更新プログラムが成功するすべての更新をロールバックすることを確認するトランザクション内で複数の更新操作をラップします。</span><span class="sxs-lookup"><span data-stu-id="a499f-110">In the Data Access Layer we wrap the multiple Update operations within a transaction to ensure that all updates succeed or all updates are rolled back.</span></span>


## <a name="introduction"></a><span data-ttu-id="a499f-111">はじめに</span><span class="sxs-lookup"><span data-stu-id="a499f-111">Introduction</span></span>

<span data-ttu-id="a499f-112">[前のチュートリアル](wrapping-database-modifications-within-a-transaction-vb.md)データベース トランザクションのサポートを追加するデータ アクセス層を拡張する方法を説明しました。</span><span class="sxs-lookup"><span data-stu-id="a499f-112">In the [preceding tutorial](wrapping-database-modifications-within-a-transaction-vb.md) we saw how to extend the Data Access Layer to add support for database transactions.</span></span> <span data-ttu-id="a499f-113">データベースのトランザクションでは、一連のデータ変更ステートメントが確実にすべての変更は失敗または成功すべてが 1 つのアトミックの操作として扱われますことを保証します。</span><span class="sxs-lookup"><span data-stu-id="a499f-113">Database transactions guarantee that a series of data modification statements will be treated as one atomic operation, which ensures that all modifications will fail or all will succeed.</span></span> <span data-ttu-id="a499f-114">低レベル DAL、この機能を邪魔にバッチのデータ変更のインターフェイスを作成することに注目する re おを準備します。</span><span class="sxs-lookup"><span data-stu-id="a499f-114">With this low-level DAL functionality out of the way, we re ready to turn our attention to creating batch data modification interfaces.</span></span>

<span data-ttu-id="a499f-115">このチュートリアルでは各行が編集可能な (図 1 参照) が GridView ビルドします。</span><span class="sxs-lookup"><span data-stu-id="a499f-115">In this tutorial we'll build a GridView where each row is editable (see Figure 1).</span></span> <span data-ttu-id="a499f-116">各行がレンダリング インターフェイスには編集、そこ s されません編集の列の必要性、ため、更新、およびキャンセル ボタン。</span><span class="sxs-lookup"><span data-stu-id="a499f-116">Since each row is rendered in its editing interface, there s no need for a column of Edit, Update, and Cancel buttons.</span></span> <span data-ttu-id="a499f-117">代わりに、2 つの製品の更新ボタンにあるページをクリックすると、GridView 行を列挙し、データベースを更新します。</span><span class="sxs-lookup"><span data-stu-id="a499f-117">Instead, there are two Update Products buttons on the page that, when clicked, enumerate the GridView rows and update the database.</span></span>


<span data-ttu-id="a499f-118">[![GridView の各行は編集可能であります。](batch-updating-vb/_static/image1.gif)](batch-updating-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="a499f-118">[![Each Row in the GridView is Editable](batch-updating-vb/_static/image1.gif)](batch-updating-vb/_static/image1.png)</span></span>

<span data-ttu-id="a499f-119">**図 1**: GridView で各の行が編集可能 ([フルサイズのイメージを表示するをクリックして](batch-updating-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="a499f-119">**Figure 1**: Each Row in the GridView is Editable ([Click to view full-size image](batch-updating-vb/_static/image2.png))</span></span>


<span data-ttu-id="a499f-120">開始 s を let!</span><span class="sxs-lookup"><span data-stu-id="a499f-120">Let s get started!</span></span>

> [!NOTE]
> <span data-ttu-id="a499f-121">[バッチ更新を実行する](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-vb.md)DataList コントロールを使用してバッチの編集を作成したチュートリアルのインターフェイスです。</span><span class="sxs-lookup"><span data-stu-id="a499f-121">In the [Performing Batch Updates](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-vb.md) tutorial we created a batch editing interface using the DataList control.</span></span> <span data-ttu-id="a499f-122">このチュートリアルに 1 つは、使用前、GridView と異なりバッチ更新は、トランザクションのスコープ内で実行します。</span><span class="sxs-lookup"><span data-stu-id="a499f-122">This tutorial differs from the previous one in that is uses a GridView and the batch update is performed within the scope of a transaction.</span></span> <span data-ttu-id="a499f-123">このチュートリアルを完了した後はことをお勧めすると、以前のチュートリアルに戻るし、前のチュートリアルで追加されたデータベースのトランザクションに関連する機能を使用するように更新します。</span><span class="sxs-lookup"><span data-stu-id="a499f-123">After completing this tutorial I encourage you to return to the earlier tutorial and update it to use the database transaction-related functionality added in the preceding tutorial.</span></span>


## <a name="examining-the-steps-for-making-all-gridview-rows-editable"></a><span data-ttu-id="a499f-124">GridView のすべての行を編集可能にするための手順を確認します。</span><span class="sxs-lookup"><span data-stu-id="a499f-124">Examining the Steps for Making All GridView Rows Editable</span></span>

<span data-ttu-id="a499f-125">説明したように、 [、概要の挿入、更新、およびデータの削除](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md)チュートリアルでは、GridView は、行ごとに、基になるデータを編集するための組み込みサポートを提供します。</span><span class="sxs-lookup"><span data-stu-id="a499f-125">As discussed in the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) tutorial, the GridView offers built-in support for editing its underlying data on a per-row basis.</span></span> <span data-ttu-id="a499f-126">内部的には、GridView ノート、どのような行を使用して編集その[`EditIndex`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.editindex(VS.80).aspx)です。</span><span class="sxs-lookup"><span data-stu-id="a499f-126">Internally, the GridView notes what row is editable through its [`EditIndex` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.editindex(VS.80).aspx).</span></span> <span data-ttu-id="a499f-127">GridView は、そのデータ ソースにバインドされているが、そのチェックして、行のインデックスの値に等しいかどうかは行ごと`EditIndex`です。</span><span class="sxs-lookup"><span data-stu-id="a499f-127">As the GridView is being bound to its data source, it checks each row to see if the index of the row equals the value of `EditIndex`.</span></span> <span data-ttu-id="a499f-128">場合は、その行の編集を使用してフィールドを表示する s はインターフェイスです。</span><span class="sxs-lookup"><span data-stu-id="a499f-128">If so, that row s fields are rendered using their editing interfaces.</span></span> <span data-ttu-id="a499f-129">BoundFields、編集のインターフェイスは、テキスト ボックスが`Text`プロパティには、BoundField 秒で指定されたデータ フィールドの値が割り当てられた`DataField`プロパティです。</span><span class="sxs-lookup"><span data-stu-id="a499f-129">For BoundFields, the editing interface is a TextBox whose `Text` property is assigned the value of the data field specified by the BoundField s `DataField` property.</span></span> <span data-ttu-id="a499f-130">TemplateFields、用、`EditItemTemplate`の代わりに使用される、`ItemTemplate`です。</span><span class="sxs-lookup"><span data-stu-id="a499f-130">For TemplateFields, the `EditItemTemplate` is used in place of the `ItemTemplate`.</span></span>

<span data-ttu-id="a499f-131">ユーザーが行の編集 ボタンをクリックしたときに編集ワークフローが開始されることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="a499f-131">Recall that the editing workflow starts when a user clicks a row s Edit button.</span></span> <span data-ttu-id="a499f-132">これには、ポストバックを発生させる、GridView s を設定`EditIndex`s クリックされた行のインデックス、およびグリッドにデータを再バインドするプロパティです。</span><span class="sxs-lookup"><span data-stu-id="a499f-132">This causes a postback, sets the GridView s `EditIndex` property to the clicked row s index, and rebinds the data to the grid.</span></span> <span data-ttu-id="a499f-133">ポストバック時に、行 s [キャンセル] ボタンをクリックすると、`EditIndex`の値に設定されている`-1`グリッドにデータを再バインドする前にします。</span><span class="sxs-lookup"><span data-stu-id="a499f-133">When a row s Cancel button is clicked, on postback the `EditIndex` is set to a value of `-1` before rebinding the data to the grid.</span></span> <span data-ttu-id="a499f-134">GridView の行は、0 でのインデックス作成を開始するための設定`EditIndex`に`-1`読み取り専用モードでの GridView の表示の効果があります。</span><span class="sxs-lookup"><span data-stu-id="a499f-134">Since the GridView s rows start indexing at zero, setting `EditIndex` to `-1` has the effect of displaying the GridView in read-only mode.</span></span>

<span data-ttu-id="a499f-135">`EditIndex`プロパティは、行ごとの編集に適してがバッチを編集するためのものではありません。</span><span class="sxs-lookup"><span data-stu-id="a499f-135">The `EditIndex` property works well for per-row editing, but is not designed for batch editing.</span></span> <span data-ttu-id="a499f-136">全体の GridView を編集するためは、各行の編集用のインターフェイスを使用して表示する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a499f-136">To make the entire GridView editable, we need to have each row render using its editing interface.</span></span> <span data-ttu-id="a499f-137">これを実現する最も簡単な方法は編集可能な各フィールドが実装されている編集インターフェイスと TemplateField で定義されている場所を作成する、`ItemTemplate`です。</span><span class="sxs-lookup"><span data-stu-id="a499f-137">The easiest way to accomplish this is to create where each editable field is implemented as a TemplateField with its editing interface defined in the `ItemTemplate`.</span></span>

<span data-ttu-id="a499f-138">次にいくつかの手順が作成されます GridView を完全に編集可能です。</span><span class="sxs-lookup"><span data-stu-id="a499f-138">Over the next several steps we'll create a completely editable GridView.</span></span> <span data-ttu-id="a499f-139">手順 1. では、GridView と、ObjectDataSource を作成することでし TemplateFields その BoundFields と CheckBoxField に変換します。</span><span class="sxs-lookup"><span data-stu-id="a499f-139">In Step 1 we'll start by creating the GridView and its ObjectDataSource and convert its BoundFields and CheckBoxField into TemplateFields.</span></span> <span data-ttu-id="a499f-140">手順 2 および 3 の TemplateFields から編集インターフェイスに移動します`EditItemTemplate`s、 `ItemTemplate` s。</span><span class="sxs-lookup"><span data-stu-id="a499f-140">In Steps 2 and 3 we'll move the editing interfaces from the TemplateFields `EditItemTemplate` s to their `ItemTemplate` s.</span></span>

## <a name="step-1-displaying-product-information"></a><span data-ttu-id="a499f-141">手順 1: 製品情報を表示します。</span><span class="sxs-lookup"><span data-stu-id="a499f-141">Step 1: Displaying Product Information</span></span>

<span data-ttu-id="a499f-142">GridView の作成と心配する前に、行は、ここでは、編集、s、製品情報を表示するだけで開始します。</span><span class="sxs-lookup"><span data-stu-id="a499f-142">Before we worry about creating a GridView where are rows are editable, let s start by simply displaying the product information.</span></span> <span data-ttu-id="a499f-143">開く、 `BatchUpdate.aspx`  ページで、`BatchData`フォルダーと、ツールボックスからデザイナーにドラッグする GridView。</span><span class="sxs-lookup"><span data-stu-id="a499f-143">Open the `BatchUpdate.aspx` page in the `BatchData` folder and drag a GridView from the Toolbox onto the Designer.</span></span> <span data-ttu-id="a499f-144">集合 GridView s`ID`に`ProductsGrid`し、そのスマート タグからという名前の新しい ObjectDataSource にバインドする選択`ProductsDataSource`です。</span><span class="sxs-lookup"><span data-stu-id="a499f-144">Set the GridView s `ID` to `ProductsGrid` and, from its smart tag, choose to bind it to a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="a499f-145">構成からそのデータを取得する ObjectDataSource、`ProductsBLL`クラスの`GetProducts`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="a499f-145">Configure the ObjectDataSource to retrieve its data from the `ProductsBLL` class s `GetProducts` method.</span></span>


<span data-ttu-id="a499f-146">[![構成、ObjectDataSource ProductsBLL クラスを使用するには](batch-updating-vb/_static/image2.gif)](batch-updating-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="a499f-146">[![Configure the ObjectDataSource to Use the ProductsBLL Class](batch-updating-vb/_static/image2.gif)](batch-updating-vb/_static/image3.png)</span></span>

<span data-ttu-id="a499f-147">**図 2**: 構成を使用する ObjectDataSource、`ProductsBLL`クラス ([フルサイズのイメージを表示するをクリックして](batch-updating-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="a499f-147">**Figure 2**: Configure the ObjectDataSource to Use the `ProductsBLL` Class ([Click to view full-size image](batch-updating-vb/_static/image4.png))</span></span>


<span data-ttu-id="a499f-148">[![GetProducts メソッドを使用して、製品データを取得します。](batch-updating-vb/_static/image3.gif)](batch-updating-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="a499f-148">[![Retrieve the Product Data Using the GetProducts Method](batch-updating-vb/_static/image3.gif)](batch-updating-vb/_static/image5.png)</span></span>

<span data-ttu-id="a499f-149">**図 3**: 製品データを使用して、取得、`GetProducts`メソッド ([フルサイズのイメージを表示するをクリックして](batch-updating-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="a499f-149">**Figure 3**: Retrieve the Product Data Using the `GetProducts` Method ([Click to view full-size image](batch-updating-vb/_static/image6.png))</span></span>


<span data-ttu-id="a499f-150">GridView のように、行ごとに、ObjectDataSource の変更機能が設計されています。</span><span class="sxs-lookup"><span data-stu-id="a499f-150">Like the GridView, the ObjectDataSource s modification features are designed to work on a per-row basis.</span></span> <span data-ttu-id="a499f-151">一連のレコードを更新するのには ASP.NET ページの分離コード クラスは、データをバッチ処理を BLL に渡すことで少量のコードを記述する必要になります。</span><span class="sxs-lookup"><span data-stu-id="a499f-151">In order to update a set of records, we'll need to write a bit of code in the ASP.NET page s code-behind class that batches the data and passes it to the BLL.</span></span> <span data-ttu-id="a499f-152">そのため、ドロップ ダウン リスト ObjectDataSource s で UPDATE、INSERT、および DELETE タブ設定を (なし) します。</span><span class="sxs-lookup"><span data-stu-id="a499f-152">Therefore, set the drop-down lists in the ObjectDataSource s UPDATE, INSERT, and DELETE tabs to (None).</span></span> <span data-ttu-id="a499f-153">ウィザードを完了するには、[完了] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="a499f-153">Click Finish to complete the wizard.</span></span>


<span data-ttu-id="a499f-154">[![UPDATE、INSERT のドロップダウン リストを設定し、(なし) タブを削除します。](batch-updating-vb/_static/image4.gif)](batch-updating-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="a499f-154">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None)](batch-updating-vb/_static/image4.gif)](batch-updating-vb/_static/image7.png)</span></span>

<span data-ttu-id="a499f-155">**図 4**: (なし) に、UPDATE、INSERT、および削除のタブで、ドロップダウン リストを設定 ([フルサイズのイメージを表示するをクリックして](batch-updating-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="a499f-155">**Figure 4**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None) ([Click to view full-size image](batch-updating-vb/_static/image8.png))</span></span>


<span data-ttu-id="a499f-156">データ ソース構成ウィザードを完了すると、ObjectDataSource s の宣言型マークアップは、次のようになります。</span><span class="sxs-lookup"><span data-stu-id="a499f-156">After completing the Configure Data Source wizard, the ObjectDataSource s declarative markup should look like the following:</span></span>


[!code-aspx[Main](batch-updating-vb/samples/sample1.aspx)]

<span data-ttu-id="a499f-157">GridView で BoundFields と製品データ フィールドの CheckBoxField を作成する Visual Studio とも、データ ソースの構成ウィザードを完了します。</span><span class="sxs-lookup"><span data-stu-id="a499f-157">Completing the Configure Data Source wizard also causes Visual Studio to create BoundFields and a CheckBoxField for the product data fields in the GridView.</span></span> <span data-ttu-id="a499f-158">このチュートリアルでは、アクセス許可のみを表示および製品の名前、カテゴリ、価格、および提供が中止された状態を編集 s を使用できます。</span><span class="sxs-lookup"><span data-stu-id="a499f-158">For this tutorial, let s only allow the user to view and edit the product s name, category, price, and discontinued status.</span></span> <span data-ttu-id="a499f-159">削除以外のすべての`ProductName`、 `CategoryName`、 `UnitPrice`、および`Discontinued`フィールドと名前の変更、`HeaderText`製品カテゴリ、および価格、フィールドは最初の 3 つのプロパティがそれぞれします。</span><span class="sxs-lookup"><span data-stu-id="a499f-159">Remove all but the `ProductName`, `CategoryName`, `UnitPrice`, and `Discontinued` fields and rename the `HeaderText` properties of the first three fields to Product, Category, and Price, respectively.</span></span> <span data-ttu-id="a499f-160">最後に、GridView s のスマート タグのページングを有効にして、並べ替えを有効にするチェック ボックスを確認します。</span><span class="sxs-lookup"><span data-stu-id="a499f-160">Lastly, check the Enable Paging and Enable Sorting checkboxes in the GridView s smart tag.</span></span>

<span data-ttu-id="a499f-161">これで、GridView、3 つ BoundFields (`ProductName`、`CategoryName`と`UnitPrice`) と、CheckBoxField (`Discontinued`)。</span><span class="sxs-lookup"><span data-stu-id="a499f-161">At this point the GridView has three BoundFields (`ProductName`, `CategoryName`, and `UnitPrice`) and a CheckBoxField (`Discontinued`).</span></span> <span data-ttu-id="a499f-162">TemplateFields に 4 つのフィールドを変換し、TemplateField s から編集インターフェイスを移動する必要があります`EditItemTemplate`にその`ItemTemplate`です。</span><span class="sxs-lookup"><span data-stu-id="a499f-162">We need to convert these four fields into TemplateFields and then move the editing interface from the TemplateField s `EditItemTemplate` to its `ItemTemplate`.</span></span>

> [!NOTE]
> <span data-ttu-id="a499f-163">作成とカスタマイズに TemplateFields おため、探索、[データ変更インターフェイスのカスタマイズ](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md)チュートリアルです。</span><span class="sxs-lookup"><span data-stu-id="a499f-163">We explored creating and customizing TemplateFields in the [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) tutorial.</span></span> <span data-ttu-id="a499f-164">TemplateFields BoundFields と CheckBoxField に変換する手順を説明しに含まれるインターフェイスの編集を定義する、`ItemTemplate`行き詰まった場合や、必要がある、この以前のチュートリアルを参照するなる躊躇リフレッシャー、don t は s です。</span><span class="sxs-lookup"><span data-stu-id="a499f-164">We'll walk through the steps of converting the BoundFields and CheckBoxField into TemplateFields and defining their editing interfaces in their `ItemTemplate` s, but if you get stuck or need a refresher, don t hesitate to refer back to this earlier tutorial.</span></span>


<span data-ttu-id="a499f-165">GridView s のスマート タグから、[フィールド] ダイアログ ボックスを開くための列の編集リンクをクリックします。</span><span class="sxs-lookup"><span data-stu-id="a499f-165">From the GridView s smart tag, click the Edit Columns link to open the Fields dialog box.</span></span> <span data-ttu-id="a499f-166">次に、各フィールドを選択し、このフィールドに変換を TemplateField のリンクをクリックします。</span><span class="sxs-lookup"><span data-stu-id="a499f-166">Next, select each field and click the Convert this field into a TemplateField link.</span></span>


![既存の BoundFields や CheckBoxField を TemplateFields に変換します。](batch-updating-vb/_static/image5.gif)

<span data-ttu-id="a499f-168">**図 5**: 既存 BoundFields や CheckBoxField を TemplateFields に変換します。</span><span class="sxs-lookup"><span data-stu-id="a499f-168">**Figure 5**: Convert the Existing BoundFields and CheckBoxField Into TemplateFields</span></span>


<span data-ttu-id="a499f-169">これで各フィールドを TemplateField、編集を移動する準備ができたらインターフェースからは`EditItemTemplate`s、 `ItemTemplate` s。</span><span class="sxs-lookup"><span data-stu-id="a499f-169">Now that each field is a TemplateField, we re ready to move the editing interface from the `EditItemTemplate` s to the `ItemTemplate` s.</span></span>

## <a name="step-2-creating-theproductnameunitprice-anddiscontinuedediting-interfaces"></a><span data-ttu-id="a499f-170">手順 2: 作成、`ProductName`、`UnitPrice`、および`Discontinued`インターフェイスの編集</span><span class="sxs-lookup"><span data-stu-id="a499f-170">Step 2: Creating the`ProductName`,`UnitPrice`, and`Discontinued`Editing Interfaces</span></span>

<span data-ttu-id="a499f-171">作成する、 `ProductName`、 `UnitPrice`、および`Discontinued`インターフェイスの編集は、この手順のトピック、非常に簡単ですが、各インターフェイスが TemplateField s で既に定義されている`EditItemTemplate`です。</span><span class="sxs-lookup"><span data-stu-id="a499f-171">Creating the `ProductName`, `UnitPrice`, and `Discontinued` editing interfaces are the topic of this step and are pretty straightforward, as each interface is already defined in the TemplateField s `EditItemTemplate`.</span></span> <span data-ttu-id="a499f-172">作成する、`CategoryName`該当するカテゴリの DropDownList を作成する必要がありますので、少し複雑ですインターフェイスを編集します。</span><span class="sxs-lookup"><span data-stu-id="a499f-172">Creating the `CategoryName` editing interface is a bit more involved since we need to create a DropDownList of the applicable categories.</span></span> <span data-ttu-id="a499f-173">これは、`CategoryName`手順 3. で取り組むはインターフェイスを編集します。</span><span class="sxs-lookup"><span data-stu-id="a499f-173">This `CategoryName` editing interface is tackled in Step 3.</span></span>

<span data-ttu-id="a499f-174">%S を開始できるように、 `ProductName` TemplateField です。</span><span class="sxs-lookup"><span data-stu-id="a499f-174">Let s start with the `ProductName` TemplateField.</span></span> <span data-ttu-id="a499f-175">GridView s のスマート タグからテンプレートの編集リンクをクリックし、ドリルダウン、 `ProductName` TemplateField の`EditItemTemplate`です。</span><span class="sxs-lookup"><span data-stu-id="a499f-175">Click on the Edit Templates link from the GridView s smart tag and drill down to the `ProductName` TemplateField s `EditItemTemplate`.</span></span> <span data-ttu-id="a499f-176">テキスト ボックスをオンに、クリップボードにコピーを貼り付けます、 `ProductName` TemplateField の`ItemTemplate`です。</span><span class="sxs-lookup"><span data-stu-id="a499f-176">Select the TextBox, copy it to the clipboard, and then paste it to the `ProductName` TemplateField s `ItemTemplate`.</span></span> <span data-ttu-id="a499f-177">TextBox s を変更する`ID`プロパティを`ProductName`です。</span><span class="sxs-lookup"><span data-stu-id="a499f-177">Change the TextBox s `ID` property to `ProductName`.</span></span>

<span data-ttu-id="a499f-178">次に、追加する RequiredFieldValidator、`ItemTemplate`をユーザーが各製品の名の値を提供することを確認します。</span><span class="sxs-lookup"><span data-stu-id="a499f-178">Next, add a RequiredFieldValidator to the `ItemTemplate` to ensure that the user provides a value for each product s name.</span></span> <span data-ttu-id="a499f-179">設定、 `ControlToValidate` ProductName、プロパティ、`ErrorMessage`にプロパティが、製品の名前を指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a499f-179">Set the `ControlToValidate` property to ProductName, the `ErrorMessage` property to You must provide the product's name.</span></span> <span data-ttu-id="a499f-180">および`Text`プロパティを\*です。</span><span class="sxs-lookup"><span data-stu-id="a499f-180">and the `Text` property to \*.</span></span> <span data-ttu-id="a499f-181">追加を行った後、`ItemTemplate`画面が図 6 のようになります。</span><span class="sxs-lookup"><span data-stu-id="a499f-181">After making these additions to the `ItemTemplate`, your screen should look similar to Figure 6.</span></span>


<span data-ttu-id="a499f-182">[![ProductName TemplateField ここでには、テキスト ボックスと、RequiredFieldValidator が含まれます。](batch-updating-vb/_static/image6.gif)](batch-updating-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="a499f-182">[![The ProductName TemplateField Now Includes a TextBox and a RequiredFieldValidator](batch-updating-vb/_static/image6.gif)](batch-updating-vb/_static/image9.png)</span></span>

<span data-ttu-id="a499f-183">**図 6**: `ProductName` TemplateField が含まれています テキスト ボックスと RequiredFieldValidator ([フルサイズのイメージを表示するをクリックして](batch-updating-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="a499f-183">**Figure 6**: The `ProductName` TemplateField Now Includes a TextBox and a RequiredFieldValidator ([Click to view full-size image](batch-updating-vb/_static/image10.png))</span></span>


<span data-ttu-id="a499f-184">`UnitPrice`からテキスト ボックスをコピーしてインターフェイスを編集するには、開始、`EditItemTemplate`を`ItemTemplate`です。</span><span class="sxs-lookup"><span data-stu-id="a499f-184">For the `UnitPrice` editing interface, start by copying the TextBox from the `EditItemTemplate` to the `ItemTemplate`.</span></span> <span data-ttu-id="a499f-185">テキスト ボックスとセットの前に、$ を次に、配置、 `ID` UnitPrice にプロパティとその`Columns`8 にプロパティです。</span><span class="sxs-lookup"><span data-stu-id="a499f-185">Next, place a $ in front of the TextBox and set its `ID` property to UnitPrice and its `Columns` property to 8 .</span></span>

<span data-ttu-id="a499f-186">追加する CompareValidator ことも、 `UnitPrice` s`ItemTemplate`ユーザーが入力した値が有効な通貨値 $0.00 以上であることを確認します。</span><span class="sxs-lookup"><span data-stu-id="a499f-186">Also add a CompareValidator to the `UnitPrice` s `ItemTemplate` to ensure that the value entered by the user is a valid currency value greater than or equal to $0.00.</span></span> <span data-ttu-id="a499f-187">バリデーター s を設定`ControlToValidate`UnitPrice、プロパティ、`ErrorMessage`にプロパティが有効な通貨値を入力する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a499f-187">Set the validator s `ControlToValidate` property to UnitPrice, its `ErrorMessage` property to You must enter a valid currency value.</span></span> <span data-ttu-id="a499f-188">省略してください、通貨記号。 には、その`Text`プロパティを\*、その`Type`プロパティを`Currency`、その`Operator`プロパティを`GreaterThanEqual`、およびその`ValueToCompare`プロパティを 0 にします。</span><span class="sxs-lookup"><span data-stu-id="a499f-188">Please omit any currency symbols., its `Text` property to \*, its `Type` property to `Currency`, its `Operator` property to `GreaterThanEqual`, and its `ValueToCompare` property to 0 .</span></span>


<span data-ttu-id="a499f-189">[![追加の価格が入力することを確認する CompareValidator が負でない通貨値](batch-updating-vb/_static/image7.gif)](batch-updating-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="a499f-189">[![Add a CompareValidator to Ensure the Price Entered is a Non-Negative Currency Value](batch-updating-vb/_static/image7.gif)](batch-updating-vb/_static/image11.png)</span></span>

<span data-ttu-id="a499f-190">**図 7**: 価格を入力、確認して CompareValidator は負でない通貨値を追加 ([フルサイズのイメージを表示するをクリックして](batch-updating-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="a499f-190">**Figure 7**: Add a CompareValidator to Ensure the Price Entered is a Non-Negative Currency Value ([Click to view full-size image](batch-updating-vb/_static/image12.png))</span></span>


<span data-ttu-id="a499f-191">`Discontinued` TemplateField で既に定義されているチェック ボックスを使用することができます、`ItemTemplate`です。</span><span class="sxs-lookup"><span data-stu-id="a499f-191">For the `Discontinued` TemplateField you can use the CheckBox already defined in the `ItemTemplate`.</span></span> <span data-ttu-id="a499f-192">単に設定、`ID`生産中止して、その`Enabled`プロパティを`True`です。</span><span class="sxs-lookup"><span data-stu-id="a499f-192">Simply set its `ID` to Discontinued and its `Enabled` property to `True`.</span></span>

## <a name="step-3-creating-thecategorynameediting-interface"></a><span data-ttu-id="a499f-193">手順 3: 作成、`CategoryName`編集インターフェイス</span><span class="sxs-lookup"><span data-stu-id="a499f-193">Step 3: Creating the`CategoryName`Editing Interface</span></span>

<span data-ttu-id="a499f-194">編集、インターフェイス、 `CategoryName` TemplateField s`EditItemTemplate`の値を表示するテキスト ボックスが含まれています、`CategoryName`データ フィールドです。</span><span class="sxs-lookup"><span data-stu-id="a499f-194">The editing interface in the `CategoryName` TemplateField s `EditItemTemplate` contains a TextBox that displays the value of the `CategoryName` data field.</span></span> <span data-ttu-id="a499f-195">ここには、可能なカテゴリを一覧表示する DropDownList が必要です。</span><span class="sxs-lookup"><span data-stu-id="a499f-195">We need to replace this with a DropDownList that lists the possible categories.</span></span>

> [!NOTE]
> <span data-ttu-id="a499f-196">[データ変更インターフェイスのカスタマイズ](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md)チュートリアルには、テキスト ボックスではなく DropDownList を含めるテンプレートをカスタマイズする方法のより完全で完全なディスカッションが含まれています。</span><span class="sxs-lookup"><span data-stu-id="a499f-196">The [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) tutorial contains a more thorough and complete discussion on customizing a template to include a DropDownList as opposed to a TextBox.</span></span> <span data-ttu-id="a499f-197">ここに示す手順は完了しましたが、記載されている答えましたです。</span><span class="sxs-lookup"><span data-stu-id="a499f-197">While the steps here are complete, they are presented tersely.</span></span> <span data-ttu-id="a499f-198">作成すると、カテゴリの DropDownList の構成に関する詳細についてを参照してください戻る、[データ変更インターフェイスのカスタマイズ](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md)チュートリアルです。</span><span class="sxs-lookup"><span data-stu-id="a499f-198">For a more in-depth look at creating and configuring the categories DropDownList, refer back to the [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) tutorial.</span></span>


<span data-ttu-id="a499f-199">DropDownList をツールボックスからドラッグして、 `CategoryName` TemplateField s `ItemTemplate`、設定、`ID`に`Categories`です。</span><span class="sxs-lookup"><span data-stu-id="a499f-199">Drag a DropDownList from the Toolbox onto the `CategoryName` TemplateField s `ItemTemplate`, setting its `ID` to `Categories`.</span></span> <span data-ttu-id="a499f-200">この時点でおは通常 DropDownLists のデータ ソースの定義のスマート タグから新しい ObjectDataSource を作成します。</span><span class="sxs-lookup"><span data-stu-id="a499f-200">At this point we would usually define the DropDownLists s data source through its smart tag, creating a new ObjectDataSource.</span></span> <span data-ttu-id="a499f-201">ただし、この追加内 ObjectDataSource、 `ItemTemplate`、その結果、GridView 行ごとに作成された ObjectDataSource インスタンス。</span><span class="sxs-lookup"><span data-stu-id="a499f-201">However, this will add the ObjectDataSource within the `ItemTemplate`, which will result in an ObjectDataSource instance created for each GridView row.</span></span> <span data-ttu-id="a499f-202">代わりに、s、ObjectDataSource、GridView の TemplateFields の外部での作成を使用できます。</span><span class="sxs-lookup"><span data-stu-id="a499f-202">Instead, let s create the ObjectDataSource outside of the GridView s TemplateFields.</span></span> <span data-ttu-id="a499f-203">テンプレート編集を終了し、ObjectDataSource を下に、デザイナーには、ツールボックスからドラッグして、 `ProductsDataSource` ObjectDataSource です。</span><span class="sxs-lookup"><span data-stu-id="a499f-203">End the template editing and drag an ObjectDataSource from the Toolbox onto the Designer beneath the `ProductsDataSource` ObjectDataSource.</span></span> <span data-ttu-id="a499f-204">名前を新しい ObjectDataSource`CategoriesDataSource`を使用するように構成し、`CategoriesBLL`クラスの`GetCategories`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="a499f-204">Name the new ObjectDataSource `CategoriesDataSource` and configure it to use the `CategoriesBLL` class s `GetCategories` method.</span></span>


<span data-ttu-id="a499f-205">[![構成、ObjectDataSource CategoriesBLL クラスを使用するには](batch-updating-vb/_static/image8.gif)](batch-updating-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="a499f-205">[![Configure the ObjectDataSource to Use the CategoriesBLL Class](batch-updating-vb/_static/image8.gif)](batch-updating-vb/_static/image13.png)</span></span>

<span data-ttu-id="a499f-206">**図 8**: 構成を使用する ObjectDataSource、`CategoriesBLL`クラス ([フルサイズのイメージを表示するをクリックして](batch-updating-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="a499f-206">**Figure 8**: Configure the ObjectDataSource to Use the `CategoriesBLL` Class ([Click to view full-size image](batch-updating-vb/_static/image14.png))</span></span>


<span data-ttu-id="a499f-207">[![メソッドを使用してカテゴリのデータを取得します。](batch-updating-vb/_static/image9.gif)](batch-updating-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="a499f-207">[![Retrieve the Category Data Using the GetCategories Method](batch-updating-vb/_static/image9.gif)](batch-updating-vb/_static/image15.png)</span></span>

<span data-ttu-id="a499f-208">**図 9**: カテゴリ データを使用して、取得、`GetCategories`メソッド ([フルサイズのイメージを表示するをクリックして](batch-updating-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="a499f-208">**Figure 9**: Retrieve the Category Data Using the `GetCategories` Method ([Click to view full-size image](batch-updating-vb/_static/image16.png))</span></span>


<span data-ttu-id="a499f-209">この ObjectDataSource はデータを取得するだけで使用されるため、(なし)、UPDATE および DELETE のタブで、ドロップダウン リストを設定します。</span><span class="sxs-lookup"><span data-stu-id="a499f-209">Since this ObjectDataSource is used merely to retrieve data, set the drop-down lists in the UPDATE and DELETE tabs to (None).</span></span> <span data-ttu-id="a499f-210">ウィザードを完了するには、[完了] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="a499f-210">Click Finish to complete the wizard.</span></span>


<span data-ttu-id="a499f-211">[![セット UPDATE と DELETE タブ (なし) をドロップダウン リスト](batch-updating-vb/_static/image10.gif)](batch-updating-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="a499f-211">[![Set the Drop-Down Lists in the UPDATE and DELETE Tabs to (None)](batch-updating-vb/_static/image10.gif)](batch-updating-vb/_static/image17.png)</span></span>

<span data-ttu-id="a499f-212">**図 10**: (None) に更新と削除のタブにドロップダウン リストを設定 ([フルサイズのイメージを表示するをクリックして](batch-updating-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="a499f-212">**Figure 10**: Set the Drop-Down Lists in the UPDATE and DELETE Tabs to (None) ([Click to view full-size image](batch-updating-vb/_static/image18.png))</span></span>


<span data-ttu-id="a499f-213">ウィザードの完了後に、 `CategoriesDataSource` s 宣言型マークアップは、次のようになります。</span><span class="sxs-lookup"><span data-stu-id="a499f-213">After completing the wizard, the `CategoriesDataSource` s declarative markup should look like the following:</span></span>


[!code-aspx[Main](batch-updating-vb/samples/sample2.aspx)]

<span data-ttu-id="a499f-214">`CategoriesDataSource`作成および構成に戻り、 `CategoryName` TemplateField の`ItemTemplate`DropDownList s のスマート タグからリンクをクリックして、データ ソースの選択とは、します。</span><span class="sxs-lookup"><span data-stu-id="a499f-214">With the `CategoriesDataSource` created and configured, return to the `CategoryName` TemplateField s `ItemTemplate` and, from the DropDownList s smart tag, click on the Choose Data Source link.</span></span> <span data-ttu-id="a499f-215">データ ソース構成ウィザードで選択、`CategoriesDataSource`最初のドロップダウン リストからオプションを選択して、`CategoryName`表示に使用し、`CategoryID`値として。</span><span class="sxs-lookup"><span data-stu-id="a499f-215">In the Data Source Configuration wizard, select the `CategoriesDataSource` option from the first drop-down list and choose to have `CategoryName` used for the display and `CategoryID` as the value.</span></span>


<span data-ttu-id="a499f-216">[![次のドロップダウン リストを CategoriesDataSource にバインドします。](batch-updating-vb/_static/image11.gif)](batch-updating-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="a499f-216">[![Bind the DropDownList to the CategoriesDataSource](batch-updating-vb/_static/image11.gif)](batch-updating-vb/_static/image19.png)</span></span>

<span data-ttu-id="a499f-217">**図 11**: に DropDownList のバインド、 `CategoriesDataSource` ([フルサイズのイメージを表示するをクリックして](batch-updating-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="a499f-217">**Figure 11**: Bind the DropDownList to the `CategoriesDataSource` ([Click to view full-size image](batch-updating-vb/_static/image20.png))</span></span>


<span data-ttu-id="a499f-218">この時点で、 `Categories` DropDownList を一覧表示、カテゴリのすべてがそのはまだ自動的に選択されません GridView の行にバインドされている製品の適切なカテゴリ。</span><span class="sxs-lookup"><span data-stu-id="a499f-218">At this point the `Categories` DropDownList lists all of the categories, but it does not yet automatically select the appropriate category for the product bound to the GridView row.</span></span> <span data-ttu-id="a499f-219">設定する必要があります。 これを実現する、 `Categories` DropDownList s`SelectedValue`製品 s`CategoryID`値。</span><span class="sxs-lookup"><span data-stu-id="a499f-219">To accomplish this we need to set the `Categories` DropDownList s `SelectedValue` to the product s `CategoryID` value.</span></span> <span data-ttu-id="a499f-220">DropDownList s のスマート タグから databindings の編集 リンクをクリックし、関連付ける、`SelectedValue`を持つプロパティ、`CategoryID`データ フィールドの図 12 に示すようにします。</span><span class="sxs-lookup"><span data-stu-id="a499f-220">Click on the Edit DataBindings link from the DropDownList s smart tag and associate the `SelectedValue` property with the `CategoryID` data field as shown in Figure 12.</span></span>


![値のバインド製品の CategoryID DropDownList の SelectedValue プロパティ](batch-updating-vb/_static/image12.gif)

<span data-ttu-id="a499f-222">**図 12**: 製品 s をバインド`CategoryID`DropDownList s 値`SelectedValue`プロパティ</span><span class="sxs-lookup"><span data-stu-id="a499f-222">**Figure 12**: Bind the Product s `CategoryID` Value to the DropDownList s `SelectedValue` Property</span></span>


<span data-ttu-id="a499f-223">最後の 1 つの問題まま: 製品されない場合、`CategoryID`で指定された値、データ バインド ステートメント`SelectedValue`例外が発生します。</span><span class="sxs-lookup"><span data-stu-id="a499f-223">One last problem remains: if the product doesn t have a `CategoryID` value specified then the databinding statement on `SelectedValue` will result in an exception.</span></span> <span data-ttu-id="a499f-224">これは、DropDownList のカテゴリの項目のみが含まれています、ある製品のオプションが提供されていないため、`NULL`の値をデータベース`CategoryID`です。</span><span class="sxs-lookup"><span data-stu-id="a499f-224">This is because the DropDownList contains only items for the categories and does not offer an option for those products that have a `NULL` database value for `CategoryID`.</span></span> <span data-ttu-id="a499f-225">この問題を解決するには、DropDownList s を設定`AppendDataBoundItems`プロパティを`True`、DropDownList に新しい項目を追加およびを省略すると、`Value`プロパティ宣言構文からです。</span><span class="sxs-lookup"><span data-stu-id="a499f-225">To remedy this, set the DropDownList s `AppendDataBoundItems` property to `True` and add a new item to the DropDownList, omitting the `Value` property from the declarative syntax.</span></span> <span data-ttu-id="a499f-226">つまり、ことを確認、 `Categories` DropDownList s 宣言の構文は、次のようになります。</span><span class="sxs-lookup"><span data-stu-id="a499f-226">That is, make sure that the `Categories` DropDownList s declarative syntax looks like the following:</span></span>


[!code-aspx[Main](batch-updating-vb/samples/sample3.aspx)]

<span data-ttu-id="a499f-227">注方法、 `<asp:ListItem Value="">` --選択 1--がその`Value`属性は、空の文字列に明示的に設定します。</span><span class="sxs-lookup"><span data-stu-id="a499f-227">Note how the `<asp:ListItem Value="">` -- Select One -- has its `Value` attribute explicitly set to an empty string.</span></span> <span data-ttu-id="a499f-228">戻って、[データ変更インターフェイスのカスタマイズ](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md)の詳細については、この追加の DropDownList の項目が処理に必要な理由のためのチュートリアル、`NULL`ケースとその理由の割り当て、 `Value`空の文字列にプロパティが不可欠です。</span><span class="sxs-lookup"><span data-stu-id="a499f-228">Refer back to the [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) tutorial for a more thorough discussion on why this additional DropDownList item is needed to handle the `NULL` case and why assignment of the `Value` property to an empty string is essential.</span></span>

> [!NOTE]
> <span data-ttu-id="a499f-229">問題がある潜在的なパフォーマンスとスケーラビリティここで説明が必要です。</span><span class="sxs-lookup"><span data-stu-id="a499f-229">There is a potential performance and scalability issue here that is worth mentioning.</span></span> <span data-ttu-id="a499f-230">行ごとに使用する DropDownList があるため、 `CategoriesDataSource` 、データ ソースとして、`CategoriesBLL`クラス s`GetCategories`メソッドが呼び出される*n* 1 ページあたりの回数を参照してください、場所*n*の数ですGridView の行。</span><span class="sxs-lookup"><span data-stu-id="a499f-230">Since each row has a DropDownList that uses the `CategoriesDataSource` as its data source, the `CategoriesBLL` class s `GetCategories` method will be called *n* times per page visit, where *n* is the number of rows in the GridView.</span></span> <span data-ttu-id="a499f-231">これら*n*呼び出し`GetCategories`結果*n*データベースに対するクエリ。</span><span class="sxs-lookup"><span data-stu-id="a499f-231">These *n* calls to `GetCategories` result in *n* queries to the database.</span></span> <span data-ttu-id="a499f-232">要求ごとのキャッシュまたは SQL キャッシュ依存関係または非常に短い形式の時刻ベースの有効期限を使用して、キャッシュ レイヤーを通じて返されるカテゴリをキャッシュすることによって、データベースに対するこの影響を軽減可能性があります。</span><span class="sxs-lookup"><span data-stu-id="a499f-232">This impact on the database could be lessened by caching the returned categories either in a per-request cache or through the Caching Layer using a SQL caching dependency or a very short time-based expiry.</span></span> <span data-ttu-id="a499f-233">詳細については、要求ごとのキャッシュ オプションを参照してください[`HttpContext.Items`キャッシュ ストアの 1 秒あたりの要求](http://aspnet.4guysfromrolla.com/articles/060904-1.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="a499f-233">For more information on the per-request caching option, see [`HttpContext.Items` a Per-Request Cache Store](http://aspnet.4guysfromrolla.com/articles/060904-1.aspx).</span></span>


## <a name="step-4-completing-the-editing-interface"></a><span data-ttu-id="a499f-234">手順 4: 完了編集インターフェイス</span><span class="sxs-lookup"><span data-stu-id="a499f-234">Step 4: Completing the Editing Interface</span></span>

<span data-ttu-id="a499f-235">作業の進行状況を表示するを一時停止せず GridView のテンプレートに対する変更の数も作成しています。</span><span class="sxs-lookup"><span data-stu-id="a499f-235">We ve made a number of changes to the GridView s templates without pausing to view our progress.</span></span> <span data-ttu-id="a499f-236">ブラウザーを使って作業の進行状況を表示するのにはしばらくを実行します。</span><span class="sxs-lookup"><span data-stu-id="a499f-236">Take a moment to view our progress through a browser.</span></span> <span data-ttu-id="a499f-237">使用して各行をレンダリングする図 13 では、その`ItemTemplate`、編集インターフェイス cell が含まれています。</span><span class="sxs-lookup"><span data-stu-id="a499f-237">As Figure 13 shows, each row is rendered using its `ItemTemplate`, which contains the cell s editing interface.</span></span>


<span data-ttu-id="a499f-238">[![GridView の各行は編集可能であります。](batch-updating-vb/_static/image13.gif)](batch-updating-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="a499f-238">[![Each GridView Row is Editable](batch-updating-vb/_static/image13.gif)](batch-updating-vb/_static/image21.png)</span></span>

<span data-ttu-id="a499f-239">**図 13**: GridView の各行は編集可能である ([フルサイズのイメージを表示するをクリックして](batch-updating-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="a499f-239">**Figure 13**: Each GridView Row is Editable ([Click to view full-size image](batch-updating-vb/_static/image22.png))</span></span>


<span data-ttu-id="a499f-240">おはずの時点で、いくつかの軽微な書式設定問題があります。</span><span class="sxs-lookup"><span data-stu-id="a499f-240">There are a few minor formatting issues that we should take care of at this point.</span></span> <span data-ttu-id="a499f-241">まず、なお、`UnitPrice`値には、4 つの 10 進数のポイントが含まれています。</span><span class="sxs-lookup"><span data-stu-id="a499f-241">First, note that the `UnitPrice` value contains four decimal points.</span></span> <span data-ttu-id="a499f-242">この問題を解決するにを返します、 `UnitPrice` TemplateField の`ItemTemplate`TextBox s のスマート タグから databindings の編集 リンクをクリックします。</span><span class="sxs-lookup"><span data-stu-id="a499f-242">To fix this, return to the `UnitPrice` TemplateField s `ItemTemplate` and, from the TextBox s smart tag, click on the Edit DataBindings link.</span></span> <span data-ttu-id="a499f-243">次に、指定する、`Text`プロパティは数値として書式設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a499f-243">Next, specify that the `Text` property should be formatted as a number.</span></span>


![Text プロパティを数値として書式設定します。](batch-updating-vb/_static/image14.gif)

<span data-ttu-id="a499f-245">**図 14**: 形式、`Text`数値としてプロパティ</span><span class="sxs-lookup"><span data-stu-id="a499f-245">**Figure 14**: Format the `Text` Property as a Number</span></span>


<span data-ttu-id="a499f-246">次のチェック ボックスの中央 let s、 `Discontinued` (左揃えさせることのではなく) 列。</span><span class="sxs-lookup"><span data-stu-id="a499f-246">Second, let s center the checkbox in the `Discontinued` column (rather than having it left-aligned).</span></span> <span data-ttu-id="a499f-247">GridView s のスマート タグからの列の編集 をクリックし、選択、`Discontinued`左下隅のフィールドの一覧から TemplateField です。</span><span class="sxs-lookup"><span data-stu-id="a499f-247">Click on Edit Columns from the GridView s smart tag and select the `Discontinued` TemplateField from the list of fields in the bottom left corner.</span></span> <span data-ttu-id="a499f-248">ドリル ダウン`ItemStyle`設定と、`HorizontalAlign`センターの図 15 に示すようにプロパティです。</span><span class="sxs-lookup"><span data-stu-id="a499f-248">Drill down into `ItemStyle` and set the `HorizontalAlign` property to Center as shown in Figure 15.</span></span>


![Center 提供が中止されたチェック ボックス](batch-updating-vb/_static/image15.gif)

<span data-ttu-id="a499f-250">**図 15**: Center、 `Discontinued`  チェック ボックス</span><span class="sxs-lookup"><span data-stu-id="a499f-250">**Figure 15**: Center the `Discontinued` CheckBox</span></span>


<span data-ttu-id="a499f-251">次に、ValidationSummary コントロールをページに追加し、設定、`ShowMessageBox`プロパティを`True`とその`ShowSummary`プロパティを`False`です。</span><span class="sxs-lookup"><span data-stu-id="a499f-251">Next, add a ValidationSummary control to the page and set its `ShowMessageBox` property to `True` and its `ShowSummary` property to `False`.</span></span> <span data-ttu-id="a499f-252">Button Web コントロールがクリックされたときにも追加、ユーザーの変更が更新されます。</span><span class="sxs-lookup"><span data-stu-id="a499f-252">Also add the Button Web controls that, when clicked, will update the user s changes.</span></span> <span data-ttu-id="a499f-253">GridView 上と下に、両方のコントロールを設定する 2 つのボタンの Web コントロールを具体的には、追加`Text`更新プログラムの製品のプロパティです。</span><span class="sxs-lookup"><span data-stu-id="a499f-253">Specifically, add two Button Web controls, one above the GridView and one below it, setting both controls `Text` properties to Update Products .</span></span>

<span data-ttu-id="a499f-254">GridView s 以降編集インターフェイスがで定義されているその TemplateFields `ItemTemplate` 、s、 `EditItemTemplate` s 余分なされ、削除することがあります。</span><span class="sxs-lookup"><span data-stu-id="a499f-254">Since the GridView s editing interface is defined in its TemplateFields `ItemTemplate` s, the `EditItemTemplate` s are superfluous and may be deleted.</span></span>

<span data-ttu-id="a499f-255">上記を行うには、書式設定の変更説明したように後のボタン コントロールの追加と削除、不要な`EditItemTemplate`s、ページの宣言型の構文は次のようになります必要があります。</span><span class="sxs-lookup"><span data-stu-id="a499f-255">After making the above mentioned formatting changes, adding the Button controls, and removing the unnecessary `EditItemTemplate` s, your page s declarative syntax should look like the following:</span></span>


[!code-aspx[Main](batch-updating-vb/samples/sample4.aspx)]

<span data-ttu-id="a499f-256">図 16 では、ボタンの Web コントロールを追加した後にブラウザーで表示したときに、このページおよび書式設定の変更を示します。</span><span class="sxs-lookup"><span data-stu-id="a499f-256">Figure 16 shows this page when viewed through a browser after the Button Web controls have been added and the formatting changes made.</span></span>


<span data-ttu-id="a499f-257">[![ページ Now には、2 つの更新プログラムの製品ボタンが含まれています。](batch-updating-vb/_static/image16.gif)](batch-updating-vb/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="a499f-257">[![The Page Now Includes Two Update Products Buttons](batch-updating-vb/_static/image16.gif)](batch-updating-vb/_static/image23.png)</span></span>

<span data-ttu-id="a499f-258">**図 16**:、ページようになりましたが含まれています 2 つ更新プログラムの製品のボタン ([フルサイズのイメージを表示するをクリックして](batch-updating-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="a499f-258">**Figure 16**: The Page Now Includes Two Update Products Buttons ([Click to view full-size image](batch-updating-vb/_static/image24.png))</span></span>


## <a name="step-5-updating-the-products"></a><span data-ttu-id="a499f-259">手順 5: 製品の更新</span><span class="sxs-lookup"><span data-stu-id="a499f-259">Step 5: Updating the Products</span></span>

<span data-ttu-id="a499f-260">ユーザーがこのページを訪問したときに、その変更を行い、2 つの更新プログラムの製品ボタンのいずれかをクリックして、されます。</span><span class="sxs-lookup"><span data-stu-id="a499f-260">When a user visits this page they will make their modifications and then click one of the two Update Products buttons.</span></span> <span data-ttu-id="a499f-261">その時点で何らかの理由で、ユーザーが入力した各行の値を保存する必要があります、`ProductsDataTable`をインスタンス化し、されるには合格し、BLL メソッドを渡す`ProductsDataTable`DAL s インスタンス`UpdateWithTransaction`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="a499f-261">At that point we need to somehow save the user-entered values for each row into a `ProductsDataTable` instance and then pass that to a BLL method that will then pass that `ProductsDataTable` instance to the DAL s `UpdateWithTransaction` method.</span></span> <span data-ttu-id="a499f-262">`UpdateWithTransaction`メソッドで作成した、[前のチュートリアル](wrapping-database-modifications-within-a-transaction-vb.md)変更のバッチをアトミックな操作として更新することを確認します。</span><span class="sxs-lookup"><span data-stu-id="a499f-262">The `UpdateWithTransaction` method, which we created in the [preceding tutorial](wrapping-database-modifications-within-a-transaction-vb.md), ensures that the batch of changes will be updated as an atomic operation.</span></span>

<span data-ttu-id="a499f-263">という名前のメソッドを作成する`BatchUpdate`で`BatchUpdate.aspx.vb`し、次のコードを追加します。</span><span class="sxs-lookup"><span data-stu-id="a499f-263">Create a method named `BatchUpdate` in `BatchUpdate.aspx.vb` and add the following code:</span></span>


[!code-vb[Main](batch-updating-vb/samples/sample5.vb)]

<span data-ttu-id="a499f-264">このメソッドは、まずすべての製品の取得に戻り、 `ProductsDataTable` BLL の呼び出しを経由して`GetProducts`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="a499f-264">This method starts out by getting all of the products back in a `ProductsDataTable` via a call to the BLL s `GetProducts` method.</span></span> <span data-ttu-id="a499f-265">列挙し、 `ProductGrid` GridView s [ `Rows`コレクション](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.rows(VS.80).aspx)です。</span><span class="sxs-lookup"><span data-stu-id="a499f-265">It then enumerates the `ProductGrid` GridView s [`Rows` collection](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.rows(VS.80).aspx).</span></span> <span data-ttu-id="a499f-266">`Rows`コレクションが含まれています、 [ `GridViewRow`インスタンス](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridviewrow.aspx)GridView に表示される行はごとです。</span><span class="sxs-lookup"><span data-stu-id="a499f-266">The `Rows` collection contains a [`GridViewRow` instance](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridviewrow.aspx) for each row displayed in the GridView.</span></span> <span data-ttu-id="a499f-267">最大で 10 行、1 ページあたり GridView s を示していますので`Rows`コレクションには、10 個の項目があります。</span><span class="sxs-lookup"><span data-stu-id="a499f-267">Since we are showing at most ten rows per page, the GridView s `Rows` collection will have no more than ten items.</span></span>

<span data-ttu-id="a499f-268">行ごとに、`ProductID`から取得、`DataKeys`コレクションと、適切な`ProductsRow`からが選択されている、`ProductsDataTable`です。</span><span class="sxs-lookup"><span data-stu-id="a499f-268">For each row the `ProductID` is grabbed from the `DataKeys` collection and the appropriate `ProductsRow` is selected from the `ProductsDataTable`.</span></span> <span data-ttu-id="a499f-269">TemplateField の 4 つの入力コントロールがプログラムによって参照されているし、その値を割り当てる、`ProductsRow`のプロパティをインスタンス化します。</span><span class="sxs-lookup"><span data-stu-id="a499f-269">The four TemplateField input controls are programmatically referenced and their values assigned to the `ProductsRow` instance s properties.</span></span> <span data-ttu-id="a499f-270">更新する各 GridView の後に行の値が使用されて、 `ProductsDataTable`、BLL s に渡される s `UpdateWithTransaction` 、前のチュートリアルで示したように単純を呼び出すメソッド DAL の`UpdateWithTransaction`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="a499f-270">After each GridView row s values have been used to update the `ProductsDataTable`, it s passed to the BLL s `UpdateWithTransaction` method which, as we saw in the preceding tutorial, simply calls down into the DAL s `UpdateWithTransaction` method.</span></span>

<span data-ttu-id="a499f-271">このチュートリアルで使用されるバッチ更新アルゴリズム内の各行の更新、`ProductsDataTable`製品の情報が変更されたかどうかに関係なく、GridView の行に対応します。</span><span class="sxs-lookup"><span data-stu-id="a499f-271">The batch update algorithm used for this tutorial updates each row in the `ProductsDataTable` that corresponds to a row in the GridView, regardless of whether the product s information has been changed.</span></span> <span data-ttu-id="a499f-272">このような blind は t 通常、パフォーマンスの問題を更新中にデータベース テーブルの変更の監査する場合に余分なレコードをつながることができます。</span><span class="sxs-lookup"><span data-stu-id="a499f-272">While such blind updates aren t usually a performance issue, they can lead to superfluous records if you re auditing changes to the database table.</span></span> <span data-ttu-id="a499f-273">戻り、[バッチ更新を実行する](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-vb.md)チュートリアル DataList でインターフェイスの更新バッチに調査し、ユーザーが実際に変更されたレコードを更新のみコードを追加します。</span><span class="sxs-lookup"><span data-stu-id="a499f-273">Back in the [Performing Batch Updates](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-vb.md) tutorial we explored a batch updating interface with the DataList and added code that would only update those records that were actually modified by the user.</span></span> <span data-ttu-id="a499f-274">自由に技法を使用して[を実行するバッチ更新](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-vb.md)必要な場合、このチュートリアルでは、コードを更新します。</span><span class="sxs-lookup"><span data-stu-id="a499f-274">Feel free to use the techniques from [Performing Batch Updates](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-vb.md) to update the code in this tutorial, if desired.</span></span>

> [!NOTE]
> <span data-ttu-id="a499f-275">ときにデータ ソースをバインドすると、そのスマート タグから GridView に、Visual Studio に自動的にデータ ソースの主キー値を割り当てます GridView の`DataKeyNames`プロパティです。</span><span class="sxs-lookup"><span data-stu-id="a499f-275">When binding the data source to the GridView through its smart tag, Visual Studio automatically assigns the data source s primary key value(s) to the GridView s `DataKeyNames` property.</span></span> <span data-ttu-id="a499f-276">バインドされなかった、ObjectDataSource、GridView s のスマート タグから GridView に、手順 1. で説明したかどうかは、GridView s を手動で設定する必要があります`DataKeyNames`プロパティにアクセスするために ProductID を`ProductID`を介して各の行の値、`DataKeys`コレクション。</span><span class="sxs-lookup"><span data-stu-id="a499f-276">If you did not bind the ObjectDataSource to the GridView through the GridView s smart tag as outlined in Step 1, then you will need to manually set the GridView s `DataKeyNames` property to ProductID in order to access the `ProductID` value for each row through the `DataKeys` collection.</span></span>


<span data-ttu-id="a499f-277">使用するコード`BatchUpdate`BLL s で使用されているような`UpdateProduct`メソッド、記述されていることの主な違い、`UpdateProduct`メソッドが 1 つだけ`ProductRow`アーキテクチャからインスタンスを取得します。</span><span class="sxs-lookup"><span data-stu-id="a499f-277">The code used in `BatchUpdate` is similar to that used in the BLL s `UpdateProduct` methods, the main difference being that in the `UpdateProduct` methods only a single `ProductRow` instance is retrieved from the architecture.</span></span> <span data-ttu-id="a499f-278">プロパティを割り当てるコード、`ProductRow`間で同じでは、`UpdateProducts`メソッドと、コード内で、`For Each`ループ`BatchUpdate`全体的なパターンが格納される、します。</span><span class="sxs-lookup"><span data-stu-id="a499f-278">The code that assigns the properties of the `ProductRow` is the same between the `UpdateProducts` methods and the code within the `For Each` loop in `BatchUpdate`, as is the overall pattern.</span></span>

<span data-ttu-id="a499f-279">このチュートリアルを完了する必要がありますが、`BatchUpdate`メソッドが呼び出されたときに更新プログラムの製品ボタンのいずれかをクリックします。</span><span class="sxs-lookup"><span data-stu-id="a499f-279">To complete this tutorial, we need to have the `BatchUpdate` method invoked when either of the Update Products buttons is clicked.</span></span> <span data-ttu-id="a499f-280">イベント ハンドラーを作成、`Click`これらの 2 つのイベントのコントロールのボタンをクリックし、イベント ハンドラーに次のコードを追加します。</span><span class="sxs-lookup"><span data-stu-id="a499f-280">Create event handlers for the `Click` events of these two Button controls and add the following code in the event handlers:</span></span>


[!code-vb[Main](batch-updating-vb/samples/sample6.vb)]

<span data-ttu-id="a499f-281">呼び出しが行われた最初`BatchUpdate`です。</span><span class="sxs-lookup"><span data-stu-id="a499f-281">First a call is made to `BatchUpdate`.</span></span> <span data-ttu-id="a499f-282">次に、 [ `ClientScript`プロパティ](https://msdn.microsoft.com/library/system.web.ui.page.clientscript(VS.80).aspx)製品が更新されましたが読み取るメッセージ ボックスを表示する JavaScript を挿入するために使用します。</span><span class="sxs-lookup"><span data-stu-id="a499f-282">Next, the [`ClientScript` property](https://msdn.microsoft.com/library/system.web.ui.page.clientscript(VS.80).aspx) is used to inject JavaScript that will display a messagebox that reads The products have been updated.</span></span>

<span data-ttu-id="a499f-283">このコードをテストする分ほどをかかります。</span><span class="sxs-lookup"><span data-stu-id="a499f-283">Take a minute to test out this code.</span></span> <span data-ttu-id="a499f-284">参照してください`BatchUpdate.aspx`ブラウザーから、行の数を編集し、いずれかの更新プログラムの製品ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="a499f-284">Visit `BatchUpdate.aspx` through a browser, edit a number of rows, and click one of the Update Products buttons.</span></span> <span data-ttu-id="a499f-285">入力の検証エラーがないと仮定した場合、製品が更新されましたが読み取るメッセージ ボックスが表示されます。</span><span class="sxs-lookup"><span data-stu-id="a499f-285">Assuming there are no input validation errors, you should see a messagebox that reads The products have been updated.</span></span> <span data-ttu-id="a499f-286">更新の原子性を確認するため、ランダムな追加を検討して`CHECK`が禁止されているいずれかのように、制約`UnitPrice`1234.56 の値。</span><span class="sxs-lookup"><span data-stu-id="a499f-286">To verify the atomicity of the update, consider adding a random `CHECK` constraint, like one that disallows `UnitPrice` values of 1234.56.</span></span> <span data-ttu-id="a499f-287">`BatchUpdate.aspx`、S、製品のいずれかを設定することを確認のレコードの数を編集`UnitPrice`値は禁止されている値 (1234.56) にします。</span><span class="sxs-lookup"><span data-stu-id="a499f-287">Then from `BatchUpdate.aspx`, edit a number of records, making sure to set one of the product s `UnitPrice` value to the forbidden value ( 1234.56 ).</span></span> <span data-ttu-id="a499f-288">元の値をそのバッチ操作中に、その他の変更と更新プログラムの製品をクリックすると、ロールバックされたときに、エラーこの発生する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a499f-288">This should result in an error when clicking Update Products with the other changes during that batch operation rolled back to their original values.</span></span>

## <a name="an-alternativebatchupdatemethod"></a><span data-ttu-id="a499f-289">代わりに`BatchUpdate`メソッド</span><span class="sxs-lookup"><span data-stu-id="a499f-289">An Alternative`BatchUpdate`Method</span></span>

<span data-ttu-id="a499f-290">`BatchUpdate`おメソッド取得の検査*すべて*BLL s から製品の`GetProducts`メソッドと GridView に表示されるには、これらのレコードを更新します。</span><span class="sxs-lookup"><span data-stu-id="a499f-290">The `BatchUpdate` method we just examined retrieves *all* of the products from the BLL s `GetProducts` method and then updates just those records that appear in the GridView.</span></span> <span data-ttu-id="a499f-291">GridView は、ページングを使用しない場合は、される可能性しますが、あります数百、何千も、または数万人の製品が GridView で 10 個までの行の場合に、この方法を使用することが理想的です。</span><span class="sxs-lookup"><span data-stu-id="a499f-291">This approach is ideal if the GridView does not use paging, but if it does, there may be hundreds, thousands, or tens of thousands of products, but only ten rows in the GridView.</span></span> <span data-ttu-id="a499f-292">このような場合は、そのうち 10 を変更するだけデータベースからすべての製品の取得より小さい最適です。</span><span class="sxs-lookup"><span data-stu-id="a499f-292">In such a case, getting all of the products from the database only to modify 10 of them is less than ideal.</span></span>

<span data-ttu-id="a499f-293">これらの種類の状況の使用を検討して、次`BatchUpdateAlternate`メソッド代わりにします。</span><span class="sxs-lookup"><span data-stu-id="a499f-293">For those types of situations, consider using the following `BatchUpdateAlternate` method instead:</span></span>


[!code-vb[Main](batch-updating-vb/samples/sample7.vb)]

<span data-ttu-id="a499f-294">`BatchMethodAlternate` 新しい空を作成して開始`ProductsDataTable`という`products`です。</span><span class="sxs-lookup"><span data-stu-id="a499f-294">`BatchMethodAlternate` starts by creating a new empty `ProductsDataTable` named `products`.</span></span> <span data-ttu-id="a499f-295">これは、後、GridView s をステップ実行`Rows`コレクション各行 BLL s を使用して特定の製品情報を取得するのと`GetProductByProductID(productID)`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="a499f-295">It then steps through the GridView s `Rows` collection and for each row gets the particular product information using the BLL s `GetProductByProductID(productID)` method.</span></span> <span data-ttu-id="a499f-296">取得した`ProductsRow`インスタンスと同じ方法で更新のプロパティがあります`BatchUpdate`が、インポートを行を更新した後、 `products` `ProductsDataTable` DataTable s を介して[`ImportRow(DataRow)`メソッド](https://msdn.microsoft.com/library/system.data.datatable.importrow(VS.80).aspx).</span><span class="sxs-lookup"><span data-stu-id="a499f-296">The retrieved `ProductsRow` instance has its properties updated in the same fashion as `BatchUpdate`, but after updating the row it is imported into the `products` `ProductsDataTable` via the DataTable s [`ImportRow(DataRow)` method](https://msdn.microsoft.com/library/system.data.datatable.importrow(VS.80).aspx).</span></span>

<span data-ttu-id="a499f-297">後に、`For Each`ループが完了すると、 `products` 1 つ含む`ProductsRow`GridView の行ごとのインスタンス。</span><span class="sxs-lookup"><span data-stu-id="a499f-297">After the `For Each` loop completes, `products` contains one `ProductsRow` instance for each row in the GridView.</span></span> <span data-ttu-id="a499f-298">以降の各、`ProductsRow`インスタンスに追加された、 `products` (の代わりに更新されます)、お無条件に渡す場合、`UpdateWithTransaction`メソッド、`ProductsTableAdatper`各レコードをデータベースに挿入しようとしてがします。</span><span class="sxs-lookup"><span data-stu-id="a499f-298">Since each of the `ProductsRow` instances have been added to the `products` (instead of updated), if we blindly pass it to the `UpdateWithTransaction` method the `ProductsTableAdatper` will try to insert each of the records into the database.</span></span> <span data-ttu-id="a499f-299">代わりに、それぞれの行が変更されたこと (追加されません) を指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a499f-299">Instead, we need to specify that each of these rows has been modified (not added).</span></span>

<span data-ttu-id="a499f-300">これには、名前付き BLL に新しいメソッドを追加して`UpdateProductsWithTransaction`です。</span><span class="sxs-lookup"><span data-stu-id="a499f-300">This can be accomplished by adding a new method to the BLL named `UpdateProductsWithTransaction`.</span></span> <span data-ttu-id="a499f-301">`UpdateProductsWithTransaction`、、次のように設定、`RowState`のそれぞれの、`ProductsRow`のインスタンスにある、`ProductsDataTable`に`Modified`し渡します、 `ProductsDataTable` DAL s`UpdateWithTransaction`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="a499f-301">`UpdateProductsWithTransaction`, shown below, sets the `RowState` of each of the `ProductsRow` instances in the `ProductsDataTable` to `Modified` and then passes the `ProductsDataTable` to the DAL s `UpdateWithTransaction` method.</span></span>


[!code-vb[Main](batch-updating-vb/samples/sample8.vb)]

## <a name="summary"></a><span data-ttu-id="a499f-302">まとめ</span><span class="sxs-lookup"><span data-stu-id="a499f-302">Summary</span></span>

<span data-ttu-id="a499f-303">GridView は、行ごとの組み込みの編集機能を提供が完全に編集可能なインターフェイスを作成するためのサポートがありません。</span><span class="sxs-lookup"><span data-stu-id="a499f-303">The GridView provides built-in per-row editing capabilities, but lacks support for creating fully editable interfaces.</span></span> <span data-ttu-id="a499f-304">このチュートリアルで説明したとおり、このようなインターフェイスが、作業のビットを必要とします。</span><span class="sxs-lookup"><span data-stu-id="a499f-304">As we saw in this tutorial, such interfaces are possible, but require a bit of work.</span></span> <span data-ttu-id="a499f-305">すべての行は編集 GridView を作成する必要があります TemplateFields GridView のフィールドに変換して内で編集のインターフェイスを定義する、 `ItemTemplate` s。</span><span class="sxs-lookup"><span data-stu-id="a499f-305">To create a GridView where every row is editable, we need to convert the GridView s fields into TemplateFields and define the editing interface within the `ItemTemplate` s.</span></span> <span data-ttu-id="a499f-306">また、更新すべてのボタン Web コントロールの種類は、GridView とは別のページに追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a499f-306">Additionally, Update All -type Button Web controls must be added to the page, separate from the GridView.</span></span> <span data-ttu-id="a499f-307">これらのボタン`Click`イベント ハンドラーが GridView s を列挙する必要があります`Rows`、コレクション内の変更を保存、 `ProductsDataTable`、更新された情報を適切な BLL メソッドに渡すとします。</span><span class="sxs-lookup"><span data-stu-id="a499f-307">These Buttons `Click` event handlers need to enumerate the GridView s `Rows` collection, store the changes in a `ProductsDataTable`, and pass the updated information into the appropriate BLL method.</span></span>

<span data-ttu-id="a499f-308">次のチュートリアルは、バッチを削除するためのインターフェイスを作成する方法が表示されます。</span><span class="sxs-lookup"><span data-stu-id="a499f-308">In the next tutorial we'll see how to create an interface for batch deleting.</span></span> <span data-ttu-id="a499f-309">具体的には、GridView の各行はチェック ボックスなどの代わりにすべての更新-入力ボタンを選択した行の削除ボタン必要があります。</span><span class="sxs-lookup"><span data-stu-id="a499f-309">In particular, each GridView row will include a checkbox and instead of Update All -type buttons, we'll have Delete Selected Rows buttons.</span></span>

<span data-ttu-id="a499f-310">満足プログラミング!</span><span class="sxs-lookup"><span data-stu-id="a499f-310">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="a499f-311">作成者について</span><span class="sxs-lookup"><span data-stu-id="a499f-311">About the Author</span></span>

<span data-ttu-id="a499f-312">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)、7 つ受け取りますブックとの創設者の作成者[4GuysFromRolla.com](http://www.4guysfromrolla.com)、1998 年からマイクロソフトの Web テクノロジで取り組んできました。</span><span class="sxs-lookup"><span data-stu-id="a499f-312">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="a499f-313">Scott は、コンサルタント、トレーナー、ライターとして機能します。</span><span class="sxs-lookup"><span data-stu-id="a499f-313">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="a499f-314">最新の著書[ *Sam 学べる自分で ASP.NET 2.0 が 24 時間以内に*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)です。</span><span class="sxs-lookup"><span data-stu-id="a499f-314">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="a499f-315">彼に到達できる[ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)彼のブログを使用して含まれているのか[ http://ScottOnWriting.NET](http://ScottOnWriting.NET)です。</span><span class="sxs-lookup"><span data-stu-id="a499f-315">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="a499f-316">感謝の特別な</span><span class="sxs-lookup"><span data-stu-id="a499f-316">Special Thanks To</span></span>

<span data-ttu-id="a499f-317">このチュートリアルの系列は既に多くの便利なレビュー担当者によって確認済みです。</span><span class="sxs-lookup"><span data-stu-id="a499f-317">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="a499f-318">このチュートリアルの潜在顧客レビュー担当者は、Teresa マーフィーおよび David Suru がいました。</span><span class="sxs-lookup"><span data-stu-id="a499f-318">Lead reviewers for this tutorial were Teresa Murphy and David Suru.</span></span> <span data-ttu-id="a499f-319">今後、MSDN の記事を確認することに関心のあるですか。</span><span class="sxs-lookup"><span data-stu-id="a499f-319">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="a499f-320">場合は、ドロップ me 一度に 1 行ずつ[mitchell@4GuysFromRolla.comです。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="a499f-320">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="a499f-321">[前へ](wrapping-database-modifications-within-a-transaction-vb.md)
> [次へ](batch-deleting-vb.md)</span><span class="sxs-lookup"><span data-stu-id="a499f-321">[Previous](wrapping-database-modifications-within-a-transaction-vb.md)
[Next](batch-deleting-vb.md)</span></span>
