---
uid: web-forms/overview/deployment/configuring-server-environments-for-web-deployment/creating-a-server-farm-with-the-web-farm-framework
title: "Web Farm Framework でサーバー ファームを作成 |Microsoft ドキュメント"
author: jrjlee
description: "このトピックでは、Web Farm Framework (WFF) 2.0 を使用して作成し、サーバーのコレクションからの web サーバー ファームを構成する方法について説明します。"
ms.author: aspnetcontent
manager: wpickett
ms.date: 05/04/2012
ms.topic: article
ms.assetid: 656dd06d-806c-467c-863d-9fc45e5ba3ab
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/deployment/configuring-server-environments-for-web-deployment/creating-a-server-farm-with-the-web-farm-framework
msc.type: authoredcontent
ms.openlocfilehash: 2458abc863a83364f90fc9d6edaace897c23b4c9
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/10/2017
---
<a name="creating-a-server-farm-with-the-web-farm-framework"></a>Web Farm Framework によるサーバー ファームの作成
====================
によって[Jason lee 著](https://github.com/jrjlee)

[PDF をダウンロードします。](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> このトピックでは、Web Farm Framework (WFF) 2.0 を使用して作成し、サーバーのコレクションからの web サーバー ファームを構成する方法について説明します。


WFF では、複数の負荷分散された web サーバー、web platform 製品とコンポーネント、web アプリケーション、web サイト、および構成設定を同期できます。 ステージングと運用環境と同様に、1 つ以上の web サーバーが必要があるシナリオでこの大幅に、展開と構成プロセスを簡略化することができます。 1 台のサーバー & #x 2014; web アプリケーションを展開することができます、*プライマリ サーバー*& #x 2014; とその web アプリケーション、サーバー ファーム内の他のすべての web サーバーに自動的にレプリケートされる WFF はします。

## <a name="understanding-the-web-farm-framework"></a>Web Farm Framework を理解します。

WFF 2.0 を使用して、プロビジョニング、管理、および web サーバーのグループにコンテンツを展開することができます。 WFF 展開は、3 つの主要なサーバー ロールで構成されます。

- *コント ローラー サーバー*です。 作成および WFF サーバー ファームを構成するには、このサーバーを使用します。 コント ローラーのサーバーでは、web プラットフォーム コンポーネント、構成設定、およびアプリケーション サーバー ファームの web サーバー間での同期を管理します。 コント ローラーのサーバーに WFF 2.0 をインストールして、コント ローラーのサーバーでは、WFF エージェントの各サーバー ファームにサーバーをインストールにします。 コント ローラーのサーバーは概念的には、WFF サーバー ファームに属していませんし、単一のコント ローラーのサーバーが複数のサーバー ファームを管理できます。 このシナリオでは、1 つ WFF コント ローラー サーバーを使用するステージング サーバー ファームと実稼働サーバー ファームを作成および管理します。
- *プライマリ サーバー*です。 各 WFF サーバー ファームには、1 つのプライマリ サーバーが含まれます。 Web プラットフォーム コンポーネントをインストールまたはプライマリ サーバーにアプリケーションを展開するときに、WFF は、サーバー ファームの他のすべてのサーバーへの変更を同期します。
- *セカンダリ サーバー*です。 各 WFF サーバー ファームには、1 つ以上のセカンダリ サーバーが含まれています。 プライマリ サーバーに加えたあらゆる変更は、サーバー ファーム内のすべてのセカンダリ サーバーにレプリケートされます。

これは、これらのサーバー ロールが Fabrikam, Inc. のステージングと運用環境に関連付ける方法を示しています。

![](creating-a-server-farm-with-the-web-farm-framework/_static/image1.png)

このシナリオでは、ステージング環境と運用環境の両方を構成 WFF サーバー ファームとして。 単一 WFF コント ローラーのサーバーでは、両方のファームを管理します。 各サーバー ファーム内では、プライマリ サーバーへの変更は、すべてのセカンダリ サーバーにレプリケートされます。

ステージングと運用環境の構成を開始する前に、WFF 2.0 の主要な概念を理解しておくため。 これらの記事を読むことお勧めします。

- [IIS 7 用の Web Farm Framework 2.0 の概要](https://go.microsoft.com/?linkid=9805126)
- [IIS 7 のサーバー ファームの Web Farm Framework 2.0 を設定します。](https://go.microsoft.com/?linkid=9805127)
- [システムおよび IIS 7 Web Farm Framework 2.0 のプラットフォームの要件](https://go.microsoft.com/?linkid=9805128)

## <a name="task-overview"></a>タスクの概要

タスクとこのトピックの「チュートリアルを完了する必要がありますには、少なくとも 3 つのサーバー & #x 2014; WFF コント ローラー、サーバー ファームの 1 つのプライマリ web サーバーおよびサーバー ファームの 1 つ以上のセカンダリの web サーバー。 複数のセカンダリ サーバーは、いつでも WFF サーバー ファームに追加できます。 作成および構成する必要があります、ステージングまたは運用環境に WFF サーバー ファームの高レベル。

- インターネット インフォメーション サービス (IIS) 7.5 および WFF 2.0 をインストールすることでコント ローラーのサーバーを作成します。
- プライマリおよびセカンダリ サーバーを準備するには、共通の管理者アカウントを作成して、ファイアウォールの例外を構成します。
- コント ローラーのサーバーで IIS マネージャーを使用して、サーバー ファームを構成します。
- IIS Application Request Routing (ARR) または別の負荷分散テクノロジを使用して負荷分散を構成します。

タスクとここでチュートリアルは、Windows Server 2008 R2 を実行するクリーンなサーバー ビルドを開始していることを想定しています。 サーバーごとに、開始する前に以下のことを確認します。

- Windows Server 2008 R2 Service Pack 1 とすべての利用可能な更新プログラムがインストールされます。
- サーバーがドメインに参加します。
- サーバーは、静的 IP アドレスを持ちます。

> [!NOTE]
> コンピューターをドメインに参加させる方法については、次を参照してください。[に参加するコンピューター、ドメインとログオン](https://technet.microsoft.com/en-us/library/cc725618(v=WS.10).aspx)です。 静的 IP アドレスを構成する方法については、次を参照してください。[静的 IP アドレスを構成](https://technet.microsoft.com/en-us/library/cc754203(v=ws.10).aspx)です。


## <a name="create-the-wff-controller-server"></a>WFF コント ローラーのサーバーを作成します。

WFF コント ローラーのサーバーを作成するには、IIS 7 以降と WFF 2.0 またはそれ以降の両方をインストールする必要があります。 WFF を内部的には、IIS Web 配置ツール (Web 配置) を使用して、ファーム内のサーバーを同期するために 2.x です。 WFF をインストールする、Web Platform Installer を使用する場合、インストーラーは自動的にダウンロードして Web Deploy をインストールします。

**WFF コント ローラーのサーバーを作成するには**

1. ダウンロードしてインストール、 [Web Platform Installer](https://go.microsoft.com/?linkid=9739157)です。
2. 上部にある、 **Web Platform Installer 3.0**ウィンドウで、をクリックして**製品**です。
3. ナビゲーション ウィンドウで、ウィンドウの左側にあるをクリックして**サーバー**です。
4. **IIS 7 の推奨構成**行で、をクリックして**追加**です。
5. **Web Farm Framework 2** 。*x*行で、をクリックして**追加**です。

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image2.png)
6. **[インストール]**をクリックします。 Web Platform Installer がインストールの一覧にさまざまな他の依存関係と共に、Web 配置ツールを追加していることを確認します。

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image3.png)
7. ライセンス条項を確認し、条項に同意した場合にをクリックして**同意**です。
8. インストールが完了したらをクリックして**完了**、し、閉じます、 **Web Platform Installer 3.0**ウィンドウです。

## <a name="configure-the-primary-and-secondary-servers"></a>プライマリおよびセカンダリ サーバーを構成します。

WFF サーバー ファームを作成する前に、ファームを構成する web サーバー上でいくつかの準備タスクを完了する必要があります。

- ファイアウォールの例外を追加できるように、**コア ネットワーク**、**リモート管理**、および**ファイルとプリンターの共有**WFF コント ローラー サーバーと通信する機能.
- ドメイン アカウントを作成する (たとえば、 **FABRIKAM\stagingfarm**) Active Directory にし、各サーバー上のローカルの administrators グループに追加します。 サーバー ファームを作成するときは、サーバー ファームの管理者アカウントとしてこのアカウントを使用します。

Windows ファイアウォールでこれらのファイアウォール例外を構成する方法の詳細については、次を参照してください。[システムと IIS 7 Web Farm Framework 2.0 のプラットフォーム要件](https://go.microsoft.com/?linkid=9805128)です。 その他のファイアウォール システム、製品のマニュアルを参照してください。

次の手順を使用すると、Windows Server 2008 R2 のローカルの administrators グループにドメイン アカウントを追加します。 サーバー ファーム & #x 2014; に追加するすべてのサーバーでこの手順を実行する必要がありますつまり、プライマリ サーバーと各セカンダリ サーバーのローカル administrators グループに同じドメイン アカウントを追加します。

**ローカルの administrators グループにドメイン アカウントを追加するには**

1. **開始** メニューのをポイント**管理ツール**、クリックして**サーバー マネージャー**です。
2. **サーバー マネージャー**ウィンドウのツリー ビュー ペインで **構成**、展開**ローカル ユーザーとグループ**、クリックして**グループ**.

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image4.png)
3. **グループ** ウィンドウをダブルクリックして**管理者**です。
4. **Administrators のプロパティ**ダイアログ ボックスで、をクリックして**追加**です。
5. **[ユーザー、コンピューター、サービス アカウントまたはグループ**、ドメイン アカウント] ダイアログ ボックス、入力 (または参照) (たとえば、 **FABRIKAM\stagingfarm**)、をクリックし、 **OK**.

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image5.png)
6. **Administrators のプロパティ**ダイアログ ボックスで、をクリックして**OK**です。

サーバーは、サーバー ファームに追加する準備が整いました。 場合は、プライマリ サーバーをサーバー ファーム & #x 2014 を作成した後または前に、アプリケーションの要件を満たすためにサーバーを構成することができますどちらの場合、WFF は、同じ製品、コンポーネントを展開することで、サーバーを同期されますか。セカンダリ サーバーを構成します。 わかりやすくするため、このチュートリアルでは、サーバー ファームの作成が完了したら、プライマリ サーバーを構成します。

## <a name="create-the-wff-server-farm"></a>WFF サーバー ファームを作成します。

この時点では、すべてのサーバーは、WFF サーバー ファームに追加する準備。

- コント ローラーのサーバーには、WFF をインストールしました。
- ファイアウォールの例外は、プライマリとセカンダリの web サーバーで構成しました。
- ドメイン アカウントは、プライマリとセカンダリの web サーバーでローカルの administrators グループに追加されました。

次の手順では、WFF でサーバー ファームを作成します。 これを行う IIS マネージャーから WFF コント ローラー サーバーにします。

**WFF サーバー ファームを作成するには**

1. WFF コント ローラーのサーバー上で、**開始** メニューのをポイント**管理ツール**、順にクリック**インターネット インフォメーション サービス (IIS) マネージャー**です。
2. **接続**ウィンドウで、ローカル サーバーのノードを展開しを右クリックして**サーバー ファーム**、クリックして**サーバー ファームの作成**です。
3. **サーバー ファームの作成**] ダイアログ ボックスで、サーバー ファームのわかりやすい名前を入力 (たとえば、**ステージング ファーム**)、し、[**プロビジョニング サーバー ファーム**です。
4. ユーザー名と各サーバーでローカルの administrators グループに追加したドメイン アカウントのパスワードを入力します。

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image6.png)
5. **[次へ]**をクリックします。
6. **サーバーの追加** ページの選択、プライマリ サーバーの完全修飾ドメイン名 (FQDN) を入力**プライマリ サーバー**、クリックして**追加**です。
7. この時点では、WFF しようとすると、指定された資格情報を使用してプライマリ サーバーに接続します。 接続に成功した場合、プライマリ サーバーが追加されるテーブルに上、**サーバーの追加**ページ。

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image7.png)

    > [!NOTE]
    > お気付きを**サーバーが負荷分散の使用可能な**が既定で選択します。 WFF では、IIS ARR モジュールを使用して負荷分散を実装し、それによって、サーバー ファーム内の web サーバー間で要求を分散します。 ほとんどのシナリオではだけをクリアする、**サーバーが負荷分散の使用可能な**サードパーティの負荷分散ソリューションを代わりを使用する場合はオプションです。
8. **サーバーの追加** ページで、最初のセカンダリ サーバーの FQDN を入力してをクリックして**追加**です。

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image8.png)
9. クリックして、ファーム内の追加のセカンダリ サーバーに対して手順 7**完了**です。

WFF サーバー ファームが起動し、実行中です。 任意の web platform 製品またはプライマリ サーバーで、および任意の web アプリケーションや、プライマリ サーバーに展開するコンテンツをインストールするコンポーネントは、すべてのセカンダリ サーバー上に自動的にプロビジョニングされます。

WFF は広範で複雑なトピックとで詳細情報を入手することができます、 [IIS 7 用の Microsoft Web Farm Framework 2.0](https://go.microsoft.com/?linkid=9805129) web サイトです。 しばらくの間、ただしが認識する必要がある 2 つの機能領域です。

- *アプリケーションのプロビジョニング*サーバー ファーム内のすべてのセカンダリ サーバー間で web アプリケーションと構成設定と同様に、プライマリ サーバーからコンテンツをレプリケートするプロセスです。 たとえば、プライマリ ステージング サーバーに連絡先のマネージャーのサンプル ソリューションを展開する場合、WFF アプリケーションのプロビジョニング プロセスはソリューションを配置このすべてのセカンダリのステージング サーバーにします。 既定では、アプリケーションのプロビジョニング プロセスには、30 秒間隔が実行されます。
- *プラットフォームのプロビジョニング*web platform 製品と、プライマリ サーバーからサーバー ファーム内のすべてのセカンダリ サーバーにコンポーネントを同期するプロセスです。 たとえば、プライマリ、ステージング サーバーに ASP.NET MVC 3 をインストールする場合、プラットフォームのプロビジョニング プロセスを使用して、Web Platform Installer インストール ASP.NET MVC 3 すべてのセカンダリのステージング サーバー上。 既定では、プラットフォームのプロビジョニング プロセスは、5 分ごとを実行します。

管理できます基本的なアプリケーションおよびプラットフォームのプロビジョニング設定を IIS マネージャーから WFF コント ローラーのサーバー上。

**アプリケーションおよびプラットフォームの設定をプロビジョニングを探索します。**

1. IIS マネージャーで、[、**接続**] ウィンドウで、サーバー ファームを選択します。

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image9.png)
2. **サーバー ファーム** ウィンドウをダブルクリックして**アプリケーション プロビジョニング**です。

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image10.png)
3. ご覧のように、サーバー ファームは 30 秒ごとに、プライマリ サーバーとセカンダリ サーバーの間での web コンテンツと構成設定を同期するために構成されています。
4. をクリックして**戻る**、順にダブルクリック**プラットフォームのプロビジョニング**です。

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image11.png)
5. ご覧のように、サーバー ファームは 5 分ごとに web platform 製品とコンポーネント、プライマリ サーバーとセカンダリ サーバーの間を同期するために構成されています。
6. をクリックして**戻る**です。
7. すぐに、web platform 製品を同期するために、サーバー ファームを強制的にで、**アクション** ウィンドウで、をクリックして**プロビジョニング プラットフォーム**です。

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image12.png)

    > [!NOTE]
    > プラットフォームのプロビジョニングと、時間がかかる場合があります。 インストーラー プロセスは、サーバー ファーム内のセカンダリ サーバーには、バック グラウンドで実行されます。
8. プロビジョニング プロセスを完了するための十分な時間を許可するよう、一度製品とプライマリ サーバーに追加するコンポーネントを今すぐレプリケートされているセカンダリ サーバーで確認できます。 たとえば、セカンダリ サーバーにログオンしを使用して、**サーバー マネージャー** web サーバーの役割がインストールされていることを確認するウィンドウです。

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image13.png)
9. さまざまな web プラットフォーム コンポーネントが追加されていることを確認するインストール済みプログラムの一覧を確認することもできます。

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image14.png)

## <a name="configure-load-balancing"></a>負荷分散を構成します。

Web ファームを作成するときに、web サーバー間での HTTP 要求を分散する負荷分散の何らかの形式を設定する必要があります。 Windows Server 2008 ネットワーク負荷分散の IIS ARR やサード パーティ製ソフトウェア ベースまたはハードウェア ベースの負荷が分散ソリューションが考えられます。

WFF が IIS の先端と密接に統合するように設計されています この統合を利用するには、WFF コント ローラー サーバーに ARR モジュールをインストールする必要があります。 指示するコント ローラーのサーバーに、すべての web トラフィック通常ドメイン ネーム システム (DNS) レコードを構成することによってです。 コント ローラーのサーバーは、サーバーの可用性とさまざまな他の条件に基づく、ファーム内のサーバー間での着信要求を配信して、します。

> [!NOTE]
> WFF; で、ARR を使用する必要はありません。サード パーティの負荷分散ソリューションを使用する WFF を構成することができます。 詳細については、次を参照してください。 [IIS 7 Web Farm Framework 2.0 の概要](https://go.microsoft.com/?linkid=9805126)です。


ARR を使用して負荷分散は、このチュートリアルの範囲を超えてが元の最も、複雑なトピックです。 ただし、モジュールをインストールする ARR 負荷分散の概要を次の手順を使用することができます。

**WFF コント ローラーのサーバーで負荷分散を設定するには**

1. WFF コント ローラーのサーバーでは、Web Platform Installer を起動します。
2. 上部にある、 **Web Platform Installer 3.0**ウィンドウで、をクリックして**製品**です。
3. ナビゲーション ウィンドウで、ウィンドウの左側にあるをクリックして**サーバー**です。
4. **アプリケーション要求ルーティング 2.5**行で、をクリックして**追加**です。

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image15.png)
5. をクリックして**インストール**、しの指示に従って、 **Web Platform のインストール**ウィンドウです。
6. インストールが完了したら、IIS マネージャーを起動し、[、**接続**] ウィンドウで、サーバー ファームのノードをクリックします。 いくつかの新しいアイコンに追加されていることを確認、**サーバー ファーム**ウィンドウです。

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image16.png)
7. **サーバー ファーム** ウィンドウをダブルクリックして**負荷分散**です。
8. **負荷分散** ウィンドウで選択した負荷分散アルゴリズム (たとえば、**少なくとも現在の要求**)。

    > [!NOTE]
    > 負荷分散アルゴリズムとその他の構成設定の詳細については、次を参照してください。[アプリケーション要求ルーティング モジュール](https://go.microsoft.com/?linkid=9805130)です。

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image17.png)
9. **アクション** ウィンドウで、をクリックして**適用**です。

基本的な負荷分散、サーバー ファーム内のサーバーを構成できました。 コント ローラーのサーバーにすべての web ファーム トラフィックを送信する場合、要求は可用性に応じて、ファーム内のサーバーと選択した負荷分散アルゴリズムの間で分散されます。

ARR で負荷分散を構成する方法の詳細については、次を参照してください。[アプリケーション要求ルーティング モジュール](https://go.microsoft.com/?linkid=9805130)です。

## <a name="monitor-the-server-farm"></a>サーバー ファームを監視します。

コント ローラーのサーバーで IIS マネージャーからいつでも、サーバー ファームのヘルスを監視できます。 **接続** ウィンドウでは、サーバー ファームを展開し、クリックして**サーバー**です。 中央のウィンドウでは、最近のアクティビティのトレース ログとファーム内の各サーバーの概要が表示されます。

![](creating-a-server-farm-with-the-web-farm-framework/_static/image18.png)

## <a name="conclusion"></a>まとめ

立ち上がっており実行中、WFF サーバー ファームになります。 どのしたい展開アプローチ & #x 2014 をサポートするために、プライマリ サーバーを構成することができます。 サーバー ファーム内の各セカンダリ サーバーでレプリケートされます詳細 & #x 2014; と構成の関連項目」セクションを参照してください。

## <a name="further-reading"></a>関連項目

構成と使用、WFF のすべての側面の詳細については、次を参照してください。、 [IIS 7 用の Microsoft Web Farm Framework 2.0](https://go.microsoft.com/?linkid=9805129) web サイトです。

>[!div class="step-by-step"]
[前へ](configuring-a-database-server-for-web-deploy-publishing.md)
[次へ](configuring-deployment-properties-for-a-target-environment.md)
