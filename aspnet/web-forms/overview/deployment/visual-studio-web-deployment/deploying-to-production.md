---
uid: web-forms/overview/deployment/visual-studio-web-deployment/deploying-to-production
title: "Visual Studio を使用した ASP.NET Web 展開: 実稼働環境に展開する |Microsoft ドキュメント"
author: tdykstra
description: "この一連のチュートリアルについては、展開する方法を示します (ASP.NET の発行) を使用して web アプリケーションを Azure App Service Web Apps またはサード パーティのホスティング プロバイダーにしています."
ms.author: aspnetcontent
manager: wpickett
ms.date: 02/15/2013
ms.topic: article
ms.assetid: 416438a1-3b2f-4d27-bf53-6b76223c33bf
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/deployment/visual-studio-web-deployment/deploying-to-production
msc.type: authoredcontent
ms.openlocfilehash: 2c49e7f6925b1ca172642747c5052ba97d70d036
ms.sourcegitcommit: 12e5194936b7e820efc5505a2d5d4f84e88eb5ef
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/11/2018
---
<a name="aspnet-web-deployment-using-visual-studio-deploying-to-production"></a><span data-ttu-id="b2cac-103">Visual Studio を使用した ASP.NET Web 展開: 実稼働環境に展開します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-103">ASP.NET Web Deployment using Visual Studio: Deploying to Production</span></span>
====================
<span data-ttu-id="b2cac-104">によって[Tom Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="b2cac-104">by [Tom Dykstra](https://github.com/tdykstra)</span></span>

[<span data-ttu-id="b2cac-105">スタート プロジェクトをダウンロードします。</span><span class="sxs-lookup"><span data-stu-id="b2cac-105">Download Starter Project</span></span>](http://go.microsoft.com/fwlink/p/?LinkId=282627)

> <span data-ttu-id="b2cac-106">この一連のチュートリアルについては、展開する方法を示します (ASP.NET の発行) Visual Studio 2012 または Visual Studio 2010 を使用して web アプリケーションを Azure App Service Web Apps またはサード パーティのホスティング プロバイダーにします。</span><span class="sxs-lookup"><span data-stu-id="b2cac-106">This tutorial series shows you how to deploy (publish) an ASP.NET web application to Azure App Service Web Apps or to a third-party hosting provider, by using Visual Studio 2012 or Visual Studio 2010.</span></span> <span data-ttu-id="b2cac-107">系列の詳細については、次を参照してください。[系列内の最初のチュートリアル](introduction.md)です。</span><span class="sxs-lookup"><span data-stu-id="b2cac-107">For information about the series, see [the first tutorial in the series](introduction.md).</span></span>


## <a name="overview"></a><span data-ttu-id="b2cac-108">概要</span><span class="sxs-lookup"><span data-stu-id="b2cac-108">Overview</span></span>

<span data-ttu-id="b2cac-109">このチュートリアルでは Microsoft Azure アカウントをセットアップ、ステージングと運用環境を作成およびステージングする ASP.NET web アプリケーションを展開して、Visual Studio の 1 回のクリックを使用して実稼働環境の機能を公開します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-109">In this tutorial, you set up a Microsoft Azure account, create staging and production environments, and deploy your ASP.NET web application to the staging and production environments by using the Visual Studio one-click publish feature.</span></span>

<span data-ttu-id="b2cac-110">を使用する場合は、サード パーティのホスティング プロバイダーに展開できます。</span><span class="sxs-lookup"><span data-stu-id="b2cac-110">If you prefer, you can deploy to a third-party hosting provider.</span></span> <span data-ttu-id="b2cac-111">このチュートリアルで説明する手順のほとんどは、各プロバイダーがあるアカウントと web サイト管理のための独自のユーザー インターフェイスを持つ点を除いて、ホスティング プロバイダーまたは Azure で同じです。</span><span class="sxs-lookup"><span data-stu-id="b2cac-111">Most of the procedures described in this tutorial are the same for a hosting provider or for Azure, except that each provider has its own user interface for account and web site management.</span></span> <span data-ttu-id="b2cac-112">ホスティング プロバイダーを見つけることができます、[プロバイダーのギャラリー](https://www.microsoft.com/web/hosting) Microsoft.com web サイトです。</span><span class="sxs-lookup"><span data-stu-id="b2cac-112">You can find a hosting provider in the [gallery of providers](https://www.microsoft.com/web/hosting) on the Microsoft.com web site.</span></span>

<span data-ttu-id="b2cac-113">アラーム: エラー メッセージを取得する、または、チュートリアルを通過するとおりに機能しないは、このチュートリアル シリーズのトラブルシューティングのページを確認することを確認します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-113">Reminder: If you get an error message or something doesn't work as you go through the tutorial, be sure to check the Troubleshooting page in this tutorial series.</span></span>

## <a name="get-a-microsoft-azure-account"></a><span data-ttu-id="b2cac-114">Microsoft Azure アカウントを取得します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-114">Get a Microsoft Azure account</span></span>

<span data-ttu-id="b2cac-115">既に Azure アカウントを持っていない場合は、ほんの数分で無料の試用アカウントを作成できます。</span><span class="sxs-lookup"><span data-stu-id="b2cac-115">If you don't already have an Azure account, you can create a free trial account in just a couple of minutes.</span></span> <span data-ttu-id="b2cac-116">詳細については、「 [Azure 無料評価版](https://azure.microsoft.com/free/?WT.mc_id=A443DD604)です。</span><span class="sxs-lookup"><span data-stu-id="b2cac-116">For details, see [Azure Free Trial](https://azure.microsoft.com/free/?WT.mc_id=A443DD604).</span></span>

## <a name="create-a-staging-environment"></a><span data-ttu-id="b2cac-117">ステージング環境を作成します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-117">Create a staging environment</span></span>

> [!NOTE]
> <span data-ttu-id="b2cac-118">このチュートリアルが書き込まれてから、Azure App Service は、ステージングと運用環境を作成するためのプロセスの多くを自動化する新機能を追加します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-118">Since this tutorial was written, Azure App Service added a new feature to automate many of the processes for creating staging and production environments.</span></span> <span data-ttu-id="b2cac-119">参照してください[ステージング環境の Azure App service web アプリ設定](https://azure.microsoft.com/documentation/articles/web-sites-staged-publishing/)です。</span><span class="sxs-lookup"><span data-stu-id="b2cac-119">See [Set up staging environments for web apps in Azure App Service](https://azure.microsoft.com/documentation/articles/web-sites-staged-publishing/).</span></span>


<span data-ttu-id="b2cac-120">説明に従って、[環境のテストのチュートリアルへの展開](deploying-to-iis.md)最も信頼性の高いテスト環境は、実稼働 web サイトと同様にしているホスティング プロバイダーに web サイトです。</span><span class="sxs-lookup"><span data-stu-id="b2cac-120">As explained in the [Deploy to the Test Environment tutorial](deploying-to-iis.md), the most reliable test environment is a web site at the hosting provider that's just like the production web site.</span></span> <span data-ttu-id="b2cac-121">大きな追加コストに対するこれの利点を比較検討する必要が多くのホスティング プロバイダーですが Azure のステージング アプリとして追加の無料の web アプリを作成することができます。</span><span class="sxs-lookup"><span data-stu-id="b2cac-121">At many hosting providers you would have to weigh the benefits of this against significant additional cost, but in Azure you can create an additional free web app as your staging app.</span></span> <span data-ttu-id="b2cac-122">また、データベースが必要し、そのため、実稼働データベースの経費経由での追加の費用は none いずれかになりますまたは最低限です。</span><span class="sxs-lookup"><span data-stu-id="b2cac-122">You also need a database, and the additional expense for that over the expense of your production database will be either none or minimal.</span></span> <span data-ttu-id="b2cac-123">Azure でした各データベースではなく、使用するデータベースの記憶域の量に対してお支払いステージングを使用して追加の記憶域の量が最小限に抑えられます。</span><span class="sxs-lookup"><span data-stu-id="b2cac-123">In Azure you pay for the amount of database storage you use rather than for each database, and the amount of additional storage you'll use in staging will be minimal.</span></span>

<span data-ttu-id="b2cac-124">説明に従って、[テスト環境のチュートリアルへの展開](deploying-to-iis.md)ステージングと運用データベースを 1 つに、2 つのデータベースを展開することで、します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-124">As explained in the [Deploy to the Test Environment tutorial](deploying-to-iis.md), in staging and production you're going to deploy your two databases into one database.</span></span> <span data-ttu-id="b2cac-125">別に保持する場合は、プロセス同じになりますが、それぞれの環境の他のデータベースを作成し、発行プロファイルを作成するときに、各データベースの正しいコピー先文字列が選択されます。 します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-125">If you wanted to keep them separate, the process would be the same except that you'd create an additional database for each environment and you would select the correct destination string for each database when you create the publish profile.</span></span>

<span data-ttu-id="b2cac-126">チュートリアルのこのセクションでは、web アプリとステージング環境で使用するデータベースを作成しますおよびをステージング展開を作成して、実稼働環境に展開する前にテストがあります。</span><span class="sxs-lookup"><span data-stu-id="b2cac-126">In this section of the tutorial you'll create a web app and database to use for the staging environment, and you'll deploy to staging and test there before creating and deploying to the production environment.</span></span>

> [!NOTE]
> <span data-ttu-id="b2cac-127">次の手順では、Azure 管理ポータルを使用して、Azure App service web アプリを作成する方法を示します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-127">The following steps show how to create a web app in Azure App Service by using the Azure management portal.</span></span> <span data-ttu-id="b2cac-128">Azure SDK の最新のバージョンで行うことができますもこのサーバー エクスプ ローラーを使用して、Visual Studio を離れずにします。</span><span class="sxs-lookup"><span data-stu-id="b2cac-128">In the latest version of the Azure SDK, you can also do this without leaving Visual Studio, by using Server Explorer.</span></span> <span data-ttu-id="b2cac-129">Visual Studio 2013 で、発行ダイアログ ボックスから直接 web アプリを作成することもできます。</span><span class="sxs-lookup"><span data-stu-id="b2cac-129">In Visual Studio 2013, you can also create a web app directly from the Publish dialog.</span></span> <span data-ttu-id="b2cac-130">詳細については、次を参照してください。 [Azure App Service で ASP.NET web アプリを作成します。](https://docs.microsoft.com/azure/app-service-web/app-service-web-get-started-dotnet)</span><span class="sxs-lookup"><span data-stu-id="b2cac-130">For more information, see [Create an ASP.NET web app in Azure App Service.](https://docs.microsoft.com/azure/app-service-web/app-service-web-get-started-dotnet)</span></span>


1. <span data-ttu-id="b2cac-131">[Azure 管理ポータル](https://manage.windowsazure.com/)をクリックして**web サイト**、順にクリック**新規**です。</span><span class="sxs-lookup"><span data-stu-id="b2cac-131">In the [Azure Management Portal](https://manage.windowsazure.com/), click **Websites**, and then click **New**.</span></span>
2. <span data-ttu-id="b2cac-132">をクリックして**web サイト**、クリックして**カスタム作成**です。</span><span class="sxs-lookup"><span data-stu-id="b2cac-132">Click **Website**, and then click **Custom Create**.</span></span>

    <span data-ttu-id="b2cac-133">**新しい web サイト - カスタム作成**ウィザードが開きます。</span><span class="sxs-lookup"><span data-stu-id="b2cac-133">The **New Website - Custom Create** wizard opens.</span></span> <span data-ttu-id="b2cac-134">**カスタム作成**ウィザードでは、同時に、web サイトとデータベースを作成することができます。</span><span class="sxs-lookup"><span data-stu-id="b2cac-134">The **Custom Create** wizard enables you to create a web site and a database at the same time.</span></span>
3. <span data-ttu-id="b2cac-135">**Web サイトの作成**ステップのウィザードで文字列を入力してください。、 **URL** 、アプリケーションの一意の URL として使用する ボックスのステージング環境。</span><span class="sxs-lookup"><span data-stu-id="b2cac-135">In the **Create Website** step of the wizard, enter a string in the **URL** box to use as the unique URL for your application's staging environment.</span></span> <span data-ttu-id="b2cac-136">たとえば、ContosoUniversity staging123 (ContosoUniversity ステージングが実行される場合に一意にする、最後の乱数を含む) を入力します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-136">For example, enter ContosoUniversity-staging123 (including random numbers at the end to make it unique in case ContosoUniversity-staging is taken).</span></span>

    <span data-ttu-id="b2cac-137">完全な URL は、ここに入力したものとテキスト ボックスの横に表示されるサフィックスで構成されます。</span><span class="sxs-lookup"><span data-stu-id="b2cac-137">The complete URL will consist of what you enter here plus the suffix that you see next to the text box.</span></span>
4. <span data-ttu-id="b2cac-138">**地域**ドロップダウン リストで、自分に最も近い地域を選択します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-138">In the **Region** drop-down list, choose the region that is closest to you.</span></span>

    <span data-ttu-id="b2cac-139">この設定は、データ センターで、web アプリは実行を指定します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-139">This setting specifies which data center your web app will run in.</span></span>
5. <span data-ttu-id="b2cac-140">**データベース**ドロップダウン リストで、選択**新しい SQL データベースの作成**です。</span><span class="sxs-lookup"><span data-stu-id="b2cac-140">In the **Database** drop-down list, choose **Create a new SQL database**.</span></span>
6. <span data-ttu-id="b2cac-141">**DB 接続文字列名**ボックスで、既定値をそのまま*DefaultConnection*です。</span><span class="sxs-lookup"><span data-stu-id="b2cac-141">In the **DB Connection String Name** box, leave the default value, *DefaultConnection*.</span></span>
7. <span data-ttu-id="b2cac-142">右側のボックスの下部にある矢印をクリックします。</span><span class="sxs-lookup"><span data-stu-id="b2cac-142">Click the arrow that points to the right at the bottom of the box.</span></span>

    <span data-ttu-id="b2cac-143">次の図は、 **web サイトの作成** ダイアログ ボックス内のサンプル値。</span><span class="sxs-lookup"><span data-stu-id="b2cac-143">The following illustration shows the **Create Website** dialog with sample values in it.</span></span> <span data-ttu-id="b2cac-144">URL と入力した地域されるが異なります。</span><span class="sxs-lookup"><span data-stu-id="b2cac-144">The URL and Region that you have entered will be different.</span></span>

    ![Web サイトを作成します。](deploying-to-production/_static/image1.png)

    <span data-ttu-id="b2cac-146">ウィザード、**データベース設定を指定**手順です。</span><span class="sxs-lookup"><span data-stu-id="b2cac-146">The wizard advances to the **Specify database settings** step.</span></span>
8. <span data-ttu-id="b2cac-147">**名前**ボックスに、入力*ContosoUniversity*乱数を一意になるよう、たとえばプラス*ContosoUniversity123*です。</span><span class="sxs-lookup"><span data-stu-id="b2cac-147">In the **Name** box, enter *ContosoUniversity* plus a random number to make it unique, for example *ContosoUniversity123*.</span></span>
9. <span data-ttu-id="b2cac-148">**サーバー**ボックスで、**新しい SQL データベース サーバー**です。</span><span class="sxs-lookup"><span data-stu-id="b2cac-148">In the **Server** box, select **New SQL Database Server**.</span></span>
10. <span data-ttu-id="b2cac-149">管理者名とパスワードを入力します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-149">Enter an administrator name and password.</span></span>

    <span data-ttu-id="b2cac-150">既存の名前とパスワードをここに入力されません。</span><span class="sxs-lookup"><span data-stu-id="b2cac-150">You aren't entering an existing name and password here.</span></span> <span data-ttu-id="b2cac-151">新しい名前と、データベースにアクセスするときに後で使用するには、ここで定義しているパスワードを入力しているか。</span><span class="sxs-lookup"><span data-stu-id="b2cac-151">You're entering a new name and password that you're defining now to use later when you access the database.</span></span>
11. <span data-ttu-id="b2cac-152">**地域**ボックスで、web アプリを選択したのと同じリージョンを選択します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-152">In the **Region** box, choose the same region that you chose for the web app.</span></span>

    <span data-ttu-id="b2cac-153">同じリージョンに、web サーバーとデータベース サーバーを維持し、最適なパフォーマンスを提供し、経費を最小限に抑えられます。</span><span class="sxs-lookup"><span data-stu-id="b2cac-153">Keeping the web server and the database server in the same region gives you the best performance and minimizes expenses.</span></span>
12. <span data-ttu-id="b2cac-154">完了したらを示すために、ボックスの下部にあるチェック マークをクリックします。</span><span class="sxs-lookup"><span data-stu-id="b2cac-154">Click the check mark at the bottom of the box to indicate that you're finished.</span></span>

    <span data-ttu-id="b2cac-155">次の図は、**データベース設定を指定** ダイアログ ボックス内のサンプル値。</span><span class="sxs-lookup"><span data-stu-id="b2cac-155">The following illustration shows the **Specify database settings** dialog with sample values in it.</span></span> <span data-ttu-id="b2cac-156">入力した値が異なる場合があります。</span><span class="sxs-lookup"><span data-stu-id="b2cac-156">The values you have entered may be different.</span></span>

    ![データベースの設定手順の新しい web サイトのデータベースのウィザードで作成します。](deploying-to-production/_static/image2.png)

    <span data-ttu-id="b2cac-158">管理ポータル ページに戻る、web サイト、および**ステータス**列は、web アプリが作成されていることを示しています。</span><span class="sxs-lookup"><span data-stu-id="b2cac-158">The Management Portal returns to the Websites page, and the **Status** column shows that the web app is being created.</span></span> <span data-ttu-id="b2cac-159">(通常よりも小さい 1 分間)、しばらくしてから、**ステータス**列は、web アプリが正常に作成されたことを示しています。</span><span class="sxs-lookup"><span data-stu-id="b2cac-159">After a while (typically less than a minute), the **Status** column shows that the web app was successfully created.</span></span> <span data-ttu-id="b2cac-160">左側にあるナビゲーション バーで、アカウント内にある web アプリの数が表示されます の横に、 **Websites**アイコン、およびデータベースの数が横に表示、 **SQL データベース**アイコン。</span><span class="sxs-lookup"><span data-stu-id="b2cac-160">In the navigation bar at the left, the number of web apps you have in your account appears next to the **Websites** icon, and the number of databases appears next to the **SQL Databases** icon.</span></span>

    ![管理ポータルで作成された web サイトの Web サイト ページ](deploying-to-production/_static/image3.png)

    <span data-ttu-id="b2cac-162">Web アプリ名は、図の例のアプリを異なるになります。</span><span class="sxs-lookup"><span data-stu-id="b2cac-162">Your web app name will be different from the example app in the illustration.</span></span>

## <a name="deploy-the-application-to-staging"></a><span data-ttu-id="b2cac-163">ステージングするアプリケーションを配置します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-163">Deploy the application to staging</span></span>

<span data-ttu-id="b2cac-164">Web アプリとステージング環境のデータベースを作成してプロジェクトを配置することができます。</span><span class="sxs-lookup"><span data-stu-id="b2cac-164">Now that you have created a web app and database for the staging environment, you can deploy the project to it.</span></span>

> [!NOTE]
> <span data-ttu-id="b2cac-165">これらの手順は、ダウンロードして発行プロファイルを作成する方法を示します、 *.publishsettings*ファイルで、サード パーティのホスティング プロバイダーが Azure 用だけでなく動作します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-165">These instructions show how to create a publish profile by downloading a *.publishsettings* file, which works not only for Azure but also for third-party hosting providers.</span></span> <span data-ttu-id="b2cac-166">最新の Azure SDK も使用する、Visual Studio から Azure に直接接続し、Azure アカウントにある web アプリの一覧から選択できます。</span><span class="sxs-lookup"><span data-stu-id="b2cac-166">The latest Azure SDK also enables you to connect directly to Azure from Visual Studio, and choose from a list of web apps that you have in your Azure account.</span></span> <span data-ttu-id="b2cac-167">Visual Studio 2013 ではから Azure にサインインすることができます、 **Web Publish**ダイアログから、または、**サーバー エクスプ ローラー**ウィンドウです。</span><span class="sxs-lookup"><span data-stu-id="b2cac-167">In Visual Studio 2013, you can sign in to Azure from the **Web Publish** dialog or from the **Server Explorer** window.</span></span> <span data-ttu-id="b2cac-168">詳細については、次を参照してください。 [Azure App Service で ASP.NET web アプリを作成](https://docs.microsoft.com/azure/app-service-web/app-service-web-get-started-dotnet)です。</span><span class="sxs-lookup"><span data-stu-id="b2cac-168">For more information, see [Create an ASP.NET web app in Azure App Service](https://docs.microsoft.com/azure/app-service-web/app-service-web-get-started-dotnet).</span></span>


### <a name="download-the-publishsettings-file"></a><span data-ttu-id="b2cac-169">.Publishsettings ファイルをダウンロードします。</span><span class="sxs-lookup"><span data-stu-id="b2cac-169">Download the .publishsettings file</span></span>

1. <span data-ttu-id="b2cac-170">作成した web アプリの名前をクリックします。</span><span class="sxs-lookup"><span data-stu-id="b2cac-170">Click the name of the web app that you just created.</span></span>

    ![ダッシュ ボードに移動するサイトをクリックします。](deploying-to-production/_static/image4.png)
2. <span data-ttu-id="b2cac-172">[**クイック グランス**で、**ダッシュ ボード**] タブで、をクリックして**発行プロファイルのダウンロード**です。</span><span class="sxs-lookup"><span data-stu-id="b2cac-172">Under **Quick glance** in the **Dashboard** tab, click **Download publish profile**.</span></span>

    ![発行プロファイルのリンクをダウンロードします。](deploying-to-production/_static/image5.png)

    <span data-ttu-id="b2cac-174">この手順では、すべてのアプリケーション、web アプリを配置するために必要な設定を含むファイルをダウンロードします。</span><span class="sxs-lookup"><span data-stu-id="b2cac-174">This step downloads a file that contains all of the settings that you need in order to deploy an application to your web app.</span></span> <span data-ttu-id="b2cac-175">この情報を手動で入力する必要はありませんは、Visual Studio にこのファイルをインポートします。</span><span class="sxs-lookup"><span data-stu-id="b2cac-175">You'll import this file into Visual Studio so you don't have to enter this information manually.</span></span>
3. <span data-ttu-id="b2cac-176">保存、 *.publishsettings* Visual Studio からアクセスできるフォルダー内のファイルです。</span><span class="sxs-lookup"><span data-stu-id="b2cac-176">Save the *.publishsettings* file in a folder that you can access from Visual Studio.</span></span>

    ![.publishsettings ファイルを保存します。](deploying-to-production/_static/image6.png)

    > [!WARNING]
    > <span data-ttu-id="b2cac-178">セキュリティ -、 *.publishsettings*ファイルには、Azure のサブスクリプションおよびサービスの管理に使用される (エンコードされていない) 資格情報が含まれています。</span><span class="sxs-lookup"><span data-stu-id="b2cac-178">Security - The *.publishsettings* file contains your credentials (unencoded) that are used to administer your Azure subscriptions and services.</span></span> <span data-ttu-id="b2cac-179">このファイルのセキュリティのベスト プラクティスは、(たとえば、\documents フォルダー) に、ソース ディレクトリの外部一時的に格納し、インポートが完了した後で削除するのにです。</span><span class="sxs-lookup"><span data-stu-id="b2cac-179">The security best practice for this file is to store it temporarily outside your source directories (for example in the Libraries\Documents folder), and then delete it once the import has completed.</span></span> <span data-ttu-id="b2cac-180">アクセスを取得した悪意のあるユーザー、 *.publishsettings*ファイルは、編集、作成、および Azure サービスを削除します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-180">A malicious user who gains access to the *.publishsettings* file can edit, create, and delete your Azure services.</span></span>

### <a name="create-a-publish-profile"></a><span data-ttu-id="b2cac-181">発行プロファイルを作成します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-181">Create a publish profile</span></span>

1. <span data-ttu-id="b2cac-182">Visual Studio でプロジェクトを右クリックして、ContosoUniversity で**ソリューション エクスプ ローラー**選択と**発行**コンテキスト メニュー。</span><span class="sxs-lookup"><span data-stu-id="b2cac-182">In Visual Studio, right-click the ContosoUniversity project in **Solution Explorer** and select **Publish** from the context menu.</span></span>

    <span data-ttu-id="b2cac-183">**Web の発行**ウィザードが開きます。</span><span class="sxs-lookup"><span data-stu-id="b2cac-183">The **Publish Web** wizard opens.</span></span>
2. <span data-ttu-id="b2cac-184">クリックして、**プロファイル**タブです。</span><span class="sxs-lookup"><span data-stu-id="b2cac-184">Click the **Profile** tab.</span></span>
3. <span data-ttu-id="b2cac-185">**[インポート]**をクリックします。</span><span class="sxs-lookup"><span data-stu-id="b2cac-185">Click **Import**.</span></span>
4. <span data-ttu-id="b2cac-186">移動し、 *.publishsettings*ファイルを以前にダウンロードし、クリックして**開く**です。</span><span class="sxs-lookup"><span data-stu-id="b2cac-186">Navigate to the *.publishsettings* file you downloaded earlier, and then click **Open**.</span></span>

    ![発行設定のインポート ダイアログ ボックス](deploying-to-production/_static/image7.png)
5. <span data-ttu-id="b2cac-188">**接続** タブで、をクリックして**接続の検証**設定が正しいことを確認します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-188">In the **Connection** tab, click **Validate Connection** to make sure that the settings are correct.</span></span>

    <span data-ttu-id="b2cac-189">緑のチェック マークが横に示すように、接続が検証されると、**接続の検証**ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="b2cac-189">When the connection has been validated, a green check mark is shown next to the **Validate Connection** button.</span></span>

    <span data-ttu-id="b2cac-190">ホスティング プロバイダーによってをクリックすると**接続の検証**、表示される、**証明書エラー**  ダイアログ ボックス。</span><span class="sxs-lookup"><span data-stu-id="b2cac-190">For some hosting providers, when you click **Validate Connection**, you might see a **Certificate Error** dialog box.</span></span> <span data-ttu-id="b2cac-191">を行う場合は、サーバー名が予期したとおりであることを確認します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-191">If you do, verify that the server name is what you expect.</span></span> <span data-ttu-id="b2cac-192">サーバー名が正しい場合は、選択**Visual Studio の今後のセッションにこの証明書を保存** をクリック**Accept**です。</span><span class="sxs-lookup"><span data-stu-id="b2cac-192">If the server name is correct, select **Save this certificate for future sessions of Visual Studio** and click **Accept**.</span></span> <span data-ttu-id="b2cac-193">(このエラーを展開している URL の SSL 証明書を購入する必要を避けるために、ホスティング プロバイダーが選択されていることを意味します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-193">(This error means that the hosting provider has chosen to avoid the expense of purchasing an SSL certificate for the URL that you are deploying to.</span></span> <span data-ttu-id="b2cac-194">有効な証明書を使用してセキュリティで保護された接続を確立する場合は、連絡、ホスティング プロバイダーです。)</span><span class="sxs-lookup"><span data-stu-id="b2cac-194">If you prefer to establish a secure connection by using a valid certificate, contact your hosting provider.)</span></span>
6. <span data-ttu-id="b2cac-195">**[次へ]**をクリックします。</span><span class="sxs-lookup"><span data-stu-id="b2cac-195">Click **Next**.</span></span>

    ![接続成功アイコンと [接続] タブで [次へ] ボタンをクリックします。](deploying-to-production/_static/image8.png)
7. <span data-ttu-id="b2cac-197">**設定**] タブで、展開**ファイルの発行オプション**、し、[**アプリからファイルを除外する\_データ フォルダー**です。</span><span class="sxs-lookup"><span data-stu-id="b2cac-197">In the **Settings** tab, expand **File Publish Options**, and then select **Exclude files from the App\_Data folder**.</span></span>

    <span data-ttu-id="b2cac-198">その他のオプションについては**ファイルの発行オプション**を参照してください、 [IIS に展開する](deploying-to-iis.md)チュートリアルです。</span><span class="sxs-lookup"><span data-stu-id="b2cac-198">For information about the other options under **File Publish Options**, see the [deploying to IIS](deploying-to-iis.md) tutorial.</span></span> <span data-ttu-id="b2cac-199">画面は、この手順と、次のデータベースの構成手順の結果は、データベースの構成手順の最後に表示されます。</span><span class="sxs-lookup"><span data-stu-id="b2cac-199">The screen shot that shows the result of this step and the following database configuration steps is at the end of the database configuration steps.</span></span>
8. <span data-ttu-id="b2cac-200">**DefaultConnection**で、**データベース**セクションで、メンバーシップ データベースに対するデータベース デプロイを構成します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-200">Under **DefaultConnection** in the **Databases** section, configure database deployment for the membership database.</span></span>
9. 1. <span data-ttu-id="b2cac-201">選択**更新データベース**です。</span><span class="sxs-lookup"><span data-stu-id="b2cac-201">Select **Update database**.</span></span>

        <span data-ttu-id="b2cac-202">**リモート接続文字列**すぐ下のボックス**DefaultConnection** .publishsettings ファイルから接続文字列が入力されます。接続文字列には、プレーン テキストで格納されている SQL Server 資格情報が含まれている、 *.pubxml*ファイル。</span><span class="sxs-lookup"><span data-stu-id="b2cac-202">The **Remote connection string** box directly below **DefaultConnection** is filled in with the connection string from the .publishsettings file.The connection string includes SQL Server credentials, which are stored in plain text in the *.pubxml* file.</span></span> <span data-ttu-id="b2cac-203">保存するように完全にしないようにする場合は、データベースを配置した後、発行プロファイルから削除して、代わりに Azure に保存します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-203">If you prefer not to store them permanently there, you can remove them from the publish profile after the database is deployed and store them in Azure instead.</span></span> <span data-ttu-id="b2cac-204">詳細については、次を参照してください。[保護する方法、ASP.NET データベース接続文字列のソースから Azure に展開するときに](http://www.hanselman.com/blog/HowToKeepYourASPNETDatabaseConnectionStringsSecureWhenDeployingToAzureFromSource.aspx)Scott Hanselman ブログ。</span><span class="sxs-lookup"><span data-stu-id="b2cac-204">For more information, see [How to keep your ASP.NET database connection strings secure when deploying to Azure from Source](http://www.hanselman.com/blog/HowToKeepYourASPNETDatabaseConnectionStringsSecureWhenDeployingToAzureFromSource.aspx) on Scott Hanselman's blog.</span></span>
    2. <span data-ttu-id="b2cac-205">をクリックして**データベース更新を構成する**です。</span><span class="sxs-lookup"><span data-stu-id="b2cac-205">Click **Configure database updates**.</span></span>
    3. <span data-ttu-id="b2cac-206">**データベース更新を構成する**ダイアログ ボックスで、をクリックして**SQL スクリプトの追加**です。</span><span class="sxs-lookup"><span data-stu-id="b2cac-206">In the **Configure Database Updates** dialog box, click **Add SQL Script**.</span></span>
    4. <span data-ttu-id="b2cac-207">**SQL スクリプトの追加**ボックスに移動、 *aspnet データ-prod.sql*ソリューション フォルダーに以前に保存し、をクリックし、スクリプトを**開く**です。</span><span class="sxs-lookup"><span data-stu-id="b2cac-207">In the **Add SQL Script** box, navigate to the *aspnet-data-prod.sql* script that you saved earlier in the solution folder, and then click **Open**.</span></span>
    5. <span data-ttu-id="b2cac-208">閉じる、**データベース更新を構成する** ダイアログ ボックス。</span><span class="sxs-lookup"><span data-stu-id="b2cac-208">Close the **Configure Database Updates** dialog box.</span></span>
10. <span data-ttu-id="b2cac-209">**SchoolContext**で、**データベース**セクションで、**実行 Code First Migrations (アプリケーション開始時に実行されます)**です。</span><span class="sxs-lookup"><span data-stu-id="b2cac-209">Under **SchoolContext** in the **Databases** section, select **Execute Code First Migrations (runs on application start)**.</span></span>

    <span data-ttu-id="b2cac-210">Visual Studio に表示**Code First Migrations を実行**の代わりに**更新データベース**の`DbContext`クラスです。</span><span class="sxs-lookup"><span data-stu-id="b2cac-210">Visual Studio displays **Execute Code First Migrations** instead of **Update Database** for `DbContext` classes.</span></span> <span data-ttu-id="b2cac-211">移行ではなく dbDacFx プロバイダーを使用して、使用してアクセスするデータベースを配置するかどうか、`DbContext`クラスを参照してください[移行なしの Code First のデータベースを展開する方法ですか?](https://msdn.microsoft.com/en-us/library/ee942158.aspx#deploy_code_first_without_migrations) for Visual Studio Web 配置の faqMSDN で ASP.NET です。</span><span class="sxs-lookup"><span data-stu-id="b2cac-211">If you want to use the dbDacFx provider instead of Migrations to deploy a database that you access by using a `DbContext` class, see [How do I deploy a Code First database without Migrations?](https://msdn.microsoft.com/en-us/library/ee942158.aspx#deploy_code_first_without_migrations) in the Web Deployment FAQ for Visual Studio and ASP.NET on MSDN.</span></span>

    <span data-ttu-id="b2cac-212">**設定** タブでは次の例のようになります。</span><span class="sxs-lookup"><span data-stu-id="b2cac-212">The **Settings** tab now looks like the following example:</span></span>

    ![ステージングのための設定 タブ](deploying-to-production/_static/image9.png)
11. <span data-ttu-id="b2cac-214">プロファイルを保存して、変更するには、次の手順を実行*ステージング*:</span><span class="sxs-lookup"><span data-stu-id="b2cac-214">Perform the following steps to save the profile and rename it to *Staging*:</span></span>

    1. <span data-ttu-id="b2cac-215">クリックして、**プロファイル** タブをクリックして**プロファイルの管理**です。</span><span class="sxs-lookup"><span data-stu-id="b2cac-215">Click the **Profile** tab, and then click **Manage Profiles**.</span></span>
    2. <span data-ttu-id="b2cac-216">インポートでは、ftp および Web Deploy 用の 2 つの新しいプロファイルを作成します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-216">The import created two new profiles, one for FTP and one for Web Deploy.</span></span> <span data-ttu-id="b2cac-217">Web Deploy プロファイルを構成する: このプロファイルの名前を変更*ステージング*です。</span><span class="sxs-lookup"><span data-stu-id="b2cac-217">You configured the Web Deploy profile: rename this profile to *Staging*.</span></span>

        ![ステージングするプロファイルの名前を変更します。](deploying-to-production/_static/image10.png)
    3. <span data-ttu-id="b2cac-219">閉じる、 **Web の発行プロファイルの編集** ダイアログ ボックス。</span><span class="sxs-lookup"><span data-stu-id="b2cac-219">Close the **Edit Web Publish Profiles** dialog box.</span></span>
    4. <span data-ttu-id="b2cac-220">閉じる、 **Web の発行**ウィザード。</span><span class="sxs-lookup"><span data-stu-id="b2cac-220">Close the **Publish Web** wizard.</span></span>

### <a name="configure-a-publish-profile-transform-for-the-environment-indicator"></a><span data-ttu-id="b2cac-221">環境のインジケーターの発行プロファイルの変換を構成します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-221">Configure a publish profile transform for the environment indicator</span></span>

> [!NOTE]
> <span data-ttu-id="b2cac-222">このセクションでは、環境のインジケーターの Web.config 変換の設定方法を示します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-222">This section shows how to set up a Web.config transform for the environment indicator.</span></span> <span data-ttu-id="b2cac-223">インジケーターがあるため、 `<appSettings>` Azure App Service に配置するときに、変換を指定するための別の方法がある要素。</span><span class="sxs-lookup"><span data-stu-id="b2cac-223">Because the indicator is in the `<appSettings>` element, you have another alternative for specifying the transformation when you're deploying to Azure App Service.</span></span> <span data-ttu-id="b2cac-224">詳細については、次を参照してください。 [Azure で指定する Web.config 設定](web-config-transformations.md#watransforms)です。</span><span class="sxs-lookup"><span data-stu-id="b2cac-224">For more information, see [Specifying Web.config settings in Azure](web-config-transformations.md#watransforms).</span></span>


1. <span data-ttu-id="b2cac-225">**ソリューション エクスプ ローラー**、展開**プロパティ**の順に展開および**PublishProfiles**です。</span><span class="sxs-lookup"><span data-stu-id="b2cac-225">In **Solution Explorer**, expand **Properties**, and then expand **PublishProfiles**.</span></span>
2. <span data-ttu-id="b2cac-226">右クリック*Staging.pubxml*、クリックして**Config 変換の追加**です。</span><span class="sxs-lookup"><span data-stu-id="b2cac-226">Right-click *Staging.pubxml*, and then click **Add Config Transform**.</span></span>

    ![ステージングのための構成変換を追加します。](deploying-to-production/_static/image11.png)

    <span data-ttu-id="b2cac-228">Visual Studio によって作成、 *Web.Staging.config*変換ファイルを開きます。</span><span class="sxs-lookup"><span data-stu-id="b2cac-228">Visual Studio creates the *Web.Staging.config* transform file and opens it.</span></span>
3. <span data-ttu-id="b2cac-229">*Web.Staging.config*変換ファイルが、開始直後に次のコードを挿入`configuration`タグ。</span><span class="sxs-lookup"><span data-stu-id="b2cac-229">In the *Web.Staging.config* transform file, insert the following code immediately after the opening `configuration` tag.</span></span>

    [!code-xml[Main](deploying-to-production/samples/sample1.xml)]

    <span data-ttu-id="b2cac-230">ステージング発行プロファイルを使用する場合、この変換は、"Prod"するインジケーターを環境を設定します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-230">When you use the Staging publish profile, this transform sets the environment indicator to "Prod".</span></span> <span data-ttu-id="b2cac-231">展開された web アプリは、「Contoso 大学」H1 見出しの後に、"(Dev)"などの任意のサフィックスや"(Test)"表示されません。</span><span class="sxs-lookup"><span data-stu-id="b2cac-231">In the deployed web app, you won't see any suffix such as "(Dev)" or "(Test)" after the "Contoso University" H1 heading.</span></span>
4. <span data-ttu-id="b2cac-232">右クリックし、 *Web.Staging.config*ファイルし、をクリックして**プレビュー変換**ようにコーディングした変換が必要な変更を生成するかどうかを確認します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-232">Right-click the *Web.Staging.config* file and click **Preview Transform** to make sure that the transform you coded produces the expected changes.</span></span>

    <span data-ttu-id="b2cac-233">**Web.config プレビュー**ウィンドウは、両方に適用した結果を示しています、 *Web.Release.config*変換と*Web.Staging.config*を変換します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-233">The **Web.config Preview** window shows the result of applying both the *Web.Release.config* transforms and the *Web.Staging.config* transforms.</span></span>

### <a name="prevent-public-use-of-the-test-app"></a><span data-ttu-id="b2cac-234">テスト アプリの公開の使用を防止します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-234">Prevent public use of the test app</span></span>

<span data-ttu-id="b2cac-235">ステージングのアプリの重要な考慮事項は、インターネットでは、ライブされますが、これを使用する公開したくないです。</span><span class="sxs-lookup"><span data-stu-id="b2cac-235">An important consideration for the staging app is that it will be live on the Internet, but you don't want the public to use it.</span></span> <span data-ttu-id="b2cac-236">ユーザーを検索し、使用する可能性を最小限に抑えるには、次の方法の 1 つ以上を使用できます。</span><span class="sxs-lookup"><span data-stu-id="b2cac-236">To minimize the likelihood that people will find and use it, you can use one or more of the following methods:</span></span>

- <span data-ttu-id="b2cac-237">ステージングのテストに使用する IP アドレスからのみステージング アプリへのアクセスを許可するファイアウォール規則を設定します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-237">Set firewall rules that allow access to the staging app only from IP addresses that you use to test staging.</span></span>
- <span data-ttu-id="b2cac-238">推測することはできませんを難読化された URL を使用します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-238">Use an obfuscated URL that would be impossible to guess.</span></span>
- <span data-ttu-id="b2cac-239">作成、 *robots.txt*ファイルを検索エンジンがクロール テスト アプリケーションとレポートのリンクに検索結果にことを確認します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-239">Create a *robots.txt* file to ensure that search engines will not crawl the test app and report links to it in search results.</span></span>

<span data-ttu-id="b2cac-240">これらのメソッドの最初のでは、最も有効ですが、Azure App Service ではなく Azure クラウド サービスに展開することが必要になるために、このチュートリアルで説明されていません。</span><span class="sxs-lookup"><span data-stu-id="b2cac-240">The first of these methods is the most effective but is not covered in this tutorial because it would require that you deploy to an Azure Cloud Service instead of Azure App Service.</span></span> <span data-ttu-id="b2cac-241">詳細については、クラウド サービスと Azure での IP 制限では、次を参照してください。 [Azure によって提供されるオプションをホストしているコンピューティング](https://docs.microsoft.com/azure/cloud-services/cloud-services-choose-me)と[特定の IP アドレス、Web ロールへのアクセスをブロック](https://msdn.microsoft.com/en-us/library/windowsazure/jj154098.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="b2cac-241">For more information about Cloud Services and IP restrictions in Azure, see [Compute Hosting Options Provided by Azure](https://docs.microsoft.com/azure/cloud-services/cloud-services-choose-me) and [Block Specific IP Addresses from Accessing a Web Role](https://msdn.microsoft.com/en-us/library/windowsazure/jj154098.aspx).</span></span> <span data-ttu-id="b2cac-242">サード パーティのホスティング プロバイダーに配置する場合は、IP 制限を実装する方法を検索するプロバイダーに問い合わせてください。</span><span class="sxs-lookup"><span data-stu-id="b2cac-242">If you are deploying to a third-party hosting provider, contact the provider to find out how to implement IP restrictions.</span></span>

<span data-ttu-id="b2cac-243">このチュートリアルを作成、 *robots.txt*ファイル。</span><span class="sxs-lookup"><span data-stu-id="b2cac-243">For this tutorial, you'll create a *robots.txt* file.</span></span>

1. <span data-ttu-id="b2cac-244">**ソリューション エクスプ ローラー**ContosoUniversity プロジェクトを右クリックし、クリックして、**新しい項目の追加**です。</span><span class="sxs-lookup"><span data-stu-id="b2cac-244">In **Solution Explorer**, right-click the ContosoUniversity project and click **Add New Item**.</span></span>
2. <span data-ttu-id="b2cac-245">新規作成**テキスト ファイル**という*robots.txt*、し、次のテキストを配置します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-245">Create a new **Text File** named *robots.txt*, and put the following text in it:</span></span>

    [!code-console[Main](deploying-to-production/samples/sample2.cmd)]

    <span data-ttu-id="b2cac-246">`User-agent`行は、ファイル内のルールがすべて検索エンジン web クローラー (ロボット) に適用される検索エンジンに指示し、`Disallow`行は、サイトのページをクロールないことを指定します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-246">The `User-agent` line tells search engines that the rules in the file apply to all search engine web crawlers (robots), and the `Disallow` line specifies that no pages on the site should be crawled.</span></span>

    <span data-ttu-id="b2cac-247">検索エンジンを運用環境のデプロイからこのファイルを除外する必要があるため、運用アプリをカタログ化するようにします。</span><span class="sxs-lookup"><span data-stu-id="b2cac-247">You do want search engines to catalog your production app, so you need to exclude this file from production deployment.</span></span> <span data-ttu-id="b2cac-248">構成することを行うには、実稼働環境で設定は、作成するときにプロファイルを発行します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-248">To do that, you'll configure a setting in the Production publish profile when you create it.</span></span>

### <a name="deploy-to-staging"></a><span data-ttu-id="b2cac-249">ステージング展開します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-249">Deploy to staging</span></span>

1. <span data-ttu-id="b2cac-250">開く、 **Web の発行**を Contoso 大学プロジェクトを右クリックしをクリックするとウィザード**発行**です。</span><span class="sxs-lookup"><span data-stu-id="b2cac-250">Open the **Publish Web** wizard by right-clicking the Contoso University project and clicking **Publish**.</span></span>
2. <span data-ttu-id="b2cac-251">確認して、**ステージング**プロファイルを選択します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-251">Make sure that the **Staging** profile is selected.</span></span>
3. <span data-ttu-id="b2cac-252">**[発行]**をクリックします。</span><span class="sxs-lookup"><span data-stu-id="b2cac-252">Click **Publish**.</span></span>

    <span data-ttu-id="b2cac-253">**出力**ウィンドウどのような展開アクションを実行した示し、展開の成功した完了を報告します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-253">The **Output** window shows what deployment actions were taken and reports successful completion of the deployment.</span></span> <span data-ttu-id="b2cac-254">既定のブラウザーは、展開された web アプリの URL を自動的に開きます。</span><span class="sxs-lookup"><span data-stu-id="b2cac-254">The default browser automatically opens to the URL of the deployed web app.</span></span>

## <a name="test-in-the-staging-environment"></a><span data-ttu-id="b2cac-255">ステージング環境でのテストします。</span><span class="sxs-lookup"><span data-stu-id="b2cac-255">Test in the staging environment</span></span>

<span data-ttu-id="b2cac-256">環境のインジケーターが存在しないことに注意してください (がない「(テスト)」または「(開発)」、H1 見出し、ことを示しています、 *Web.config*環境のインジケーターの変換が成功しました。</span><span class="sxs-lookup"><span data-stu-id="b2cac-256">Notice that the environment indicator is absent (there is no "(Test)" or "(Dev)" after the H1 heading, which shows that the *Web.config* transformation for the environment indicator was successful.</span></span>

![ステージングのホーム ページ](deploying-to-production/_static/image12.png)

<span data-ttu-id="b2cac-258">実行、**受講者**ページに配置されるデータベースに受講者がいないことを確認します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-258">Run the **Students** page to verify that the deployed database has no students.</span></span>

<span data-ttu-id="b2cac-259">実行、**講習においてインストラクター**ページを Code First シード インストラクター データとデータベースを確認します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-259">Run the **Instructors** page to verify that Code First seeded the database with instructor data:</span></span>

<span data-ttu-id="b2cac-260">選択**受講者を追加**から、**受講者** メニューの 、受講者を追加し、新しい学生を表示、**受講者**データベースに正常に記述できることを確認する ページ.</span><span class="sxs-lookup"><span data-stu-id="b2cac-260">Select **Add Students** from the **Students** menu, add a student, and then view the new student in the **Students** page to verify that you can successfully write to the database.</span></span>

<span data-ttu-id="b2cac-261">**コース**] ページで [**更新クレジット**です。</span><span class="sxs-lookup"><span data-stu-id="b2cac-261">From the **Courses** page, click **Update Credits**.</span></span> <span data-ttu-id="b2cac-262">**更新クレジット**ページには、管理者のアクセス許可が必要がありますので、**ログで**ページが表示されます。</span><span class="sxs-lookup"><span data-stu-id="b2cac-262">The **Update Credits** page requires administrator permissions, so the **Log In** page is displayed.</span></span> <span data-ttu-id="b2cac-263">以前 ("admin"および"prodpwd") で作成した管理者アカウントの資格情報を入力します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-263">Enter the administrator account credentials that you created earlier ("admin" and "prodpwd").</span></span> <span data-ttu-id="b2cac-264">**更新クレジット**ページが表示されたら、前のチュートリアルで作成した管理者アカウントが、テスト環境に正しく展開されたことを確認します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-264">The **Update Credits** page is displayed, which verifies that the administrator account that you created in the previous tutorial was correctly deployed to the test environment.</span></span>

<span data-ttu-id="b2cac-265">ELMAH が追跡、および ELMAH エラー レポートを次に、要求は、エラーが発生する無効な URL を要求します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-265">Request an invalid URL to cause an error that ELMAH will track, and then request the ELMAH error report.</span></span> <span data-ttu-id="b2cac-266">サード パーティのホスティング プロバイダーに配置する場合、レポートが前のチュートリアルでは空か、同じ理由から空である可能性がありますわかります。</span><span class="sxs-lookup"><span data-stu-id="b2cac-266">If you are deploying to a third-party hosting provider, you will probably find that the report is empty for the same reason that it was empty in the previous tutorial.</span></span> <span data-ttu-id="b2cac-267">ログ フォルダーに書き込む ELMAH を有効にするフォルダーのアクセス許可を構成するホスティング プロバイダーのアカウントの管理ツールを使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b2cac-267">You will have to use the hosting provider's account management tools to configure folder permissions to enable ELMAH to write to the log folder.</span></span>

<span data-ttu-id="b2cac-268">作成したアプリケーションは、実稼働に使用するものと同じように、web アプリで、クラウドで実行されています。</span><span class="sxs-lookup"><span data-stu-id="b2cac-268">The application that you created is now running in the cloud in a web app that is just like what you will use for production.</span></span> <span data-ttu-id="b2cac-269">すべてが正しく動作しているために、次の手順は、実稼働環境に展開するは。</span><span class="sxs-lookup"><span data-stu-id="b2cac-269">Since everything is working correctly, the next step is to deploy to production.</span></span>

## <a name="deploy-to-production"></a><span data-ttu-id="b2cac-270">実稼働環境に展開します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-270">Deploy to production</span></span>

<span data-ttu-id="b2cac-271">運用 web アプリを作成して実稼働環境に展開するプロセスについては、同じステージング、除外する必要がある場合を除き、 *robots.txt*展開からします。</span><span class="sxs-lookup"><span data-stu-id="b2cac-271">The process for creating a production web app and deploying to production is the same as for staging, except that you need to exclude the *robots.txt* from deployment.</span></span> <span data-ttu-id="b2cac-272">これを行うには、発行プロファイル ファイルを編集します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-272">To do that you'll edit the publish profile file.</span></span>

### <a name="create-the-production-environment-and-the-production-publish-profile"></a><span data-ttu-id="b2cac-273">実稼働環境を作成し、発行プロファイルの運用環境</span><span class="sxs-lookup"><span data-stu-id="b2cac-273">Create the production environment and the production publish profile</span></span>

1. <span data-ttu-id="b2cac-274">Azure では、同じ手順に従って、ステージングのために使用するには、運用 web アプリとデータベースを作成します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-274">Create the production web app and database in Azure, following the same procedure that you used for staging.</span></span>

    <span data-ttu-id="b2cac-275">データベースを作成するときに前に作成した同じサーバーに配置を選択したり、新しいサーバーを作成できます。</span><span class="sxs-lookup"><span data-stu-id="b2cac-275">When you create the database, you can choose to put it on the same server you created earlier, or create a new server.</span></span>
2. <span data-ttu-id="b2cac-276">ダウンロード、 *.publishsettings*ファイル。</span><span class="sxs-lookup"><span data-stu-id="b2cac-276">Download the *.publishsettings* file.</span></span>
3. <span data-ttu-id="b2cac-277">運用環境にインポートすることによって、発行プロファイルを作成*.publishsettings*ファイル、ステージングのために使用する同じ手順を実行します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-277">Create the publish profile by importing the production *.publishsettings* file, following the same procedure that you used for staging.</span></span>

    <span data-ttu-id="b2cac-278">忘れずに データの配置スクリプトを構成する**DefaultConnection**で、**データベース**のセクションで、**設定**タブです。</span><span class="sxs-lookup"><span data-stu-id="b2cac-278">Don't forget to configure the data deployment script under **DefaultConnection** in the **Databases** section of the **Settings** tab.</span></span>
4. <span data-ttu-id="b2cac-279">発行プロファイルの名前を変更*運用*です。</span><span class="sxs-lookup"><span data-stu-id="b2cac-279">Rename the publish profile to *Production*.</span></span>
5. <span data-ttu-id="b2cac-280">ステージングを使用している同じ手順に従って、環境のインジケーターの発行プロファイルの変換を構成するには.</span><span class="sxs-lookup"><span data-stu-id="b2cac-280">Configure a publish profile transform for the environment indicator, following the same procedure that you used for staging..</span></span>

### <a name="edit-the-pubxml-file-to-exclude-robotstxt"></a><span data-ttu-id="b2cac-281">Robots.txt を除外する .pubxml ファイルを編集します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-281">Edit the .pubxml file to exclude robots.txt</span></span>

<span data-ttu-id="b2cac-282">発行プロファイル ファイルの名前は&lt;profilename&gt;*.pubxml*内にあると、 *PublishProfiles*フォルダーです。</span><span class="sxs-lookup"><span data-stu-id="b2cac-282">Publish profile files are named &lt;profilename&gt;*.pubxml* and are located in the *PublishProfiles* folder.</span></span> <span data-ttu-id="b2cac-283">*PublishProfiles*フォルダーは、*プロパティ*フォルダー c# web アプリケーションでプロジェクトの下にある、 *My Project*フォルダーまたは VB web アプリケーション プロジェクトで、*アプリ\_データ*web アプリケーション プロジェクト内のフォルダーです。</span><span class="sxs-lookup"><span data-stu-id="b2cac-283">The *PublishProfiles* folder is under the *Properties* folder in a C# web application project, under the *My Project* folder in a VB web application project, or under the *App\_Data* folder in a web app project.</span></span> <span data-ttu-id="b2cac-284">各*.pubxml*ファイルには、いずれかに適用される設定が含まれています。 発行プロファイル。</span><span class="sxs-lookup"><span data-stu-id="b2cac-284">Each *.pubxml* file contains settings that apply to one publish profile.</span></span> <span data-ttu-id="b2cac-285">Web の発行ウィザードで入力した値は、これらのファイルに格納および編集することを作成または Visual Studio UI で利用可能になっていない設定を変更することができます。</span><span class="sxs-lookup"><span data-stu-id="b2cac-285">The values you enter in the Publish Web wizard are stored in these files, and you can edit them to create or change settings that aren't made available in the Visual Studio UI.</span></span>

<span data-ttu-id="b2cac-286">既定では、 *.pubxml*発行プロファイルを作成する、プロジェクトから除外することができますが、および Visual Studio は引き続き使用すると、プロジェクトのファイルが表示されます。</span><span class="sxs-lookup"><span data-stu-id="b2cac-286">By default, *.pubxml* files are included in the project when you create a publish profile, but you can exclude them from the project and Visual Studio will still use them.</span></span> <span data-ttu-id="b2cac-287">Visual Studio の検索、 *PublishProfiles*用のフォルダー *.pubxml*プロジェクトに含まれているかどうかに関係なく、ファイルです。</span><span class="sxs-lookup"><span data-stu-id="b2cac-287">Visual Studio looks in the *PublishProfiles* folder for *.pubxml* files, regardless of whether they are included in the project.</span></span>

<span data-ttu-id="b2cac-288">各*.pubxml*ファイルがある、 *. pubxml.user*ファイル。</span><span class="sxs-lookup"><span data-stu-id="b2cac-288">For each *.pubxml* file there is a *.pubxml.user* file.</span></span> <span data-ttu-id="b2cac-289">*. Pubxml.user*ファイルには、暗号化されたパスワードが含まれる選択した場合、**保存パスワード**オプション、および既定では、プロジェクトから除外されます。</span><span class="sxs-lookup"><span data-stu-id="b2cac-289">The *.pubxml.user* file contains the encrypted password if you selected the **Save password** option, and by default it is excluded from the project.</span></span>

<span data-ttu-id="b2cac-290">A *.pubxml*ファイルには、特定の発行プロファイルに関連する設定が含まれています。</span><span class="sxs-lookup"><span data-stu-id="b2cac-290">A *.pubxml* file contains the settings that pertain to a specific publish profile.</span></span> <span data-ttu-id="b2cac-291">すべてのプロファイルに適用される設定を構成する場合は、作成、 *. wpp.targets*ファイル。</span><span class="sxs-lookup"><span data-stu-id="b2cac-291">If you want to configure settings that apply to all profiles, you can create a *.wpp.targets* file.</span></span> <span data-ttu-id="b2cac-292">ビルド プロセスにこれらのファイルのインポート、 *.csproj*または*.vbproj*プロジェクト ファイル、プロジェクト ファイルで構成できる設定のほとんどは、これらのファイルで構成できます。</span><span class="sxs-lookup"><span data-stu-id="b2cac-292">The build process imports these files into the *.csproj* or *.vbproj* project file, so most settings that you can configure in the project file can be configured in these files.</span></span> <span data-ttu-id="b2cac-293">詳細については*.pubxml*ファイルと*. wpp.targets*ファイルを参照してください[する方法: 発行プロファイル (.pubxml) ファイルでの展開設定の編集、および wpp.targets Visual Studio でのファイル。Web プロジェクト](https://msdn.microsoft.com/en-us/library/ff398069.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="b2cac-293">For more information about *.pubxml* files and *.wpp.targets* files, see [How to: Edit Deployment Settings in Publish Profile (.pubxml) Files and the .wpp.targets File in Visual Studio Web Projects](https://msdn.microsoft.com/en-us/library/ff398069.aspx).</span></span>

1. <span data-ttu-id="b2cac-294">**ソリューション エクスプ ローラー**、展開**プロパティ**展開**PublishProfiles**です。</span><span class="sxs-lookup"><span data-stu-id="b2cac-294">In **Solution Explorer**, expand **Properties** and expand **PublishProfiles**.</span></span>
2. <span data-ttu-id="b2cac-295">右クリック*Production.pubxml*  をクリック**開く**です。</span><span class="sxs-lookup"><span data-stu-id="b2cac-295">Right-click *Production.pubxml* and click **Open**.</span></span>

    ![.Pubxml ファイルを開く](deploying-to-production/_static/image13.png)
3. <span data-ttu-id="b2cac-297">右クリック*Production.pubxml*  をクリック**開く**です。</span><span class="sxs-lookup"><span data-stu-id="b2cac-297">Right-click *Production.pubxml* and click **Open**.</span></span>
4. <span data-ttu-id="b2cac-298">終了する直前に次の行を追加`PropertyGroup`要素。</span><span class="sxs-lookup"><span data-stu-id="b2cac-298">Add the following lines immediately before the closing `PropertyGroup` element:</span></span>

    [!code-xml[Main](deploying-to-production/samples/sample3.xml)]

    <span data-ttu-id="b2cac-299">.Pubxml ファイルは、次の例のようになります。</span><span class="sxs-lookup"><span data-stu-id="b2cac-299">The .pubxml file now looks like the following example:</span></span>

    [!code-xml[Main](deploying-to-production/samples/sample4.xml?highlight=18-20)]

    <span data-ttu-id="b2cac-300">ファイルとフォルダーを除外する方法の詳細については、次を参照してください。[できますものを除外する特定のファイルまたはフォルダーの展開から?](https://msdn.microsoft.com/en-us/library/ee942158.aspx#can_i_exclude_specific_files_or_folders_from_deployment)で、 **Visual Studio と ASP.NET の Web 配置の FAQ** msdn です。</span><span class="sxs-lookup"><span data-stu-id="b2cac-300">For more information about how to exclude files and folders, see [Can I exclude specific files or folders from deployment?](https://msdn.microsoft.com/en-us/library/ee942158.aspx#can_i_exclude_specific_files_or_folders_from_deployment) in the **Web Deployment FAQ for Visual Studio and ASP.NET** on MSDN.</span></span>

### <a name="deploy-to-production"></a><span data-ttu-id="b2cac-301">実稼働環境に展開します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-301">Deploy to production</span></span>

1. <span data-ttu-id="b2cac-302">開く、 **Web の発行**ウィザードことを確認して、**実稼働**発行プロファイルを選択して、をクリックして**開始プレビュー**上、**プレビュー**ことを確認するには、タブ、 *robots.txt*ファイルは、運用アプリにコピーされません。</span><span class="sxs-lookup"><span data-stu-id="b2cac-302">Open the **Publish Web** wizard make sure that the **Production** publish profile is selected, and then click **Start Preview** on the **Preview** tab to verify that the *robots.txt* file will not be copied to the production app.</span></span>

    ![実稼働環境に発行されるファイルのプレビュー](deploying-to-production/_static/image14.png)

    <span data-ttu-id="b2cac-304">コピーされるファイルの一覧を確認します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-304">Review the list of files that will be copied.</span></span> <span data-ttu-id="b2cac-305">表示されるすべての*.cs*など、ファイル*. aspx.cs*、 *. aspx.designer.cs*、 *Master.cs*、および*Master.designer.cs*ファイルは省略されます。</span><span class="sxs-lookup"><span data-stu-id="b2cac-305">You'll see that all of the *.cs* files, including *.aspx.cs*, *.aspx.designer.cs*, *Master.cs*, and *Master.designer.cs* files are omitted.</span></span> <span data-ttu-id="b2cac-306">このすべてのコードにコンパイルした、 *ContosoUniversity.dll*と*ContosUniversity.pdb*にファイル、 *bin*フォルダーです。</span><span class="sxs-lookup"><span data-stu-id="b2cac-306">All of this code has been compiled into the *ContosoUniversity.dll* and *ContosUniversity.pdb* files that you'll find in the *bin* folder.</span></span> <span data-ttu-id="b2cac-307">のみ、 *.dll*に必要な実行して、アプリケーションでは、前に指定、アプリケーションの実行に必要なファイルのみを展開する必要がある、no *.cs*ファイルは、先にコピーされました環境。</span><span class="sxs-lookup"><span data-stu-id="b2cac-307">Because only the *.dll* is needed to run the application, and you specified earlier that only files needed to run the application should be deployed, no *.cs* files were copied to the destination environment.</span></span> <span data-ttu-id="b2cac-308">*Obj*フォルダーおよび*ContosoUniversity.csproj*と*. csproj.user*ファイルは、同じ理由から省略されます。</span><span class="sxs-lookup"><span data-stu-id="b2cac-308">The *obj* folder and the *ContosoUniversity.csproj* and *.csproj.user* files are omitted for the same reason.</span></span>

    <span data-ttu-id="b2cac-309">をクリックして**発行**を運用環境に展開します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-309">Click **Publish** to deploy to the production environment.</span></span>
2. <span data-ttu-id="b2cac-310">同じ手順に従って、ステージングを使用して、実稼働環境でテストします。</span><span class="sxs-lookup"><span data-stu-id="b2cac-310">Test in production, following the same procedure you used for staging.</span></span>

    <span data-ttu-id="b2cac-311">同じ URL を除くステージングおよびがない場合にすべて、 *robots.txt*ファイル。</span><span class="sxs-lookup"><span data-stu-id="b2cac-311">Everything is identical to staging except for the URL and the absence of the *robots.txt* file.</span></span>

## <a name="summary"></a><span data-ttu-id="b2cac-312">まとめ</span><span class="sxs-lookup"><span data-stu-id="b2cac-312">Summary</span></span>

<span data-ttu-id="b2cac-313">これで正常にデプロイして、web アプリをテストしが使用可能なパブリック インターネット経由でします。</span><span class="sxs-lookup"><span data-stu-id="b2cac-313">You have now successfully deployed and tested your web app and it is available publicly over the Internet.</span></span>

![実稼働のホーム ページ](deploying-to-production/_static/image15.png)

<span data-ttu-id="b2cac-315">次のチュートリアルでをアプリケーション コードを更新し、テスト、ステージング、および実稼働環境に変更を展開します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-315">In the next tutorial, you'll update application code and deploy the change to the test, staging, and production environments.</span></span>

> [!NOTE]
> <span data-ttu-id="b2cac-316">アプリケーションが、実稼働環境で使用するときは、復旧計画を実装する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b2cac-316">While your application is in use in the production environment you should be implementing a recovery plan.</span></span> <span data-ttu-id="b2cac-317">つまり、する必要がある定期的にデータベースのバックアップを運用アプリから、セキュリティで保護された記憶域の場所に、このようなバックアップのいくつかの世代を保存する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b2cac-317">That is, you should be periodically backing up your databases from the production app to a secure storage location, and you should be keeping several generations of such backups.</span></span> <span data-ttu-id="b2cac-318">データベースを更新するときに、変更の直前からバックアップ コピーを作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b2cac-318">When you update the database, you should make a backup copy from immediately before the change.</span></span> <span data-ttu-id="b2cac-319">次に、更新を間違えたして実稼働環境に配置した後まで、検出されない場合もことができますが破損する前に、の状態にデータベースを回復します。</span><span class="sxs-lookup"><span data-stu-id="b2cac-319">Then, if you make a mistake and don't discover it until after you have deployed it to production, you will still be able to recover the database to the state it was in before it became corrupted.</span></span> <span data-ttu-id="b2cac-320">詳細については、次を参照してください。 [Azure SQL データベースのバックアップと復元](https://msdn.microsoft.com/en-us/library/windowsazure/jj650016.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="b2cac-320">For more information, see [Azure SQL Database Backup and Restore](https://msdn.microsoft.com/en-us/library/windowsazure/jj650016.aspx).</span></span>


> [!NOTE]
> <span data-ttu-id="b2cac-321">このチュートリアルは、SQL Server を展開しているエディションは、Azure SQL データベースがします。</span><span class="sxs-lookup"><span data-stu-id="b2cac-321">In this tutorial the SQL Server edition that you are deploying to is Azure SQL Database.</span></span> <span data-ttu-id="b2cac-322">展開プロセスは、SQL Server の他のエディションに似ていますが、実際の運用アプリケーション必要があります特別なコードを Azure SQL Database の一部のシナリオで。</span><span class="sxs-lookup"><span data-stu-id="b2cac-322">While the deployment process is similar to other editions of SQL Server, a real production application might require special code for Azure SQL Database in some scenarios.</span></span> <span data-ttu-id="b2cac-323">詳細については、次を参照してください。 [Azure SQL データベースで作業](../../../../whitepapers/aspnet-data-access-content-map.md#ssdb)と[SQL Server と Azure SQL Database の使い分け](../../../../whitepapers/aspnet-data-access-content-map.md#ssdbchoosing)です。</span><span class="sxs-lookup"><span data-stu-id="b2cac-323">For more information, see [Working with Azure SQL Database](../../../../whitepapers/aspnet-data-access-content-map.md#ssdb) and [Choosing between SQL Server and Azure SQL Database](../../../../whitepapers/aspnet-data-access-content-map.md#ssdbchoosing).</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="b2cac-324">[前へ](setting-folder-permissions.md)
[次へ](deploying-a-code-update.md)</span><span class="sxs-lookup"><span data-stu-id="b2cac-324">[Previous](setting-folder-permissions.md)
[Next](deploying-a-code-update.md)</span></span>
