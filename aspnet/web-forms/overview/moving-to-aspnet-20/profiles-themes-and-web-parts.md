---
uid: web-forms/overview/moving-to-aspnet-20/profiles-themes-and-web-parts
title: "プロファイル、テーマ、および Web パーツ |Microsoft ドキュメント"
author: microsoft
description: "構成の主な変更と ASP.NET 2.0 の実装があります。 構成の変更を加える pr 新規の ASP.NET 構成 API を使用する."
ms.author: aspnetcontent
manager: wpickett
ms.date: 02/20/2005
ms.topic: article
ms.assetid: 92df4051-77c6-492c-bd34-23d24189cea4
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/moving-to-aspnet-20/profiles-themes-and-web-parts
msc.type: authoredcontent
ms.openlocfilehash: c9fe97dbd5fe10cbde25b9daf5ddd35b2d7eaab5
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/10/2017
---
<a name="profiles-themes-and-web-parts"></a>プロファイル、テーマ、および Web パーツ
====================
によって[Microsoft](https://github.com/microsoft)

> 構成の主な変更と ASP.NET 2.0 の実装があります。 構成の変更をプログラムで実行できる新しい ASP.NET 構成 API を使用します。 さらに、多くの新しい構成設定が存在して新しい構成およびインストルメンテーションを許可します。


ASP.NET 2.0 では、カスタマイズされた Web サイトの領域で大幅に向上を表します。 既に説明メンバーシップ機能という、に加えて ASP.NET プロファイル、テーマ、および Web パーツを大幅に改善の Web サイト内の個人用設定します。

## <a name="aspnet-profiles"></a>ASP.NET プロファイル

ASP.NET プロファイルは、セッションと似ています。 違いは、プロファイルは、ブラウザーを閉じるときに、セッションが失われますが、永続的なことです。 セッションとプロファイルのもう 1 つの大きな違いは、プロファイルに、したがって提供するための IntelliSense 対応の開発プロセス中に厳密型指定されたことです。

プロファイルは、マシン構成ファイルまたはアプリケーションの web.config ファイルで定義されます。 (プロファイルはサブフォルダーの web.config ファイルで定義できません)。次のコードでは、Web サイトの訪問者を最初に格納し、名前を最後にプロファイルを定義します。

[!code-xml[Main](profiles-themes-and-web-parts/samples/sample1.xml)]

プロファイル プロパティの既定のデータ型は System.String です。 上記の例では、データ型が指定されていません。 したがって FirstName および LastName から構成プロパティは、文字列型の両方です。 既に触れましたが、プロパティが厳密に型指定されたプロファイル。 次のコードは、Int32 型では、年齢の新しいプロパティを追加します。

[!code-xml[Main](profiles-themes-and-web-parts/samples/sample2.xml)]

プロファイルは通常、ASP.NET フォーム認証で使用されます。 フォーム認証と組み合わせて使用する場合は、各ユーザーがそのユーザーの ID に関連付けられている個別のプロファイル ただし、プロファイルを使用して、匿名のアプリケーションで使用できるようにすることはまた、 &lt;anonymousIdentification&gt;と共に構成ファイル内の要素、 **allowAnonymous**として属性次に示します。

[!code-xml[Main](profiles-themes-and-web-parts/samples/sample3.xml)]

ASP.NET がのインスタンスを作成して、匿名ユーザーは、サイトを参照すると、 **ProfileCommon**ユーザー。 このプロファイルは、一意のビジターとしてユーザーを識別するのに、ブラウザーの cookie に格納されている一意の ID を使用します。 この方法では、匿名で参照するユーザーのプロファイル情報を格納できます。

## <a name="profile-groups"></a>プロファイル グループ

プロファイルのグループのプロパティを行うことができます。 グループ化のプロパティでは、特定のアプリケーションに対して複数のプロファイルをシミュレートすることができます。

次の構成が 2 つのグループのプロパティを FirstName および LastName から構成を設定します。購入者率や導入を検討します。

[!code-xml[Main](profiles-themes-and-web-parts/samples/sample4.xml)]

可能であれば、次のように、特定のグループのプロパティを設定します。

[!code-csharp[Main](profiles-themes-and-web-parts/samples/sample5.cs)]

## <a name="storing-complex-objects"></a>複雑なオブジェクトを格納します。

これまで説明した例には、プロファイルに単純なデータ型が格納されているがします。 シリアル化を使用する方法を指定することによって、プロファイルに複雑なデータ型を格納することも、 **serializeAs**次のように属性します。

[!code-xml[Main](profiles-themes-and-web-parts/samples/sample6.xml)]

この例では、種類は PurchaseInvoice です。 PurchaseInvoice クラスは、シリアル化可能としてマークする必要があり、任意の数のプロパティを含めることができます。 たとえば、PurchaseInvoice というプロパティがあります**NumItemsPurchased**コード内でそのプロパティを次のように参照することができます。

[!code-css[Main](profiles-themes-and-web-parts/samples/sample7.css)]

## <a name="profile-inheritance"></a>プロファイルの継承

複数のアプリケーションで使用するプロファイルを作成することができます。 ProfileBase から派生したプロファイル クラスを作成すると、再利用できるいくつかのアプリケーションでプロファイルを使用して、**継承**次に示すように属性します。

[!code-xml[Main](profiles-themes-and-web-parts/samples/sample8.xml)]

この場合は、クラス**PurchasingProfile**なります次のようにします。

[!code-csharp[Main](profiles-themes-and-web-parts/samples/sample9.cs)]

## <a name="profile-providers"></a>プロファイル プロバイダー

ASP.NET プロファイルは、プロバイダー モデルを使用します。 既定のプロバイダーは、アプリで SQL Server Express データベースに情報を保存\_SqlProfileProvider プロバイダーを使用して Web アプリケーションのデータ フォルダーです。 データベースが存在しない場合 ASP.NET が自動的に作成、プロファイルが情報を保存しようとするとします。

場合によっては、ただし、可能性がある、独自のプロファイル プロバイダーを作成します。 ASP.NET のプロファイル機能では、異なるプロバイダーを使用して簡単にすることができます。

カスタム プロファイル プロバイダーを作成するとき。

- など、.NET Framework に付属するプロファイル プロバイダーによってサポートされていない FoxPro データベースまたは Oracle データベースでは、データ ソースのプロファイル情報を格納する必要があります。
- .NET Framework に含まれているプロバイダーによって使用されるデータベース スキーマとは異なるデータベース スキーマを使用してプロファイル情報を管理する必要があります。 一般的な例は、既存の SQL Server データベース内のユーザー データとプロファイル情報を統合することです。

### <a name="required-classes"></a>必要なクラス

プロファイル プロバイダーを実装するのには、System.Web.Profile.ProfileProvider 抽象クラスを継承するクラスを作成します。 **済みの ProfileProvider**抽象クラスがさらに System.Configuration.Provider.ProviderBase 抽象クラスを継承して System.Configuration.SettingsProvider 抽象クラスを継承します。 必要なメンバーに加え、この継承チェーンにより、**済みの ProfileProvider**クラスに必要なメンバーを実装する必要があります、 **SettingsProvider**と**ProviderBase**クラスです。

次の表は、プロパティとメソッドを実装する必要があります、 **ProviderBase**、 **SettingsProvider**、および**済みの ProfileProvider**抽象クラス。

### <a name="providerbase-members"></a>ProviderBase メンバー

| **メンバー** | **説明** |
| --- | --- |
| Initialize メソッド | プロバイダーのインスタンスの名前と構成設定の NameValueCollection の入力として受け取ります。 オプションと実装に固有の値や、マシン構成ファイルまたは Web.config ファイルで指定されたオプションなど、プロバイダーのインスタンスのプロパティの値を設定するために使用します。 |

### <a name="settingsprovider-members"></a>SettingsProvider メンバー

| **メンバー** | **説明** |
| --- | --- |
| ApplicationName プロパティ | 各プロファイルに格納されているアプリケーション名。 プロファイル プロバイダーでは、アプリケーション名を使用して、アプリケーションごとに個別のプロファイル情報を格納します。 これにより、複数の ASP.NET アプリケーションで別のアプリケーションに同じユーザー名を作成する場合、競合することがなく、同じデータ ソースを使用できます。 または、複数の ASP.NET アプリケーションでは、同じアプリケーション名を指定することによって、プロファイル データ ソースを共有できます。 |
| GetPropertyValues メソッド | SettingsPropertyCollection オブジェクトおよび SettingsContext 入力として受け取ります。 **SettingsContext**ユーザーに関する情報を提供します。 主キーとして情報を使用するには、ユーザーのプロファイル プロパティの情報を取得します。 使用して、 **SettingsContext**ユーザー名と、ユーザーは、認証済みまたは匿名かどうかを取得するオブジェクト。 **SettingsPropertyCollection** SettingsProperty オブジェクトのコレクションが含まれています。 各**SettingsProperty**オブジェクトは、名前と種類のプロパティと、プロパティとプロパティは読み取り専用かどうかの既定値などの追加情報を提供します。 **GetPropertyValues**メソッド、SettingsPropertyValueCollection SettingsPropertyValue オブジェクトに設定に基づいて、 **SettingsProperty**入力として提供されるオブジェクト。 各 PropertyValue プロパティに指定したユーザーのデータ ソースの値が割り当てられている**SettingsPropertyValue**オブジェクトとコレクション全体が返されます。 メソッドを呼び出すことも、LastActivityDate の値を更新、指定されたユーザー プロファイルを現在の日付と時刻。 |
| SetPropertyValues メソッド | 入力として受け取り、 **SettingsContext**と**SettingsPropertyValueCollection**オブジェクト。 **SettingsContext**ユーザーに関する情報を提供します。 主キーとして情報を使用するには、ユーザーのプロファイル プロパティの情報を取得します。 使用して、 **SettingsContext**ユーザー名と、ユーザーは、認証済みまたは匿名かどうかを取得するオブジェクト。 **SettingsPropertyValueCollection**のコレクションを格納**SettingsPropertyValue**オブジェクト。 各**SettingsPropertyValue**オブジェクト名、型、およびプロパティと、プロパティとプロパティは読み取り専用かどうかの既定値などの追加情報の値を提供します。 **SetPropertyValues**メソッドは、指定したユーザーのデータ ソース内のプロファイル プロパティ値を更新します。 メソッドを呼び出すことも更新プログラム、 **LastActivityDate**と現在の日付と時刻に指定されたユーザー プロファイルの LastUpdatedDate 値。 |

### <a name="profileprovider-members"></a>済みの ProfileProvider メンバー

| **メンバー** | **説明** |
| --- | --- |
| DeleteProfiles メソッド | アプリケーション名が一致するユーザーの文字列配列の名前し、データ ソースからすべてのプロファイル情報およびプロパティの値に対して指定した名前を削除の入力として受け取り、 **ApplicationName**プロパティの値。 データ ソースは、トランザクションをサポートする場合は、トランザクションですべての削除操作を含めることと、トランザクションをロールバックして、削除操作が失敗した場合に例外をスローするをお勧めします。 |
| DeleteProfiles メソッド | アプリケーション名が一致する ProfileInfo のコレクション オブジェクトし、データ ソースからすべてのプロファイル情報およびプロパティ値は削除プロファイルごとの入力として受け取り、 **ApplicationName**プロパティの値。 データ ソースは、トランザクションをサポートする場合は、すべての削除操作をトランザクションに含めるとトランザクションをロールバックして、削除操作が失敗した場合に例外をスロー、勧めします。 |
| DeleteInactiveProfiles メソッド | ProfileAuthenticationOption 値を入力として受け取り、DateTime オブジェクトおよびデータから削除しますソースのすべてのプロファイル情報およびプロパティの値で、最後のアクティビティの日付が指定した日付と時刻に以下のアプリケーション名。一致する、 **ApplicationName**プロパティの値。 **ProfileAuthenticationOption**パラメーターは、匿名のみプロファイルは、のみプロファイルを認証するかどうかを指定またはすべてのプロファイルを削除します。 データ ソースは、トランザクションをサポートする場合は、すべての削除操作をトランザクションに含めるとトランザクションをロールバックして、削除操作が失敗した場合に例外をスロー、勧めします。 |
| GetAllProfiles メソッド | 入力として受け取り、 **ProfileAuthenticationOption**値、ページのインデックスを指定する整数、ページ サイズ、およびプロファイルの合計数に設定される整数への参照を指定する整数。 含む ProfileInfoCollection を返します**ProfileInfo**アプリケーション名が一致するデータ ソース内のすべてのプロファイル用のオブジェクト、 **ApplicationName**プロパティの値。 **ProfileAuthenticationOption**パラメーターは、匿名のみプロファイルは、のみプロファイルを認証するかどうかを指定またはすべてのプロファイルは、返されます。 によって返される結果、 **GetAllProfiles**メソッドは、ページのインデックスとページ サイズの値によって制限されます。 ページ サイズの値の最大数を指定する**ProfileInfo**で返されるオブジェクト、 **ProfileInfoCollection**です。 ページのインデックス値では、結果を返すには、1 が最初のページを識別する場合のどのページを指定します。 合計レコード数のパラメーターは out パラメーター (使用することができます**ByRef** Visual Basic で) プロファイルの合計数に設定されています。 たとえば、データ ストアには、アプリケーションの 13 のプロファイルが含まれています、ページのインデックス値は 2 ページ サイズが 5 の場合、 **ProfileInfoCollection**返されるは 6 ~ 10 番目のプロファイルが含まれています。 メソッドが戻るとき、レコードの合計値は 13 に設定されます。 |
| GetAllInactiveProfiles メソッド | 入力として受け取り、 **ProfileAuthenticationOption**値、 **DateTime**オブジェクト、ページのインデックスを指定する整数、ページ サイズ、および設定される整数への参照を指定する整数プロファイルの合計数。 返します、 **ProfileInfoCollection**を格納している**ProfileInfo**最後のアクティビティの日付が以下に、指定されたデータ ソースのすべてのプロファイル オブジェクト**DateTime**アプリケーション名が一致して、 **ApplicationName**プロパティの値。 **ProfileAuthenticationOption**パラメーターは、匿名のみプロファイルは、のみプロファイルを認証するかどうかを指定またはすべてのプロファイルは、返されます。 によって返される結果、 **GetAllInactiveProfiles**メソッドは、ページのインデックスとページ サイズの値によって制限されます。 ページ サイズの値の最大数を指定する**ProfileInfo**で返されるオブジェクト、 **ProfileInfoCollection**です。 ページのインデックス値では、結果を返すには、1 が最初のページを識別する場合のどのページを指定します。 合計レコード数のパラメーターは out パラメーター (使用することができます**ByRef** Visual Basic で) プロファイルの合計数に設定されています。 たとえば、データ ストアには、アプリケーションの 13 のプロファイルが含まれています、ページのインデックス値は 2 ページ サイズが 5 の場合、 **ProfileInfoCollection**返されるは 6 ~ 10 番目のプロファイルが含まれています。 メソッドが戻るとき、レコードの合計値は 13 に設定されます。 |
| FindProfilesByUserName メソッド | 入力として受け取り、 **ProfileAuthenticationOption**値に設定するユーザー名、ページのインデックスを指定する整数、ページ サイズとの合計数に設定される整数への参照を指定する整数を含む文字列プロファイル。 返します、 **ProfileInfoCollection**を格納している**ProfileInfo**オブジェクトのすべてのプロファイル データのソースのユーザー名が指定されたユーザー名と一致して、アプリケーション名が一致する、**ApplicationName**プロパティの値。 **ProfileAuthenticationOption**パラメーターは、匿名のみプロファイルは、のみプロファイルを認証するかどうかを指定またはすべてのプロファイルは、返されます。 データ ソースは、ワイルドカード文字などの他の検索機能をサポートしている場合は、ユーザー名をより広範な検索機能を提供できます。 によって返される結果、 **FindProfilesByUserName**メソッドは、ページのインデックスとページ サイズの値によって制限されます。 ページ サイズの値の最大数を指定する**ProfileInfo**で返されるオブジェクト、 **ProfileInfoCollection**です。 ページのインデックス値では、結果を返すには、1 が最初のページを識別する場合のどのページを指定します。 合計レコード数のパラメーターは out パラメーター (使用することができます**ByRef** Visual Basic で) プロファイルの合計数に設定されています。 たとえば、データ ストアには、アプリケーションの 13 のプロファイルが含まれています、ページのインデックス値は 2 ページ サイズが 5 の場合、 **ProfileInfoCollection**返されるは 6 ~ 10 番目のプロファイルが含まれています。 メソッドが戻るとき、レコードの合計値は 13 に設定されます。 |
| FindInactiveProfilesByUserName メソッド | 入力として受け取り、 **ProfileAuthenticationOption**値、ユーザー名を含む文字列、 **DateTime**オブジェクト、ページのインデックスを指定する整数、ページ サイズを指定する整数とプロファイルの合計数に設定される整数への参照します。 返します、 **ProfileInfoCollection**を格納している**ProfileInfo**最後のアクティビティの日付がここでは、ユーザー名が指定されたユーザー名と一致するデータ ソース内のすべてのプロファイル用のオブジェクトより小さいか、指定したのと同じ**DateTime**、アプリケーション名が一致して、 **ApplicationName**プロパティの値。 **ProfileAuthenticationOption**パラメーターは、匿名のみプロファイルは、のみプロファイルを認証するかどうかを指定またはすべてのプロファイルは、返されます。 データ ソースは、ワイルドカード文字などの他の検索機能をサポートしている場合は、ユーザー名をより広範な検索機能を提供できます。 によって返される結果、 **FindInactiveProfilesByUserName**メソッドは、ページのインデックスとページ サイズの値によって制限されます。 ページ サイズの値の最大数を指定する**ProfileInfo**で返されるオブジェクト、 **ProfileInfoCollection**です。 ページのインデックス値では、結果を返すには、1 が最初のページを識別する場合のどのページを指定します。 合計レコード数のパラメーターは out パラメーター (使用することができます**ByRef** Visual Basic で) プロファイルの合計数に設定されています。 たとえば、データ ストアには、アプリケーションの 13 のプロファイルが含まれています、ページのインデックス値は 2 ページ サイズが 5 の場合、 **ProfileInfoCollection**返されるは 6 ~ 10 番目のプロファイルが含まれています。 メソッドが戻るとき、レコードの合計値は 13 に設定されます。 |
| GetNumberOfInActiveProfiles メソッド | 入力として受け取り、 **ProfileAuthenticationOption**値と**DateTime**オブジェクトし、最後のアクティビティの日付が指定された小さいデータソース内のすべてのプロファイルの数を返します**DateTime**アプリケーション名が一致して、 **ApplicationName**プロパティの値。 **ProfileAuthenticationOption**パラメーターは、匿名のみプロファイルは、のみプロファイルを認証するかどうかを指定すべてのプロファイルをカウントするか。 |

### <a name="applicationname"></a>ApplicationName

プロファイル プロバイダーは、アプリケーションごとに個別にプロファイル情報を格納するためデータ スキーマに、アプリケーション名が含まれていると、クエリや更新も含まれること、アプリケーション名を確認する必要があります。 たとえば、次のコマンドは、ユーザー名と、プロファイルは、匿名かどうかに基づいてデータベースからプロパティ値を取得するために使用し、確実に、 **ApplicationName**値クエリに含まれます。

[!code-sql[Main](profiles-themes-and-web-parts/samples/sample10.sql)]

## <a name="aspnet-themes"></a>ASP.NET のテーマ

## <a name="what-are-aspnet-20-themes"></a>ASP.NET 2.0 のテーマとは

Web アプリケーションの最も重要な側面の 1 つは、サイト全体で一貫したルック アンド フィールです。 通常、ASP.NET 1.x 開発者は、一貫したルック アンド フィールを実装するのにカスケード スタイル シート (CSS) を使用します。 ASP.NET 2.0 のテーマを大幅に向上 CSS 時に、ASP.NET 開発者 HTML 要素と同様に ASP.NET サーバー コントロールの外観を定義する機能を提供するためです。 ASP.NET のテーマは、個々 のコントロール、特定の Web ページまたは Web アプリケーション全体に適用できます。 テーマは、イメージが必要な場合に、CSS ファイル、省略可能なスキン ファイル、および画像の省略可能なディレクトリの組み合わせを使用します。 スキン ファイルは、ASP.NET サーバー コントロールの外観を制御します。

## <a name="where-are-themes-stored"></a>ここでは、テーマが格納されるか。

テーマの格納場所は、それぞれのスコープに基づいて異なります。 任意のアプリケーションに適用できるテーマは、次のフォルダーに格納されます。

`C:\WINDOWS\Microsoft.NET\Framework\v2.x.xxxxx\ASP.NETClientFiles\Themes\<Theme_Name>`

アプリには、特定のアプリケーションに固有のテーマが格納されている\_テーマ\&lt;テーマ\_名前&gt;で Web サイトのルート ディレクトリ。

> [!NOTE]
> スキン ファイルは、外観に影響を与えるサーバー コントロールのプロパティのみを変更する必要があります。

グローバル テーマは、すべてのアプリケーションまたは Web サーバーで実行されている Web サイトに適用できるテーマです。 V2.x.xxxxx ディレクトリ内では、ASP.NETClientfiles\Themes ディレクトリに既定では、これらのテーマを格納します。 Aspnet にテーマのファイルを移動する代わりに、\_クライアント/システム\_web/[バージョン]/Themes/[テーマ\_名] で、Web サイトのルート フォルダー。

アプリケーション固有のテーマは、ファイルが存在するアプリケーションにのみ適用できます。 アプリでこれらのファイルが格納されている\_テーマ/&lt;テーマ\_名前&gt;で Web サイトのルート ディレクトリ。

## <a name="the-components-of-a-theme"></a>テーマのコンポーネント

テーマは、1 つまたは複数の CSS ファイル、省略可能なスキン ファイル、およびオプションのイメージ フォルダーの構成されます。 CSS ファイルでは、任意の名前 (つまり default.css または theme.css など) を希望してテーマ フォルダーのルートである必要がありますを指定できます。 CSS ファイルは、通常の CSS クラスと特定のセレクターの属性を定義に使用されます。 ページ要素に CSS クラスの 1 つを適用する、 **CSSClass**プロパティを使用します。

スキン ファイルは、ASP.NET サーバー コントロールのプロパティ定義を含む XML ファイルです。 下記のコードでは、スキン ファイルの例を示します。

[!code-aspx[Main](profiles-themes-and-web-parts/samples/sample11.aspx)]

**図 1**テーマが適用せず、少量の ASP.NET ページ参照を示しています。 **図 2**テーマが適用された、同じファイルを示しています。 背景色とテキストの色は、CSS ファイル経由で構成されます。 ボタンとテキスト ボックスの外観は、上に示したスキン ファイルを使用して構成されます。


![テーマなし](profiles-themes-and-web-parts/_static/image1.gif)

**図 1**: テーマなし


![適用されているテーマ](profiles-themes-and-web-parts/_static/image2.gif)

**図 2**: 適用されているテーマ


上記のスキン ファイルでは、すべてのテキスト ボックス コントロールおよびボタン コントロールの既定のスキンを定義します。 この外観ですべてのテキスト ボックス コントロールとボタン コントロールがページ上に挿入を実行することを意味します。 使用してこれらのコントロールの特定のインスタンスに適用するスキンを定義することも、 **SkinID**コントロールのプロパティです。

次のコードでは、ボタン コントロールのスキンを定義します。 ボタンのみと制御、 **SkinID**プロパティの**goButton**スキンの外観になります。

[!code-aspx[Main](profiles-themes-and-web-parts/samples/sample12.aspx)]

サーバー コントロールの種類ごとに 1 つの既定スキンだけことができます。 その他のスキンを必要とする場合は、SkinID プロパティを使用する必要があります。

## <a name="applying-themes-to-pages"></a>ページ テーマを適用します。

テーマを適用するには、次の方法のいずれかを使用します。

- &lt;ページ&gt;web.config ファイルの要素
- @Pageページのディレクティブ
- プログラムで

## <a name="applying-a-theme-in-the-configuration-file"></a>構成ファイルにテーマを適用します。

アプリケーション構成ファイルにテーマを適用するには、次の構文を使用します。

[!code-xml[Main](profiles-themes-and-web-parts/samples/sample13.xml)]

ここで指定されたテーマ名は、テーマ フォルダーの名前と一致する必要があります。 このフォルダーは、このコースで以前に記載されている場所のいずれかのいずれかに存在できます。 存在しないテーマを適用しようとすると、構成エラーが発生します。

## <a name="applying-a-theme-in-the-page-directive"></a>Page ディレクティブでテーマを適用します。

@ Page ディレクティブでテーマを適用することもできます。 このメソッドでは、特定のページのテーマを使用することができます。

テーマを適用する、@Pageディレクティブについては、次の構文を使用します。

[!code-aspx[Main](profiles-themes-and-web-parts/samples/sample14.aspx)]

もう一度ここで指定されたテーマは、既に説明したように、テーマ フォルダーを一致させなければなりません。 存在しないテーマを適用しようとすると、ビルドの失敗が発生します。 Visual Studio も属性を強調表示し、このようなテーマが存在しないことを通知します。

## <a name="applying-a-theme-programmatically"></a>プログラムでテーマを適用します。

テーマをプログラムを適用する必要がありますを指定する、**テーマ**内のページのプロパティ、**ページ\_PreInit**メソッドです。

プログラムでテーマを適用するには、次の構文を使用します。

[!code-csharp[Main](profiles-themes-and-web-parts/samples/sample15.cs)]

ページのライフ サイクルのため PreInit メソッドでテーマを適用する必要があります。 適用する場合、その後、ページのテーマが既に適用されているランタイムによってと変更がその時点で、ライフ サイクルには遅すぎます。 存在しないテーマを適用する場合、 **HttpException**に発生します。 適用すると、テーマがプログラムによって、任意のサーバー コントロールには、指定された SkinID プロパティが設定されてビルドの警告が発生します。 この警告は、テーマが宣言によって適用されず、無視することを通知するためのものです。

## <a name="exercise-1--applying-a-theme"></a>手順 1: テーマを適用します。

この演習では、Web サイトに ASP.NET のテーマが適用されます。

> [!IMPORTANT]
> Microsoft Word がスキン ファイルに情報を入力を使用している場合は、スマート引用符を含む通常の引用符を置き換えるいないことを確認します。 引用符では、スキン ファイルで問題が発生します。

1. 新しい ASP.NET Web サイトを作成します。
2. ソリューション エクスプ ローラーでプロジェクトを右クリックし、新しい項目の追加を選択します。
3. ファイルの一覧から Web 構成ファイルを選択し、[追加] をクリックします。
4. ソリューション エクスプ ローラーでプロジェクトを右クリックし、新しい項目の追加を選択します。
5. スキン ファイルを選択し、[追加] をクリックします。
6. アプリ内でファイルを配置するとかどうかメッセージが表示されたら [はい] をクリックして\_テーマ フォルダーです。
7. アプリ内で SkinFile フォルダーを右クリックして\_テーマ フォルダー ソリューション エクスプ ローラーで新しい項目の追加を選択します。
8. ファイルの一覧からスタイル シートを選択し、[追加] をクリックします。 今すぐ必要があるすべての新しいテーマを実装するために必要なファイルです。 ただし、Visual Studio には、テーマ フォルダー SkinFile がという名前です。 そのフォルダーを右クリックし、CoolTheme に名前を変更します。
9. SkinFile.skin ファイルを開き、ファイルの末尾の次のコードを追加します。 

    [!code-aspx[Main](profiles-themes-and-web-parts/samples/sample16.aspx)]
10. SkinFile.skin ファイルを保存します。
11. スタイル シートを開きます。
12. すべてのテキストでは、次に置き換えます。 

    [!code-css[Main](profiles-themes-and-web-parts/samples/sample17.css)]
13. スタイル シート ファイルを保存します。
14. Default.aspx ページを開きます。
15. テキスト ボックス コントロールおよびボタン コントロールを追加します。
16. ページを保存します。 これで、Default.aspx ページを参照します。 通常、Web フォームとして表示されます。
17. Web.config ファイルを開きます。
18. 開始のすぐ下に次の追加`<system.web>`タグ。 

    [!code-xml[Main](profiles-themes-and-web-parts/samples/sample18.xml)]
19. Web.config ファイルを保存します。 これで、Default.aspx ページを参照します。 テーマを適用したが表示されます。
20. これがまだ開いていない場合は、Visual Studio で、Default.aspx ページを開きます。
21. ボタンを選択します。
22. 変更、 **SkinID** goButton するプロパティです。 Visual Studio によって提供される有効な SkinID の値を含むドロップダウンのボタン コントロールに注意してください。
23. ページを保存します。 お使いのブラウザーでページをもう一度プレビューようになりました。 ボタンは、"go"だとする必要があり、外観で広くする必要があります。

使用して、 **SkinID**プロパティ、サーバー コントロールの特定の種類の異なるインスタンスごとに異なるスキンを簡単に構成できます。

## <a name="the-stylesheettheme-property"></a>StyleSheetTheme プロパティ

これまでに説明しただけのテーマ プロパティを使用してテーマを適用します。 テーマのプロパティを使用する場合、スキン ファイルはサーバー コントロールのすべての宣言型の設定をオーバーライドします。 たとえば、演習 1 では、ボタン コントロールの"goButton"の SkinID を指定したし、"go"にボタンのテキストを変更します。 デザイナーでボタンのテキスト プロパティ"Button"に設定されましたが、テーマをオーバーライドすることお気付きします。 テーマでは、デザイナーでプロパティの設定は常に上書きします。

テーマのスキン ファイルで定義されているプロパティを上書きすることができるしたい場合プロパティで指定された、デザイナーを使用することができます、 **StyleSheetTheme**テーマ プロパティではなくプロパティです。 StyleSheetTheme プロパティですが、テーマのプロパティと同じテーマ プロパティのように、すべての明示的なプロパティ設定をオーバーライドしません。

これを見る、手順 1 で、プロジェクトから、web.config ファイルを開くし、変更、&lt;ページ&gt;には、次の要素。

[!code-xml[Main](profiles-themes-and-web-parts/samples/sample19.xml)]

ここで Default.aspx ページを参照し、ボタン コントロールは、もう一度に"Button"のテキスト プロパティを持つことを確認します。 デザイナーで、明示的なプロパティの設定が goButton SkinID が設定するテキストのプロパティをオーバーライドするためです。

## <a name="overriding-themes"></a>テーマをオーバーライドします。

グローバル テーマは、アプリ内の同じ名前でテーマを適用することによりオーバーライドできます\_アプリケーションのテーマ フォルダーです。 ただし、テーマは、true の上書きのシナリオでは適用されません。 ランタイムは、アプリでテーマ ファイルを見つけた場合\_テーマ フォルダーでは、それらのファイルを使用してテーマを適用し、グローバルのテーマは無視されます。

StyleSheetTheme プロパティは、オーバーライド可能なコードで次のようにオーバーライドすることができます。

[!code-csharp[Main](profiles-themes-and-web-parts/samples/sample20.cs)]

## <a name="web-parts"></a>Web パーツ

ASP.NET Web パーツは、エンドユーザーはコンテンツ、外観、およびブラウザーから直接 Web ページの動作を変更する Web サイトを作成するためのコントロールの統合セットです。 サイト上のすべてのユーザーに、または個々 のユーザーに、変更を適用できます。 ユーザーは、ページおよびコントロールを変更するときに、パーソナル化と呼ばれる機能を今後のブラウザー セッション間でユーザーの個人設定を保持する設定を保存できます。 これらの Web パーツの機能は、開発者が開発者または管理者の介入なしに Web アプリケーションを動的に個人用に設定するエンドユーザーを高めることを意味します。

Web パーツ コントロール セットを使用して、エンドユーザーを有効にできます開発者。

- ページのコンテンツをカスタマイズします。 ユーザーは、ページに新しい Web パーツ コントロールを追加、それらを削除、非表示にするには、または通常のウィンドウと同様に、それらを最小限に抑えることができます。
- ページ レイアウトをカスタマイズします。 ユーザーでは、ページでは、別のゾーンに Web パーツ コントロールをドラッグしたり、その外観、プロパティ、および動作を変更することができます。
- エクスポートし、コントロールをインポートします。 ユーザーでは、インポートしたり、プロパティ、外観、およびコントロールでのデータも保持他のページや、サイトで使用する Web パーツ コントロールの設定をエクスポートすることができます。 これにより、エンドユーザーにデータ項目と構成要求が減少します。
- 接続を作成します。 これにより、たとえば、グラフ コントロールは、株価表示器コントロールでのデータのグラフを表示できます、ユーザーはコントロール間の接続を確立できます。 ユーザーだけでなく接続自体が、外観と、グラフ コントロールがデータを表示する方法の詳細をカスタマイズする可能性があります。
- 管理し、サイト レベルの設定をカスタマイズします。 承認されたユーザーできますサイト レベルの設定を構成し、特定して、ユーザーことができますサイトまたはページにアクセス、コントロールにロールベースのアクセスを設定にします。 たとえば、管理者の役割のユーザーは、すべてのユーザーで共有される Web パーツ コントロールの設定し、制御共有のカスタマイズの管理者ではないユーザーを防ぐためです。

通常、3 つの方法のいずれかで Web パーツを操作します。 ページを使用する Web パーツ コントロールの作成、個々 の Web パーツ コントロールの作成、またはポータルなど、完了、パーソナル化可能な、Web アプリケーションを作成します。

## <a name="page-development"></a>ページの開発

ページの開発者は、Microsoft Visual Studio 2005 などのビジュアル デ ザイン ツールを使用して、Web パーツを使用するページを作成します。 ツールを使用して、Visual Studio が Web パーツ コントロール セットであることなどの利点の 1 つは、ビジュアル デザイナーでの Web パーツ コントロールのドラッグ アンド ドロップの作成と構成の機能を提供します。 たとえば、デザイナーを使用して Web パーツ ゾーン、または Web パーツ エディター コントロールでは、デザイン画面にドラッグし、コントロールを構成し、Web パーツによって提供される UI を使用して、デザイナーで設定を制御します。 Web パーツのアプリケーションの開発を高速化できを記述する必要のあるコードの量を削減できます。

## <a name="control-development"></a>コントロールの開発

既存の ASP.NET コントロールは、標準的な Web サーバー コントロール、カスタム サーバー コントロール、およびユーザー コントロールを含む、Web パーツ コントロールとして使用できます。 環境内の最大のプログラムによる制御を web パーツ クラスから派生するカスタムの Web パーツ コントロールを作成することもできます。 個々 の Web パーツ コントロールの開発では、するが通常ユーザー コントロールを作成し、Web パーツ コントロールとして使用またはカスタム Web パーツ コントロールを開発します。

カスタム Web パーツ コントロールの開発の例は、としてのパーソナル化可能な Web パーツ コントロールとしてパッケージを便利になる可能性があるその他の ASP.NET サーバー コントロールによって提供される機能を提供するコントロールを作成する可能性があります: カレンダー、リスト、財務情報は、ニュース、電卓、コンテンツを編集可能なグリッドを更新するためのリッチ テキスト コントロールを動的にその画面を更新または気象条件し、情報を旅行するグラフ、データベースに接続します。 コントロールにビジュアル デザイナーを提供する場合 Visual Studio を使用してすべてのページ開発者ことができます単に Web パーツ ゾーンにコントロールをドラッグし、追加のコードを記述することがなくデザイン時に構成します。

パーソナル化は、Web パーツの機能の基盤です。 変更--またはパーソナル化レイアウト、外観、およびページ上の Web パーツ コントロールの動作をすることができます。 個人用の設定は有効期間が長い: だけでなく、現在のブラウザー セッション中に永続化する (ビュー状態と同様)、長期的な記憶域にもの今後のブラウザー セッションも、ユーザーの設定を保存できるようにします。 パーソナル化は、Web パーツ ページについて既定で有効です。

UI の構造コンポーネントは、パーソナル化に依存し、中核となる構造とすべての Web パーツ コントロールで必要なサービスを提供します。 すべての Web パーツ ページに必要な 1 つの UI 構造上のコンポーネントは、WebPartManager コントロールです。 このコントロールを表示されませんが、ページ上のすべての Web パーツ コントロールの調整の重要なタスクがあります。 たとえば、すべての個別の Web パーツ コントロールを追跡します。 Web パーツ ゾーン (ページ上の Web パーツ コントロールを含む領域) を管理するゾーンでのコントロールがあるとします。 また、追跡し、さまざまな表示モードが、ページで使用される、このような参照、接続、編集、またはカタログの各モード、およびすべてのユーザーまたは個々 のユーザーに個人的な変更が適用するかどうかを制御します。 最後に、開始し、Web パーツ コントロール間の接続と通信を追跡します。

2 番目の種類の UI の構造コンポーネントは、ゾーンです。 ゾーンは、Web パーツ ページで、レイアウト マネージャーとして機能します。 含まれてと (パーツ コントロール)、部分クラスから派生したコントロールを整理し、水平方向または垂直方向のモジュール ページ レイアウトを行うには機能を提供します。、 ゾーン (ヘッダーとページ フッターのスタイル、タイトル、罫線のスタイル、動作設定ボタン、およびなど) などの一般的なと一貫性のある UI 要素に対して提供されています。 各コントロールこれらの共通要素は、コントロールの chrome と呼ばれます。 いくつかの特別な種類のゾーンは、さまざまなコントロールを使用して、さまざまな表示モードで使用されます。 ゾーンの種類は以下の Web パーツの不可欠なコントロールのセクションで説明します。

派生するすべての Web パーツの UI コントロール、**一部**クラス、Web パーツ ページに主要な UI を構成します。 Web パーツ コントロール セットは柔軟性ができ、オプションの包括的なパーツ コントロールを作成するためです。 に加えて、独自のカスタム Web パーツ コントロールを作成するには、することができますも既存の ASP.NET サーバー コントロール、ユーザー コントロールまたはカスタム サーバー コントロールとして使用 Web パーツ コントロールです。 Web パーツ ページの作成に最もよく使用される重要なコントロールは、次のセクションで説明します。

## <a name="web-parts-essential-controls"></a>Web パーツの不可欠なコントロール

Web パーツ コントロール セットが広範には、するために、Web パーツに必要であるため、または Web パーツ ページに最も頻繁に使用されているコントロールであるために、一部のコントロールは不可欠です。 Web パーツの使用を開始すると、基本的な Web パーツ ページを作成するは、次の表で説明されている重要な Web パーツ コントロールについて理解するおくと便利です。

| **Web パーツ コントロール** | **説明** |
| --- | --- |
| WebPartManager | ページ上のすべての Web パーツ コントロールを管理します。 いずれか (および 1 つだけ) **WebPartManager**コントロールはすべての Web パーツ ページに必要です。 |
| CatalogZone | CatalogPart コントロールが含まれています。 このゾーンを使用すると、ユーザーがページに追加するのにコントロールを選択できる Web パーツ コントロールのカタログを作成できます。 |
| EditorZone | EditorPart コントロールが含まれています。 ユーザーを編集し、ページ上の Web パーツ コントロールのカスタマイズを有効にするのにには、このゾーンを使用します。 |
| WebPartZone | 格納し、ページの主要な UI を作成する web パーツ コントロールのレイアウト全体を提供します。 Web パーツ コントロールにページを作成するときに、このゾーンを使用します。 ページには、1 つまたは複数のゾーンを含めることができます。 |
| ConnectionsZone | WebPartConnection コントロールが含まれてし、接続を管理するための UI を提供します。 |
| Web パーツ (GenericWebPart) | 主要な UI を表示します。ほとんどの Web パーツの UI コントロールは、このカテゴリに分類されます。 最大限のプログラムによる制御ベースから派生するカスタムの Web パーツ コントロールを作成することができます**WebPart**コントロール。 Web パーツ コントロールとして、また既存のサーバー コントロール、ユーザー コントロール、またはカスタム コントロールを使用することができます。 ゾーンで、これらのコントロールのいずれかを配置しているときに、 **WebPartManager**コントロールが自動的に折り返されるで**GenericWebPart**実行時にコントロールを Web パーツの機能を持つそれらを使用できるようにします。 |
| CatalogPart | ユーザーがページに追加できる Web パーツ コントロールの一覧が含まれています。 |
| WebPartConnection | ページ上の 2 つの Web パーツ コントロール間の接続を作成します。 接続は、データの)、プロバイダーおよびコンシューマーとして、その他のとして Web パーツ コントロールのいずれかを定義します。 |
| EditorPart | 特殊なエディター コントロールの基底クラスとして機能します。 |
| EditorPart コントロール (AppearanceEditorPart、LayoutEditorPart、BehaviorEditorPart、および PropertyGridEditorPart) | ページ上の Web パーツの UI コントロールのさまざまな側面を個人用に設定するユーザーを許可します。 |

## <a name="lab-create-a-web-part-page"></a>Web パーツ ページを作成するラボ。

このラボでは、ASP.NET プロファイルを介して情報を保持する Web パーツ ページを作成します。

### <a name="creating-a-simple-page-with-web-parts"></a>Web パーツを含む、単純なページを作成します。

このチュートリアルのこの部分では、Web パーツ コントロールを使用して静的コンテンツを表示するページを作成します。 Web パーツを使用して最初の手順では、2 つの必要な構造体要素をページを作成します。 最初に、Web パーツ ページには、WebPartManager コントロールを追跡およびすべての Web パーツ コントロールを調整する必要があります。 次に、Web パーツ ページには、web パーツやその他のサーバー コントロールを含めるし、ページの指定した領域を占有した複合コントロールは、1 つまたは複数のゾーンが必要があります。

> [!NOTE]
> Web パーツのパーソナル化を有効にするために何もする必要はありません。既定では、Web パーツ コントロール セットには有効です。 サイトで Web パーツ ページを初めて実行するときに、ASP.NET はユーザーの個人用設定を保存する既定のパーソナル化プロバイダーを設定します。 パーソナル化の詳細については、Web パーツのパーソナル化の概要を参照してください。


### <a name="to-create-a-page-for-containing-web-parts-controls"></a>Web パーツ コントロールを格納するためのページを作成するには

1. 既定のページを閉じて、閉じをという名前のサイトに新しいページを追加します。
2. 切り替える**デザイン**ビュー。
3. **ビュー** ] メニューの [ことを確認して、**非ビジュアル コントロール**と**詳細**レイアウト タグと、UI がないコントロールが表示されるようにオプションが選択されています。
4. 前にカーソルを置き、  **&lt;div&gt;** タグ上のデザイン画面で、新しい行を追加するには ENTER キーを押します。 改行文字の前にカーソルを置きをクリックして、**ブロック形式**ドロップダウン リストを選択して、メニュー、コントロールを選択、**見出し 1**オプション。 テキストを追加、見出し**Web パーツのデモ ページ**です。
5. **WebParts**ドラッグ、ツールボックスのタブ、 **WebPartManager**とする前に改行文字の直後後に配置する、ページ上にコントロール、  **&lt;div&gt;**タグ。   
  
 **WebPartManager**デザイナー画面に灰色のボックスとして表示コントロールが何も出力をレンダリングしません。
6. 内でカーソルを置き、  **&lt;div&gt;** タグ。
7. **レイアウト** メニューのをクリックして**表の挿入**、し、1 つの行と 3 つの列を含む新しいテーブルを作成します。 をクリックして、**セル プロパティ**ボタンで、**上部**から、**垂直位置揃え**ドロップダウン リスト をクリックして**OK** をクリック**OK**もう一度、テーブルを作成します。
8. 左側のテーブル列に WebPartZone コントロールをドラッグします。 右クリックし、 **WebPartZone**コントロール を選択**プロパティ**、次のプロパティを設定します。   
  
 ID: SidebarZone   
  
 HeaderText: サイド バー
9. 1 秒あたりのドラッグ**WebPartZone**中間テーブル列に制御し、次のプロパティを設定します。   
  
 ID: MainZone   
  
 HeaderText: メイン
10. ファイルを保存します。

ページでは、個別に制御できる 2 つの個別のゾーンできるようになりました。 ただし、いずれのゾーンでは、次の手順は、コンテンツを作成するために内容がないです。 このチュートリアルでは、静的なコンテンツのみを表示する Web パーツ コントロールと連携します。

Web パーツ ゾーンのレイアウトを指定、  **&lt;zonetemplate&gt;** 要素。 ゾーンのテンプレートの内部カスタム Web パーツ コントロール、ユーザー コントロール、または既存のサーバー コントロールがあるかどうか、すべての ASP.NET コントロールを追加できます。 ここで、ラベル コントロールを使用しているには、単に静的なテキストを追加することは、ことを確認します。 通常のサーバー コントロールを配置するとき、 **WebPartZone**ゾーン、ASP.NET コントロールとして扱います Web パーツ コントロール、コントロール上の Web パーツの機能を有効にすると、実行時にします。

**メインのゾーンのコンテンツを作成するには**

1. **デザイン**ビューで、ドラッグ、**ラベル**から制御、**標準**ゾーンの内容領域には、ツールボックスのタブが**ID**プロパティMainZone に設定されます。
2. 切り替える**ソース**ビュー。 注意して、  **&lt;zonetemplate&gt;** をラップする要素が追加された、**ラベル**MainZone で制御します。
3. という名前の属性を追加**タイトル**を **&lt;asp: ラベル&gt;**要素、コンテンツにその値を設定します。 テキストを削除する ="Label"属性から、  **&lt;asp: ラベル&gt;**要素。 開始タグと終了タグの間、  **&lt;asp: ラベル&gt;**要素などいくつかのテキストの追加**ホーム ページへようこそ**内の **&lt;h2&gt;** 要素タグ。 コードには、次のようになります。 

    [!code-aspx[Main](profiles-themes-and-web-parts/samples/sample21.aspx)]
4. ファイルを保存します。

次に、Web パーツ コントロールとしてそのページに追加することもユーザー コントロールを作成します。

### <a name="to-create-a-user-control"></a>ユーザー コントロールを作成するには

1. 検索コントロールとして機能するようにサイトを新しい Web ユーザー コントロールを追加します。 オプションの選択を解除**別のファイルにソース コードを配置**です。 閉じページと同じディレクトリに追加し、SearchUserControl.ascx という名前を付けます。   
  
    > [!NOTE]
    > このチュートリアルではユーザー コントロールでは、実際の検索機能を実装しません。Web パーツ機能説明するために使用されます。
2. 切り替える**デザイン**ビュー。 **標準** タブ、ツールボックスのページにテキスト ボックス コントロールをドラッグします。
3. カーソルを置き、追加したテキスト ボックスの後と、新しい行を追加するには ENTER キーを押します。
4. ボタン コントロールを追加するテキスト ボックスの下の新しい行のページにドラッグします。
5. 切り替える**ソース**ビュー。 次の例のように、ユーザー コントロールのソース コードは次のことを確認します。 

    [!code-aspx[Main](profiles-themes-and-web-parts/samples/sample22.aspx)]
6. ファイルを保存して閉じます。

これでサイドバーのゾーンに Web パーツ コントロールを追加できます。 サイドバーをゾーンに 2 つのコントロールを追加する、前の手順で作成したユーザー コントロールであるリンクの一覧を含む 1 つです。 リンクは、標準的なとして追加されます**ラベル**サーバー コントロールは、メイン ゾーンの静的なテキストを作成する方法に似ています。 ただしに含まれている個々 のサーバー コントロール (ラベル コントロール) のようなゾーンに直接ユーザー コントロールを含めることが、ここではありません。 代わりに、前の手順で作成したユーザー コントロールの一部であります。 これは、どのようなコントロールと、ユーザー コントロールに必要な追加の機能をパッケージ化し、そのコントロールを Web パーツ コントロールとゾーンで参照する一般的な方法を示しています。

実行時に、Web パーツ コントロール セットは、両方のコントロールは GenericWebPart のコントロールをラップします。 ときに、 **GenericWebPart**コントロールには、Web サーバー コントロールが折り返される、汎用パーツ コントロールは、親コントロール、および親コントロールの ChildControl プロパティを通じてサーバー コントロールにアクセスすることができます。 この汎用パーツ コントロールの使用を有効にして、同じ基本的な動作と属性から派生する Web パーツ コントロールとして標準の Web サーバー コントロール、 **WebPart**クラスです。

### <a name="to-add-web-parts-controls-to-the-sidebar-zone"></a>サイドバーをゾーンに Web パーツ コントロールを追加するには

1. 閉じページを開きます。
2. 切り替える**デザイン**ビュー。
3. ユーザー コントロール ページを作成して、SearchUserControl.ascx をドラッグして**ソリューション エクスプ ローラー**ゾーンに持つ**ID**プロパティ SidebarZone に設定されているし、あるドロップします。
4. 閉じページを保存します。
5. 切り替える**ソース**ビュー。
6. 内部、  **&lt;asp: webpartzone&gt;**  、ユーザー コントロールへの参照のすぐ上、SidebarZone の要素を追加、  **&lt;asp: ラベル&gt;**次の例で示すように、包含へのリンクを持つ要素。 また、追加、**タイトル**属性の値を持つ、ユーザー コントロール タグに**検索**ように、します。 

    [!code-aspx[Main](profiles-themes-and-web-parts/samples/sample23.aspx)]
7. ファイルを保存して閉じます。

今すぐお使いのブラウザーでを参照して、ページをテストできます。 ページには、2 つのゾーンが表示されます。 次のスクリーン ショットは、ページを示します。

**2 つのゾーンの web パーツ デモ ページ**


![Web パーツ VS チュートリアル 1 のスクリーン ショット](profiles-themes-and-web-parts/_static/image3.gif)

**図 3**: Web パーツ VS チュートリアル 1 のスクリーン ショット


タイトルには、各コントロールのバーは、コントロールで実行できる使用可能なアクションの動詞メニューへのアクセスを提供する下向き矢印です。 動詞メニュー、コントロールのいずれかをクリックし、をクリックして、**最小化**動詞と、コントロールが最小化されたことに注意してください。 動詞メニューから **復元**、し、通常のサイズにコントロールを返します。

### <a name="enabling-users-to-edit-pages-and-change-layout"></a>ユーザーがページの編集とレイアウトの変更を有効にします。

Web パーツは、ユーザーにドラッグして 1 つのゾーンから別の Web パーツ コントロールのレイアウトを変更するための機能を提供します。 ユーザーを移動できることに加え**WebPart**別に 1 つのゾーンからコントロールを外観、レイアウト、動作など、コントロールのさまざまな特性を編集するユーザーを許可できます。 Web パーツ コントロール セットの基本的な編集機能を提供する**WebPart**コントロール。 このチュートリアルでは、いないの機能を編集するユーザーに許可するカスタム エディター コントロールを作成することも**WebPart**コントロール。 場所を変更すると同様、 **WebPart**コントロール、コントロールのプロパティの編集をユーザーが加えた変更を保存する ASP.NET の個人用設定に依存します。

このチュートリアルでは、ユーザーがいずれかの基本的な特性を編集する機能を追加する**WebPart**ページ上のコントロールです。 これらの機能を有効にする別カスタム ユーザー コントロールを追加する ページで、と共に、  **&lt;asp: editorzone&gt;** 要素と 2 つの編集コントロール。

### <a name="to-create-a-user-control-that-enables-changing-page-layout"></a>ページ レイアウトの変更を有効にするユーザー コントロールを作成するには

1. Visual Studio で、上、**ファイル**メニューの 、**新規**サブメニューの場合をクリックして、**ファイル**オプション。
2. **新しい項目の追加**ダイアログで、 **Web ユーザー コントロール**です。 新しいファイルの名前を付けます。 オプションの選択を解除**別のファイルにソース コードを配置**です。
3. 新しいコントロールを作成する追加 をクリックします。
4. 切り替える**ソース**ビュー。
5. 新しいファイルの既存のすべてのコードを削除し、次のコードを貼り付けます。 このユーザー コントロールのコード ページのビューを変更または表示モードを有効にする Web パーツ コントロール セットの機能を使用して物理の外観を変更することもできするときにページのレイアウトでは特定の表示モードでします。 

    [!code-aspx[Main](profiles-themes-and-web-parts/samples/sample24.aspx)]
6. 保存 をクリックしてファイルを保存 アイコンを選択すると、ツールバーで、**保存**上、**ファイル**メニュー。

### <a name="to-enable-users-to-change-the-layout"></a>レイアウトを変更するユーザーを有効にするには

1. 閉じページを開きに切り替えます**デザイン**ビュー。
2. 内のカーソルの位置、**デザイン**直後に表示、 **WebPartManager**前に追加したコントロール。 テキストの後に改行を追加して、後の空白行があるように、 **WebPartManager**コントロール。 空白行にカーソルを置きます。
3. 作成したユーザー コントロールをドラッグして (ファイルは、名前付き DisplayModeMenu.ascx) に、閉じページし、空白行の上にドロップします。
4. EditorZone コントロールからドラッグ、 **WebParts**閉じページの残りのテーブルを開くセルには、ツールボックスのセクションでします。
5. **WebParts**セクションで、ツールボックスの AppearanceEditorPart コントロールと LayoutEditorPart にコントロールをドラッグして、 **EditorZone**コントロール。
6. 切り替える**ソース**ビュー。 テーブル セル内の結果コードは、次のコードのようになります。 

    [!code-aspx[Main](profiles-themes-and-web-parts/samples/sample25.aspx)]
7. 閉じファイルを保存します。 ページ レイアウトと表示モードを変更することができるようにするユーザー コントロールを作成したし、プライマリ Web ページ上のコントロールを参照している場合。

ページを編集し、レイアウトを変更する機能をテストできます。

### <a name="to-test-layout-changes"></a>レイアウトの変更をテストするには

1. ブラウザーでページを読み込みます。
2. クリックして、**表示モード**ドロップダウン メニューのおよび選択**編集**です。 ゾーンのタイトルが表示されます。
3. ドラッグ、**個人用リンク**Main ゾーンの最下位にサイドバー ゾーンからのタイトル バー コントロール。 ページは、次のスクリーン ショットのようになります。

### <a name="web-parts-demo-page-with-my-links-control-moved"></a>Web パーツ デモ ページ個人用リンク コントロールの移動


![Web パーツ VS チュートリアル 2 のスクリーン ショット](profiles-themes-and-web-parts/_static/image4.gif)

**図 4**: Web パーツ VS チュートリアル 2 のスクリーン ショット


1. をクリックして、**表示モード**ドロップダウン メニューのおよび選択**参照**です。 ページが更新される、ゾーン名が消え、および**個人用リンク**まま配置場所を制御します。
2. 個人用設定が動作していることを示すためには、ブラウザーを閉じます、ページを再度読み込みます。 加えた変更は、今後のブラウザー セッションに保存されます。
3. **表示モード**メニューの **編集**です。   
  
 ページ上の各コントロール動詞のドロップダウン メニューが含まれているタイトル バーに下向きの矢印が表示されます。
4. メニューを表示する動詞の矢印をクリックして、**個人用リンク**コントロール。 クリックして、**編集**動詞です。   
  
 **EditorZone**コントロールを表示、追加を制御、EditorPart を表示します。
5. **外観**エディット コントロール、変更のセクションで、**タイトル**お気に入りを使用して、**枠の種類**を選択するドロップダウン リスト**タイトルのみ**、クリックして**適用**です。 次のスクリーン ショットは、編集モードでページを示します。

### <a name="web-parts-demo-page-in-edit-mode"></a>編集モードで web パーツ デモ ページ


![Web パーツ VS チュートリアル 3 スクリーンショット](profiles-themes-and-web-parts/_static/image5.gif)

**図 5**: Web パーツ VS チュートリアル 3 スクリーン ショット


1. をクリックして、**表示モード**メニューのおよび選択**参照**ブラウズ モードに戻ります。
2. 次のスクリーン ショットに示すように、タイトルが更新され、境界線コントロール今すぐいます。

### <a name="edited-web-parts-demo-page"></a>編集済みの Web パーツのデモ ページ


![Web パーツ VS チュートリアル 4 スクリーンショット](profiles-themes-and-web-parts/_static/image6.gif)

**図 4**: Web パーツ VS チュートリアル 4 のスクリーン ショット


### <a name="adding-web-parts-at-run-time"></a>実行時に Web パーツの追加

実行時にそのページに Web パーツ コントロールを追加するユーザーを許可することもできます。 これを行うには、ユーザーを使用できるようにする Web パーツ コントロールのリストを含む Web パーツのカタログをページに設定します。

**実行時に Web パーツを追加するユーザーを許可するには**

1. 閉じページを開きに切り替えます**デザイン**ビュー。
2. **WebParts**  タブ、ツールボックスの CatalogZone コントロールをドラッグ右側の列、テーブルの下に、 **EditorZone**コントロール。   
  
 両方のコントロールは、同時に表示されませんので同じテーブル セルで指定できます。
3. プロパティ ペインで、文字列を割り当てる**Web パーツの追加**の HeaderText プロパティに、 **CatalogZone**コントロール。
4. **WebParts**セクションで、ツールボックスの DeclarativeCatalogPart コントロールをドラッグのコンテンツ領域、 **CatalogZone**コントロール。
5. 右上隅にある矢印をクリックして、 **DeclarativeCatalogPart**して、[タスク] メニューを公開するコントロールを選択し、**テンプレートの編集**です。
6. **標準**ドラッグ、ツールボックスのセクションで、**ファイルアップロード**コントロールと**カレンダー**にコントロールを**WebPartsTemplate**セクションで、 **DeclarativeCatalogPart**コントロール。
7. 切り替える**ソース**ビュー。 ソース コードを調べ、  **&lt;asp: catalogzone&gt;** 要素。 注意して、 **DeclarativeCatalogPart**コントロールに含まれる、  **&lt;webpartstemplate&gt;**  2 つのかっこで囲んだサーバー コントロールをページに追加することができますを持つ要素カタログです。
8. 追加、**タイトル**を示す文字列値を使用して、次のコード例では、各タイトルのカタログに追加したコントロールの各プロパティ。 タイトルは、プロパティではない場合でも通常を設定できますこれら 2 つのサーバーのコントロールにユーザーがこれらのコントロールを追加するときに、デザイン時に、 **WebPartZone**ゾーン実行時に、カタログからそれぞれラップされると、 **GenericWebPart**コントロール。 これにより、タイトルを表示できるように、Web パーツ コントロールとして機能することができます。   
  
 コードに含まれている 2 つのコントロールを**DeclarativeCatalogPart**コントロールは次のようになります。 

    [!code-aspx[Main](profiles-themes-and-web-parts/samples/sample26.aspx)]
9. ページを保存します。

カタログをテストできます。

### <a name="to-test-the-web-parts-catalog"></a>Web パーツのカタログをテストするには

1. ブラウザーでページを読み込みます。
2. クリックして、**表示モード**ドロップダウン メニューのおよび選択**カタログ**です。   
  
 タイトル カタログ**Web パーツの追加**が表示されます。
3. ドラッグ、**お気に入り**Main ゾーンからサイドバー ゾーンのページのトップへを制御しがありますにドロップします。
4. **Web パーツの追加**カタログ、両方のチェック ボックスを選択し、 **Main**を利用可能なゾーンを含むドロップダウン リストからです。
5. をクリックして**追加**カタログにします。 コントロールは、メインのゾーンに追加されます。 する場合は、ページに、カタログからのコントロールの複数のインスタンスを追加できます。   
  
 次のスクリーン ショットは、メイン ゾーンでファイル アップロード コントロール、およびカレンダーのページを示します。 

![カタログからメイン ゾーンに追加されたコントロール](profiles-themes-and-web-parts/_static/image7.gif)

    **Figure 5**: Controls added to Main zone from the catalog
6. をクリックして、**表示モード**ドロップダウン メニューのおよび選択**参照**です。 カタログが消え、ページを更新します。
7. ブラウザーを閉じます。 ページを再度読み込みます。 加えた変更を永続化します。
