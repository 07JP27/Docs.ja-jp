---
uid: web-forms/overview/older-versions-getting-started/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-3
title: データベースの概要 Entity Framework 4.0 最初および ASP.NET 4 Web フォーム - パート 3 |Microsoft ドキュメント
author: tdykstra
description: Contoso 大学でサンプル web アプリケーションでは、Entity Framework を使用して ASP.NET Web フォーム アプリケーションを作成する方法を示します。 サンプル アプリケーションは、.
ms.author: aspnetcontent
manager: wpickett
ms.date: 12/03/2010
ms.topic: article
ms.assetid: ccdc3f8c-2568-40a7-8f8b-3c23d2e05388
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-getting-started/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-3
msc.type: authoredcontent
ms.openlocfilehash: 654f3556af5d05ec186e1811421966bbaffd2e21
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/06/2018
---
<a name="getting-started-with-entity-framework-40-database-first-and-aspnet-4-web-forms---part-3"></a><span data-ttu-id="ccb7b-104">データベースの概要 Entity Framework 4.0 最初および ASP.NET 4 Web フォーム - パート 3</span><span class="sxs-lookup"><span data-stu-id="ccb7b-104">Getting Started with Entity Framework 4.0 Database First and ASP.NET 4 Web Forms - Part 3</span></span>
====================
<span data-ttu-id="ccb7b-105">によって[Tom Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="ccb7b-105">by [Tom Dykstra](https://github.com/tdykstra)</span></span>

> <span data-ttu-id="ccb7b-106">Contoso 大学でサンプル web アプリケーションでは、Entity Framework 4.0 および Visual Studio 2010 を使用して ASP.NET Web フォーム アプリケーションを作成する方法を示します。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-106">The Contoso University sample web application demonstrates how to create ASP.NET Web Forms applications using the Entity Framework 4.0 and Visual Studio 2010.</span></span> <span data-ttu-id="ccb7b-107">一連のチュートリアルについては、次を参照してください[系列内の最初のチュートリアル。](the-entity-framework-and-aspnet-getting-started-part-1.md)</span><span class="sxs-lookup"><span data-stu-id="ccb7b-107">For information about the tutorial series, see [the first tutorial in the series](the-entity-framework-and-aspnet-getting-started-part-1.md)</span></span>


## <a name="filtering-ordering-and-grouping-data"></a><span data-ttu-id="ccb7b-108">フィルター処理、並べ替え、およびデータをグループ化</span><span class="sxs-lookup"><span data-stu-id="ccb7b-108">Filtering, Ordering, and Grouping Data</span></span>

<span data-ttu-id="ccb7b-109">前のチュートリアルでは使用して、`EntityDataSource`コントロールを表示し、データを編集します。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-109">In the previous tutorial you used the `EntityDataSource` control to display and edit data.</span></span> <span data-ttu-id="ccb7b-110">このチュートリアルではあり、フィルター処理する、順序、データをグループ化します。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-110">In this tutorial you'll filter, order, and group data.</span></span> <span data-ttu-id="ccb7b-111">プロパティを設定してのこれを行うと、`EntityDataSource`コントロール、構文は他のデータ ソース コントロールから異なります。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-111">When you do this by setting properties of the `EntityDataSource` control, the syntax is different from other data source controls.</span></span> <span data-ttu-id="ccb7b-112">説明するように、ただし、使用できます、`QueryExtender`をこれらの相違点を最小限にするコントロール。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-112">As you'll see, however, you can use the `QueryExtender` control to minimize these differences.</span></span>

<span data-ttu-id="ccb7b-113">変更、 *Students.aspx*ページ、受講者をフィルター処理を名前で検索して、名前で並べ替え。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-113">You'll change the *Students.aspx* page to filter for students, sort by name, and search on name.</span></span> <span data-ttu-id="ccb7b-114">変更することもあります、 *Courses.aspx*名前でコースを検索して選択した部門のコースを表示するページ。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-114">You'll also change the *Courses.aspx* page to display courses for the selected department and search for courses by name.</span></span> <span data-ttu-id="ccb7b-115">最後に、学生の統計情報を追加、 *About.aspx*ページ。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-115">Finally, you'll add student statistics to the *About.aspx* page.</span></span>

<span data-ttu-id="ccb7b-116">[![Image02](the-entity-framework-and-aspnet-getting-started-part-3/_static/image2.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="ccb7b-116">[![Image02](the-entity-framework-and-aspnet-getting-started-part-3/_static/image2.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image1.png)</span></span>

<span data-ttu-id="ccb7b-117">[![Image11](the-entity-framework-and-aspnet-getting-started-part-3/_static/image4.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="ccb7b-117">[![Image11](the-entity-framework-and-aspnet-getting-started-part-3/_static/image4.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image3.png)</span></span>

<span data-ttu-id="ccb7b-118">[![Image10](the-entity-framework-and-aspnet-getting-started-part-3/_static/image6.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="ccb7b-118">[![Image10](the-entity-framework-and-aspnet-getting-started-part-3/_static/image6.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image5.png)</span></span>

<span data-ttu-id="ccb7b-119">[![Image14](the-entity-framework-and-aspnet-getting-started-part-3/_static/image8.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="ccb7b-119">[![Image14](the-entity-framework-and-aspnet-getting-started-part-3/_static/image8.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image7.png)</span></span>

## <a name="using-the-entitydatasource-where-property-to-filter-data"></a><span data-ttu-id="ccb7b-120">プロパティを使用して、EntityDataSource"Where"データをフィルター処理</span><span class="sxs-lookup"><span data-stu-id="ccb7b-120">Using the EntityDataSource "Where" Property to Filter Data</span></span>

<span data-ttu-id="ccb7b-121">開く、 *Students.aspx*前のチュートリアルで作成したページ。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-121">Open the *Students.aspx* page that you created in the previous tutorial.</span></span> <span data-ttu-id="ccb7b-122">現在の構成に従って、`GridView`ページ内のコントロールからのすべての名前を表示する、`People`エンティティ セット。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-122">As currently configured, the `GridView` control in the page displays all the names from the `People` entity set.</span></span> <span data-ttu-id="ccb7b-123">のみ受講者を表示するただし、見つけることができます を選択して`Person`null 以外の登録の日付が含まれているエンティティ。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-123">However, you want to show only students, which you can find by selecting `Person` entities that have non-null enrollment dates.</span></span>

<span data-ttu-id="ccb7b-124">切り替える**デザイン**表示し、選択、`EntityDataSource`コントロール。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-124">Switch to **Design** view and select the `EntityDataSource` control.</span></span> <span data-ttu-id="ccb7b-125">**プロパティ**ウィンドウで、設定、`Where`プロパティを`it.EnrollmentDate is not null`です。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-125">In the **Properties** window, set the `Where` property to `it.EnrollmentDate is not null`.</span></span>

<span data-ttu-id="ccb7b-126">[![Image01](the-entity-framework-and-aspnet-getting-started-part-3/_static/image10.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="ccb7b-126">[![Image01](the-entity-framework-and-aspnet-getting-started-part-3/_static/image10.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image9.png)</span></span>

<span data-ttu-id="ccb7b-127">使用する構文、`Where`のプロパティ、`EntityDataSource`コントロールは、Entity SQL です。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-127">The syntax you use in the `Where` property of the `EntityDataSource` control is Entity SQL.</span></span> <span data-ttu-id="ccb7b-128">Entity SQL は、TRANSACT-SQL に似ていますが、データベース オブジェクトではなく、エンティティで使用するためにカスタマイズがします。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-128">Entity SQL is similar to Transact-SQL, but it's customized for use with entities rather than database objects.</span></span> <span data-ttu-id="ccb7b-129">式で`it.EnrollmentDate is not null`、単語`it`クエリによって返されるエンティティへの参照を表します。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-129">In the expression `it.EnrollmentDate is not null`, the word `it` represents a reference to the entity returned by the query.</span></span> <span data-ttu-id="ccb7b-130">したがって、`it.EnrollmentDate`を指す、`EnrollmentDate`のプロパティ、`Person`エンティティを`EntityDataSource`制御を返します。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-130">Therefore, `it.EnrollmentDate` refers to the `EnrollmentDate` property of the `Person` entity that the `EntityDataSource` control returns.</span></span>

<span data-ttu-id="ccb7b-131">ページを実行します。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-131">Run the page.</span></span> <span data-ttu-id="ccb7b-132">これで、学生のリストには、受講者のみが含まれています。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-132">The students list now contains only students.</span></span> <span data-ttu-id="ccb7b-133">(ここで表示される行がない登録日はありません)。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-133">(There are no rows displayed where there's no enrollment date.)</span></span>

<span data-ttu-id="ccb7b-134">[![Image02](the-entity-framework-and-aspnet-getting-started-part-3/_static/image12.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="ccb7b-134">[![Image02](the-entity-framework-and-aspnet-getting-started-part-3/_static/image12.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image11.png)</span></span>

## <a name="using-the-entitydatasource-orderby-property-to-order-data"></a><span data-ttu-id="ccb7b-135">注文データを EntityDataSource"OrderBy"プロパティを使用します。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-135">Using the EntityDataSource "OrderBy" Property to Order Data</span></span>

<span data-ttu-id="ccb7b-136">この一覧が最初に表示されるときに、名前の順序である必要があります。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-136">You also want this list to be in name order when it's first displayed.</span></span> <span data-ttu-id="ccb7b-137">*Students.aspx*  ページで開かれて**デザイン**ビューを使用して、`EntityDataSource`コントロールがまだオンにした場合、**プロパティ**ウィンドウのセット、 **OrderBy**プロパティを`it.LastName`です。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-137">With the *Students.aspx* page still open in **Design** view, and with the `EntityDataSource` control still selected, in the **Properties** window set the **OrderBy** property to `it.LastName`.</span></span>

<span data-ttu-id="ccb7b-138">[![Image05](the-entity-framework-and-aspnet-getting-started-part-3/_static/image14.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="ccb7b-138">[![Image05](the-entity-framework-and-aspnet-getting-started-part-3/_static/image14.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image13.png)</span></span>

<span data-ttu-id="ccb7b-139">ページを実行します。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-139">Run the page.</span></span> <span data-ttu-id="ccb7b-140">学生のリストは姓で並べ替えが開始されました。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-140">The students list is now in order by last name.</span></span>

<span data-ttu-id="ccb7b-141">[![Image04](the-entity-framework-and-aspnet-getting-started-part-3/_static/image16.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="ccb7b-141">[![Image04](the-entity-framework-and-aspnet-getting-started-part-3/_static/image16.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image15.png)</span></span>

## <a name="using-a-control-parameter-to-set-the-where-property"></a><span data-ttu-id="ccb7b-142">"Where"プロパティを設定する制御パラメーターを使用します。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-142">Using a Control Parameter to Set the "Where" Property</span></span>

<span data-ttu-id="ccb7b-143">その他のデータ ソース コントロールとするパラメーターの値を渡すことができます、`Where`プロパティです。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-143">As with other data source controls, you can pass parameter values to the `Where` property.</span></span> <span data-ttu-id="ccb7b-144">*Courses.aspx*ページ、チュートリアルのパート 2 で作成した、このメソッドを使用するには、ユーザーがドロップダウン リストから選択する部門に関連付けられているコースを表示することです。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-144">On the *Courses.aspx* page that you created in part 2 of the tutorial, you can use this method to display courses that are associated with the department that a user selects from the drop-down list.</span></span>

<span data-ttu-id="ccb7b-145">開いている*Courses.aspx*に切り替えると**デザイン**ビュー。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-145">Open *Courses.aspx* and switch to **Design** view.</span></span> <span data-ttu-id="ccb7b-146">1 秒あたりの追加`EntityDataSource`コントロールをページ、および名前を付けます`CoursesEntityDataSource`です。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-146">Add a second `EntityDataSource` control to the page, and name it `CoursesEntityDataSource`.</span></span> <span data-ttu-id="ccb7b-147">接続して、`SchoolEntities`モデル、および選択`Courses`として、 **EntitySetName**値。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-147">Connect it to the `SchoolEntities` model, and select `Courses` as the **EntitySetName** value.</span></span>

<span data-ttu-id="ccb7b-148">**プロパティ** ウィンドウにある省略記号をクリックして、**場所**プロパティ ボックス。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-148">In the **Properties** window, click the ellipsis in the **Where** property box.</span></span> <span data-ttu-id="ccb7b-149">(確認、`CoursesEntityDataSource`コントロールが使用する前に選択されて、**プロパティ**ウィンドウです)。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-149">(Make sure the `CoursesEntityDataSource` control is still selected before using the **Properties** window.)</span></span>

<span data-ttu-id="ccb7b-150">[![Image06](the-entity-framework-and-aspnet-getting-started-part-3/_static/image18.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="ccb7b-150">[![Image06](the-entity-framework-and-aspnet-getting-started-part-3/_static/image18.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image17.png)</span></span>

<span data-ttu-id="ccb7b-151">**式エディター**  ダイアログ ボックスが表示されます。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-151">The **Expression Editor** dialog box is displayed.</span></span> <span data-ttu-id="ccb7b-152">このダイアログ ボックスで選択**Where を自動的に生成式が指定されたパラメーターに基づく**、クリックして**パラメーターの追加**です。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-152">In this dialog box, select **Automatically generate the Where expression based on the provided parameters**, and then click **Add Parameter**.</span></span> <span data-ttu-id="ccb7b-153">パラメーターの名前を付けます`DepartmentID`**コントロール**として、**パラメーター ソース**値に設定して、選択**DepartmentsDropDownList**として、 **ControlID**値。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-153">Name the parameter `DepartmentID`, select **Control** as the **Parameter source** value, and select **DepartmentsDropDownList** as the **ControlID** value.</span></span>

<span data-ttu-id="ccb7b-154">[![Image07](the-entity-framework-and-aspnet-getting-started-part-3/_static/image20.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="ccb7b-154">[![Image07](the-entity-framework-and-aspnet-getting-started-part-3/_static/image20.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image19.png)</span></span>

<span data-ttu-id="ccb7b-155">をクリックして**詳細プロパティの表示**、し、[、**プロパティ**のウィンドウ、**式エディター** ] ダイアログ ボックスで、変更、`Type`プロパティを`Int32`です。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-155">Click **Show advanced properties**, and in the **Properties** window of the **Expression Editor** dialog box, change the `Type` property to `Int32`.</span></span>

<span data-ttu-id="ccb7b-156">[![Image15](the-entity-framework-and-aspnet-getting-started-part-3/_static/image22.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="ccb7b-156">[![Image15](the-entity-framework-and-aspnet-getting-started-part-3/_static/image22.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image21.png)</span></span>

<span data-ttu-id="ccb7b-157">完了したら、をクリックして**OK**です。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-157">When you're done, click **OK**.</span></span>

<span data-ttu-id="ccb7b-158">ドロップダウン リストの下に追加、`GridView`コントロールをページし、名前を付けます`CoursesGridView`です。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-158">Below the drop-down list, add a `GridView` control to the page and name it `CoursesGridView`.</span></span> <span data-ttu-id="ccb7b-159">接続に、`CoursesEntityDataSource`データ ソース コントロールで、をクリックして**スキーマの更新**、 をクリックして**列の編集**、および削除、`DepartmentID`列。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-159">Connect it to the `CoursesEntityDataSource` data source control, click **Refresh Schema**, click **Edit Columns**, and remove the `DepartmentID` column.</span></span> <span data-ttu-id="ccb7b-160">`GridView`コントロールのマークアップが次の例に似ています。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-160">The `GridView` control markup resembles the following example.</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample1.aspx)]

<span data-ttu-id="ccb7b-161">ユーザーには、ドロップダウン リストで選択した部門が変更された、ときに関連付けられているコースに自動的に変更の一覧が必要です。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-161">When the user changes the selected department in the drop-down list, you want the list of associated courses to change automatically.</span></span> <span data-ttu-id="ccb7b-162">これには、ドロップダウン リストを選択して、**プロパティ**ウィンドウのセット、`AutoPostBack`プロパティを`True`です。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-162">To make this happen, select the drop-down list, and in the **Properties** window set the `AutoPostBack` property to `True`.</span></span>

<span data-ttu-id="ccb7b-163">[![Image08](the-entity-framework-and-aspnet-getting-started-part-3/_static/image24.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="ccb7b-163">[![Image08](the-entity-framework-and-aspnet-getting-started-part-3/_static/image24.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image23.png)</span></span>

<span data-ttu-id="ccb7b-164">デザイナーの使用が完了したら、これに切り替える**ソース**表示し、置換、`ConnectionString`と`DefaultContainer`のプロパティの名前に、`CoursesEntityDataSource`コントロールを`ContextTypeName="ContosoUniversity.DAL.SchoolEntities"`属性。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-164">Now that you're finished using the designer, switch to **Source** view and replace the `ConnectionString` and `DefaultContainer` name properties of the `CoursesEntityDataSource` control with the `ContextTypeName="ContosoUniversity.DAL.SchoolEntities"` attribute.</span></span> <span data-ttu-id="ccb7b-165">完了したら、コントロールのマークアップは次の例のようになります。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-165">When you're done, the markup for the control will look like the following example.</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample2.aspx)]

<span data-ttu-id="ccb7b-166">ページを実行し、ドロップダウン リストを使用して、さまざまな部門を選択します。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-166">Run the page and use the drop-down list to select different departments.</span></span> <span data-ttu-id="ccb7b-167">選択した部門によって提供されるコースのみが表示されます、`GridView`コントロール。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-167">Only courses that are offered by the selected department are displayed in the `GridView` control.</span></span>

<span data-ttu-id="ccb7b-168">[![Image09](the-entity-framework-and-aspnet-getting-started-part-3/_static/image26.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="ccb7b-168">[![Image09](the-entity-framework-and-aspnet-getting-started-part-3/_static/image26.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image25.png)</span></span>

## <a name="using-the-entitydatasource-groupby-property-to-group-data"></a><span data-ttu-id="ccb7b-169">プロパティを使用して、EntityDataSource"GroupBy"データをグループ化</span><span class="sxs-lookup"><span data-stu-id="ccb7b-169">Using the EntityDataSource "GroupBy" Property to Group Data</span></span>

<span data-ttu-id="ccb7b-170">Contoso 大学が、に関するページにいくつかの学生本文統計に配置しようとします。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-170">Suppose Contoso University wants to put some student-body statistics on its About page.</span></span> <span data-ttu-id="ccb7b-171">具体的には、登録されていると、日付によって生徒数の内訳を表示しようとします。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-171">Specifically, it wants to show a breakdown of numbers of students by the date they enrolled.</span></span>

<span data-ttu-id="ccb7b-172">開いている*About.aspx*、し、**ソース**ビューで、既存の内容を置き換える、`BodyContent`間を「学生本文統計」を含む制御`h2`タグ。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-172">Open *About.aspx*, and in **Source** view, replace the existing contents of the `BodyContent` control with "Student Body Statistics" between `h2` tags:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample3.aspx)]

<span data-ttu-id="ccb7b-173">見出しの後の追加、`EntityDataSource`を制御し、名前を付けます`StudentStatisticsEntityDataSource`です。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-173">After the heading, add an `EntityDataSource` control and name it `StudentStatisticsEntityDataSource`.</span></span> <span data-ttu-id="ccb7b-174">接続に`SchoolEntities`を選択、`People`エンティティ セットにしのままにして、**選択**ボックス、ウィザードをそのままにします。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-174">Connect it to `SchoolEntities`, select the `People` entity set, and leave the **Select** box in the wizard unchanged.</span></span> <span data-ttu-id="ccb7b-175">次のプロパティを設定、**プロパティ**ウィンドウ。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-175">Set the following properties in the **Properties** window:</span></span>

- <span data-ttu-id="ccb7b-176">受講者のみをフィルターするには、設定、`Where`プロパティを`it.EnrollmentDate is not null`です。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-176">To filter for students only, set the `Where` property to `it.EnrollmentDate is not null`.</span></span>
- <span data-ttu-id="ccb7b-177">登録日で結果をグループ化、設定、`GroupBy`プロパティを`it.EnrollmentDate`です。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-177">To group the results by the enrollment date, set the `GroupBy` property to `it.EnrollmentDate`.</span></span>
- <span data-ttu-id="ccb7b-178">登録日と生徒の数を選択するには設定、`Select`プロパティを`it.EnrollmentDate, Count(it.EnrollmentDate) AS NumberOfStudents`です。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-178">To select the enrollment date and the number of students, set the `Select` property to `it.EnrollmentDate, Count(it.EnrollmentDate) AS NumberOfStudents`.</span></span>
- <span data-ttu-id="ccb7b-179">登録日で結果の順序、設定、`OrderBy`プロパティを`it.EnrollmentDate`です。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-179">To order the results by the enrollment date, set the `OrderBy` property to `it.EnrollmentDate`.</span></span>

<span data-ttu-id="ccb7b-180">**ソース**ビューで、置換、`ConnectionString`と`DefaultContainer`とプロパティの名前に、`ContextTypeName`プロパティです。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-180">In **Source** view, replace the `ConnectionString` and `DefaultContainer` name properties with a `ContextTypeName` property.</span></span> <span data-ttu-id="ccb7b-181">`EntityDataSource`コントロール マークアップ次の例のようになります。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-181">The `EntityDataSource` control markup now resembles the following example.</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample4.aspx)]

<span data-ttu-id="ccb7b-182">構文、 `Select`、 `GroupBy`、および`Where`プロパティ以外には、TRANSACT-SQL のようになります、`it`現在のエンティティを指定するキーワードです。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-182">The syntax of the `Select`, `GroupBy`, and `Where` properties resembles Transact-SQL except for the `it` keyword that specifies the current entity.</span></span>

<span data-ttu-id="ccb7b-183">作成する次のマークアップを追加、`GridView`コントロールにデータを表示します。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-183">Add the following markup to create a `GridView` control to display the data.</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample5.aspx)]

<span data-ttu-id="ccb7b-184">登録日ごと生徒の数を示す一覧を表示するページを実行します。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-184">Run the page to see a list showing the number of students by enrollment date.</span></span>

<span data-ttu-id="ccb7b-185">[![Image10](the-entity-framework-and-aspnet-getting-started-part-3/_static/image28.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="ccb7b-185">[![Image10](the-entity-framework-and-aspnet-getting-started-part-3/_static/image28.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image27.png)</span></span>

## <a name="using-the-queryextender-control-for-filtering-and-ordering"></a><span data-ttu-id="ccb7b-186">フィルター処理と順序付けの QueryExtender コントロールの使用</span><span class="sxs-lookup"><span data-stu-id="ccb7b-186">Using the QueryExtender Control for Filtering and Ordering</span></span>

<span data-ttu-id="ccb7b-187">`QueryExtender`コントロールには、マークアップのフィルターおよび並べ替えを指定する方法が用意されています。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-187">The `QueryExtender` control provides a way to specify filtering and sorting in markup.</span></span> <span data-ttu-id="ccb7b-188">構文が使用しているデータベース管理システム (DBMS) に依存しません。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-188">The syntax is independent of the database management system (DBMS) you're using.</span></span> <span data-ttu-id="ccb7b-189">ナビゲーション プロパティを使用する構文が Entity Framework に一意である例外に、Entity Framework の一般的に独立してもできます。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-189">It's also generally independent of the Entity Framework, with the exception that syntax you use for navigation properties is unique to the Entity Framework.</span></span>

<span data-ttu-id="ccb7b-190">このチュートリアルのこの部分で使用する、`QueryExtender`データのフィルターと順序を制御し、order by フィールドのいずれかにナビゲーション プロパティなります。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-190">In this part of the tutorial you'll use a `QueryExtender` control to filter and order data, and one of the order-by fields will be a navigation property.</span></span>

<span data-ttu-id="ccb7b-191">(マークアップではなくコードを使用して、によって自動的に生成されるクエリを拡張する場合、`EntityDataSource`制御を行うことができますを処理、`QueryCreated`イベント。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-191">(If you prefer to use code instead of markup to extend the queries that are automatically generated by the `EntityDataSource` control, you can do that by handling the `QueryCreated` event.</span></span> <span data-ttu-id="ccb7b-192">これは、どのように`QueryExtender`コントロールを拡張`EntityDataSource`もクエリを制御します)。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-192">This is how the `QueryExtender` control extends `EntityDataSource` control queries also.)</span></span>

<span data-ttu-id="ccb7b-193">開く、 *Courses.aspx*ページし、前に追加したマークアップの下には、見出し、[検索] ボタンの検索文字列を入力するテキスト ボックスを作成する次のマークアップを挿入し、 `EntityDataSource` にバインドされているコントロール`Courses`エンティティ セット。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-193">Open the *Courses.aspx* page, and below the markup you added previously, insert the following markup to create a heading, a text box for entering search strings, a search button, and an `EntityDataSource` control that's bound to the `Courses` entity set.</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample6.aspx)]

<span data-ttu-id="ccb7b-194">注意して、`EntityDataSource`コントロールの`Include`プロパティに設定されている`Department`です。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-194">Notice that the `EntityDataSource` control's `Include` property is set to `Department`.</span></span> <span data-ttu-id="ccb7b-195">データベースで、`Course`テーブルが部門名を含まない; が含まれている、`DepartmentID`外部キー列です。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-195">In the database, the `Course` table does not contain the department name; it contains a `DepartmentID` foreign key column.</span></span> <span data-ttu-id="ccb7b-196">結合する必要がありますが、データベースを直接、コース データと共に部門名を取得するクエリを実行する場合、`Course`と`Department`テーブル。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-196">If you were querying the database directly, to get the department name along with course data, you would have to join the `Course` and `Department` tables.</span></span> <span data-ttu-id="ccb7b-197">設定して、`Include`プロパティを`Department`、Entity Framework が、関連する作業の作業を行う必要がありますを指定する`Department`エンティティを取得するとき、`Course`エンティティです。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-197">By setting the `Include` property to `Department`, you specify that the Entity Framework should do the work of getting the related `Department` entity when it gets a `Course` entity.</span></span> <span data-ttu-id="ccb7b-198">`Department`エンティティに保存し、`Department`のナビゲーション プロパティ、`Course`エンティティです。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-198">The `Department` entity is then stored in the `Department` navigation property of the `Course` entity.</span></span> <span data-ttu-id="ccb7b-199">(既定では、`SchoolEntities`データ モデル デザイナーによって生成されたクラスが関連するデータを取得すると、必要なため、そのクラスに、データ ソース コントロールをバインドした、`Include`プロパティが必要ではありません。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-199">(By default, the `SchoolEntities` class that was generated by the data model designer retrieves related data when it's needed, and you've bound the data source control to that class, so setting the `Include` property is not necessary.</span></span> <span data-ttu-id="ccb7b-200">ただし、設定することのパフォーマンスが向上します ページで、それ以外の場合、Entity Framework 実行するようにデータを取得するデータベースへの呼び出しを区切るため、`Course`エンティティと関連する`Department`エンティティです)。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-200">However, setting it improves performance of the page, because otherwise the Entity Framework would make separate calls to the database to retrieve data for the `Course` entities and for the related `Department` entities.)</span></span>

<span data-ttu-id="ccb7b-201">後に、`EntityDataSource`したコントロールを作成する次のマークアップを挿入、作成、`QueryExtender`にバインドされるコントロールを`EntityDataSource`コントロール。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-201">After the `EntityDataSource` control you just created, insert the following markup to create a `QueryExtender` control that's bound to that `EntityDataSource` control.</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample7.aspx)]

<span data-ttu-id="ccb7b-202">`SearchExpression`要素は、タイトルが一致するテキスト ボックスに入力された値のコースを選択することを指定します。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-202">The `SearchExpression` element specifies that you want to select courses whose titles match the value entered in the text box.</span></span> <span data-ttu-id="ccb7b-203">テキスト ボックスに入力した文字の数と比較されます、ためにのみ、`SearchType`プロパティを指定`StartsWith`です。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-203">Only as many characters as are entered in the text box will be compared, because the `SearchType` property specifies `StartsWith`.</span></span>

<span data-ttu-id="ccb7b-204">`OrderByExpression`要素は、部門名内のコース タイトルは、結果セットを並べ替えられますことを指定します。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-204">The `OrderByExpression` element specifies that the result set will be ordered by course title within department name.</span></span> <span data-ttu-id="ccb7b-205">部門名を指定する方法に注意してください:`Department.Name`です。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-205">Notice how department name is specified: `Department.Name`.</span></span> <span data-ttu-id="ccb7b-206">の間の関連付け、`Course`エンティティと`Department`エンティティは、一対一、`Department`ナビゲーション プロパティが含まれています、`Department`エンティティです。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-206">Because the association between the `Course` entity and the `Department` entity is one-to-one, the `Department` navigation property contains a `Department` entity.</span></span> <span data-ttu-id="ccb7b-207">(これが一対多リレーションシップの場合、プロパティはコレクションを格納します。)部門名を取得する必要がありますを指定する、`Name`のプロパティ、`Department`エンティティです。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-207">(If this were a one-to-many relationship, the property would contain a collection.) To get the department name, you must specify the `Name` property of the `Department` entity.</span></span>

<span data-ttu-id="ccb7b-208">最後に、追加、`GridView`コースの一覧を表示するコントロール。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-208">Finally, add a `GridView` control to display the list of courses:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample8.aspx)]

<span data-ttu-id="ccb7b-209">最初の列は、部門名が表示されるテンプレート フィールドです。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-209">The first column is a template field that displays the department name.</span></span> <span data-ttu-id="ccb7b-210">データ バインド式を指定`Department.Name`で学習したのと同様、`QueryExtender`コントロール。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-210">The databinding expression specifies `Department.Name`, just as you saw in the `QueryExtender` control.</span></span>

<span data-ttu-id="ccb7b-211">ページを実行します。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-211">Run the page.</span></span> <span data-ttu-id="ccb7b-212">最初の表示は、部門られ、続いてコースのタイトルの順序ですべてのコースの一覧を示します。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-212">The initial display shows a list of all courses in order by department and then by course title.</span></span>

<span data-ttu-id="ccb7b-213">[![Image11](the-entity-framework-and-aspnet-getting-started-part-3/_static/image30.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="ccb7b-213">[![Image11](the-entity-framework-and-aspnet-getting-started-part-3/_static/image30.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image29.png)</span></span>

<span data-ttu-id="ccb7b-214">"M"を入力し、クリックして**検索**にタイトルが"m"(検索はいない大文字と小文字) で始まるすべてのコースを参照してください。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-214">Enter an "m" and click **Search** to see all courses whose titles begin with "m" (the search is not case sensitive).</span></span>

<span data-ttu-id="ccb7b-215">[![Image12](the-entity-framework-and-aspnet-getting-started-part-3/_static/image32.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="ccb7b-215">[![Image12](the-entity-framework-and-aspnet-getting-started-part-3/_static/image32.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image31.png)</span></span>

## <a name="using-the-like-operator-to-filter-data"></a><span data-ttu-id="ccb7b-216">"Like"演算子を使用してデータをフィルター処理</span><span class="sxs-lookup"><span data-stu-id="ccb7b-216">Using the "Like" Operator to Filter Data</span></span>

<span data-ttu-id="ccb7b-217">同様の効果を得ることができます、`QueryExtender`コントロールの`StartsWith`、 `Contains`、および`EndsWith`を使用して型を検索、`Like`の演算子、`EntityDataSource`コントロールの`Where`プロパティです。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-217">You can achieve an effect similar to the `QueryExtender` control's `StartsWith`, `Contains`, and `EndsWith` search types by using a `Like` operator in the `EntityDataSource` control's `Where` property.</span></span> <span data-ttu-id="ccb7b-218">このチュートリアルでは、使用する方法が表示されます、`Like`受講者の名前を検索する演算子です。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-218">In this part of the tutorial, you'll see how to use the `Like` operator to search for a student by name.</span></span>

<span data-ttu-id="ccb7b-219">開いている*Students.aspx*で**ソース**ビュー。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-219">Open *Students.aspx* in **Source** view.</span></span> <span data-ttu-id="ccb7b-220">後に、`GridView`コントロールを次のマークアップを追加します。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-220">After the `GridView` control, add the following markup:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample9.aspx)]

<span data-ttu-id="ccb7b-221">このマークアップが経験した前除くに似ていますが、`Where`プロパティの値。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-221">This markup is similar to what you've seen earlier except for the `Where` property value.</span></span> <span data-ttu-id="ccb7b-222">2 番目の部分、`Where`部分文字列検索を定義する式 (`LIKE %FirstMidName% or LIKE %LastName%`)、テキスト ボックスに入力した内容の姓と名の両方を検索します。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-222">The second part of the `Where` expression defines a substring search (`LIKE %FirstMidName% or LIKE %LastName%`) that searches both the first and last names for whatever is entered in the text box.</span></span>

<span data-ttu-id="ccb7b-223">ページを実行します。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-223">Run the page.</span></span> <span data-ttu-id="ccb7b-224">最初に表示すべて受講者のための既定値、`StudentName`パラメーターは、「%」です。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-224">Initially you see all of the students because the default value for the `StudentName` parameter is "%".</span></span>

<span data-ttu-id="ccb7b-225">[![Image13](the-entity-framework-and-aspnet-getting-started-part-3/_static/image34.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="ccb7b-225">[![Image13](the-entity-framework-and-aspnet-getting-started-part-3/_static/image34.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image33.png)</span></span>

<span data-ttu-id="ccb7b-226">テキスト ボックスに"g"の文字を入力し、クリックして**検索**です。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-226">Enter the letter "g" in the text box and click **Search**.</span></span> <span data-ttu-id="ccb7b-227">"G"いずれかで、名前を持つ最初または最生徒数の一覧が表示されます。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-227">You see a list of students that have a "g" in either the first or last name.</span></span>

<span data-ttu-id="ccb7b-228">[![Image14](the-entity-framework-and-aspnet-getting-started-part-3/_static/image36.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="ccb7b-228">[![Image14](the-entity-framework-and-aspnet-getting-started-part-3/_static/image36.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image35.png)</span></span>

<span data-ttu-id="ccb7b-229">したようになりました表示、更新、フィルター処理、並べ替え、および個々 のテーブルからデータをグループ化します。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-229">You've now displayed, updated, filtered, ordered, and grouped data from individual tables.</span></span> <span data-ttu-id="ccb7b-230">次のチュートリアルでは、関連するデータ (マスター/詳細シナリオ) を扱う始めます。</span><span class="sxs-lookup"><span data-stu-id="ccb7b-230">In the next tutorial you'll begin to work with related data (master-detail scenarios).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="ccb7b-231">[前へ](the-entity-framework-and-aspnet-getting-started-part-2.md)
> [次へ](the-entity-framework-and-aspnet-getting-started-part-4.md)</span><span class="sxs-lookup"><span data-stu-id="ccb7b-231">[Previous](the-entity-framework-and-aspnet-getting-started-part-2.md)
[Next](the-entity-framework-and-aspnet-getting-started-part-4.md)</span></span>
