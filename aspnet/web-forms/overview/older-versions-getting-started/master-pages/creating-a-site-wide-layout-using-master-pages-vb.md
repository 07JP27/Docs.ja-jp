---
uid: web-forms/overview/older-versions-getting-started/master-pages/creating-a-site-wide-layout-using-master-pages-vb
title: "マスター ページ (VB) を使用して、サイト全体のレイアウトを作成 |Microsoft ドキュメント"
author: rick-anderson
description: "このチュートリアルでは、マスター ページの基本を説明します。 つまり、マスター ページとはどのようにいずれか 1 つの cr をどのようにコンテンツ プレース ホルダーとは、マスター ページを作成しています."
ms.author: aspnetcontent
manager: wpickett
ms.date: 05/21/2008
ms.topic: article
ms.assetid: 30945276-8ed9-4b27-8e50-4309244d3559
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-getting-started/master-pages/creating-a-site-wide-layout-using-master-pages-vb
msc.type: authoredcontent
ms.openlocfilehash: 29671970dc6f53d0e14170cf6376c02634b7b08e
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/24/2018
---
<a name="creating-a-site-wide-layout-using-master-pages-vb"></a><span data-ttu-id="84766-104">マスター ページ (VB) を使用して、サイト全体のレイアウトを作成します。</span><span class="sxs-lookup"><span data-stu-id="84766-104">Creating a Site-Wide Layout Using Master Pages (VB)</span></span>
====================
<span data-ttu-id="84766-105">によって[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="84766-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="84766-106">[コードをダウンロードする](http://download.microsoft.com/download/e/e/f/eef369f5-743a-4a52-908f-b6532c4ce0a4/ASPNET_MasterPages_Tutorial_01_VB.zip)または[PDF のダウンロード](http://download.microsoft.com/download/8/f/6/8f6349e4-6554-405a-bcd7-9b094ba5089a/ASPNET_MasterPages_Tutorial_01_VB.pdf)</span><span class="sxs-lookup"><span data-stu-id="84766-106">[Download Code](http://download.microsoft.com/download/e/e/f/eef369f5-743a-4a52-908f-b6532c4ce0a4/ASPNET_MasterPages_Tutorial_01_VB.zip) or [Download PDF](http://download.microsoft.com/download/8/f/6/8f6349e4-6554-405a-bcd7-9b094ba5089a/ASPNET_MasterPages_Tutorial_01_VB.pdf)</span></span>

> <span data-ttu-id="84766-107">このチュートリアルでは、マスター ページの基本を説明します。</span><span class="sxs-lookup"><span data-stu-id="84766-107">This tutorial will show master page basics.</span></span> <span data-ttu-id="84766-108">つまり、マスター ページはいずれかの作成方法、マスター ページ コンテンツ プレース ホルダーとは何かが 1 つ作成方法変更する方法、マスター ページが自動的に反映されます、関連するコンテンツ ページで、マスター ページを使用する ASP.NET ページです。</span><span class="sxs-lookup"><span data-stu-id="84766-108">Namely, what are master pages, how does one create a master page, what are content place holders, how does one create an ASP.NET page that uses a master page, how modifying the master page is automatically reflected in its associated content pages, and so on.</span></span>


## <a name="introduction"></a><span data-ttu-id="84766-109">はじめに</span><span class="sxs-lookup"><span data-stu-id="84766-109">Introduction</span></span>

<span data-ttu-id="84766-110">適切に設計された web サイトの 1 つの属性は、一貫性のあるサイト全体のページ レイアウトです。</span><span class="sxs-lookup"><span data-stu-id="84766-110">One attribute of a well-designed website is a consistent site-wide page layout.</span></span> <span data-ttu-id="84766-111">たとえば、www.asp.net の web サイトを考えてみましょう。</span><span class="sxs-lookup"><span data-stu-id="84766-111">Take the www.asp.net website, for example.</span></span> <span data-ttu-id="84766-112">この記事の執筆時は、すべてのページは、上部とページの下部に同じコンテンツがします。</span><span class="sxs-lookup"><span data-stu-id="84766-112">At the time of this writing, every page has the same content at the top and bottom of the page.</span></span> <span data-ttu-id="84766-113">図 1 に示す各ページの最上位には、Microsoft のコミュニティの一覧が灰色のバーが表示されます。</span><span class="sxs-lookup"><span data-stu-id="84766-113">As Figure 1 shows, the very top of each page displays a gray bar with a list of Microsoft Communities.</span></span> <span data-ttu-id="84766-114">つまり、サイトのロゴ、言語に翻訳したサイト、およびコア セクションでは、の一覧の下にある: ホーム、概要、詳細を表示、ダウンロード、およびなどです。</span><span class="sxs-lookup"><span data-stu-id="84766-114">Beneath that is the site logo, the list of languages into which the site has been translated, and the core sections: Home, Get Started, Learn, Downloads, and so forth.</span></span> <span data-ttu-id="84766-115">同様に、ページの下部には、www.asp.net、著作権、およびプライバシーに関する声明へのリンクで、広告に関する情報が含まれます。</span><span class="sxs-lookup"><span data-stu-id="84766-115">Likewise, the bottom of the page includes information about advertising on www.asp.net, a copyright statement, and a link to the privacy statement.</span></span>


<span data-ttu-id="84766-116">[![Www.asp.net の web サイトは、すべてのページにわたって一貫したルック アンド フィールを採用します。](creating-a-site-wide-layout-using-master-pages-vb/_static/image2.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="84766-116">[![The www.asp.net Website Employs a Consistent Look and Feel Across All Pages](creating-a-site-wide-layout-using-master-pages-vb/_static/image2.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image1.png)</span></span>

<span data-ttu-id="84766-117">**図 01**: www.asp.net の web サイトを使用して、一貫した参照と思われる間でのすべてのページ ([フルサイズのイメージを表示するをクリックして](creating-a-site-wide-layout-using-master-pages-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="84766-117">**Figure 01**: The www.asp.net Website Employs a Consistent Look and Feel Across All Pages  ([Click to view full-size image](creating-a-site-wide-layout-using-master-pages-vb/_static/image3.png))</span></span>


<span data-ttu-id="84766-118">適切に設計されたサイトの別の属性は、簡単に使用するサイトの外観を変更できます。</span><span class="sxs-lookup"><span data-stu-id="84766-118">Another attribute of a well-designed site is the ease with which the site's appearance can be changed.</span></span> <span data-ttu-id="84766-119">図 1 は 2008 年 3 月、時点で www.asp.net のホーム ページを示していますが、ルック アンド フィールをここで、このチュートリアルの文書間変更可能性があります。</span><span class="sxs-lookup"><span data-stu-id="84766-119">Figure 1 shows the www.asp.net homepage as of March 2008, but between now and this tutorial's publication, the look and feel may have changed.</span></span> <span data-ttu-id="84766-120">おそらく、上部にメニュー項目には、MVC フレームワークの新しいセクションが含まれますが展開されます。</span><span class="sxs-lookup"><span data-stu-id="84766-120">Perhaps the menu items along the top will expand to include a new section for the MVC framework.</span></span> <span data-ttu-id="84766-121">またはおそらくさまざまな色、フォント、およびレイアウトを大幅に新たに設計されません出現します。</span><span class="sxs-lookup"><span data-stu-id="84766-121">Or maybe a radically new design with different colors, fonts, and layout will be unveiled.</span></span> <span data-ttu-id="84766-122">サイト全体にこのような変更を適用すると、サイトを構成する web ページの数千の変更が不要な高速で単純な処理をする必要があります。</span><span class="sxs-lookup"><span data-stu-id="84766-122">Applying such changes to the entire site should be a fast and simple process that does not require modifying the thousands of web pages that make up the site.</span></span>

<span data-ttu-id="84766-123">使用すると考えられる ASP.NET でサイト全体のページ テンプレートの作成は*マスター ページ*です。</span><span class="sxs-lookup"><span data-stu-id="84766-123">Creating a site-wide page template in ASP.NET is possible through the use of *master pages*.</span></span> <span data-ttu-id="84766-124">簡単に言うと、マスター ページでは、特殊な種類のすべての間で共通するマークアップを定義する ASP.NET ページ*コンテンツ ページ*はコンテンツのページ コンテンツ ページごとにカスタマイズ可能な領域とします。</span><span class="sxs-lookup"><span data-stu-id="84766-124">In a nutshell, a master page is a special type of ASP.NET page that defines the markup that is common among all *content pages* as well as regions that are customizable on a content page-by-content page basis.</span></span> <span data-ttu-id="84766-125">(コンテンツ ページとは、マスター ページにバインドされている ASP.NET ページのことです)。マスター ページのレイアウトや書式設定が変更されたときにそのコンテンツ ページの出力のすべてが同様に直ちに更新される、されるため、更新し、1 つのファイル (つまり、マスター ページ) の配置と同じくらい簡単サイト全体の外観の変更を適用します。</span><span class="sxs-lookup"><span data-stu-id="84766-125">(A content page is an ASP.NET page that is bound to the master page.) Whenever a master page's layout or formatting is changed, all of its content pages' output is likewise immediately updated, which makes applying site-wide appearance changes as easy as updating and deploying a single file (namely, the master page).</span></span>

<span data-ttu-id="84766-126">これは、一連のマスター ページの使用方法について説明するチュートリアルの最初のチュートリアルです。</span><span class="sxs-lookup"><span data-stu-id="84766-126">This is the first tutorial in a series of tutorials that explore using master pages.</span></span> <span data-ttu-id="84766-127">このチュートリアル シリーズの過程では。</span><span class="sxs-lookup"><span data-stu-id="84766-127">Over the course of this tutorial series we:</span></span>

- <span data-ttu-id="84766-128">マスター ページと、対応するコンテンツ ページの作成を調べる</span><span class="sxs-lookup"><span data-stu-id="84766-128">Examine creating master pages and their associated content pages,</span></span>
- <span data-ttu-id="84766-129">さまざまなヒント、テクニック、およびトラップの説明します。</span><span class="sxs-lookup"><span data-stu-id="84766-129">Discuss a variety of tips, tricks, and traps,</span></span>
- <span data-ttu-id="84766-130">マスター ページよくある落とし穴を特定し、回避策を調べる</span><span class="sxs-lookup"><span data-stu-id="84766-130">Identify common master page pitfalls and explore workarounds,</span></span>
- <span data-ttu-id="84766-131">マスター ページ コンテンツ ページと逆からへのアクセス方法を参照してください。</span><span class="sxs-lookup"><span data-stu-id="84766-131">See how to access the master page from a content page and vice-a-versa,</span></span>
- <span data-ttu-id="84766-132">実行時に、コンテンツ ページのマスター ページを指定する方法について説明し、</span><span class="sxs-lookup"><span data-stu-id="84766-132">Learn how to specify a content page's master page at runtime, and</span></span>
- <span data-ttu-id="84766-133">マスター ページのトピックは他の詳細。</span><span class="sxs-lookup"><span data-stu-id="84766-133">Other advanced master page topics.</span></span>

<span data-ttu-id="84766-134">これらのチュートリアルは、簡潔なは、スクリーン ショットが多いプロセスを視覚的に順番の詳細な手順についての提供に特化しています。</span><span class="sxs-lookup"><span data-stu-id="84766-134">These tutorials are geared to be concise and provide step-by-step instructions with plenty of screen shots to walk you through the process visually.</span></span> <span data-ttu-id="84766-135">各チュートリアルは、c# および Visual Basic バージョンで利用可能な使用される完全なコードのダウンロードが含まれています。</span><span class="sxs-lookup"><span data-stu-id="84766-135">Each tutorial is available in C# and Visual Basic versions and includes a download of the complete code used.</span></span>

<span data-ttu-id="84766-136">このスタートとなったチュートリアルは、マスター ページの基本を確認を開始します。</span><span class="sxs-lookup"><span data-stu-id="84766-136">This inaugural tutorial starts with a look at master page basics.</span></span> <span data-ttu-id="84766-137">マスター ページと Visual Web Developer を使用して、関連するコンテンツ ページの作成について見て、およびマスター ページへの変更がそのコンテンツ ページですぐに反映される方法を参照してください。 おマスター ページの動作について説明します。</span><span class="sxs-lookup"><span data-stu-id="84766-137">We discuss how master pages work, look at creating a master page and associated content pages using Visual Web Developer, and see how changes to a master page are immediately reflected in its content pages.</span></span> <span data-ttu-id="84766-138">開始しましょう!</span><span class="sxs-lookup"><span data-stu-id="84766-138">Let's get started!</span></span>

## <a name="understanding-how-master-pages-work"></a><span data-ttu-id="84766-139">マスター ページの動作を理解します。</span><span class="sxs-lookup"><span data-stu-id="84766-139">Understanding How Master Pages Work</span></span>

<span data-ttu-id="84766-140">一貫性のあるサイト全体のページ レイアウトと web サイトを構築するには、各 web ページがそのカスタム コンテンツに加えて共通の書式設定マークアップを生成することが必要です。</span><span class="sxs-lookup"><span data-stu-id="84766-140">Building a website with a consistent site-wide page layout requires that each web page emit common formatting markup in addition to its custom content.</span></span> <span data-ttu-id="84766-141">たとえば、www.asp.net の各チュートリアルやフォーラムの投稿では、独自の一意のコンテンツがありますが、これらのページの各もレンダリング一連の共通`<div>`の最上位のセクションのリンクを表示する要素: Home、開始、学習、およびなどです。</span><span class="sxs-lookup"><span data-stu-id="84766-141">For example, while each tutorial or forum post on www.asp.net have their own unique content, each of these pages also render a series of common `<div>` elements that display the top-level section links: Home, Get Started, Learn, and so on.</span></span>

<span data-ttu-id="84766-142">さまざまな一貫したルック アンド フィールで web ページを作成するための方法があります。</span><span class="sxs-lookup"><span data-stu-id="84766-142">There are a variety of techniques for creating web pages with a consistent look and feel.</span></span> <span data-ttu-id="84766-143">単純な手法は、単にコピーして、すべての web ページに共通のレイアウトのマークアップを貼り付けますが、このアプローチにはマイナス面の数。</span><span class="sxs-lookup"><span data-stu-id="84766-143">A naive approach is to simply copy and paste the common layout markup into all web pages, but this approach has a number of downsides.</span></span> <span data-ttu-id="84766-144">まず、新しいページが作成されるたびに、コピーして共有のコンテンツをページに貼り付けますことを忘れないでください。</span><span class="sxs-lookup"><span data-stu-id="84766-144">For starters, every time a new page is created, you must remember to copy and paste the shared content into the page.</span></span> <span data-ttu-id="84766-145">このようなコピーと貼り付け操作はエラー、誤っての新しいページに共有マークアップのサブセットのみをコピーする場合があります。</span><span class="sxs-lookup"><span data-stu-id="84766-145">Such copying and pasting operations are ripe for error as you may accidentally copy only a subset of the shared markup into a new page.</span></span> <span data-ttu-id="84766-146">入れたら、このアプローチにより、既存のサイト全体の外観を実際のペインの新しいルック アンド フィールを使用するために、サイト内の各単一ページを編集する必要があるため、新しいものに置き換えます。</span><span class="sxs-lookup"><span data-stu-id="84766-146">And to top it off, this approach makes replacing the existing site-wide appearance with a new one a real pain because every single page in the site must be edited in order to use the new look and feel.</span></span>

<span data-ttu-id="84766-147">ASP.NET version 2.0 では前のページで一般的なマークアップを配置することがよく開発者[ユーザー コントロール](https://msdn.microsoft.com/library/y6wb1a0e.aspx)され、各ページにこれらのユーザー コントロールを追加します。</span><span class="sxs-lookup"><span data-stu-id="84766-147">Prior to ASP.NET version 2.0, page developers often placed common markup in [User Controls](https://msdn.microsoft.com/library/y6wb1a0e.aspx) and then added these User Controls to each and every page.</span></span> <span data-ttu-id="84766-148">この方法では、ページの開発者が手動ですべての新しいページにユーザー コントロールを追加するが、変更する一般的なマークアップを更新するときにユーザー コントロールだけが必要なために、サイト全体の変更を簡単に許可が必要です。</span><span class="sxs-lookup"><span data-stu-id="84766-148">This approach required that the page developer remember to manually add the User Controls to every new page, but allowed for easier site-wide modifications because when updating the common markup only the User Controls needed to be modified.</span></span> <span data-ttu-id="84766-149">残念ながら、Visual Studio .NET 2002 および 2003 のバージョンの Visual Studio は、1.x の ASP.NET アプリケーションのユーザー コントロールをデザイン ビューで灰色のボックスとしてレンダリングの作成に使用します。</span><span class="sxs-lookup"><span data-stu-id="84766-149">Unfortunately, Visual Studio .NET 2002 and 2003 - the versions of Visual Studio used to create ASP.NET 1.x applications - rendered User Controls in the Design view as gray boxes.</span></span> <span data-ttu-id="84766-150">そのため、このアプローチを使用しているページの開発者は、いない WYSIWYG デザイン時環境をご利用いただけますでした。</span><span class="sxs-lookup"><span data-stu-id="84766-150">Consequently, page developers using this approach did not enjoy a WYSIWYG design-time environment.</span></span>

<span data-ttu-id="84766-151">ユーザー コントロールを使用する場合の欠点は、ASP.NET version 2.0 および Visual Studio 2005 での導入で対処された*マスター ページ*です。</span><span class="sxs-lookup"><span data-stu-id="84766-151">The shortcomings of using User Controls were addressed in ASP.NET version 2.0 and Visual Studio 2005 with the introduction of *master pages*.</span></span> <span data-ttu-id="84766-152">マスター ページは、特殊な種類の両方のサイト全体のマークアップを定義する ASP.NET ページと*領域*関連付けられている、*ページのコンテンツ*カスタムのマークアップを定義します。</span><span class="sxs-lookup"><span data-stu-id="84766-152">A master page is a special type of ASP.NET page that defines both the site-wide markup and the *regions* where associated *content pages* define their custom markup.</span></span> <span data-ttu-id="84766-153">手順 1. でよう、これらの領域は、プレース ホルダー コントロールによって定義されます。</span><span class="sxs-lookup"><span data-stu-id="84766-153">As we will see in Step 1, these regions are defined by ContentPlaceHolder controls.</span></span> <span data-ttu-id="84766-154">ContentPlaceHolder コントロールは、単にカスタム コンテンツを挿入して、コンテンツ ページで、マスター ページのコントロールの階層内の位置を表します。</span><span class="sxs-lookup"><span data-stu-id="84766-154">The ContentPlaceHolder control simply denotes a position in the master page's control hierarchy where custom content can be injected by a content page.</span></span>

> [!NOTE]
> <span data-ttu-id="84766-155">ASP.NET version 2.0 以降には、主要な概念とマスター ページの機能が変更されていません。</span><span class="sxs-lookup"><span data-stu-id="84766-155">The core concepts and functionality of master pages has not changed since ASP.NET version 2.0.</span></span> <span data-ttu-id="84766-156">ただし、Visual Studio 2008 では、Visual Studio 2005 で欠けている機能、入れ子になったマスター ページのデザイン時サポートを提供しています。</span><span class="sxs-lookup"><span data-stu-id="84766-156">However, Visual Studio 2008 offers design-time support for nested master pages, a feature that was lacking in Visual Studio 2005.</span></span> <span data-ttu-id="84766-157">入れ子になったマスター ページを使用して、今後のチュートリアルで見ていきます。</span><span class="sxs-lookup"><span data-stu-id="84766-157">We will look at using nested master pages in a future tutorial.</span></span>


<span data-ttu-id="84766-158">図 2 は、www.asp.net のマスター ページの外観を示しています。</span><span class="sxs-lookup"><span data-stu-id="84766-158">Figure 2 shows what the master page for www.asp.net might look like.</span></span> <span data-ttu-id="84766-159">マスター ページでは、中央左に、web ページごとに固有のコンテンツが配置されている ContentPlaceHolder だけでなくサイト全体の一般的なレイアウトの上部、下部、およびすべてのページの右側にマークアップ - が定義に注意してください。</span><span class="sxs-lookup"><span data-stu-id="84766-159">Note that the master page defines the common site-wide layout - the markup at the top, bottom, and right of every page - as well as a ContentPlaceHolder in the middle-left, where the unique content for each individual web page is located.</span></span>


![マスター ページ コンテンツ ページ コンテンツ ページごとに、サイト全体のレイアウトや編集可能な領域を定義します。](creating-a-site-wide-layout-using-master-pages-vb/_static/image4.png)

<span data-ttu-id="84766-161">**図 02**: マスター ページ コンテンツ ページ コンテンツ ページごとに、サイト全体のレイアウトや編集可能な領域を定義します。</span><span class="sxs-lookup"><span data-stu-id="84766-161">**Figure 02**: A Master Page Defines the Site-Wide Layout and the Regions Editable on a Content Page-by-Content Page Basis</span></span>


<span data-ttu-id="84766-162">マスター ページを定義した後は、チェック ボックスのチェック マークを新規の ASP.NET ページにバインドすることができます。</span><span class="sxs-lookup"><span data-stu-id="84766-162">Once a master page has been defined it can be bound to new ASP.NET pages through the tick of a checkbox.</span></span> <span data-ttu-id="84766-163">コンテンツ ページと呼ばれる - これらの ASP.NET ページには、マスター ページの ContentPlaceHolder のコントロールの各コンテンツ コントロールが含まれます。</span><span class="sxs-lookup"><span data-stu-id="84766-163">These ASP.NET pages - called content pages - include a Content control for each of the master page's ContentPlaceHolder controls.</span></span> <span data-ttu-id="84766-164">コンテンツ ページがブラウザーからアクセスしたときに、ASP.NET エンジンは、マスター ページのコントロールの階層構造を作成し、コンテンツ ページのコントロールの階層では、該当する場所に挿入します。</span><span class="sxs-lookup"><span data-stu-id="84766-164">When the content page is visited through a browser the ASP.NET engine creates the master page's control hierarchy and injects the content page's control hierarchy into the appropriate places.</span></span> <span data-ttu-id="84766-165">この結合されたコントロールの階層が表示され、結果の HTML がエンドユーザーのブラウザーに返されます。</span><span class="sxs-lookup"><span data-stu-id="84766-165">This combined control hierarchy is rendered and the resulting HTML is returned to the end user's browser.</span></span> <span data-ttu-id="84766-166">したがって、コンテンツ ページでは、一般的なマークアップをマスター ページ プレース ホルダー コントロールの外部で定義されていると、独自のコンテンツ コントロール内で定義されたページ固有のマークアップの両方を出力します。</span><span class="sxs-lookup"><span data-stu-id="84766-166">Consequently, the content page emits both the common markup defined in its master page outside of the ContentPlaceHolder controls and the page-specific markup defined within its own Content controls.</span></span> <span data-ttu-id="84766-167">図 3 は、この概念を示します。</span><span class="sxs-lookup"><span data-stu-id="84766-167">Figure 3 illustrates this concept.</span></span>


<span data-ttu-id="84766-168">[![マスター ページに、要求されたページのマークアップを定着します。](creating-a-site-wide-layout-using-master-pages-vb/_static/image6.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="84766-168">[![The Requested Page's Markup is Fused into the Master Page](creating-a-site-wide-layout-using-master-pages-vb/_static/image6.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image5.png)</span></span>

<span data-ttu-id="84766-169">**図 03**: マスター ページに、要求されたページのマークアップを定着 ([フルサイズのイメージを表示するをクリックして](creating-a-site-wide-layout-using-master-pages-vb/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="84766-169">**Figure 03**: The Requested Page's Markup is Fused into the Master Page  ([Click to view full-size image](creating-a-site-wide-layout-using-master-pages-vb/_static/image7.png))</span></span>


<span data-ttu-id="84766-170">マスター ページの動作に説明したが、これで、マスター ページと Visual Web Developer を使用して、関連するコンテンツ ページの作成を見てをみましょう。</span><span class="sxs-lookup"><span data-stu-id="84766-170">Now that we have discussed how master pages work, let's take a look at creating a master page and associated content pages using Visual Web Developer.</span></span>

> [!NOTE]
> <span data-ttu-id="84766-171">最も幅の広い可能な対象ユーザーを達成するために構築するこのチュートリアルの系列全体での ASP.NET web サイトが作成されますの Visual Studio 2008 では、Microsoft の無料版で ASP.NET 3.5 を使用して[Visual Web Developer 2008](https://www.microsoft.com/express/vwd/)です。</span><span class="sxs-lookup"><span data-stu-id="84766-171">In order to reach the widest possible audience, the ASP.NET website we build throughout this tutorial series will be created using ASP.NET 3.5 with Microsoft's free version of Visual Studio 2008, [Visual Web Developer 2008](https://www.microsoft.com/express/vwd/).</span></span> <span data-ttu-id="84766-172">されませんがまだ心配しないで ASP.NET 3.5 にアップグレードの場合は、これらのチュートリアルの作業で説明する概念と同様 ASP.NET 2.0 および Visual Studio 2005。</span><span class="sxs-lookup"><span data-stu-id="84766-172">If you have not yet upgraded to ASP.NET 3.5, don't worry - the concepts discussed in these tutorials work equally well with ASP.NET 2.0 and Visual Studio 2005.</span></span> <span data-ttu-id="84766-173">ただし、デモ アプリケーションによっては、.NET Framework version 3.5; に新機能を使用できます。3.5 に固有の機能を使用している場合は、バージョン 2.0 では同様の機能を実装する方法について説明する注記を含めます。</span><span class="sxs-lookup"><span data-stu-id="84766-173">However, some demo applications may use features new to the .NET Framework version 3.5; when 3.5-specific features are used, I include a note that discusses how to implement similar functionality in version 2.0.</span></span> <span data-ttu-id="84766-174">その結果、.NET Framework version 3.5 では、チュートリアルの各ターゲットからの使用可能なデモ アプリケーションをダウンロードすることに留意してくださいは、 `Web.config` 3.5 に固有の構成要素を含むファイルです。</span><span class="sxs-lookup"><span data-stu-id="84766-174">Do keep in mind that the demo applications available for download from each tutorial target the .NET Framework version 3.5, which results in a `Web.config` file that includes 3.5-specific configuration elements.</span></span> <span data-ttu-id="84766-175">最初から 3.5 固有のマークアップを削除しないで手短、.NET 3.5 をインストール、ダウンロード可能な web アプリケーションでは、コンピューターにまだがある場合は機能しません`Web.config`です。</span><span class="sxs-lookup"><span data-stu-id="84766-175">Long story short, if you have yet to install .NET 3.5 on your computer then the downloadable web application will not work without first removing the 3.5-specific markup from `Web.config`.</span></span> <span data-ttu-id="84766-176">参照してください[分解 ASP.NET Version 3.5 の`Web.config`ファイル](http://www.4guysfromrolla.com/articles/121207-1.aspx)詳細については、このトピックの内容。</span><span class="sxs-lookup"><span data-stu-id="84766-176">See [Dissecting ASP.NET Version 3.5's `Web.config` File](http://www.4guysfromrolla.com/articles/121207-1.aspx) for more information on this topic.</span></span>


## <a name="step-1-creating-a-master-page"></a><span data-ttu-id="84766-177">手順 1: マスター ページの作成</span><span class="sxs-lookup"><span data-stu-id="84766-177">Step 1: Creating a Master Page</span></span>

<span data-ttu-id="84766-178">作成およびマスター ページとコンテンツ ページを使用して調べることができます、前に、ASP.NET web サイトが最初に必要です。</span><span class="sxs-lookup"><span data-stu-id="84766-178">Before we can explore creating and using master and content pages, we first need an ASP.NET website.</span></span> <span data-ttu-id="84766-179">まず、新しいファイル システムに基づく ASP.NET web サイトを作成します。</span><span class="sxs-lookup"><span data-stu-id="84766-179">Start by creating a new file system-based ASP.NET website.</span></span> <span data-ttu-id="84766-180">これを実現する、Visual Web Developer を起動して、ファイル メニューに移動し、新しい Web サイト ダイアログを表示する新しい Web サイトを選択ボックス (図 4 を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="84766-180">To accomplish this, launch Visual Web Developer and then go to the File menu and choose New Web Site, displaying the New Web Site dialog box (see Figure 4).</span></span> <span data-ttu-id="84766-181">ASP.NET Web サイト テンプレートを選択して、場所ドロップダウン リストをファイル システムに設定、web サイトを配置するフォルダーを選択および Visual Basic 言語に設定します。</span><span class="sxs-lookup"><span data-stu-id="84766-181">Choose the ASP.NET Web Site template, set the Location drop-down list to File System, choose a folder to place the web site, and set the language to Visual Basic.</span></span> <span data-ttu-id="84766-182">これで新しい web サイトが作成されます、 `Default.aspx` ASP.NET ページ、`App_Data`フォルダー、および`Web.config`ファイル。</span><span class="sxs-lookup"><span data-stu-id="84766-182">This will create a new web site with a `Default.aspx` ASP.NET page, an `App_Data` folder, and a `Web.config` file.</span></span>

> [!NOTE]
> <span data-ttu-id="84766-183">Visual Studio には、プロジェクト管理の 2 つのモードがサポートされています。 Web サイト プロジェクトと Web アプリケーション プロジェクト。</span><span class="sxs-lookup"><span data-stu-id="84766-183">Visual Studio supports two modes of project management: Web Site Projects and Web Application Projects.</span></span> <span data-ttu-id="84766-184">Web サイト プロジェクトが Web アプリケーション プロジェクトを模倣プロジェクト アーキテクチャ Visual Studio .NET 2002年/2003 - プロジェクト ファイルが含まれていて、プロジェクトのソース コードに配置されている単一のアセンブリにコンパイルされ、プロジェクト ファイルの不足している、 `/bin`フォルダーです。</span><span class="sxs-lookup"><span data-stu-id="84766-184">Web Site Projects lack a project file, whereas Web Application Projects mimic the project architecture in Visual Studio .NET 2002/2003 - they include a project file and compile the project's source code into a single assembly, which is placed in the `/bin` folder.</span></span> <span data-ttu-id="84766-185">Visual Studio 2005 最初に唯一のサポートされている Web サイト プロジェクト、Web アプリケーション プロジェクト モデルは、Service Pack 1; 再導入されましたが、Visual Studio 2008 には、両方のプロジェクト モデルが用意されています。</span><span class="sxs-lookup"><span data-stu-id="84766-185">Visual Studio 2005 initially only supported Web Site Projects, although the Web Application Project model was reintroduced with Service Pack 1; Visual Studio 2008 offers both project models.</span></span> <span data-ttu-id="84766-186">Visual Web Developer 2005 および 2008 のエディションはサポート Web サイト プロジェクト。</span><span class="sxs-lookup"><span data-stu-id="84766-186">The Visual Web Developer 2005 and 2008 editions, however, only support Web Site Projects.</span></span> <span data-ttu-id="84766-187">このチュートリアル シリーズのマイ デモ Web サイト プロジェクトのモデルを使用します。</span><span class="sxs-lookup"><span data-stu-id="84766-187">I use the Web Site Project model for my demos in this tutorial series.</span></span> <span data-ttu-id="84766-188">Express 以外のエディションを使用しているし、使用するかどうか、 [Web アプリケーション プロジェクト モデル](https://msdn.microsoft.com/library/aa730880(vs.80).aspx)代わりに、自由にこれがあることをいくつかの相違点、画面とではなく実行する必要があります手順で表示されるものの間に注意してください、スクリーン ショットに表示し、これらのチュートリアルで説明する手順。</span><span class="sxs-lookup"><span data-stu-id="84766-188">If you are using a non-Express edition and want to use the [Web Application Project model](https://msdn.microsoft.com/library/aa730880(vs.80).aspx) instead, feel free to do so but be aware that there may be some discrepancies between what you see on your screen and the steps you must take versus the screen shots shown and instructions provided in these tutorials.</span></span>


<span data-ttu-id="84766-189">[![新しいファイル システムに基づいた Web サイトを作成します。](creating-a-site-wide-layout-using-master-pages-vb/_static/image9.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="84766-189">[![Create a New File System-Based Web Site](creating-a-site-wide-layout-using-master-pages-vb/_static/image9.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image8.png)</span></span>

<span data-ttu-id="84766-190">**図 04**: New File System-Based Web サイトの作成 ([フルサイズのイメージを表示するをクリックして](creating-a-site-wide-layout-using-master-pages-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="84766-190">**Figure 04**: Create a New File System-Based Web Site  ([Click to view full-size image](creating-a-site-wide-layout-using-master-pages-vb/_static/image10.png))</span></span>


<span data-ttu-id="84766-191">次に、プロジェクト名を右クリックし、新しい項目の追加 を選択して、マスター ページのテンプレートを選択すると、ルート ディレクトリ内のサイトにマスター ページを追加します。</span><span class="sxs-lookup"><span data-stu-id="84766-191">Next, add a master page to the site in the root directory by right-clicking on the Project name, choosing Add New Item, and selecting the Master Page template.</span></span> <span data-ttu-id="84766-192">マスター ページが、拡張子で終わることに注意してください`.master`です。</span><span class="sxs-lookup"><span data-stu-id="84766-192">Note that master pages end with the extension `.master`.</span></span> <span data-ttu-id="84766-193">この新しいマスター ページの名前`Site.master`追加 をクリックします。</span><span class="sxs-lookup"><span data-stu-id="84766-193">Name this new master page `Site.master` and click Add.</span></span>


<span data-ttu-id="84766-194">[![マスター ページを追加するという名前の web サイトに Site.master](creating-a-site-wide-layout-using-master-pages-vb/_static/image12.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="84766-194">[![Add a Master Page Named Site.master to the Website](creating-a-site-wide-layout-using-master-pages-vb/_static/image12.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image11.png)</span></span>

<span data-ttu-id="84766-195">**図 05**: マスター ページの名前付きの追加`Site.master`、web サイトに ([フルサイズのイメージを表示するをクリックして](creating-a-site-wide-layout-using-master-pages-vb/_static/image13.png))</span><span class="sxs-lookup"><span data-stu-id="84766-195">**Figure 05**: Add a Master Page Named `Site.master` to the Website  ([Click to view full-size image](creating-a-site-wide-layout-using-master-pages-vb/_static/image13.png))</span></span>


<span data-ttu-id="84766-196">Visual Web Developer で新しいマスター ページ ファイルを追加すると、次の宣言型マークアップ マスター ページが作成されます。</span><span class="sxs-lookup"><span data-stu-id="84766-196">Adding a new master page file through Visual Web Developer creates a master page with the following declarative markup:</span></span>

[!code-aspx[Main](creating-a-site-wide-layout-using-master-pages-vb/samples/sample1.aspx)]

<span data-ttu-id="84766-197">宣言型マークアップの最初の行は、 [ `@Master`ディレクティブ](https://msdn.microsoft.com/library/ms228176.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="84766-197">The first line in the declarative markup is the [`@Master` directive](https://msdn.microsoft.com/library/ms228176.aspx).</span></span> <span data-ttu-id="84766-198">`@Master`ディレクティブがに似ていますが、 [ `@Page`ディレクティブ](https://msdn.microsoft.com/library/ydy4x04a.aspx)ASP.NET ページに表示されます。</span><span class="sxs-lookup"><span data-stu-id="84766-198">The `@Master` directive is similar to the [`@Page` directive](https://msdn.microsoft.com/library/ydy4x04a.aspx) that appears in ASP.NET pages.</span></span> <span data-ttu-id="84766-199">これは、サーバー側の言語 (VB) と、マスター ページの分離コード クラスの継承と場所に関する情報を定義します。</span><span class="sxs-lookup"><span data-stu-id="84766-199">It defines the server-side language (VB) and information about the location and inheritance of the master page's code-behind class.</span></span>

<span data-ttu-id="84766-200">`DOCTYPE`ページの宣言型マークアップが下に表示し、`@Master`ディレクティブです。</span><span class="sxs-lookup"><span data-stu-id="84766-200">The `DOCTYPE` and the page's declarative markup appears beneath the `@Master` directive.</span></span> <span data-ttu-id="84766-201">このページには、静的な HTML と共に次の 4 つのサーバー側コントロールが含まれます。</span><span class="sxs-lookup"><span data-stu-id="84766-201">The page includes static HTML along with four server-side controls:</span></span>

- <span data-ttu-id="84766-202">**Web フォーム (、 `<form runat="server">`)** - すべての ASP.NET ページは、通常 Web フォームであるし、マスター ページは、Web コントロールを Web フォームに表示することを含めることができますので、マスター ページ (ではなく電子メールへの Web フォームの追加を Web フォームを追加することを確認するためコンテンツ ページ)。</span><span class="sxs-lookup"><span data-stu-id="84766-202">**A Web Form (the `<form runat="server">`)** - because all ASP.NET pages typically have a Web Form - and because the master page may include Web controls that must appear within a Web Form - be sure to add the Web Form to your master page (rather than adding a Web Form to each content page).</span></span>
- <span data-ttu-id="84766-203">**という名前のプレース ホルダー コントロール`ContentPlaceHolder1`**  -この ContentPlaceHolder コントロールは、Web フォーム内で表示され、コンテンツ ページのユーザー インターフェイスの領域として機能します。</span><span class="sxs-lookup"><span data-stu-id="84766-203">**A ContentPlaceHolder control named `ContentPlaceHolder1`** - this ContentPlaceHolder control appears within the Web Form and serves as the region for the content page's user interface.</span></span>
- <span data-ttu-id="84766-204">**サーバー側`<head>`要素**-`<head>`要素には、`runat="server"`属性に、サーバー側コードからアクセスできるようにします。</span><span class="sxs-lookup"><span data-stu-id="84766-204">**A server-side `<head>` element** - the `<head>` element has the `runat="server"` attribute, making it accessible through server-side code.</span></span> <span data-ttu-id="84766-205">`<head>`要素はこの方法で実装ができるように、ページのタイトルおよびその他の`<head>`-関連するマークアップを追加またはプログラムで調整することがあります。</span><span class="sxs-lookup"><span data-stu-id="84766-205">The `<head>` element is implemented this way so that the page's title and other `<head>`-related markup may be added or adjusted programmatically.</span></span> <span data-ttu-id="84766-206">たとえば、ASP.NET ページのプロパティに設定`Title`プロパティが変更された、`<title>`によってレンダリングされる要素、`<head>`サーバー コントロールです。</span><span class="sxs-lookup"><span data-stu-id="84766-206">For example, setting an ASP.NET page's `Title` property changes the `<title>` element rendered by the `<head>` server control.</span></span>
- <span data-ttu-id="84766-207">**という名前のプレース ホルダー コントロール`head`**  -内でこのプレース ホルダー コントロールが表示されます、`<head>`サーバーを制御し、宣言的にコンテンツを追加するために使用する、`<head>`要素。</span><span class="sxs-lookup"><span data-stu-id="84766-207">**A ContentPlaceHolder control named `head`** - this ContentPlaceHolder control appears within the `<head>` server control and can be used to declaratively add content to the `<head>` element.</span></span>

<span data-ttu-id="84766-208">この既定のマスター ページの宣言型マークアップは、マスター ページをデザインするための開始点として機能します。</span><span class="sxs-lookup"><span data-stu-id="84766-208">This default master page declarative markup serves as a starting point for designing your own master pages.</span></span> <span data-ttu-id="84766-209">自由に HTML を編集するか、マスター ページに追加の Web コントロールまたは contentplaceholders を追加できます。</span><span class="sxs-lookup"><span data-stu-id="84766-209">Feel free to edit the HTML or to add additional Web controls or ContentPlaceHolders to the master page.</span></span>

> [!NOTE]
> <span data-ttu-id="84766-210">マスター ページをデザインすることを確認してし、マスター ページには、Web フォームが含まれています。 この Web フォーム内でプレース ホルダーを制御するには、少なくとも 1 つが表示されます。</span><span class="sxs-lookup"><span data-stu-id="84766-210">When designing a master page make sure that the master page contains a Web Form and that at least one ContentPlaceHolder control appears within this Web Form.</span></span>


### <a name="creating-a-simple-site-layout"></a><span data-ttu-id="84766-211">単純なサイトのレイアウトを作成します。</span><span class="sxs-lookup"><span data-stu-id="84766-211">Creating a Simple Site Layout</span></span>

<span data-ttu-id="84766-212">拡張しましょう`Site.master`のすべてのページを共有しているサイトのレイアウトを作成する既定の宣言型マークアップ: 共通ヘッダー; ナビゲーション、ニュースとその他のサイト全体のコンテンツです。"Microsoft ASP.NET での電源"アイコンを表示するページ フッターと左の列です。</span><span class="sxs-lookup"><span data-stu-id="84766-212">Let's expand `Site.master`'s default declarative markup to create a site layout where all pages share: a common header; a left column with navigation, news and other site-wide content; and a footer that displays the "Powered by Microsoft ASP.NET" icon.</span></span> <span data-ttu-id="84766-213">図 6 は、ブラウザーを使って、コンテンツ ページのいずれかを表示するときに、マスター ページの最終結果を示します。</span><span class="sxs-lookup"><span data-stu-id="84766-213">Figure 6 shows the end result of the master page when one of its content pages is viewed through a browser.</span></span> <span data-ttu-id="84766-214">図 6 に赤い丸領域にアクセスしたページに固有です (`Default.aspx`) です。 他のコンテンツはマスター ページで定義され、したがって一貫性のあるすべてのコンテンツ ページで、します。</span><span class="sxs-lookup"><span data-stu-id="84766-214">The red circled region in Figure 6 is specific to the page being visited (`Default.aspx`); the other content is defined in the master page and therefore consistent across all content pages.</span></span>


<span data-ttu-id="84766-215">[![マスター ページ上、左、および下の部分を表すマークアップを定義します。](creating-a-site-wide-layout-using-master-pages-vb/_static/image15.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="84766-215">[![The Master Page Defines the Markup for the Top, Left, and Bottom Portions](creating-a-site-wide-layout-using-master-pages-vb/_static/image15.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image14.png)</span></span>

<span data-ttu-id="84766-216">**図 06**: マスター ページ上、左、および下の部分を表すマークアップを定義する ([フルサイズのイメージを表示するをクリックして](creating-a-site-wide-layout-using-master-pages-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="84766-216">**Figure 06**: The Master Page Defines the Markup for the Top, Left, and Bottom Portions  ([Click to view full-size image](creating-a-site-wide-layout-using-master-pages-vb/_static/image16.png))</span></span>


<span data-ttu-id="84766-217">図 6 に示すようにサイトのレイアウトを実現するために更新することで開始、`Site.master`マスター ページを次の宣言型マークアップが含まれるようにします。</span><span class="sxs-lookup"><span data-stu-id="84766-217">To achieve the site layout shown in Figure 6, start by updating the `Site.master` master page so that it contains the following declarative markup:</span></span>

[!code-aspx[Main](creating-a-site-wide-layout-using-master-pages-vb/samples/sample2.aspx)]

<span data-ttu-id="84766-218">マスター ページのレイアウトが、一連ので定義されている`<div>`HTML 要素です。</span><span class="sxs-lookup"><span data-stu-id="84766-218">The master page's layout is defined using a series of `<div>` HTML elements.</span></span> <span data-ttu-id="84766-219">`topContent` `<div>` 、各ページの上部に表示されるマークアップを格納中に、 `mainContent`、 `leftContent`、および`footerContent``<div>`ページのコンテンツ、左の列と、"電源がオンで Microsoft を表示するために使用されますASP.NET"アイコンでは、それぞれします。</span><span class="sxs-lookup"><span data-stu-id="84766-219">The `topContent` `<div>` contains the markup that appears at the top of each page, while the `mainContent`, `leftContent`, and `footerContent` `<div>` s are used to display the page's content, the left column, and the "Powered by Microsoft ASP.NET" icon, respectively.</span></span> <span data-ttu-id="84766-220">これらの追加に加えて`<div>`要素も変更したところ、`ID`からプライマリ ContentPlaceHolder コントロールのプロパティ`ContentPlaceHolder1`に`MainContent`です。</span><span class="sxs-lookup"><span data-stu-id="84766-220">In addition to adding these `<div>` elements, I also renamed the `ID` property of the primary ContentPlaceHolder control from `ContentPlaceHolder1` to `MainContent`.</span></span>

<span data-ttu-id="84766-221">これらのさまざまな書式設定とレイアウト規則`<div>`に要素が記述された、[カスケード スタイル シート (CSS)](http://en.wikipedia.org/wiki/Cascading_Style_Sheets)ファイル`Styles.css`、経由で指定されている、`<link>`マスター ページ内の要素`<head>`要素。</span><span class="sxs-lookup"><span data-stu-id="84766-221">The formatting and layout rules for these assorted `<div>` elements is spelled out in the [Cascading Stylesheet (CSS)](http://en.wikipedia.org/wiki/Cascading_Style_Sheets) file `Styles.css`, which is specified via a `<link>` element in the master page's `<head>` element.</span></span> <span data-ttu-id="84766-222">これらのさまざまなルール定義のそれぞれのルック アンド フィール`<div>`要素上で述べたです。</span><span class="sxs-lookup"><span data-stu-id="84766-222">These various rules define the look and feel of each `<div>` element noted above.</span></span> <span data-ttu-id="84766-223">たとえば、 `topContent` `<div>`要素は、「マスター ページ チュートリアル」のテキストとリンクが表示されたらがで指定された書式指定規則`Styles.css`次のようにします。</span><span class="sxs-lookup"><span data-stu-id="84766-223">For example, the `topContent` `<div>` element, which displays the "Master Pages Tutorials" text and link, has its formatting rules specified in `Styles.css` as follows:</span></span>

[!code-css[Main](creating-a-site-wide-layout-using-master-pages-vb/samples/sample3.css)]

<span data-ttu-id="84766-224">実行する場合、コンピューターは、このチュートリアルの付属のコードをダウンロードし、追加する必要があります、`Styles.css`ファイルをプロジェクト。</span><span class="sxs-lookup"><span data-stu-id="84766-224">If you are following along at your computer, you will need to download this tutorial's accompanying code and add the `Styles.css` file to your project.</span></span> <span data-ttu-id="84766-225">同様をという名前のフォルダーを作成する必要があります`Images`し、ダウンロードしたデモ web サイトから、"Microsoft ASP.NET での電源"アイコンをプロジェクトにコピーします。</span><span class="sxs-lookup"><span data-stu-id="84766-225">Similarly, you will also need to create a folder named `Images` and copy the "Powered by Microsoft ASP.NET" icon from the downloaded demo website to your project.</span></span>

> [!NOTE]
> <span data-ttu-id="84766-226">CSS、および web ページの書式の詳細については、この記事の範囲を超えてはします。</span><span class="sxs-lookup"><span data-stu-id="84766-226">A discussion of CSS and web page formatting is beyond the scope of this article.</span></span> <span data-ttu-id="84766-227">詳細については、CSS、チェック アウト、 [CSS チュートリアル](http://www.w3schools.com/css/default.asp)で[W3Schools.com](http://www.w3schools.com/)です。ぜひ、このチュートリアルの付属のコードをダウンロードし、CSS の設定で再生`Styles.css`さまざまな書式指定規則の効果を確認します。</span><span class="sxs-lookup"><span data-stu-id="84766-227">For more on CSS, check out the [CSS Tutorials](http://www.w3schools.com/css/default.asp) at [W3Schools.com](http://www.w3schools.com/). I also encourage you to download this tutorial's accompanying code and play with the CSS settings in `Styles.css` to see the effects of different formatting rules.</span></span>


### <a name="creating-a-master-page-using-an-existing-design-template"></a><span data-ttu-id="84766-228">既存のデザインのテンプレートを使用してマスター ページを作成します。</span><span class="sxs-lookup"><span data-stu-id="84766-228">Creating a Master Page Using an Existing Design Template</span></span>

<span data-ttu-id="84766-229">長年にわたって多数の小規模から中規模企業の ASP.NET web アプリケーションを構築しました。</span><span class="sxs-lookup"><span data-stu-id="84766-229">Over the years I've built a number of ASP.NET web applications for small- to medium-sized companies.</span></span> <span data-ttu-id="84766-230">を使用したい既存のサイトのレイアウトをいた一部のクライアント他のユーザーには、資格のあるグラフィックス デザイナーとして採用されました。</span><span class="sxs-lookup"><span data-stu-id="84766-230">Some of my clients had an existing site layout they wanted to use; others hired a competent graphics designer.</span></span> <span data-ttu-id="84766-231">いくつかでは、web サイトのレイアウトをデザインするから委託されします。</span><span class="sxs-lookup"><span data-stu-id="84766-231">A few entrusted me to design the website layout.</span></span> <span data-ttu-id="84766-232">図 6 で分かるように、web サイトのレイアウトのデザインにプログラマのマルチタスクをお勧め通常として、経理担当医師は税金 open-heart surgery 実行があるとします。</span><span class="sxs-lookup"><span data-stu-id="84766-232">As you can tell by Figure 6, tasking a programmer to design a website's layout is usually as wise as having your accountant perform open-heart surgery while your doctor does your taxes.</span></span>

<span data-ttu-id="84766-233">幸いにも、無料の HTML デザイン テンプレート innumerous の web サイトがある - Google 検索用語「無料の web サイト テンプレート」の 600万より多くの結果が返されます</span><span class="sxs-lookup"><span data-stu-id="84766-233">Fortunately, there are innumerous websites that offer free HTML design templates - Google returned more than six million results for the search term "free website templates."</span></span> <span data-ttu-id="84766-234">自分の好みの 1 つは[OpenDesigns.org](http://opendesigns.org/)です。たい web サイト テンプレートが見つかったらは、CSS ファイルとイメージを web サイト プロジェクトに追加し、マスター ページに、テンプレートの HTML を統合します。</span><span class="sxs-lookup"><span data-stu-id="84766-234">One of my favorite ones is [OpenDesigns.org](http://opendesigns.org/). Once you find a website template you like, add the CSS files and images to your website project and integrate the template's HTML into your master page.</span></span>

> [!NOTE]
> <span data-ttu-id="84766-235">Microsoft にも多数の[デザイン スタート キットのテンプレートの ASP.NET を空き](https://msdn.microsoft.com/asp.net/aa336613.aspx)Visual Studio で新しい Web サイト ダイアログ ボックスに統合します。</span><span class="sxs-lookup"><span data-stu-id="84766-235">Microsoft also offers a number of [free ASP.NET Design Start Kit Templates](https://msdn.microsoft.com/asp.net/aa336613.aspx) that integrate into the New Web Site dialog box in Visual Studio.</span></span>


## <a name="step-2-creating-associated-content-pages"></a><span data-ttu-id="84766-236">手順 2: コンテンツのページは関連付けを作成します。</span><span class="sxs-lookup"><span data-stu-id="84766-236">Step 2: Creating Associated Content Pages</span></span>

<span data-ttu-id="84766-237">作成されたマスター ページ、マスター ページにバインドされている ASP.NET ページの作成を開始する準備が整いました。</span><span class="sxs-lookup"><span data-stu-id="84766-237">With the master page created, we are ready to start creating ASP.NET pages that are bound to the master page.</span></span> <span data-ttu-id="84766-238">このようなページをいいます*コンテンツ ページ*です。</span><span class="sxs-lookup"><span data-stu-id="84766-238">Such pages are referred to as *content pages*.</span></span>

<span data-ttu-id="84766-239">プロジェクトに新しい ASP.NET ページを追加してにバインドしてみましょう、`Site.master`マスター ページ。</span><span class="sxs-lookup"><span data-stu-id="84766-239">Let's add a new ASP.NET page to the project and bind it to the `Site.master` master page.</span></span> <span data-ttu-id="84766-240">ソリューション エクスプ ローラーでプロジェクト名を右クリックし、[新しい項目の追加] オプションを選択します。</span><span class="sxs-lookup"><span data-stu-id="84766-240">Right-click on the project name in Solution Explorer and choose the Add New Item option.</span></span> <span data-ttu-id="84766-241">Web フォーム テンプレートを選択し、名前を入力します`About.aspx`、し、図 7 に示すように「マスター ページを選択」チェック ボックスを確認します。</span><span class="sxs-lookup"><span data-stu-id="84766-241">Select the Web Form template, enter the name `About.aspx`, and then check the "Select master page" checkbox as shown in Figure 7.</span></span> <span data-ttu-id="84766-242">これは選択マスター ページ ダイアログ ボックスを表示 (図 8 を参照してください) をボックスから使用するマスター ページを選択できます。</span><span class="sxs-lookup"><span data-stu-id="84766-242">Doing so will display the Select a Master Page dialog box (see Figure 8) from where you can choose the master page to use.</span></span>

> [!NOTE]
> <span data-ttu-id="84766-243">Web サイト プロジェクトのモデルではなく、Web アプリケーション プロジェクト モデルを使用して、ASP.NET web サイトを作成する場合は図 7 に示すように新しい項目の追加 ダイアログ ボックスで"Select マスター ページ"チェック ボックスは表示されません。</span><span class="sxs-lookup"><span data-stu-id="84766-243">If you created your ASP.NET website using the Web Application Project model instead of the Web Site Project model you will not see the "Select master page" checkbox in the Add New Item dialog box shown in Figure 7.</span></span> <span data-ttu-id="84766-244">コンテンツを作成するには、ページ、Web アプリケーション プロジェクトを使用してモデル化する場合は、Web フォーム テンプレートの代わりに、Web コンテンツのフォーム テンプレートを選択してください。</span><span class="sxs-lookup"><span data-stu-id="84766-244">To create a content page when using the Web Application Project model you must choose the Web Content Form template instead of the Web Form template.</span></span> <span data-ttu-id="84766-245">Web コンテンツのフォーム テンプレートを選択すると、[追加] をクリックして、図 8 に示すダイアログ ボックスが表示されますマスター ページの選択と同じです。</span><span class="sxs-lookup"><span data-stu-id="84766-245">After selecting the Web Content Form template and clicking Add, the same Select a Master Page dialog box shown in Figure 8 will appear.</span></span>


<span data-ttu-id="84766-246">[![新しいコンテンツ ページを追加します。](creating-a-site-wide-layout-using-master-pages-vb/_static/image18.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="84766-246">[![Add a New Content Page](creating-a-site-wide-layout-using-master-pages-vb/_static/image18.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image17.png)</span></span>

<span data-ttu-id="84766-247">**図 07**: 新しいコンテンツ ページを追加 ([フルサイズのイメージを表示するをクリックして](creating-a-site-wide-layout-using-master-pages-vb/_static/image19.png))</span><span class="sxs-lookup"><span data-stu-id="84766-247">**Figure 07**: Add a New Content Page  ([Click to view full-size image](creating-a-site-wide-layout-using-master-pages-vb/_static/image19.png))</span></span>


<span data-ttu-id="84766-248">[![Site.master マスター ページを選択します。](creating-a-site-wide-layout-using-master-pages-vb/_static/image21.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="84766-248">[![Select the Site.master Master Page](creating-a-site-wide-layout-using-master-pages-vb/_static/image21.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image20.png)</span></span>

<span data-ttu-id="84766-249">**図 08**: 選択、`Site.master`マスター ページ ([フルサイズのイメージを表示するをクリックして](creating-a-site-wide-layout-using-master-pages-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="84766-249">**Figure 08**: Select the `Site.master` Master Page  ([Click to view full-size image](creating-a-site-wide-layout-using-master-pages-vb/_static/image22.png))</span></span>


<span data-ttu-id="84766-250">次の宣言型マークアップを示しています、新しいコンテンツ ページが含まれています、`@Page`ことを指してそのマスタ ページおよびコンテンツ コントロール、マスター ページの ContentPlaceHolder のコントロールの各ディレクティブです。</span><span class="sxs-lookup"><span data-stu-id="84766-250">As the following declarative markup shows, a new content page contains a `@Page` directive that points back to its master page and a Content control for each of the master page's ContentPlaceHolder controls.</span></span>

[!code-aspx[Main](creating-a-site-wide-layout-using-master-pages-vb/samples/sample4.aspx)]

> [!NOTE]
> <span data-ttu-id="84766-251">変更したところ、「を作成する、単純なサイト レイアウト」セクションで手順 1. で`ContentPlaceHolder1`に`MainContent`です。</span><span class="sxs-lookup"><span data-stu-id="84766-251">In the "Creating a Simple Site Layout" section in Step 1 I renamed `ContentPlaceHolder1` to `MainContent`.</span></span> <span data-ttu-id="84766-252">このプレース ホルダー コントロールの名前を変更するがない場合`ID`、同じ方法で、コンテンツ ページの宣言型マークアップが少し異なりますの前に示したマークアップ。</span><span class="sxs-lookup"><span data-stu-id="84766-252">If you did not rename this ContentPlaceHolder control's `ID` in the same way, your content page's declarative markup will differ slightly from the markup shown above.</span></span> <span data-ttu-id="84766-253">つまり、2 番目コンテンツ コントロールの`ContentPlaceHolderID`が反映されます、`ID`の対応する ContentPlaceHolder のマスター ページで制御します。</span><span class="sxs-lookup"><span data-stu-id="84766-253">Namely, the second Content control's `ContentPlaceHolderID` will reflect the `ID` of the corresponding ContentPlaceHolder control in your master page.</span></span>


<span data-ttu-id="84766-254">ASP.NET エンジンが、ページを組み込む必要がありますコンテンツ ページを表示するときにコントロールをマスター ページ プレース ホルダー コントロールのコンテンツします。</span><span class="sxs-lookup"><span data-stu-id="84766-254">When rendering a content page, the ASP.NET engine must fuse the page's Content controls with its master page's ContentPlaceHolder controls.</span></span> <span data-ttu-id="84766-255">ASP.NET エンジンからのコンテンツ ページのマスター ページを決定する、`@Page`ディレクティブの`MasterPageFile`属性。</span><span class="sxs-lookup"><span data-stu-id="84766-255">The ASP.NET engine determines the content page's master page from the `@Page` directive's `MasterPageFile` attribute.</span></span> <span data-ttu-id="84766-256">このコンテンツのページがバインドされているように、上記のマークアップを示しています、`~/Site.master`です。</span><span class="sxs-lookup"><span data-stu-id="84766-256">As the above markup shows, this content page is bound to `~/Site.master`.</span></span>

<span data-ttu-id="84766-257">マスター ページが 2 つのプレース ホルダー コントロール -`head`と`MainContent`-Visual Web Developer は、次の 2 つのコンテンツ コントロールを生成します。</span><span class="sxs-lookup"><span data-stu-id="84766-257">Because the master page has two ContentPlaceHolder controls - `head` and `MainContent` - Visual Web Developer generated two Content controls.</span></span> <span data-ttu-id="84766-258">各コンテンツ コントロールの参照を使用して特定 ContentPlaceHolder その`ContentPlaceHolderID`プロパティです。</span><span class="sxs-lookup"><span data-stu-id="84766-258">Each Content control references a particular ContentPlaceHolder via its `ContentPlaceHolderID` property.</span></span>

<span data-ttu-id="84766-259">デザイン時サポートはサイト全体のテンプレートの以前の技術上のマスター ページの際立つ場所です。</span><span class="sxs-lookup"><span data-stu-id="84766-259">Where master pages shine over previous site-wide template techniques is with their design-time support.</span></span> <span data-ttu-id="84766-260">図 9 を示しています、 `About.aspx` Visual Web Developer のデザイン ビューで表示したときに、コンテンツ ページ。</span><span class="sxs-lookup"><span data-stu-id="84766-260">Figure 9 shows the `About.aspx` content page when viewed through Visual Web Developer's Design view.</span></span> <span data-ttu-id="84766-261">マスター ページ コンテンツが表示されることに注目、これは淡色表示して変更できません。</span><span class="sxs-lookup"><span data-stu-id="84766-261">Note that while the master page content is visible, it is grayed out and cannot be modified.</span></span> <span data-ttu-id="84766-262">マスター ページの contentplaceholders に対応するコンテンツ コントロールは、ただし、編集します。</span><span class="sxs-lookup"><span data-stu-id="84766-262">The Content controls corresponding to the master page's ContentPlaceHolders are, however, editable.</span></span> <span data-ttu-id="84766-263">同様に他の ASP.NET ページと、ソース ビューまたはデザイン ビューを通じて、Web コントロールを追加することで、コンテンツ ページのインターフェイスを作成できます。</span><span class="sxs-lookup"><span data-stu-id="84766-263">And just like with any other ASP.NET page, you can create the content page's interface by adding Web controls through the Source or Design views.</span></span>


<span data-ttu-id="84766-264">[![コンテンツ ページの [デザイン] ビューには、両方のページ固有およびマスター ページ内容が表示されます。](creating-a-site-wide-layout-using-master-pages-vb/_static/image24.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="84766-264">[![The Content Page's Design View Displays Both the Page-Specific and Master Page Contents](creating-a-site-wide-layout-using-master-pages-vb/_static/image24.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image23.png)</span></span>

<span data-ttu-id="84766-265">**図 09**:、コンテンツ ページのデザイン ビューが表示されます両方ページ固有とマスター ページの内容 ([フルサイズのイメージを表示するをクリックして](creating-a-site-wide-layout-using-master-pages-vb/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="84766-265">**Figure 09**: The Content Page's Design View Displays Both the Page-Specific and Master Page Contents  ([Click to view full-size image](creating-a-site-wide-layout-using-master-pages-vb/_static/image25.png))</span></span>


### <a name="adding-markup-and-web-controls-to-the-content-page"></a><span data-ttu-id="84766-266">コンテンツ ページにマークアップと Web コントロールの追加</span><span class="sxs-lookup"><span data-stu-id="84766-266">Adding Markup and Web Controls to the Content Page</span></span>

<span data-ttu-id="84766-267">一部のコンテンツを作成する、`About.aspx`ページ。</span><span class="sxs-lookup"><span data-stu-id="84766-267">Take a moment to create some content for the `About.aspx` page.</span></span> <span data-ttu-id="84766-268">図 10 では、"について、Author"見出しと、いくつかの段落のテキストを入力したを参照してください。 が自由にも、Web コントロールを追加することができます。</span><span class="sxs-lookup"><span data-stu-id="84766-268">As you can see in Figure 10, I entered an "About the Author" heading and a couple of paragraphs of text, but feel free to add Web controls, too.</span></span> <span data-ttu-id="84766-269">このインターフェイスを作成すると、次を参照してください。、`About.aspx`ページがブラウザーを使用します。</span><span class="sxs-lookup"><span data-stu-id="84766-269">After creating this interface, visit the `About.aspx` page through a browser.</span></span>


<span data-ttu-id="84766-270">[![ブラウザーを使って About.aspx ページを参照してください。](creating-a-site-wide-layout-using-master-pages-vb/_static/image27.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="84766-270">[![Visit the About.aspx Page Through a Browser](creating-a-site-wide-layout-using-master-pages-vb/_static/image27.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image26.png)</span></span>

<span data-ttu-id="84766-271">**図 10**: を参照してください、`About.aspx`ブラウザーを介してページ ([フルサイズのイメージを表示するをクリックして](creating-a-site-wide-layout-using-master-pages-vb/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="84766-271">**Figure 10**: Visit the `About.aspx` Page Through a Browser  ([Click to view full-size image](creating-a-site-wide-layout-using-master-pages-vb/_static/image28.png))</span></span>


<span data-ttu-id="84766-272">これは、要求されたコンテンツ ページと関連付けられているマスター ページ: fused は web サーバーで完全に全体として表示されることを理解しておく必要です。</span><span class="sxs-lookup"><span data-stu-id="84766-272">It is important to understand that the requested content page and its associated master page are fused and rendered as a whole entirely on the web server.</span></span> <span data-ttu-id="84766-273">エンドユーザーのブラウザーでは、結果として得られる、余裕が生まれます HTML は送信されます。</span><span class="sxs-lookup"><span data-stu-id="84766-273">The end user's browser is then sent the resulting, fused HTML.</span></span> <span data-ttu-id="84766-274">これを確認するには、ブラウザーで表示 メニューの ソース を選択して受信した HTML を表示します。</span><span class="sxs-lookup"><span data-stu-id="84766-274">To verify this, view the HTML received by the browser by going to the View menu and choosing Source.</span></span> <span data-ttu-id="84766-275">フレームなしまたは 1 つのウィンドウに次の 2 つの異なる web ページを表示するため、その他の特殊な手法ことに注意してください。</span><span class="sxs-lookup"><span data-stu-id="84766-275">Note that there are no frames or any other specialized techniques for displaying two different web pages in a single window.</span></span>

### <a name="binding-a-master-page-to-an-existing-aspnet-page"></a><span data-ttu-id="84766-276">既存の ASP.NET ページへのマスター ページのバインド</span><span class="sxs-lookup"><span data-stu-id="84766-276">Binding a Master Page to an Existing ASP.NET Page</span></span>

<span data-ttu-id="84766-277">この手順で説明したとおりは、「マスター ページの選択」チェック ボックスをオンし、マスター ページの選択と同じくらい簡単では、ASP.NET web アプリケーションを新しいコンテンツ ページを追加することです。</span><span class="sxs-lookup"><span data-stu-id="84766-277">As we saw in this step, adding a new content page to an ASP.NET web application is as easy as checking the "Select master page" checkbox and picking the master page.</span></span> <span data-ttu-id="84766-278">残念ながら、既存の ASP.NET ページをマスター ページに変換するは簡単ではありません。</span><span class="sxs-lookup"><span data-stu-id="84766-278">Unfortunately, converting an existing ASP.NET page to a master page is not as easy.</span></span>

<span data-ttu-id="84766-279">マスター ページを既存の ASP.NET ページにバインドするには、次の手順を実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="84766-279">To bind a master page to an existing ASP.NET page you need to perform the following steps:</span></span>

1. <span data-ttu-id="84766-280">追加、`MasterPageFile`属性を ASP.NET ページの`@Page`ディレクティブについては、適切なマスター ページをポイントします。</span><span class="sxs-lookup"><span data-stu-id="84766-280">Add the `MasterPageFile` attribute to the ASP.NET page's `@Page` directive, pointing it to the appropriate master page.</span></span>
2. <span data-ttu-id="84766-281">マスター ページで contentplaceholders の各コンテンツ コントロールを追加します。</span><span class="sxs-lookup"><span data-stu-id="84766-281">Add Content controls for each of the ContentPlaceHolders in the master page.</span></span>
3. <span data-ttu-id="84766-282">選択的を切り取って、適切なコンテンツ コントロールに、ASP.NET ページの既存の内容を貼り付けます。</span><span class="sxs-lookup"><span data-stu-id="84766-282">Selectively cut and paste the ASP.NET page's existing content into the appropriate Content controls.</span></span> <span data-ttu-id="84766-283">ここで言う「選択的に」次に、ASP.NET ページの可能性があります含まれているため既にによって表されます、マスター ページなどのマークアップ、 `DOCTYPE`、`<html>`要素、および Web フォームです。</span><span class="sxs-lookup"><span data-stu-id="84766-283">I say "selectively" here because the ASP.NET page likely contains markup that's already expressed by the master page, such as the `DOCTYPE`, the `<html>` element, and the Web Form.</span></span>

<span data-ttu-id="84766-284">スクリーン ショットと共にこのプロセスの手順については、チェック アウト[Scott Guthrie](https://weblogs.asp.net/scottgu/)の[を使用してマスター ページとサイト ナビゲーション](http://webproject.scottgu.com/VisualBasic/MasterPages/MasterPages.aspx)チュートリアルです。</span><span class="sxs-lookup"><span data-stu-id="84766-284">For step-by-step instructions on this process along with screen shots, check out [Scott Guthrie](https://weblogs.asp.net/scottgu/)'s [Using Master Pages and Site Navigation](http://webproject.scottgu.com/VisualBasic/MasterPages/MasterPages.aspx) tutorial.</span></span> <span data-ttu-id="84766-285">"更新`Default.aspx`と`DataSample.aspx`マスター ページを使用する」セクションには、これらの手順が詳しく説明します。</span><span class="sxs-lookup"><span data-stu-id="84766-285">The "Update `Default.aspx` and `DataSample.aspx` to use the Master Page" section details these steps.</span></span>

<span data-ttu-id="84766-286">コンテンツ ページに既存の ASP.NET ページを変換するよりも新しいコンテンツ ページを作成するはるかに簡単なのでを作成するたびに新しい ASP.NET web サイト マスター ページを追加サイトをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="84766-286">Because it is much easier to create new content pages than it is to convert existing ASP.NET pages into content pages, I recommend that whenever you create a new ASP.NET website add a master page to the site.</span></span> <span data-ttu-id="84766-287">このマスター ページには、すべての新しい ASP.NET ページをバインドします。</span><span class="sxs-lookup"><span data-stu-id="84766-287">Bind all new ASP.NET pages to this master page.</span></span> <span data-ttu-id="84766-288">最初のマスター ページが非常に単純なまたは標準以外の場合、心配しないでください。後で、マスター ページを更新することができます。</span><span class="sxs-lookup"><span data-stu-id="84766-288">Don't worry if the initial master page is very simple or plain; you can update the master page later.</span></span>

> [!NOTE]
> <span data-ttu-id="84766-289">Visual Web Developer が追加された新しい ASP.NET アプリケーションを作成するときに、`Default.aspx`マスター ページにバインドされていないページ。</span><span class="sxs-lookup"><span data-stu-id="84766-289">When creating a new ASP.NET application, Visual Web Developer adds a `Default.aspx` page that isn't bound to a master page.</span></span> <span data-ttu-id="84766-290">使用してくださいプラクティス コンテンツ ページに既存の ASP.NET ページを変換する場合は、`Default.aspx`です。</span><span class="sxs-lookup"><span data-stu-id="84766-290">If you want to practice converting an existing ASP.NET page into a content page, go ahead and do so with `Default.aspx`.</span></span> <span data-ttu-id="84766-291">削除する代わりに、`Default.aspx`してから、今度は「マスター ページを選択」チェック ボックスを再び追加します。</span><span class="sxs-lookup"><span data-stu-id="84766-291">Alternatively, you can delete `Default.aspx` and then re-add it, but this time checking the "Select master page" checkbox.</span></span>


## <a name="step-3-updating-the-master-pages-markup"></a><span data-ttu-id="84766-292">手順 3: マスター ページのマークアップを更新します。</span><span class="sxs-lookup"><span data-stu-id="84766-292">Step 3: Updating the Master Page's Markup</span></span>

<span data-ttu-id="84766-293">マスター ページの主な利点の 1 つは、サイトで多数のページの全体的なレイアウトを定義する、単一のマスター ページを使用することがあることです。</span><span class="sxs-lookup"><span data-stu-id="84766-293">One of the primary benefits of master pages is that a single master page may be used to define the overall layout for numerous pages on the site.</span></span> <span data-ttu-id="84766-294">そのため、サイトのルック アンド フィールの更新には、マスター ページの 1 つのファイルの更新が必要です。</span><span class="sxs-lookup"><span data-stu-id="84766-294">Therefore, updating the site's look and feel requires updating a single file - the master page.</span></span>

<span data-ttu-id="84766-295">この動作を示すためには、更新、マスター ページで、左側の列の上部にある現在の日付がみましょう。</span><span class="sxs-lookup"><span data-stu-id="84766-295">To illustrate this behavior, let's update our master page to include the current date in at the top of the left column.</span></span> <span data-ttu-id="84766-296">という名前のラベルを追加`DateDisplay`を`leftContent``<div>`です。</span><span class="sxs-lookup"><span data-stu-id="84766-296">Add a Label named `DateDisplay` to the `leftContent` `<div>`.</span></span>

[!code-aspx[Main](creating-a-site-wide-layout-using-master-pages-vb/samples/sample5.aspx)]

<span data-ttu-id="84766-297">次に、作成、`Page_Load`マスターのイベント ハンドラー ページし、次のコードを追加します。</span><span class="sxs-lookup"><span data-stu-id="84766-297">Next, create a `Page_Load` event handler for the master page and add the following code:</span></span>

[!code-vb[Main](creating-a-site-wide-layout-using-master-pages-vb/samples/sample6.vb)]

<span data-ttu-id="84766-298">上記のコードを設定、ラベルの`Text`を現在の日付と時刻のプロパティは、曜日、月、および 2 桁の日の名前として書式設定 (図 11 を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="84766-298">The above code sets the Label's `Text` property to the current date and time formatted as the day of the week, the name of the month, and the two-digit day (see Figure 11).</span></span> <span data-ttu-id="84766-299">この変更により、コンテンツ、ページの 1 つを再表示します。</span><span class="sxs-lookup"><span data-stu-id="84766-299">With this change, revisit one of your content pages.</span></span> <span data-ttu-id="84766-300">図 11 では、結果として得られるマークアップはマスター ページへの変更を含めるすぐに更新されます。</span><span class="sxs-lookup"><span data-stu-id="84766-300">As Figure 11 shows, the resulting markup is immediately updated to include the change to the master page.</span></span>


<span data-ttu-id="84766-301">[![マスター ページへの変更が反映されるときに表示する、コンテンツ ページ](creating-a-site-wide-layout-using-master-pages-vb/_static/image30.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="84766-301">[![The Changes to the Master Page are Reflected When Viewing the a Content Page](creating-a-site-wide-layout-using-master-pages-vb/_static/image30.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image29.png)</span></span>

<span data-ttu-id="84766-302">**図 11**: マスター ページへの変更が反映されるときに表示する、コンテンツ ページ ([フルサイズのイメージを表示するをクリックして](creating-a-site-wide-layout-using-master-pages-vb/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="84766-302">**Figure 11**: The Changes to the Master Page are Reflected When Viewing the a Content Page  ([Click to view full-size image](creating-a-site-wide-layout-using-master-pages-vb/_static/image31.png))</span></span>


> [!NOTE]
> <span data-ttu-id="84766-303">この例のように、マスター ページはサーバー側の Web コントロール、コード、およびイベント ハンドラーを含めることができます。</span><span class="sxs-lookup"><span data-stu-id="84766-303">As this example illustrates, master pages may contain server-side Web controls, code, and event handlers.</span></span>


## <a name="summary"></a><span data-ttu-id="84766-304">まとめ</span><span class="sxs-lookup"><span data-stu-id="84766-304">Summary</span></span>

<span data-ttu-id="84766-305">マスター ページでは、ASP.NET 開発者は簡単に更新を一貫性のあるサイト全体のレイアウトをデザインを有効にします。</span><span class="sxs-lookup"><span data-stu-id="84766-305">Master pages enable ASP.NET developers to design a consistent site-wide layout that is easily updateable.</span></span> <span data-ttu-id="84766-306">Visual Web Developer が豊富なデザイン時サポートを提供できると、マスター ページと、対応するコンテンツ ページの作成は標準の ASP.NET ページを作成するように単純です。</span><span class="sxs-lookup"><span data-stu-id="84766-306">Creating master pages and their associated content pages is as simple as creating standard ASP.NET pages, as Visual Web Developer offers rich design-time support.</span></span>

<span data-ttu-id="84766-307">このチュートリアルで作成したマスター ページの例では、2 つのプレース ホルダー コントロール、ヘッドとメインがありました。</span><span class="sxs-lookup"><span data-stu-id="84766-307">The master page example we created in this tutorial had two ContentPlaceHolder controls, head and MainContent.</span></span> <span data-ttu-id="84766-308">のみに指定したメイン ContentPlaceHolder コントロールのマークアップをコンテンツ ページで、ただしです。</span><span class="sxs-lookup"><span data-stu-id="84766-308">We only specified markup for the MainContent ContentPlaceHolder control in our content page, however.</span></span> <span data-ttu-id="84766-309">複数のコンテンツを使用して次のチュートリアルで見てコンテンツ ページのコントロールです。</span><span class="sxs-lookup"><span data-stu-id="84766-309">In the next tutorial we look at using multiple Content controls in the content page.</span></span> <span data-ttu-id="84766-310">表示されています。 既定値を定義する方法のコンテンツのマークアップ内で制御マスター ページで、も既定値の使用を切り替えるマークアップで定義されているマスター ページと、コンテンツ ページからカスタムのマークアップを提供する方法です。</span><span class="sxs-lookup"><span data-stu-id="84766-310">We also see how to define default markup for Content controls within the master page, as well as how to toggle between using the default markup defined in the master page and providing custom markup from the content page.</span></span>

<span data-ttu-id="84766-311">満足プログラミング!</span><span class="sxs-lookup"><span data-stu-id="84766-311">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="84766-312">関連項目</span><span class="sxs-lookup"><span data-stu-id="84766-312">Further Reading</span></span>

<span data-ttu-id="84766-313">このチュートリアルで説明したトピックの詳細については、次の情報を参照してください。</span><span class="sxs-lookup"><span data-stu-id="84766-313">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="84766-314">デザイナーの ASP.NET: Web 標準を使用して ASP.NET web サイトの構築にデザイン テンプレートおよびガイダンスを解放します。</span><span class="sxs-lookup"><span data-stu-id="84766-314">ASP.NET for Designers: Free Design Templates and Guidance on Building ASP.NET Websites Using Web Standards</span></span>](https://msdn.microsoft.com/asp.net/aa336602.aspx)
- [<span data-ttu-id="84766-315">ASP.NET マスター ページの概要</span><span class="sxs-lookup"><span data-stu-id="84766-315">ASP.NET Master Pages Overview</span></span>](https://msdn.microsoft.com/library/wtxbf3hh.aspx)
- [<span data-ttu-id="84766-316">カスケード スタイル シート (CSS) のチュートリアル</span><span class="sxs-lookup"><span data-stu-id="84766-316">Cascading Stylesheets (CSS) Tutorials</span></span>](http://www.w3schools.com/css/default.asp)
- [<span data-ttu-id="84766-317">ページのタイトルの動的設定</span><span class="sxs-lookup"><span data-stu-id="84766-317">Dynamically Setting the Page's Title</span></span>](http://aspnet.4guysfromrolla.com/articles/051006-1.aspx)
- [<span data-ttu-id="84766-318">ASP.NET マスター ページ</span><span class="sxs-lookup"><span data-stu-id="84766-318">Master Pages in ASP.NET</span></span>](http://www.odetocode.com/articles/419.aspx)
- [<span data-ttu-id="84766-319">マスター ページのクイック スタート チュートリアル</span><span class="sxs-lookup"><span data-stu-id="84766-319">Master Pages QuickStart Tutorials</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/masterpages/default.aspx)

### <a name="about-the-author"></a><span data-ttu-id="84766-320">作成者について</span><span class="sxs-lookup"><span data-stu-id="84766-320">About the Author</span></span>

<span data-ttu-id="84766-321">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)、作成者複数受け取ります書籍や 4GuysFromRolla.com の創設者を操作した Microsoft Web テクノロジ 1998 年です。</span><span class="sxs-lookup"><span data-stu-id="84766-321">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="84766-322">Scott は、コンサルタント、トレーナー、ライターとして機能します。</span><span class="sxs-lookup"><span data-stu-id="84766-322">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="84766-323">最新の著書[ *Sam 学べる自分で ASP.NET 3.5 24 時間以内に*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)です。</span><span class="sxs-lookup"><span data-stu-id="84766-323">His latest book is [*Sams Teach Yourself ASP.NET 3.5 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="84766-324">Scott に到達できる[ mitchell@4GuysFromRolla.com ](mailto:mitchell@4GuysFromRolla.com)または彼のブログでを介して[http://ScottOnWriting.NET](http://scottonwriting.net/)です。</span><span class="sxs-lookup"><span data-stu-id="84766-324">Scott can be reached at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="84766-325">感謝の特別な</span><span class="sxs-lookup"><span data-stu-id="84766-325">Special Thanks To</span></span>

<span data-ttu-id="84766-326">今後、MSDN の記事を確認することに関心のあるですか。</span><span class="sxs-lookup"><span data-stu-id="84766-326">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="84766-327">場合は、ドロップ me 一度に 1 行ずつ[ mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)です。</span><span class="sxs-lookup"><span data-stu-id="84766-327">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com).</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="84766-328">[前へ](nested-master-pages-cs.md)
[次へ](multiple-contentplaceholders-and-default-content-vb.md)</span><span class="sxs-lookup"><span data-stu-id="84766-328">[Previous](nested-master-pages-cs.md)
[Next](multiple-contentplaceholders-and-default-content-vb.md)</span></span>
