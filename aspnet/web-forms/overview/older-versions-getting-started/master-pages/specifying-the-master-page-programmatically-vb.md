---
uid: web-forms/overview/older-versions-getting-started/master-pages/specifying-the-master-page-programmatically-vb
title: プログラムによるマスター ページの指定 (VB) |Microsoft ドキュメント
author: rick-anderson
description: PreInit イベント ハンドラーを使用してプログラムからのコンテンツ ページのマスター ページの設定を見ます。
ms.author: aspnetcontent
manager: wpickett
ms.date: 07/28/2008
ms.topic: article
ms.assetid: 0edcd653-f24a-41aa-aef4-75f868fe5ac2
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-getting-started/master-pages/specifying-the-master-page-programmatically-vb
msc.type: authoredcontent
ms.openlocfilehash: 4ba2981e627199da89a25b0b59840f66521f2e78
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/06/2018
---
<a name="specifying-the-master-page-programmatically-vb"></a><span data-ttu-id="6cccf-103">プログラムによるマスター ページの指定 (VB)</span><span class="sxs-lookup"><span data-stu-id="6cccf-103">Specifying the Master Page Programmatically (VB)</span></span>
====================
<span data-ttu-id="6cccf-104">によって[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="6cccf-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="6cccf-105">[コードをダウンロードする](http://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_09_VB.zip)または[PDF のダウンロード](http://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_09_VB.pdf)</span><span class="sxs-lookup"><span data-stu-id="6cccf-105">[Download Code](http://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_09_VB.zip) or [Download PDF](http://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_09_VB.pdf)</span></span>

> <span data-ttu-id="6cccf-106">PreInit イベント ハンドラーを使用してプログラムからのコンテンツ ページのマスター ページの設定を見ます。</span><span class="sxs-lookup"><span data-stu-id="6cccf-106">Looks at setting the content page's master page programmatically via the PreInit event handler.</span></span>


## <a name="introduction"></a><span data-ttu-id="6cccf-107">はじめに</span><span class="sxs-lookup"><span data-stu-id="6cccf-107">Introduction</span></span>

<span data-ttu-id="6cccf-108">以降の例ではスタートとなった[ *、サイト全体のレイアウトを使用してマスター ページを作成する*](creating-a-site-wide-layout-using-master-pages-vb.md)、ページは、宣言を使用して、マスター ページを参照しているすべてのコンテンツ、 `MasterPageFile` 属性`@Page`ディレクティブです。</span><span class="sxs-lookup"><span data-stu-id="6cccf-108">Since the inaugural example in [*Creating a Site-Wide Layout Using Master Pages*](creating-a-site-wide-layout-using-master-pages-vb.md), all content pages have referenced their master page declaratively via the `MasterPageFile` attribute in the `@Page` directive.</span></span> <span data-ttu-id="6cccf-109">たとえば、次`@Page`ディレクティブがコンテンツ ページをマスター ページにリンク`Site.master`:</span><span class="sxs-lookup"><span data-stu-id="6cccf-109">For example, the following `@Page` directive links the content page to the master page `Site.master`:</span></span>


[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample1.aspx)]

<span data-ttu-id="6cccf-110">[ `Page`クラス](https://msdn.microsoft.com/library/system.web.ui.page.aspx)で、`System.Web.UI`名前空間が含まれています、 [ `MasterPageFile`プロパティ](https://msdn.microsoft.com/library/system.web.ui.page.masterpagefile.aspx)コンテンツ ページのマスター ページへのパスを返す; はこの、によって設定されるプロパティ`@Page`ディレクティブです。</span><span class="sxs-lookup"><span data-stu-id="6cccf-110">The [`Page` class](https://msdn.microsoft.com/library/system.web.ui.page.aspx) in the `System.Web.UI` namespace includes a [`MasterPageFile` property](https://msdn.microsoft.com/library/system.web.ui.page.masterpagefile.aspx) that returns the path to the content page's master page; it is this property that is set by the `@Page` directive.</span></span> <span data-ttu-id="6cccf-111">このプロパティは、コンテンツ ページのマスター ページ、プログラムで指定するも使用できます。</span><span class="sxs-lookup"><span data-stu-id="6cccf-111">This property can also be used to programmatically specify the content page's master page.</span></span> <span data-ttu-id="6cccf-112">この方法は、ページにアクセスしたユーザーなどの外部要因に基づくマスター ページを動的に割り当てる場合に便利です。</span><span class="sxs-lookup"><span data-stu-id="6cccf-112">This approach is useful if you want to dynamically assign the master page based on external factors, such as the user visiting the page.</span></span>

<span data-ttu-id="6cccf-113">このチュートリアルでは 2 つ目のマスター ページ、web サイトに追加を実行時に使用するマスター ページを動的に決定します。</span><span class="sxs-lookup"><span data-stu-id="6cccf-113">In this tutorial we add a second master page to our website and dynamically decide which master page to use at runtime.</span></span>

## <a name="step-1-a-look-at-the-page-lifecycle"></a><span data-ttu-id="6cccf-114">手順 1: を見て、ページのライフ サイクル</span><span class="sxs-lookup"><span data-stu-id="6cccf-114">Step 1: A Look at the Page Lifecycle</span></span>

<span data-ttu-id="6cccf-115">ASP.NET エンジンが、ページを組み込む必要があります要求がコンテンツ ページの ASP.NET ページ用の web サーバーに到着すると、マスター ページにコントロールのプレース ホルダー コントロールに対応するコンテンツ。</span><span class="sxs-lookup"><span data-stu-id="6cccf-115">Whenever a request arrives at the web server for an ASP.NET page that is a content page, the ASP.NET engine must fuse the page's Content controls into the master page's corresponding ContentPlaceHolder controls.</span></span> <span data-ttu-id="6cccf-116">この fusion は、一般的なページのライフ サイクルを続行し、1 つのコントロール階層を作成します。</span><span class="sxs-lookup"><span data-stu-id="6cccf-116">This fusion creates a single control hierarchy that can then proceed through the typical page lifecycle.</span></span>

<span data-ttu-id="6cccf-117">図 1 は、この fusion を示しています。</span><span class="sxs-lookup"><span data-stu-id="6cccf-117">Figure 1 illustrates this fusion.</span></span> <span data-ttu-id="6cccf-118">図 1 の手順 1 では、初期コンテンツおよびマスター ページ コントロール階層を示します。</span><span class="sxs-lookup"><span data-stu-id="6cccf-118">Step 1 in Figure 1 shows the initial content and master page control hierarchies.</span></span> <span data-ttu-id="6cccf-119">PreInit ステージ コンテンツの末尾には、ページのコントロールがマスター ページ (手順 2) に対応する contentplaceholders に追加されます。</span><span class="sxs-lookup"><span data-stu-id="6cccf-119">At the tail end of the PreInit stage the Content controls in the page are added to the corresponding ContentPlaceHolders in the master page (Step 2).</span></span> <span data-ttu-id="6cccf-120">この fusion 後は、マスター ページは、余裕が生まれますコントロールの階層のルートとして機能します。</span><span class="sxs-lookup"><span data-stu-id="6cccf-120">After this fusion, the master page serves as the root of the fused control hierarchy.</span></span> <span data-ttu-id="6cccf-121">コントロールを定着この階層は完成したコントロールの階層 (手順 3) を生成するために、ページに追加されます。</span><span class="sxs-lookup"><span data-stu-id="6cccf-121">This fused control hierarchy is then added to the page to produce the finalized control hierarchy (Step 3).</span></span> <span data-ttu-id="6cccf-122">最終的な結果は、ページのコントロールの階層に余裕が生まれますコントロール階層が含まれることです。</span><span class="sxs-lookup"><span data-stu-id="6cccf-122">The net result is that the page's control hierarchy includes the fused control hierarchy.</span></span>


<span data-ttu-id="6cccf-123">[![PreInit ステージ中に、マスター ページとコンテンツ ページのコントロールの階層が一緒に定着](specifying-the-master-page-programmatically-vb/_static/image2.png)](specifying-the-master-page-programmatically-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="6cccf-123">[![The Master Page and Content Page's Control Hierarchies are Fused Together during the PreInit Stage](specifying-the-master-page-programmatically-vb/_static/image2.png)](specifying-the-master-page-programmatically-vb/_static/image1.png)</span></span>

<span data-ttu-id="6cccf-124">**図 01**: PreInit ステージ中に、マスター ページとページのコンテンツのコントロール階層は、一緒に定着 ([フルサイズのイメージを表示するをクリックして](specifying-the-master-page-programmatically-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="6cccf-124">**Figure 01**: The Master Page and Content Page's Control Hierarchies are Fused Together during the PreInit Stage ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image3.png))</span></span>


## <a name="step-2-setting-themasterpagefileproperty-from-code"></a><span data-ttu-id="6cccf-125">手順 2: 設定、`MasterPageFile`コードからプロパティ</span><span class="sxs-lookup"><span data-stu-id="6cccf-125">Step 2: Setting the`MasterPageFile`Property from Code</span></span>

<span data-ttu-id="6cccf-126">値に依存この fusion でどのようなマスター ページが partakes、`Page`オブジェクトの`MasterPageFile`プロパティです。</span><span class="sxs-lookup"><span data-stu-id="6cccf-126">What master page partakes in this fusion depends on the value of the `Page` object's `MasterPageFile` property.</span></span> <span data-ttu-id="6cccf-127">設定、`MasterPageFile`属性、`@Page`ディレクティブが割り当てることの実際の影響、`Page`の`MasterPageFile`段階で、初期化、ページのライフ サイクルの最初のステージであるプロパティ。</span><span class="sxs-lookup"><span data-stu-id="6cccf-127">Setting the `MasterPageFile` attribute in the `@Page` directive has the net effect of assigning the `Page`'s `MasterPageFile` property during the Initialization stage, which is the very first stage of the page's lifecycle.</span></span> <span data-ttu-id="6cccf-128">代わりにこのプロパティをプログラムで設定できます。</span><span class="sxs-lookup"><span data-stu-id="6cccf-128">We can alternatively set this property programmatically.</span></span> <span data-ttu-id="6cccf-129">ただし、これが図 1 に fusion 行われる前にこのプロパティを設定することが重要です。</span><span class="sxs-lookup"><span data-stu-id="6cccf-129">However, it is imperative that this property be set before the fusion in Figure 1 takes place.</span></span>

<span data-ttu-id="6cccf-130">PreInit ステージの開始時、`Page`オブジェクト、 [ `PreInit`イベント](https://msdn.microsoft.com/library/system.web.ui.page.preinit.aspx)呼び出しとその[`OnPreInit`メソッド](https://msdn.microsoft.com/library/system.web.ui.page.onpreinit.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="6cccf-130">At the start of the PreInit stage the `Page` object raises its [`PreInit` event](https://msdn.microsoft.com/library/system.web.ui.page.preinit.aspx) and calls its [`OnPreInit` method](https://msdn.microsoft.com/library/system.web.ui.page.onpreinit.aspx).</span></span> <span data-ttu-id="6cccf-131">マスター ページ、プログラムで設定を次に、生み出すことができますか、イベント ハンドラーを`PreInit`イベントまたは上書き、`OnPreInit`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="6cccf-131">To set the master page programmatically, then, we can either create an event handler for the `PreInit` event or override the `OnPreInit` method.</span></span> <span data-ttu-id="6cccf-132">両方の方法を見てみましょう。</span><span class="sxs-lookup"><span data-stu-id="6cccf-132">Let's look at both approaches.</span></span>

<span data-ttu-id="6cccf-133">開いて開始`Default.aspx.vb`、このサイトのホーム ページの分離コード クラス ファイルです。</span><span class="sxs-lookup"><span data-stu-id="6cccf-133">Start by opening `Default.aspx.vb`, the code-behind class file for our site's homepage.</span></span> <span data-ttu-id="6cccf-134">ページのイベント ハンドラーを追加`PreInit`次のコードを入力してイベント。</span><span class="sxs-lookup"><span data-stu-id="6cccf-134">Add an event handler for the page's `PreInit` event by typing in the following code:</span></span>


[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample2.vb)]

<span data-ttu-id="6cccf-135">ここで設定することが、`MasterPageFile`プロパティです。</span><span class="sxs-lookup"><span data-stu-id="6cccf-135">From here we can set the `MasterPageFile` property.</span></span> <span data-ttu-id="6cccf-136">値を代入するため、コードを更新"~/Site.master"に、`MasterPageFile`プロパティです。</span><span class="sxs-lookup"><span data-stu-id="6cccf-136">Update the code so that it assigns the value "~/Site.master" to the `MasterPageFile` property.</span></span>


[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample3.vb)]

<span data-ttu-id="6cccf-137">ブレークポイントを設定して、デバッグの開始に表示される場合されるたびに、`Default.aspx`ページにアクセスするか、このページへのポストバックが存在する場合は、`Page_PreInit`イベント ハンドラーが実行されると、`MasterPageFile`にプロパティが割り当てられた"~/Site.master"です。</span><span class="sxs-lookup"><span data-stu-id="6cccf-137">If you set a breakpoint and start with debugging you'll see that whenever the `Default.aspx` page is visited or whenever there's a postback to this page, the `Page_PreInit` event handler executes and the `MasterPageFile` property is assigned to "~/Site.master".</span></span>

<span data-ttu-id="6cccf-138">また、オーバーライド、`Page`クラスの`OnPreInit`メソッドと set、`MasterPageFile`プロパティがあります。</span><span class="sxs-lookup"><span data-stu-id="6cccf-138">Alternatively, you can override the `Page` class's `OnPreInit` method and set the `MasterPageFile` property there.</span></span> <span data-ttu-id="6cccf-139">たとえば、みましょう設定されていない特定 ページでは、マスター ページからわけではなく`BasePage`です。</span><span class="sxs-lookup"><span data-stu-id="6cccf-139">For this example, let's not set the master page in a particular page, but rather from `BasePage`.</span></span> <span data-ttu-id="6cccf-140">ベース ページのカスタム クラスを作成したということに注意してください (`BasePage`) に戻り、 [*マスター ページのタイトル、メタ タグ、およびその他の HTML ヘッダーを指定する*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md)チュートリアルです。</span><span class="sxs-lookup"><span data-stu-id="6cccf-140">Recall that we created a custom base page class (`BasePage`) back in the [*Specifying the Title, Meta Tags, and Other HTML Headers in the Master Page*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) tutorial.</span></span> <span data-ttu-id="6cccf-141">現在`BasePage`よりも優先、`Page`クラスの`OnLoadComplete`メソッド、ページの設定`Title`プロパティのサイト マップ データに基づきます。</span><span class="sxs-lookup"><span data-stu-id="6cccf-141">Currently `BasePage` overrides the `Page` class's `OnLoadComplete` method, where it sets the page's `Title` property based on the site map data.</span></span> <span data-ttu-id="6cccf-142">みましょう更新`BasePage`も上書きする、`OnPreInit`メソッドをプログラムで、マスター ページを指定します。</span><span class="sxs-lookup"><span data-stu-id="6cccf-142">Let's update `BasePage` to also override the `OnPreInit` method to programmatically specify the master page.</span></span>


[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample4.vb)]

<span data-ttu-id="6cccf-143">派生して、すべてのコンテンツ ページのため`BasePage`、今すぐに割り当てられたプログラムで、マスター ページを持つし、すべてのです。</span><span class="sxs-lookup"><span data-stu-id="6cccf-143">Because all our content pages derive from `BasePage`, all of them now have their master page programmatically assigned.</span></span> <span data-ttu-id="6cccf-144">この時点で、`PreInit`内のイベント ハンドラー`Default.aspx.vb`は不要です。 自由にそれを削除します。</span><span class="sxs-lookup"><span data-stu-id="6cccf-144">At this point the `PreInit` event handler in `Default.aspx.vb` is superfluous; feel free to remove it.</span></span>

### <a name="what-about-thepagedirective"></a><span data-ttu-id="6cccf-145">では、`@Page`ディレクティブですか?</span><span class="sxs-lookup"><span data-stu-id="6cccf-145">What About the`@Page`Directive?</span></span>

<span data-ttu-id="6cccf-146">少しわかりにくいものがありますは、コンテンツ ページの`MasterPageFile`2 つの場所のプロパティが指定されているようになりました: でプログラムによって、`BasePage`クラスの`OnPreInit`メソッドからも、`MasterPageFile`ページごとにコンテンツの属性`@Page`ディレクティブです。</span><span class="sxs-lookup"><span data-stu-id="6cccf-146">What may be a little confusing is that the content pages' `MasterPageFile` properties are now being specified in two places: programmatically in the `BasePage` class's `OnPreInit` method as well as through the `MasterPageFile` attribute in each content page's `@Page` directive.</span></span>

<span data-ttu-id="6cccf-147">ページのライフ サイクルの最初のステージは、初期化段階です。</span><span class="sxs-lookup"><span data-stu-id="6cccf-147">The first stage in the page lifecycle is the Initialization stage.</span></span> <span data-ttu-id="6cccf-148">この段階で、`Page`オブジェクトの`MasterPageFile`プロパティには、値が割り当てられた、`MasterPageFile`属性、`@Page`ディレクティブ (提供されている) 場合。</span><span class="sxs-lookup"><span data-stu-id="6cccf-148">During this stage the `Page` object's `MasterPageFile` property is assigned the value of the `MasterPageFile` attribute in the `@Page` directive (if it is provided).</span></span> <span data-ttu-id="6cccf-149">初期化段階の次の PreInit 段階であり、ここでプログラムで設定されている、`Page`オブジェクトの`MasterPageFile`から割り当てられた値を上書きして、プロパティ、`@Page`ディレクティブです。</span><span class="sxs-lookup"><span data-stu-id="6cccf-149">The PreInit stage follows the Initialization stage, and it is here where we programmatically set the `Page` object's `MasterPageFile` property, thereby overwriting the value assigned from the `@Page` directive.</span></span> <span data-ttu-id="6cccf-150">設定するため、`Page`オブジェクトの`MasterPageFile`プロパティ、プログラムで削除することでした、`MasterPageFile`属性から、`@Page`ディレクティブをエンドユーザーのエクスペリエンスに影響を与えずにします。</span><span class="sxs-lookup"><span data-stu-id="6cccf-150">Because we are setting the `Page` object's `MasterPageFile` property programmatically, we could remove the `MasterPageFile` attribute from the `@Page` directive without affecting the end user's experience.</span></span> <span data-ttu-id="6cccf-151">このたどりにさあ、削除、`MasterPageFile`属性から、`@Page`ディレクティブで`Default.aspx`し、ブラウザーでページにアクセスします。</span><span class="sxs-lookup"><span data-stu-id="6cccf-151">To convince yourself of this, go ahead and remove the `MasterPageFile` attribute from the `@Page` directive in `Default.aspx` and then visit the page through a browser.</span></span> <span data-ttu-id="6cccf-152">予想できるように、出力は、同じとして属性が削除される前にします。</span><span class="sxs-lookup"><span data-stu-id="6cccf-152">As you would expect, the output is the same as before the attribute was removed.</span></span>

<span data-ttu-id="6cccf-153">かどうか、`MasterPageFile`経由でプロパティが設定されて、`@Page`ディレクティブまたはプログラムによってエンドユーザーのエクスペリエンスに重要ではありません。</span><span class="sxs-lookup"><span data-stu-id="6cccf-153">Whether the `MasterPageFile` property is set via the `@Page` directive or programmatically is inconsequential to the end user's experience.</span></span> <span data-ttu-id="6cccf-154">ただし、`MasterPageFile`属性、`@Page`ディレクティブを使用して Visual Studio デザイン時に、WYSIWYG を生成するために、デザイナーで表示します。</span><span class="sxs-lookup"><span data-stu-id="6cccf-154">However, the `MasterPageFile` attribute in the `@Page` directive is used by Visual Studio during design-time to produce the WYSIWYG view in the Designer.</span></span> <span data-ttu-id="6cccf-155">戻る場合`Default.aspx`Visual Studio で、移動、デザイナーには、メッセージが表示されます"マスター ページのエラー: ページ、マスター ページの参照が必要なコントロールが指定されていない"(図 2 を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="6cccf-155">If you return to `Default.aspx` in Visual Studio and navigate to the Designer you'll see the message, "Master Page error: The page has controls that require a Master Page reference, but none is specified" (see Figure 2).</span></span>

<span data-ttu-id="6cccf-156">つまりのままにする必要があります、`MasterPageFile`属性、`@Page`ディレクティブを Visual Studio での豊富なデザイン時機能をご利用いただけます。</span><span class="sxs-lookup"><span data-stu-id="6cccf-156">In short, you need to leave the `MasterPageFile` attribute in the `@Page` directive to enjoy a rich design-time experience in Visual Studio.</span></span>


<span data-ttu-id="6cccf-157">[![Visual Studio で使用、@Pageデザイン ビューを表示するために、ディレクティブの MasterPageFile 属性](specifying-the-master-page-programmatically-vb/_static/image5.png)](specifying-the-master-page-programmatically-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="6cccf-157">[![Visual Studio Uses the @Page Directive's MasterPageFile Attribute to Render the Design View](specifying-the-master-page-programmatically-vb/_static/image5.png)](specifying-the-master-page-programmatically-vb/_static/image4.png)</span></span>

<span data-ttu-id="6cccf-158">**図 02**: Visual Studio を使用して、`@Page`ディレクティブの`MasterPageFile`デザイン ビューを表示する属性 ([フルサイズのイメージを表示するをクリックして](specifying-the-master-page-programmatically-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="6cccf-158">**Figure 02**: Visual Studio Uses the `@Page` Directive's `MasterPageFile` Attribute to Render the Design View  ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image6.png))</span></span>


## <a name="step-3-creating-an-alternative-master-page"></a><span data-ttu-id="6cccf-159">手順 3: 代替のマスター ページを作成します。</span><span class="sxs-lookup"><span data-stu-id="6cccf-159">Step 3: Creating an Alternative Master Page</span></span>

<span data-ttu-id="6cccf-160">実行時に、コンテンツ ページのマスター ページをプログラムで設定できるため、外部条件に基づいた特定のマスター ページを動的に読み込むことです。</span><span class="sxs-lookup"><span data-stu-id="6cccf-160">Because a content page's master page can be set programmatically at runtime it's possible to dynamically load a particular master page based on some external criteria.</span></span> <span data-ttu-id="6cccf-161">この機能は、サイトのレイアウトをする必要がある異なるユーザーに基づく場合に便利です。</span><span class="sxs-lookup"><span data-stu-id="6cccf-161">This functionality can be useful in situations where the site's layout needs to vary based on the user.</span></span> <span data-ttu-id="6cccf-162">たとえば、ブログ エンジン web アプリケーションのユーザーに許可できます、ブログのレイアウトを選択各レイアウトは別のマスター ページに関連付けられてます。</span><span class="sxs-lookup"><span data-stu-id="6cccf-162">For instance, a blog engine web application may allow its users to choose a layout for their blog, where each layout is associated with a different master page.</span></span> <span data-ttu-id="6cccf-163">実行時に、訪問者が、ユーザーのブログを表示するときに web アプリケーション必要があります、ブログのレイアウトを確認し、コンテンツ ページに、対応するマスター ページを動的に関連付けます。</span><span class="sxs-lookup"><span data-stu-id="6cccf-163">At runtime, when a visitor is viewing a user's blog, the web application would need to determine the blog's layout and dynamically associate the corresponding master page with the content page.</span></span>

<span data-ttu-id="6cccf-164">外部の条件に基づいて実行時に、マスター ページを動的に読み込む方法を調べてみましょう。</span><span class="sxs-lookup"><span data-stu-id="6cccf-164">Let's examine how to dynamically load a master page at runtime based on some external criteria.</span></span> <span data-ttu-id="6cccf-165">当社の web サイトには現在 1 つのマスター ページが含まれています (`Site.master`)。</span><span class="sxs-lookup"><span data-stu-id="6cccf-165">Our website currently contains just one master page (`Site.master`).</span></span> <span data-ttu-id="6cccf-166">実行時にマスター ページの選択を説明するために別のマスター ページが必要です。</span><span class="sxs-lookup"><span data-stu-id="6cccf-166">We need another master page to illustrate choosing a master page at runtime.</span></span> <span data-ttu-id="6cccf-167">この手順は、作成して、新しいマスター ページの構成について説明します。</span><span class="sxs-lookup"><span data-stu-id="6cccf-167">This step focuses on creating and configuring the new master page.</span></span> <span data-ttu-id="6cccf-168">手順 4 では、実行時に使用するどのようなマスター ページを判断するために検索します。</span><span class="sxs-lookup"><span data-stu-id="6cccf-168">Step 4 looks at determining what master page to use at runtime.</span></span>

<span data-ttu-id="6cccf-169">という名前のルート フォルダーに新しいマスター ページを作成`Alternate.master`です。</span><span class="sxs-lookup"><span data-stu-id="6cccf-169">Create a new master page in the root folder named `Alternate.master`.</span></span> <span data-ttu-id="6cccf-170">新しいスタイル シートをという名前の web サイトにも追加`AlternateStyles.css`です。</span><span class="sxs-lookup"><span data-stu-id="6cccf-170">Also add a new style sheet to the website named `AlternateStyles.css`.</span></span>


<span data-ttu-id="6cccf-171">[![もう 1 つ追加の web サイトにマスター ページおよび CSS ファイル](specifying-the-master-page-programmatically-vb/_static/image8.png)](specifying-the-master-page-programmatically-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="6cccf-171">[![Add Another Master Page and CSS File to the Website](specifying-the-master-page-programmatically-vb/_static/image8.png)](specifying-the-master-page-programmatically-vb/_static/image7.png)</span></span>

<span data-ttu-id="6cccf-172">**図 03**: 別のマスター ページの追加と、web サイトに CSS ファイル ([フルサイズのイメージを表示するをクリックして](specifying-the-master-page-programmatically-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="6cccf-172">**Figure 03**: Add Another Master Page and CSS File to the Website  ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image9.png))</span></span>


<span data-ttu-id="6cccf-173">設計すれば、`Alternate.master`マスター ページにあるネイビー カラーのバック グラウンドで中央揃え、ページの上部に表示されるタイトルです。</span><span class="sxs-lookup"><span data-stu-id="6cccf-173">I've designed the `Alternate.master` master page to have the title displayed at the top of the page, centered and on a navy background.</span></span> <span data-ttu-id="6cccf-174">左の列の割り当てを下にあるそのコンテンツを移動したすれば、 `MainContent` ContentPlaceHolder コントロールは、ページの幅全体にまたがるようになりました。</span><span class="sxs-lookup"><span data-stu-id="6cccf-174">I've dispensed of the left column and moved that content beneath the `MainContent` ContentPlaceHolder control, which now spans the entire width of the page.</span></span> <span data-ttu-id="6cccf-175">さらに、順序なしのレッスンのリストを nixed して上記の水平方向の一覧に置き換え`MainContent`です。</span><span class="sxs-lookup"><span data-stu-id="6cccf-175">Furthermore, I nixed the unordered Lessons list and replaced it with a horizontal list above `MainContent`.</span></span> <span data-ttu-id="6cccf-176">フォントおよびマスター ページで (および、そのコンテンツ ページの拡張機能) を使用する色を更新しました。</span><span class="sxs-lookup"><span data-stu-id="6cccf-176">I also updated the fonts and colors used by the master page (and, by extension, its content pages).</span></span> <span data-ttu-id="6cccf-177">図 4 は`Default.aspx`を使用する場合、`Alternate.master`マスター ページ。</span><span class="sxs-lookup"><span data-stu-id="6cccf-177">Figure 4 shows `Default.aspx` when using the `Alternate.master` master page.</span></span>

> [!NOTE]
> <span data-ttu-id="6cccf-178">ASP.NET には、定義する機能が含まれています。*テーマ*です。</span><span class="sxs-lookup"><span data-stu-id="6cccf-178">ASP.NET includes the ability to define *Themes*.</span></span> <span data-ttu-id="6cccf-179">テーマは、イメージ、CSS ファイル、およびスタイルに関連する Web コントロール プロパティの設定時にページに適用できるのコレクションです。</span><span class="sxs-lookup"><span data-stu-id="6cccf-179">A Theme is a collection of images, CSS files, and style-related Web control property settings that can be applied to a page at runtime.</span></span> <span data-ttu-id="6cccf-180">テーマは、および、CSS 規則によって表示される画像にのみ、サイトのレイアウトが異なる場合に移動する方法です。</span><span class="sxs-lookup"><span data-stu-id="6cccf-180">Themes are the way to go if your site's layouts differ only in the images displayed and by their CSS rules.</span></span> <span data-ttu-id="6cccf-181">別の Web コントロールを使用して、根本的に異なるレイアウトを持つなど、実質的に複数のレイアウトが異なる場合は、個別のマスター ページを使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="6cccf-181">If the layouts differ more substantially, such as using different Web controls or having a radically different layout, then you will need to use separate master pages.</span></span> <span data-ttu-id="6cccf-182">テーマの詳細については、このチュートリアルの最後には、関連項目」セクションを参照してください。</span><span class="sxs-lookup"><span data-stu-id="6cccf-182">Consult the Further Reading section at the end of this tutorial for more information on Themes.</span></span>


<span data-ttu-id="6cccf-183">[![コンテンツ ページ、使用できるように新しいルック アンド フィール](specifying-the-master-page-programmatically-vb/_static/image11.png)](specifying-the-master-page-programmatically-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="6cccf-183">[![Our Content Pages Can Now Use a New Look and Feel](specifying-the-master-page-programmatically-vb/_static/image11.png)](specifying-the-master-page-programmatically-vb/_static/image10.png)</span></span>

<span data-ttu-id="6cccf-184">**図 04**: コンテンツのページは、使用できるように新しいルック アンド フィール ([フルサイズのイメージを表示するをクリックして](specifying-the-master-page-programmatically-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="6cccf-184">**Figure 04**: Our Content Pages Can Now Use a New Look and Feel ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image12.png))</span></span>


<span data-ttu-id="6cccf-185">マスターとコンテンツのページのマークアップを定着すると、ときに、`MasterPage`クラスのすべてのコンテンツをことを確認するためのチェック コンテンツ ページにコントロールがマスター ページ プレース ホルダーを参照します。</span><span class="sxs-lookup"><span data-stu-id="6cccf-185">When the master and content pages' markup are fused, the `MasterPage` class checks to ensure that every Content control in the content page references a ContentPlaceHolder in the master page.</span></span> <span data-ttu-id="6cccf-186">存在しない ContentPlaceHolder を参照するコンテンツ コントロールが見つかった場合は、例外がスローされます。</span><span class="sxs-lookup"><span data-stu-id="6cccf-186">An exception is thrown if a Content control that references a non-existent ContentPlaceHolder is found.</span></span> <span data-ttu-id="6cccf-187">つまり、コンテンツ ページに割り当てられているマスター ページにある各、ContentPlaceHolder 命令型は、コンテンツ ページ内のコントロールのコンテンツします。</span><span class="sxs-lookup"><span data-stu-id="6cccf-187">In other words, it is imperative that the master page being assigned to the content page have a ContentPlaceHolder for each Content control in the content page.</span></span>

<span data-ttu-id="6cccf-188">`Site.master`マスター ページには、4 つのプレース ホルダー コントロールが含まれています。</span><span class="sxs-lookup"><span data-stu-id="6cccf-188">The `Site.master` master page includes four ContentPlaceHolder controls:</span></span>

- `head`
- `MainContent`
- `QuickLoginUI`
- `LeftColumnContent`

<span data-ttu-id="6cccf-189">当社の web サイトのコンテンツ ページのものが 1 つか 2 つのコンテンツ コントロールです。他のユーザーには、使用可能な contentplaceholders の各コンテンツ コントロールが含まれます。</span><span class="sxs-lookup"><span data-stu-id="6cccf-189">Some of the content pages in our website include just one or two Content controls; others include a Content control for each of the available ContentPlaceHolders.</span></span> <span data-ttu-id="6cccf-190">場合、新しいマスター ページ (`Alternate.master`) これまでに contentplaceholders には、すべてのコンテンツ コントロールがあるこれらのコンテンツ ページを割り当てることができます`Site.master`を`Alternate.master`として同じレイアウトを得ることがあります`Site.master`.</span><span class="sxs-lookup"><span data-stu-id="6cccf-190">If our new master page (`Alternate.master`) may ever be assigned to those content pages that have Content controls for all of the ContentPlaceHolders in `Site.master` then it is essential that `Alternate.master` also include the same ContentPlaceHolder controls as `Site.master`.</span></span>

<span data-ttu-id="6cccf-191">取得する、`Alternate.master`マスター ページ (図 4 を参照) が広くで、マスター ページのスタイルを定義することによって開始するように、`AlternateStyles.css`スタイル シートです。</span><span class="sxs-lookup"><span data-stu-id="6cccf-191">To get your `Alternate.master` master page to look similar to mine (see Figure 4), start by defining the master page's styles in the `AlternateStyles.css` style sheet.</span></span> <span data-ttu-id="6cccf-192">次の規則を追加`AlternateStyles.css`:</span><span class="sxs-lookup"><span data-stu-id="6cccf-192">Add the following rules into `AlternateStyles.css`:</span></span>


[!code-css[Main](specifying-the-master-page-programmatically-vb/samples/sample5.css)]

<span data-ttu-id="6cccf-193">次に示す宣言型マークアップを次に、追加`Alternate.master`です。</span><span class="sxs-lookup"><span data-stu-id="6cccf-193">Next, add the following declarative markup to `Alternate.master`.</span></span> <span data-ttu-id="6cccf-194">ご覧のとおり、`Alternate.master`を同じ 4 つのプレース ホルダー コントロールが含まれています`ID`ContentPlaceHolder のコントロールと値`Site.master`です。</span><span class="sxs-lookup"><span data-stu-id="6cccf-194">As you can see, `Alternate.master` contains four ContentPlaceHolder controls with the same `ID` values as the ContentPlaceHolder controls in `Site.master`.</span></span> <span data-ttu-id="6cccf-195">さらに、これは、これらのページ、web サイトで ASP.NET AJAX framework を使用するために必要な ScriptManager コントロールが含まれています。</span><span class="sxs-lookup"><span data-stu-id="6cccf-195">Moreover, it includes a ScriptManager control, which is necessary for those pages in our website that use the ASP.NET AJAX framework.</span></span>


[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample6.aspx)]

### <a name="testing-the-new-master-page"></a><span data-ttu-id="6cccf-196">新しいマスター ページのテスト</span><span class="sxs-lookup"><span data-stu-id="6cccf-196">Testing the New Master Page</span></span>

<span data-ttu-id="6cccf-197">この新しいマスター ページの更新プログラムをテストする、`BasePage`クラスの`OnPreInit`メソッドできるように、`MasterPageFile`プロパティの値が割り当てられた`"~/Alternate.maser"`し、web サイトにアクセスします。</span><span class="sxs-lookup"><span data-stu-id="6cccf-197">To test this new master page update the `BasePage` class's `OnPreInit` method so that the `MasterPageFile` property is assigned the value `"~/Alternate.maser"` and then visit the website.</span></span> <span data-ttu-id="6cccf-198">すべてのページが 2 つを除くエラーなし機能する必要があります:`~/Admin/AddProduct.aspx`と`~/Admin/Products.aspx`です。</span><span class="sxs-lookup"><span data-stu-id="6cccf-198">Every page should function without error except for two: `~/Admin/AddProduct.aspx` and `~/Admin/Products.aspx`.</span></span> <span data-ttu-id="6cccf-199">DetailsView で製品を追加`~/Admin/AddProduct.aspx`結果、`NullReferenceException`マスター ページの設定を試みるコードの行から`GridMessageText`プロパティです。</span><span class="sxs-lookup"><span data-stu-id="6cccf-199">Adding a product to the DetailsView in `~/Admin/AddProduct.aspx` results in a `NullReferenceException` from the line of code that attempts to set the master page's `GridMessageText` property.</span></span> <span data-ttu-id="6cccf-200">アクセスすると`~/Admin/Products.aspx`、`InvalidCastException`メッセージ ページの読み込みでスローされます:"型のオブジェクトはキャストできません 'ASP.alternate\_マスター' 型に ' ASP.site\_マスター '。"。</span><span class="sxs-lookup"><span data-stu-id="6cccf-200">When visiting `~/Admin/Products.aspx` an `InvalidCastException` is thrown on page load with the message: "Unable to cast object of type 'ASP.alternate\_master' to type 'ASP.site\_master'."</span></span>

<span data-ttu-id="6cccf-201">これらのエラーが発生する、`Site.master`分離コード クラスには、パブリック イベント、プロパティ、およびで定義されていないメソッドが含まれています。`Alternate.master`です。</span><span class="sxs-lookup"><span data-stu-id="6cccf-201">These errors occur because the `Site.master` code-behind class includes public events, properties, and methods that are not defined in `Alternate.master`.</span></span> <span data-ttu-id="6cccf-202">これら 2 つのページのマークアップの部分である、`@MasterType`を参照するディレクティブ、`Site.master`マスター ページ。</span><span class="sxs-lookup"><span data-stu-id="6cccf-202">The markup portion of these two pages have a `@MasterType` directive that references the `Site.master` master page.</span></span>


[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample7.aspx)]

<span data-ttu-id="6cccf-203">また、DetailsView の`ItemInserted`内のイベント ハンドラー `~/Admin/AddProduct.aspx` 、厳密に型をキャストするコードが含まれています`Page.Master`プロパティ型のオブジェクトを`Site`です。</span><span class="sxs-lookup"><span data-stu-id="6cccf-203">Also, the DetailsView's `ItemInserted` event handler in `~/Admin/AddProduct.aspx` includes code that casts the loosely-typed `Page.Master` property to an object of type `Site`.</span></span> <span data-ttu-id="6cccf-204">`@MasterType`ディレクティブ (この方法を使用) とのキャスト、`ItemInserted`イベント ハンドラーを密に結合、`~/Admin/AddProduct.aspx`と`~/Admin/Products.aspx`ページを`Site.master`マスター ページ。</span><span class="sxs-lookup"><span data-stu-id="6cccf-204">The `@MasterType` directive (used this way) and the cast in the `ItemInserted` event handler tightly couples the `~/Admin/AddProduct.aspx` and `~/Admin/Products.aspx` pages to the `Site.master` master page.</span></span>

<span data-ttu-id="6cccf-205">あってもこの密結合を中断する`Site.master`と`Alternate.master`のパブリック メンバーの定義が含まれる共通の基本クラスから派生します。</span><span class="sxs-lookup"><span data-stu-id="6cccf-205">To break this tight coupling we can have `Site.master` and `Alternate.master` derive from a common base class that contains definitions for the public members.</span></span> <span data-ttu-id="6cccf-206">次に、更新することが、`@MasterType`この共通の基本型を参照するディレクティブ。</span><span class="sxs-lookup"><span data-stu-id="6cccf-206">Following that, we can update the `@MasterType` directive to reference this common base type.</span></span>

### <a name="creating-a-custom-base-master-page-class"></a><span data-ttu-id="6cccf-207">カスタム ベースのマスター ページ クラスを作成します。</span><span class="sxs-lookup"><span data-stu-id="6cccf-207">Creating a Custom Base Master Page Class</span></span>

<span data-ttu-id="6cccf-208">新しいクラス ファイルを追加、`App_Code`という名前のフォルダー`BaseMasterPage.vb`をから派生して`System.Web.UI.MasterPage`です。</span><span class="sxs-lookup"><span data-stu-id="6cccf-208">Add a new class file to the `App_Code` folder named `BaseMasterPage.vb` and have it derive from `System.Web.UI.MasterPage`.</span></span> <span data-ttu-id="6cccf-209">定義する必要があります、`RefreshRecentProductsGrid`メソッドおよび`GridMessageText`プロパティ`BaseMasterPage`、そこからを単に移動できませんが、`Site.master`これらのメンバーに固有の Web コントロールを操作するため、`Site.master`マスター ページ (、 `RecentProducts`GridView と`GridMessage`ラベル)。</span><span class="sxs-lookup"><span data-stu-id="6cccf-209">We need to define the `RefreshRecentProductsGrid` method and the `GridMessageText` property in `BaseMasterPage`, but we can't simply move them there from `Site.master` because these members work with Web controls that are specific to the `Site.master` master page (the `RecentProducts` GridView and `GridMessage` Label).</span></span>

<span data-ttu-id="6cccf-210">構成を行う必要があります`BaseMasterPage`これらのメンバーが、定義されますが、によって実際に実装されているように`BaseMasterPage`派生クラス (`Site.master`と`Alternate.master`)。</span><span class="sxs-lookup"><span data-stu-id="6cccf-210">What we need to do is configure `BaseMasterPage` in such a way that these members are defined there, but are actually implemented by `BaseMasterPage`'s derived classes (`Site.master` and `Alternate.master`).</span></span> <span data-ttu-id="6cccf-211">この継承の種類がクラスとしてマークすることによって可能な`MustInherit`とそのメンバーとして`MustOverride`です。</span><span class="sxs-lookup"><span data-stu-id="6cccf-211">This type of inheritance is possible by marking the class as `MustInherit` and its members as `MustOverride`.</span></span> <span data-ttu-id="6cccf-212">つまり、クラスとその 2 つのメンバーにこれらのキーワードを追加することを発表を`BaseMasterPage`実装いない`RefreshRecentProductsGrid`と`GridMessageText`が、その派生クラスはします。</span><span class="sxs-lookup"><span data-stu-id="6cccf-212">In short, adding these keywords to the class and its two members announces that `BaseMasterPage` hasn't implemented `RefreshRecentProductsGrid` and `GridMessageText`, but that its derived classes will.</span></span>

<span data-ttu-id="6cccf-213">定義する必要があります、`PricesDoubled`でイベント`BaseMasterPage`し、イベントを発生させる、派生クラスによって手段を提供します。</span><span class="sxs-lookup"><span data-stu-id="6cccf-213">We also need to define the `PricesDoubled` event in `BaseMasterPage` and provide a means by the derived classes to raise the event.</span></span> <span data-ttu-id="6cccf-214">この動作を容易にするために、.NET Framework で使用されるパターンでは、基本クラスにパブリック イベントを作成し、という名前の保護されている、オーバーライド可能なメソッドを追加`OnEventName`です。</span><span class="sxs-lookup"><span data-stu-id="6cccf-214">The pattern used in the .NET Framework to facilitate this behavior is to create a public event in the base class and add a protected, overridable method named `OnEventName`.</span></span> <span data-ttu-id="6cccf-215">派生クラスでは、イベントを発生させるには、このメソッドを呼び出すことができますし、またはイベントが発生した後、または直前にコードを実行するようにオーバーライドできます。</span><span class="sxs-lookup"><span data-stu-id="6cccf-215">Derived classes can then call this method to raise the event or can override it to execute code immediately before or after the event is raised.</span></span>

<span data-ttu-id="6cccf-216">更新プログラム、`BaseMasterPage`クラスの次のコードが含まれるようにします。</span><span class="sxs-lookup"><span data-stu-id="6cccf-216">Update your `BaseMasterPage` class so that it contains the following code:</span></span>


[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample8.vb)]

<span data-ttu-id="6cccf-217">次に移動、`Site.master`分離コード クラスをから派生して`BaseMasterPage`です。</span><span class="sxs-lookup"><span data-stu-id="6cccf-217">Next, go to the `Site.master` code-behind class and have it derive from `BaseMasterPage`.</span></span> <span data-ttu-id="6cccf-218">`BaseMasterPage`マークされたメンバーを含む`MustOverride`をここでのメンバーをオーバーライドする必要があります`Site.master`です。</span><span class="sxs-lookup"><span data-stu-id="6cccf-218">Because `BaseMasterPage` contains members marked `MustOverride` we need to override those members here in `Site.master`.</span></span> <span data-ttu-id="6cccf-219">追加、`Overrides`キーワード、メソッドとプロパティの定義をします。</span><span class="sxs-lookup"><span data-stu-id="6cccf-219">Add the `Overrides` keyword to the method and property definitions.</span></span> <span data-ttu-id="6cccf-220">発生させるコードを更新しても、`PricesDoubled`内のイベント、`DoublePrice`ボタンの`Click`を呼び出して、基底クラスのイベント ハンドラー`OnPricesDoubled`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="6cccf-220">Also update the code that raises the `PricesDoubled` event in the `DoublePrice` Button's `Click` event handler with a call to the base class's `OnPricesDoubled` method.</span></span>

<span data-ttu-id="6cccf-221">これらの変更後、`Site.master`分離コード クラスには、次のコードが含まれている必要があります。</span><span class="sxs-lookup"><span data-stu-id="6cccf-221">After these modifications the `Site.master` code-behind class should contain the following code:</span></span>


[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample9.vb)]

<span data-ttu-id="6cccf-222">更新する必要があります`Alternate.master`の分離コード クラスから派生する`BaseMasterPage`、2 つのオーバーライドと`MustOverride`メンバー。</span><span class="sxs-lookup"><span data-stu-id="6cccf-222">We also need to update `Alternate.master`'s code-behind class to derive from `BaseMasterPage` and override the two `MustOverride` members.</span></span> <span data-ttu-id="6cccf-223">`Alternate.master`リストは、データベースに最新の製品や新製品の後にメッセージを表示するラベルを追加、これらのメソッドは必要がないことは何も操作する GridView が含まれていません。</span><span class="sxs-lookup"><span data-stu-id="6cccf-223">But because `Alternate.master` does not contain a GridView that lists the most recent products nor a Label that displays a message after a new product is added to the database, these methods do not need to do anything.</span></span>


[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample10.vb)]

### <a name="referencing-the-base-master-page-class"></a><span data-ttu-id="6cccf-224">ベースのマスター ページ クラスを参照します。</span><span class="sxs-lookup"><span data-stu-id="6cccf-224">Referencing the Base Master Page Class</span></span>

<span data-ttu-id="6cccf-225">これで完了しました、`BaseMasterPage`クラスし拡張すること、2 つのマスター ページ、最後の手順が更新するには、`~/Admin/AddProduct.aspx`と`~/Admin/Products.aspx`この共通の型を参照するページ。</span><span class="sxs-lookup"><span data-stu-id="6cccf-225">Now that we have completed the `BaseMasterPage` class and have our two master pages extending it, our final step is to update the `~/Admin/AddProduct.aspx` and `~/Admin/Products.aspx` pages to refer to this common type.</span></span> <span data-ttu-id="6cccf-226">変更することで開始、`@MasterType`ディレクティブから両方のページで。</span><span class="sxs-lookup"><span data-stu-id="6cccf-226">Start by changing the `@MasterType` directive in both pages from:</span></span>


[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample11.aspx)]

<span data-ttu-id="6cccf-227">移動先:</span><span class="sxs-lookup"><span data-stu-id="6cccf-227">To:</span></span>


[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample12.aspx)]

<span data-ttu-id="6cccf-228">ファイルのパスを参照するのではなく、`@MasterType`プロパティは、基本データ型を参照するよう (`BaseMasterPage`)。</span><span class="sxs-lookup"><span data-stu-id="6cccf-228">Rather than referencing a file path, the `@MasterType` property now references the base type (`BaseMasterPage`).</span></span> <span data-ttu-id="6cccf-229">その結果、厳密に型指定された`Master`両方のページの分離コード クラスで使用されるプロパティは、現在の型の`BaseMasterPage`(型ではなく`Site`)。</span><span class="sxs-lookup"><span data-stu-id="6cccf-229">Consequently, the strongly-typed `Master` property used in both pages' code-behind classes is now of type `BaseMasterPage` (instead of type `Site`).</span></span> <span data-ttu-id="6cccf-230">この場所の変更と再表示`~/Admin/Products.aspx`です。</span><span class="sxs-lookup"><span data-stu-id="6cccf-230">With this change in place revisit `~/Admin/Products.aspx`.</span></span> <span data-ttu-id="6cccf-231">以前は、このエラーが発生しました、キャスト、ページを使用して構成されているため、`Alternate.master`マスター ページですが、`@MasterType`参照ディレクティブ、`Site.master`ファイル。</span><span class="sxs-lookup"><span data-stu-id="6cccf-231">Previously, this resulted in a casting error because the page is configured to use the `Alternate.master` master page, but the `@MasterType` directive referenced the `Site.master` file.</span></span> <span data-ttu-id="6cccf-232">エラーが発生せず、ページが表示されるようになりました。</span><span class="sxs-lookup"><span data-stu-id="6cccf-232">But now the page renders without error.</span></span> <span data-ttu-id="6cccf-233">これは、ため、`Alternate.master`マスター ページは、型のオブジェクトにキャストできる`BaseMasterPage`(これは、それを拡張) してからです。</span><span class="sxs-lookup"><span data-stu-id="6cccf-233">This is because the `Alternate.master` master page can be cast to an object of type `BaseMasterPage` (since it extends it).</span></span>

<span data-ttu-id="6cccf-234">実行する必要がある 1 つの小さな変更がある`~/Admin/AddProduct.aspx`です。</span><span class="sxs-lookup"><span data-stu-id="6cccf-234">There's one small change that needs to be made in `~/Admin/AddProduct.aspx`.</span></span> <span data-ttu-id="6cccf-235">DetailsView コントロールの`ItemInserted`両方、厳密に型指定されたイベント ハンドラーを使用して`Master`プロパティと、厳密に型`Page.Master`プロパティです。</span><span class="sxs-lookup"><span data-stu-id="6cccf-235">The DetailsView control's `ItemInserted` event handler uses both the strongly-typed `Master` property and the loosely-typed `Page.Master` property.</span></span> <span data-ttu-id="6cccf-236">更新されたときに、厳密に型指定された参照を修正しました、`@MasterType`ディレクティブ、ですが厳密に型参照を更新する必要があります。</span><span class="sxs-lookup"><span data-stu-id="6cccf-236">We fixed the strongly-typed reference when we updated the `@MasterType` directive, but we still need to update the loosely-typed reference.</span></span> <span data-ttu-id="6cccf-237">次のコード行に置き換えます。</span><span class="sxs-lookup"><span data-stu-id="6cccf-237">Replace the following line of code:</span></span>


[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample13.vb)]

<span data-ttu-id="6cccf-238">キャストすると、次のように`Page.Master`基本型にします。</span><span class="sxs-lookup"><span data-stu-id="6cccf-238">With the following, which casts `Page.Master` to the base type:</span></span>


[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample14.vb)]

## <a name="step-4-determining-what-master-page-to-bind-to-the-content-pages"></a><span data-ttu-id="6cccf-239">手順 4: コンテンツのページへのバインドには、どのようなマスター ページを決定します。</span><span class="sxs-lookup"><span data-stu-id="6cccf-239">Step 4: Determining What Master Page to Bind to the Content Pages</span></span>

<span data-ttu-id="6cccf-240">当社`BasePage`クラスは、すべてのコンテンツ ページを現在設定`MasterPageFile`プロパティ ページのライフ サイクルの PreInit 段階ではハード コーディングされた値にします。</span><span class="sxs-lookup"><span data-stu-id="6cccf-240">Our `BasePage` class currently sets all content pages' `MasterPageFile` properties to a hard-coded value in the PreInit stage of the page lifecycle.</span></span> <span data-ttu-id="6cccf-241">このコードの外部要素をマスター ページを基に更新することができます。</span><span class="sxs-lookup"><span data-stu-id="6cccf-241">We can update this code to base the master page on some external factor.</span></span> <span data-ttu-id="6cccf-242">おそらく、マスター ページの読み込みには、現在ログオンしているユーザーの基本設定に依存します。</span><span class="sxs-lookup"><span data-stu-id="6cccf-242">Perhaps the master page to load depends on the preferences of the currently logged on user.</span></span> <span data-ttu-id="6cccf-243">コードを記述する必要があります、その場合は、`OnPreInit`メソッド`BasePage`現在アクセスしたユーザーのマスター ページの基本設定を検索します。</span><span class="sxs-lookup"><span data-stu-id="6cccf-243">In that case, we'd need to write code in the `OnPreInit` method in `BasePage` that looks up the currently visiting user's master page preferences.</span></span>

<span data-ttu-id="6cccf-244">使用するマスター ページを選択できる web ページを作成しましょう`Site.master`または`Alternate.master`-セッション変数にこの選択を保存します。</span><span class="sxs-lookup"><span data-stu-id="6cccf-244">Let's create a web page that allows the user to choose which master page to use - `Site.master` or `Alternate.master` - and save this choice in a Session variable.</span></span> <span data-ttu-id="6cccf-245">まず、という名前のルート ディレクトリに新しい web ページを作成して`ChooseMasterPage.aspx`です。</span><span class="sxs-lookup"><span data-stu-id="6cccf-245">Start by creating a new web page in the root directory named `ChooseMasterPage.aspx`.</span></span> <span data-ttu-id="6cccf-246">このページ (またはその他のコンテンツ ページ以降) を作成するときにないマスター ページをプログラムで設定されているため、マスター ページにバインドする必要があります。`BasePage`です。</span><span class="sxs-lookup"><span data-stu-id="6cccf-246">When creating this page (or any other content pages henceforth) you don't need to bind it to a master page because the master page is set programmatically in `BasePage`.</span></span> <span data-ttu-id="6cccf-247">ただし、マスター ページに新しいページをバインドしない場合、新しいページの既定の宣言型マークアップが含まれています、Web フォームおよびマスター ページで指定されたその他のコンテンツ。</span><span class="sxs-lookup"><span data-stu-id="6cccf-247">However, if you do not bind the new page to a master page then the new page's default declarative markup contains a Web Form and other content supplied by the master page.</span></span> <span data-ttu-id="6cccf-248">適切なコンテンツ コントロールをこのマークアップを手動で交換する必要があります。</span><span class="sxs-lookup"><span data-stu-id="6cccf-248">You'll need to manually replace this markup with the appropriate Content controls.</span></span> <span data-ttu-id="6cccf-249">そのため、ほうが簡単にマスター ページに新しい ASP.NET ページをバインドします。</span><span class="sxs-lookup"><span data-stu-id="6cccf-249">For that reason, I find it easier to bind the new ASP.NET page to a master page.</span></span>

> [!NOTE]
> <span data-ttu-id="6cccf-250">`Site.master`と`Alternate.master`同じ設定した ContentPlaceHolder コントロールの新しいコンテンツ ページを作成するときに選択するどのようなマスター ページは重要でありません。</span><span class="sxs-lookup"><span data-stu-id="6cccf-250">Because `Site.master` and `Alternate.master` have the same set of ContentPlaceHolder controls it doesn't matter what master page you choose when creating the new content page.</span></span> <span data-ttu-id="6cccf-251">一貫性のことをお勧めを使用して`Site.master`です。</span><span class="sxs-lookup"><span data-stu-id="6cccf-251">For consistency, I'd suggest using `Site.master`.</span></span>


<span data-ttu-id="6cccf-252">[![Web サイトに新しいコンテンツ ページを追加します。](specifying-the-master-page-programmatically-vb/_static/image14.png)](specifying-the-master-page-programmatically-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="6cccf-252">[![Add a New Content Page to the Website](specifying-the-master-page-programmatically-vb/_static/image14.png)](specifying-the-master-page-programmatically-vb/_static/image13.png)</span></span>

<span data-ttu-id="6cccf-253">**図 05**: web サイトに新しいコンテンツ ページを追加 ([フルサイズのイメージを表示するをクリックして](specifying-the-master-page-programmatically-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="6cccf-253">**Figure 05**: Add a New Content Page to the Website ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image15.png))</span></span>


<span data-ttu-id="6cccf-254">更新プログラム、`Web.sitemap`このレッスンのエントリを追加するファイル。</span><span class="sxs-lookup"><span data-stu-id="6cccf-254">Update the `Web.sitemap` file to include an entry for this lesson.</span></span> <span data-ttu-id="6cccf-255">下に次のマークアップを追加、`<siteMapNode>`マスター ページや ASP.NET AJAX のレッスン。</span><span class="sxs-lookup"><span data-stu-id="6cccf-255">Add the following markup beneath the `<siteMapNode>` for the Master Pages and ASP.NET AJAX lesson:</span></span>


[!code-xml[Main](specifying-the-master-page-programmatically-vb/samples/sample15.xml)]

<span data-ttu-id="6cccf-256">コンテンツを追加する前に、`ChooseMasterPage.aspx`から派生するように、ページの分離コード クラスを更新する ページですぐ`BasePage`(なく`System.Web.UI.Page`)。</span><span class="sxs-lookup"><span data-stu-id="6cccf-256">Before adding any content to the `ChooseMasterPage.aspx` page take a moment to update the page's code-behind class so that it derives from `BasePage` (rather than `System.Web.UI.Page`).</span></span> <span data-ttu-id="6cccf-257">DropDownList コントロール、ページを追加、設定を次に、その`ID`プロパティを`MasterPageChoice`で 2 つのリスト項目を追加し、`Text`の値"~/Site.master"と"~/Alternate.master"です。</span><span class="sxs-lookup"><span data-stu-id="6cccf-257">Next, add a DropDownList control to the page, set its `ID` property to `MasterPageChoice`, and add two ListItems with the `Text` values of "~/Site.master" and "~/Alternate.master".</span></span>

<span data-ttu-id="6cccf-258">Button Web コントロールをページに追加し、設定、`ID`と`Text`プロパティ`SaveLayout`と「保存レイアウトの選択」、それぞれします。</span><span class="sxs-lookup"><span data-stu-id="6cccf-258">Add a Button Web control to the page and set its `ID` and `Text` properties to `SaveLayout` and "Save Layout Choice", respectively.</span></span> <span data-ttu-id="6cccf-259">この時点で、ページの宣言型マークアップは、次のようになります。</span><span class="sxs-lookup"><span data-stu-id="6cccf-259">At this point your page's declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample16.aspx)]

<span data-ttu-id="6cccf-260">ページが初めてアクセスしたときに、ユーザーの現在選択されているマスター ページの選択を表示する必要があります。</span><span class="sxs-lookup"><span data-stu-id="6cccf-260">When the page is first visited we need to display the user's currently selected master page choice.</span></span> <span data-ttu-id="6cccf-261">作成、`Page_Load`イベント ハンドラーを次のコードを追加します。</span><span class="sxs-lookup"><span data-stu-id="6cccf-261">Create a `Page_Load` event handler and add the following code:</span></span>


[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample17.vb)]

<span data-ttu-id="6cccf-262">上記のコードは、最初のページ アクセスでのみ (および以降のポストバックではなく) を実行します。</span><span class="sxs-lookup"><span data-stu-id="6cccf-262">The above code executes only on the first page visit (and not on subsequent postbacks).</span></span> <span data-ttu-id="6cccf-263">かどうかをまずセッション変数`MyMasterPage`が存在します。</span><span class="sxs-lookup"><span data-stu-id="6cccf-263">It first checks to see if the Session variable `MyMasterPage` exists.</span></span> <span data-ttu-id="6cccf-264">一致するリスト アイテムを検索する場合はその、 `MasterPageChoice` DropDownList です。</span><span class="sxs-lookup"><span data-stu-id="6cccf-264">If it does, it attempts to find the matching ListItem in the `MasterPageChoice` DropDownList.</span></span> <span data-ttu-id="6cccf-265">一致する ListItem が見つかった場合、その`Selected`プロパティに設定されている`True`です。</span><span class="sxs-lookup"><span data-stu-id="6cccf-265">If a matching ListItem is found, its `Selected` property is set to `True`.</span></span>

<span data-ttu-id="6cccf-266">コードにユーザーの選択を保存する必要があります、`MyMasterPage`セッション変数。</span><span class="sxs-lookup"><span data-stu-id="6cccf-266">We also need code that saves the user's choice into the `MyMasterPage` Session variable.</span></span> <span data-ttu-id="6cccf-267">イベント ハンドラーを作成、`SaveLayout`ボタンの`Click`イベントし、次のコードを追加します。</span><span class="sxs-lookup"><span data-stu-id="6cccf-267">Create an event handler for the `SaveLayout` Button's `Click` event and add the following code:</span></span>


[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample18.vb)]

> [!NOTE]
> <span data-ttu-id="6cccf-268">時間によって、`Click`ポストバック時にイベント ハンドラーが実行されると、マスター ページは既に選択されています。</span><span class="sxs-lookup"><span data-stu-id="6cccf-268">By the time the `Click` event handler executes on postback, the master page has already been selected.</span></span> <span data-ttu-id="6cccf-269">そのため、ユーザーのドロップダウン リストの選択はありませんが有効にまで、次のページを参照してください。</span><span class="sxs-lookup"><span data-stu-id="6cccf-269">Therefore, the user's drop-down list selection won't be in effect until the next page visit.</span></span> <span data-ttu-id="6cccf-270">`Response.Redirect`強制的に再要求するブラウザー`ChooseMasterPage.aspx`です。</span><span class="sxs-lookup"><span data-stu-id="6cccf-270">The `Response.Redirect` forces the browser to re-request `ChooseMasterPage.aspx`.</span></span>


<span data-ttu-id="6cccf-271">`ChooseMasterPage.aspx`ページが完了したら、最後のタスクは、こと`BasePage`を割り当てる、`MasterPageFile`プロパティの値に基づきます、`MyMasterPage`セッション変数。</span><span class="sxs-lookup"><span data-stu-id="6cccf-271">With the `ChooseMasterPage.aspx` page complete, our final task is to have `BasePage` assign the `MasterPageFile` property based on the value of the `MyMasterPage` Session variable.</span></span> <span data-ttu-id="6cccf-272">セッション変数が設定されていない場合は`BasePage`既定`Site.master`です。</span><span class="sxs-lookup"><span data-stu-id="6cccf-272">If the Session variable is not set have `BasePage` default to `Site.master`.</span></span>


[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample19.vb)]

> [!NOTE]
> <span data-ttu-id="6cccf-273">割り当てるコードを移動したら、`Page`オブジェクトの`MasterPageFile`プロパティのうち、`OnPreInit`イベント ハンドラーと 2 つの異なるメソッドにします。</span><span class="sxs-lookup"><span data-stu-id="6cccf-273">I moved the code that assigns the `Page` object's `MasterPageFile` property out of the `OnPreInit` event handler and into two separate methods.</span></span> <span data-ttu-id="6cccf-274">この最初のメソッドで`SetMasterPageFile`、代入、`MasterPageFile`プロパティを 2 番目のメソッドによって返される値に`GetMasterPageFileFromSession`です。</span><span class="sxs-lookup"><span data-stu-id="6cccf-274">This first method, `SetMasterPageFile`, assigns the `MasterPageFile` property to the value returned by the second method, `GetMasterPageFileFromSession`.</span></span> <span data-ttu-id="6cccf-275">マークは、`SetMasterPageFile`メソッド`Overridable`今後のクラスを拡張するように`BasePage`必要に応じて、カスタム ロジックを実装するように必要に応じてオーバーライドできます。</span><span class="sxs-lookup"><span data-stu-id="6cccf-275">I marked the `SetMasterPageFile` method `Overridable` so that future classes that extend `BasePage` can optionally override it to implement custom logic, if needed.</span></span> <span data-ttu-id="6cccf-276">オーバーライドする例を見てみましょう`BasePage`の`SetMasterPageFile`次のチュートリアルではプロパティです。</span><span class="sxs-lookup"><span data-stu-id="6cccf-276">We'll see an example of overriding `BasePage`'s `SetMasterPageFile` property in the next tutorial.</span></span>


<span data-ttu-id="6cccf-277">配置でこのコードでは、次を参照してください。、`ChooseMasterPage.aspx`ページ。</span><span class="sxs-lookup"><span data-stu-id="6cccf-277">With this code in place, visit the `ChooseMasterPage.aspx` page.</span></span> <span data-ttu-id="6cccf-278">最初に、`Site.master`マスター ページ選択 (図 6 参照)、ですが、ユーザーがドロップダウン リストから別のマスター ページを選択できます。</span><span class="sxs-lookup"><span data-stu-id="6cccf-278">Initially, the `Site.master` master page is selected (see Figure 6), but the user can pick a different master page from the drop-down list.</span></span>


<span data-ttu-id="6cccf-279">[![Site.master マスター ページを使用してコンテンツ ページが表示されます。](specifying-the-master-page-programmatically-vb/_static/image17.png)](specifying-the-master-page-programmatically-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="6cccf-279">[![Content Pages are Displayed Using the Site.master Master Page](specifying-the-master-page-programmatically-vb/_static/image17.png)](specifying-the-master-page-programmatically-vb/_static/image16.png)</span></span>

<span data-ttu-id="6cccf-280">**図 06**: コンテンツのページは、表示を使用して、`Site.master`マスター ページ ([フルサイズのイメージを表示するをクリックして](specifying-the-master-page-programmatically-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="6cccf-280">**Figure 06**: Content Pages are Displayed Using the `Site.master` Master Page ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image18.png))</span></span>


<span data-ttu-id="6cccf-281">[![コンテンツ ページを表示 Alternate.master マスター ページを使用するようになりました](specifying-the-master-page-programmatically-vb/_static/image20.png)](specifying-the-master-page-programmatically-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="6cccf-281">[![Content Pages are Now Displayed Using the Alternate.master Master Page](specifying-the-master-page-programmatically-vb/_static/image20.png)](specifying-the-master-page-programmatically-vb/_static/image19.png)</span></span>

<span data-ttu-id="6cccf-282">**図 07**: コンテンツのページは、表示を使用するようになりました、`Alternate.master`マスター ページ ([フルサイズのイメージを表示するをクリックして](specifying-the-master-page-programmatically-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="6cccf-282">**Figure 07**: Content Pages are Now Displayed Using the `Alternate.master` Master Page ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image21.png))</span></span>


## <a name="summary"></a><span data-ttu-id="6cccf-283">まとめ</span><span class="sxs-lookup"><span data-stu-id="6cccf-283">Summary</span></span>

<span data-ttu-id="6cccf-284">コンテンツ ページをアクセスすると、そのコンテンツ コントロールは、マスター ページ プレース ホルダー コントロールと: fused です。</span><span class="sxs-lookup"><span data-stu-id="6cccf-284">When a content page is visited, its Content controls are fused with its master page's ContentPlaceHolder controls.</span></span> <span data-ttu-id="6cccf-285">コンテンツ ページのマスター ページがで示される、`Page`クラスの`MasterPageFile`プロパティに割り当てられる、`@Page`ディレクティブの`MasterPageFile`初期化段階での属性です。</span><span class="sxs-lookup"><span data-stu-id="6cccf-285">The content page's master page is denoted by the `Page` class's `MasterPageFile` property, which is assigned to the `@Page` directive's `MasterPageFile` attribute during the Initialization stage.</span></span> <span data-ttu-id="6cccf-286">このチュートリアルに値を割り当てることで見たとして、 `MasterPageFile` PreInit ステージの終了前に行うように限りプロパティです。</span><span class="sxs-lookup"><span data-stu-id="6cccf-286">As this tutorial showed, we can assign a value to the `MasterPageFile` property as long as we do so before the end of the PreInit stage.</span></span> <span data-ttu-id="6cccf-287">マスター ページ、プログラムで指定できることには、外部要因に基づくマスター ページに、コンテンツ ページの動的な連結などの高度なシナリオのドアが表示されます。</span><span class="sxs-lookup"><span data-stu-id="6cccf-287">Being able to programmatically specify the master page opens the door for more advanced scenarios, such as dynamically binding a content page to a master page based on external factors.</span></span>

<span data-ttu-id="6cccf-288">満足プログラミング!</span><span class="sxs-lookup"><span data-stu-id="6cccf-288">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="6cccf-289">関連項目</span><span class="sxs-lookup"><span data-stu-id="6cccf-289">Further Reading</span></span>

<span data-ttu-id="6cccf-290">このチュートリアルで説明したトピックの詳細については、次の情報を参照してください。</span><span class="sxs-lookup"><span data-stu-id="6cccf-290">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="6cccf-291">ASP.NET ページ ライフ サイクル ダイアグラム</span><span class="sxs-lookup"><span data-stu-id="6cccf-291">ASP.NET Page Lifecycle Diagram</span></span>](http://emanish.googlepages.com/Asp.Net2.0Lifecycle.PNG)
- [<span data-ttu-id="6cccf-292">ASP.NET ページ ライフ サイクルの概要</span><span class="sxs-lookup"><span data-stu-id="6cccf-292">ASP.NET Page Lifecycle Overview</span></span>](https://msdn.microsoft.com/library/ms178472.aspx)
- [<span data-ttu-id="6cccf-293">ASP.NET のテーマとスキンの概要</span><span class="sxs-lookup"><span data-stu-id="6cccf-293">ASP.NET Themes and Skins Overview</span></span>](https://msdn.microsoft.com/library/ykzx33wh.aspx)
- [<span data-ttu-id="6cccf-294">マスター ページ: ヒント、テクニック、およびトラップ</span><span class="sxs-lookup"><span data-stu-id="6cccf-294">Master Pages: Tips, Tricks, and Traps</span></span>](http://www.odetocode.com/articles/450.aspx)
- [<span data-ttu-id="6cccf-295">ASP.NET のテーマ</span><span class="sxs-lookup"><span data-stu-id="6cccf-295">Themes in ASP.NET</span></span>](http://www.odetocode.com/articles/423.aspx)

### <a name="about-the-author"></a><span data-ttu-id="6cccf-296">作成者について</span><span class="sxs-lookup"><span data-stu-id="6cccf-296">About the Author</span></span>

<span data-ttu-id="6cccf-297">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)、作成者複数受け取ります書籍や 4GuysFromRolla.com の創設者を操作した Microsoft Web テクノロジ 1998 年です。</span><span class="sxs-lookup"><span data-stu-id="6cccf-297">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="6cccf-298">Scott は、コンサルタント、トレーナー、ライターとして機能します。</span><span class="sxs-lookup"><span data-stu-id="6cccf-298">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="6cccf-299">最新の著書[ *Sam 学べる自分で ASP.NET 3.5 24 時間以内に*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco)です。</span><span class="sxs-lookup"><span data-stu-id="6cccf-299">His latest book is [*Sams Teach Yourself ASP.NET 3.5 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span></span> <span data-ttu-id="6cccf-300">Scott に到達できる[ mitchell@4GuysFromRolla.com ](mailto:mitchell@4GuysFromRolla.com)または彼のブログでを介して[ http://ScottOnWriting.NET](http://scottonwriting.net/)です。</span><span class="sxs-lookup"><span data-stu-id="6cccf-300">Scott can be reached at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="6cccf-301">感謝の特別な</span><span class="sxs-lookup"><span data-stu-id="6cccf-301">Special Thanks To</span></span>

<span data-ttu-id="6cccf-302">このチュートリアルの系列は既に多くの便利なレビュー担当者によって確認済みです。</span><span class="sxs-lookup"><span data-stu-id="6cccf-302">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="6cccf-303">このチュートリアルのレビュー担当者の潜在顧客が Suchi Banerjee しました。</span><span class="sxs-lookup"><span data-stu-id="6cccf-303">Lead reviewer for this tutorial was Suchi Banerjee.</span></span> <span data-ttu-id="6cccf-304">今後、MSDN の記事を確認することに関心のあるですか。</span><span class="sxs-lookup"><span data-stu-id="6cccf-304">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="6cccf-305">場合は、ドロップ me 一度に 1 行ずつ [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="6cccf-305">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="6cccf-306">[前へ](master-pages-and-asp-net-ajax-vb.md)
> [次へ](nested-master-pages-vb.md)</span><span class="sxs-lookup"><span data-stu-id="6cccf-306">[Previous](master-pages-and-asp-net-ajax-vb.md)
[Next](nested-master-pages-vb.md)</span></span>
