---
uid: web-forms/overview/older-versions-security/admin/building-an-interface-to-select-one-user-account-from-many-cs
title: 多数 (C# の場合) から 1 つのユーザー アカウントを選択するインターフェイスを作成 |Microsoft ドキュメント
author: rick-anderson
description: このチュートリアルでは、ページング、フィルターを適用できるグリッドによるユーザー インターフェイスを構築します。 具体的には、ユーザー インターフェイスは、一連のあるので構成されます.
ms.author: aspnetcontent
manager: wpickett
ms.date: 04/01/2008
ms.topic: article
ms.assetid: 9e4e687c-b4ec-434f-a4ef-edb0b8f365e4
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-security/admin/building-an-interface-to-select-one-user-account-from-many-cs
msc.type: authoredcontent
ms.openlocfilehash: 304505b18e330425ea1dc8df87a552f3d8cd15f3
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/06/2018
ms.locfileid: "30890672"
---
<a name="building-an-interface-to-select-one-user-account-from-many-c"></a><span data-ttu-id="d058c-104">多数 (C# の場合) から 1 つのユーザー アカウントを選択するインターフェイスの構築</span><span class="sxs-lookup"><span data-stu-id="d058c-104">Building an Interface to Select One User Account from Many (C#)</span></span>
====================
<span data-ttu-id="d058c-105">によって[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="d058c-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="d058c-106">[コードをダウンロードする](http://download.microsoft.com/download/6/0/e/60e1bd94-e5f9-4d5a-a079-f23c98f4f67d/CS.12.zip)または[PDF のダウンロード](http://download.microsoft.com/download/6/0/e/60e1bd94-e5f9-4d5a-a079-f23c98f4f67d/aspnet_tutorial12_SelectUser_cs.pdf)</span><span class="sxs-lookup"><span data-stu-id="d058c-106">[Download Code](http://download.microsoft.com/download/6/0/e/60e1bd94-e5f9-4d5a-a079-f23c98f4f67d/CS.12.zip) or [Download PDF](http://download.microsoft.com/download/6/0/e/60e1bd94-e5f9-4d5a-a079-f23c98f4f67d/aspnet_tutorial12_SelectUser_cs.pdf)</span></span>

> <span data-ttu-id="d058c-107">このチュートリアルでは、ページング、フィルターを適用できるグリッドによるユーザー インターフェイスを構築します。</span><span class="sxs-lookup"><span data-stu-id="d058c-107">In this tutorial we will build a user interface with a paged, filterable grid.</span></span> <span data-ttu-id="d058c-108">具体的には、ユーザー インターフェイスではある一連のユーザー名と一致するユーザーに表示する GridView コントロールの開始文字に基づく結果をフィルター処理します。</span><span class="sxs-lookup"><span data-stu-id="d058c-108">In particular, our user interface will consist of a series of LinkButtons for filtering the results based on the starting letter of the username, and a GridView control to show the matching users.</span></span> <span data-ttu-id="d058c-109">まず、GridView のユーザー アカウントのすべてを一覧表示します。</span><span class="sxs-lookup"><span data-stu-id="d058c-109">We'll start by listing all of the user accounts in a GridView.</span></span> <span data-ttu-id="d058c-110">次に、手順 3 であるフィルターを追加します。</span><span class="sxs-lookup"><span data-stu-id="d058c-110">Then, in Step 3, we will add the filter LinkButtons.</span></span> <span data-ttu-id="d058c-111">手順 4 は、フィルター選択された結果をページングします。</span><span class="sxs-lookup"><span data-stu-id="d058c-111">Step 4 looks at paging the filtered results.</span></span> <span data-ttu-id="d058c-112">4 までの手順 2 で構築されたインターフェイスは、特定のユーザー アカウントの管理タスクを実行すると、以降のチュートリアルで使用されてはします。</span><span class="sxs-lookup"><span data-stu-id="d058c-112">The interface constructed in Steps 2 through 4 will be used in the subsequent tutorials to perform administrative tasks for a particular user account.</span></span>


## <a name="introduction"></a><span data-ttu-id="d058c-113">はじめに</span><span class="sxs-lookup"><span data-stu-id="d058c-113">Introduction</span></span>

<span data-ttu-id="d058c-114"><a id="_msoanchor_1"> </a> [*ロールをユーザーに割り当てる*](../roles/assigning-roles-to-users-cs.md)チュートリアルでは、管理者ユーザーを選択し、自分のロールを管理するための基本的なインターフェイスを作成しました。</span><span class="sxs-lookup"><span data-stu-id="d058c-114">In the <a id="_msoanchor_1"></a>[*Assigning Roles to Users*](../roles/assigning-roles-to-users-cs.md) tutorial, we created a rudimentary interface for an administrator to select a user and manage her roles.</span></span> <span data-ttu-id="d058c-115">具体的には、インターフェイスでは、すべてのユーザーのドロップダウン リストで、管理者が表示されます。</span><span class="sxs-lookup"><span data-stu-id="d058c-115">Specifically, the interface presented the administrator with a drop-down list of all of the users.</span></span> <span data-ttu-id="d058c-116">このようなインターフェイスがありますが、ユーザーの数が 12、アカウントしますが、数百または数千のアカウントのサイト用に複雑になる場合に適しています。</span><span class="sxs-lookup"><span data-stu-id="d058c-116">Such an interface is suitable when there are but a dozen or so user accounts, but is unwieldy for sites with hundreds or thousands of accounts.</span></span> <span data-ttu-id="d058c-117">ページング、フィルターを適用できるグリッドとは、多数のユーザー ベースの web サイトの適切なユーザー インターフェイスです。</span><span class="sxs-lookup"><span data-stu-id="d058c-117">A paged, filterable grid is more suitable user interface for websites with large user bases.</span></span>

<span data-ttu-id="d058c-118">このチュートリアルでは、このようなユーザー インターフェイスを構築します。</span><span class="sxs-lookup"><span data-stu-id="d058c-118">In this tutorial we will build such a user interface.</span></span> <span data-ttu-id="d058c-119">具体的には、ユーザー インターフェイスではある一連のユーザー名と一致するユーザーに表示する GridView コントロールの開始文字に基づく結果をフィルター処理します。</span><span class="sxs-lookup"><span data-stu-id="d058c-119">In particular, our user interface will consist of a series of LinkButtons for filtering the results based on the starting letter of the username, and a GridView control to show the matching users.</span></span> <span data-ttu-id="d058c-120">まず、GridView のユーザー アカウントのすべてを一覧表示します。</span><span class="sxs-lookup"><span data-stu-id="d058c-120">We'll start by listing all of the user accounts in a GridView.</span></span> <span data-ttu-id="d058c-121">次に、手順 3 であるフィルターを追加します。</span><span class="sxs-lookup"><span data-stu-id="d058c-121">Then, in Step 3, we will add the filter LinkButtons.</span></span> <span data-ttu-id="d058c-122">手順 4 は、フィルター選択された結果をページングします。</span><span class="sxs-lookup"><span data-stu-id="d058c-122">Step 4 looks at paging the filtered results.</span></span> <span data-ttu-id="d058c-123">4 までの手順 2 で構築されたインターフェイスは、特定のユーザー アカウントの管理タスクを実行すると、以降のチュートリアルで使用されてはします。</span><span class="sxs-lookup"><span data-stu-id="d058c-123">The interface constructed in Steps 2 through 4 will be used in the subsequent tutorials to perform administrative tasks for a particular user account.</span></span>

<span data-ttu-id="d058c-124">開始しましょう!</span><span class="sxs-lookup"><span data-stu-id="d058c-124">Let's get started!</span></span>

## <a name="step-1-adding-new-aspnet-pages"></a><span data-ttu-id="d058c-125">手順 1: 新規の ASP.NET ページの追加</span><span class="sxs-lookup"><span data-stu-id="d058c-125">Step 1: Adding New ASP.NET Pages</span></span>

<span data-ttu-id="d058c-126">このチュートリアルで次の 2 つお検査さまざまな管理に関連する関数と機能します。</span><span class="sxs-lookup"><span data-stu-id="d058c-126">In this tutorial and the next two we will be examining various administration-related functions and capabilities.</span></span> <span data-ttu-id="d058c-127">一連のトピックでは、これらのチュートリアル全体で検証を実装する ASP.NET ページが必要ですが。</span><span class="sxs-lookup"><span data-stu-id="d058c-127">We will need a series of ASP.NET pages to implement the topics examined throughout these tutorials.</span></span> <span data-ttu-id="d058c-128">これらのページを作成し、サイト マップを更新してみましょう。</span><span class="sxs-lookup"><span data-stu-id="d058c-128">Let's create these pages and update the site map.</span></span>

<span data-ttu-id="d058c-129">という名前のプロジェクトに新しいフォルダーを作成して開始`Administration`です。</span><span class="sxs-lookup"><span data-stu-id="d058c-129">Start by creating a new folder in the project named `Administration`.</span></span> <span data-ttu-id="d058c-130">次に、リンクの各ページで、フォルダーを新しい 2 つの ASP.NET ページを追加、`Site.master`マスター ページ。</span><span class="sxs-lookup"><span data-stu-id="d058c-130">Next, add two new ASP.NET pages to the folder, linking each page with the `Site.master` master page.</span></span> <span data-ttu-id="d058c-131">ページの名前を付けます。</span><span class="sxs-lookup"><span data-stu-id="d058c-131">Name the pages:</span></span>

- `ManageUsers.aspx`
- `UserInformation.aspx`

<span data-ttu-id="d058c-132">また、web サイトのルート ディレクトリに 2 つのページを追加:`ChangePassword.aspx`と`RecoverPassword.aspx`です。</span><span class="sxs-lookup"><span data-stu-id="d058c-132">Also add two pages to the website's root directory: `ChangePassword.aspx` and `RecoverPassword.aspx`.</span></span>

<span data-ttu-id="d058c-133">これら 4 つのページ、この時点では、マスター ページの contentplaceholders にごとに 1 つ、2 つのコンテンツ コントロール:`MainContent`と`LoginContent`です。</span><span class="sxs-lookup"><span data-stu-id="d058c-133">These four pages should, at this point, have two Content controls, one for each of the master page's ContentPlaceHolders: `MainContent` and `LoginContent`.</span></span>

[!code-aspx[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample1.aspx)]

<span data-ttu-id="d058c-134">マスター ページの既定のマークアップを表示すること、 `LoginContent` ContentPlaceHolder これらのページです。</span><span class="sxs-lookup"><span data-stu-id="d058c-134">We want to show the master page's default markup for the `LoginContent` ContentPlaceHolder for these pages.</span></span> <span data-ttu-id="d058c-135">このため、削除の宣言型マークアップ、`Content2`コンテンツ コントロールです。</span><span class="sxs-lookup"><span data-stu-id="d058c-135">Therefore, remove the declarative markup for the `Content2` Content control.</span></span> <span data-ttu-id="d058c-136">その後、ページのマークアップは、1 つだけのコンテンツ コントロールを含める必要があります。</span><span class="sxs-lookup"><span data-stu-id="d058c-136">After doing so, the pages' markup should contain just one Content control.</span></span>

<span data-ttu-id="d058c-137">ASP.NET ページで、`Administration`管理ユーザーにのみフォルダーが目的としています。</span><span class="sxs-lookup"><span data-stu-id="d058c-137">The ASP.NET pages in the `Administration` folder are intended solely for administrative users.</span></span> <span data-ttu-id="d058c-138">システムを管理者ロールに追加しました、 <a id="_msoanchor_2"> </a> [*の作成とロールの管理*](../roles/creating-and-managing-roles-cs.md)チュートリアルです。 このロールにこれら 2 つのページへのアクセスを制限します。</span><span class="sxs-lookup"><span data-stu-id="d058c-138">We added an Administrators role to the system in the <a id="_msoanchor_2"></a>[*Creating and Managing Roles*](../roles/creating-and-managing-roles-cs.md) tutorial; restrict access to these two pages to this role.</span></span> <span data-ttu-id="d058c-139">これを実現するには追加、`Web.config`ファイルの名前を`Administration`フォルダーを構成して、`<authorization>`管理者ロールのユーザーを許可し、その他のすべてを拒否する要素。</span><span class="sxs-lookup"><span data-stu-id="d058c-139">To accomplish this, add a `Web.config` file to the `Administration` folder and configure its `<authorization>` element to admit users in the Administrators role and to deny all others.</span></span>

[!code-xml[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample2.xml)]

<span data-ttu-id="d058c-140">この時点で、プロジェクトのソリューション エクスプ ローラーはのスクリーン ショット、図 1 に示すようになります。</span><span class="sxs-lookup"><span data-stu-id="d058c-140">At this point your project's Solution Explorer should look similar to the screen shot shown in Figure 1.</span></span>


<span data-ttu-id="d058c-141">[![次の 4 つの新しいページと、Web.config ファイルが、web サイトに追加されました](building-an-interface-to-select-one-user-account-from-many-cs/_static/image2.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="d058c-141">[![Four New Pages and a Web.config File Have Been Added to the Website](building-an-interface-to-select-one-user-account-from-many-cs/_static/image2.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image1.png)</span></span>

<span data-ttu-id="d058c-142">**図 1**: 次の 4 つの新しいページおよび`Web.config`ファイルは、web サイトに追加されている ([フルサイズのイメージを表示するをクリックして](building-an-interface-to-select-one-user-account-from-many-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="d058c-142">**Figure 1**: Four New Pages and a `Web.config` File Have Been Added to the Website  ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-cs/_static/image3.png))</span></span>


<span data-ttu-id="d058c-143">最後に、サイト マップを更新 (`Web.sitemap`) に項目を追加し、`ManageUsers.aspx`ページ。</span><span class="sxs-lookup"><span data-stu-id="d058c-143">Finally, update the site map (`Web.sitemap`) to include an entry to the `ManageUsers.aspx` page.</span></span> <span data-ttu-id="d058c-144">後に次の XML を追加、`<siteMapNode>`チュートリアルでは、ロールを追加しました。</span><span class="sxs-lookup"><span data-stu-id="d058c-144">Add the following XML after the `<siteMapNode>` we added for the Roles tutorials.</span></span>

[!code-xml[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample3.xml)]

<span data-ttu-id="d058c-145">更新されたサイト マップには、ブラウザーを使用してサイトを参照してください。</span><span class="sxs-lookup"><span data-stu-id="d058c-145">With the site map updated, visit the site through a browser.</span></span> <span data-ttu-id="d058c-146">図 2 では、左側のナビゲーションには、管理のチュートリアルのアイテムが含まれます。</span><span class="sxs-lookup"><span data-stu-id="d058c-146">As Figure 2 shows, the navigation on the left now includes items for the Administration tutorials.</span></span>


<span data-ttu-id="d058c-147">[![サイト マップには、ユーザーの管理をという名前のノードが含まれています。](building-an-interface-to-select-one-user-account-from-many-cs/_static/image5.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="d058c-147">[![The Site Map Includes a Node Titled User Administration](building-an-interface-to-select-one-user-account-from-many-cs/_static/image5.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image4.png)</span></span>

<span data-ttu-id="d058c-148">**図 2**: サイト マップにはノードという名前のユーザー管理が含まれています ([フルサイズのイメージを表示するをクリックして](building-an-interface-to-select-one-user-account-from-many-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="d058c-148">**Figure 2**: The Site Map Includes a Node Titled User Administration  ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-cs/_static/image6.png))</span></span>


## <a name="step-2-listing-all-user-accounts-in-a-gridview"></a><span data-ttu-id="d058c-149">手順 2: GridView 内のすべてのユーザー アカウントを一覧表示します。</span><span class="sxs-lookup"><span data-stu-id="d058c-149">Step 2: Listing All User Accounts in a GridView</span></span>

<span data-ttu-id="d058c-150">このチュートリアルの最後の目標は、管理者が管理するユーザー アカウントを選択するページング、フィルターを適用できるグリッドを作成します。</span><span class="sxs-lookup"><span data-stu-id="d058c-150">Our end goal for this tutorial is to create a paged, filterable grid through which an administrator can select a user account to manage.</span></span> <span data-ttu-id="d058c-151">一覧から始めましょう*すべて*GridView 内のユーザーです。</span><span class="sxs-lookup"><span data-stu-id="d058c-151">Let's start by listing *all* users in a GridView.</span></span> <span data-ttu-id="d058c-152">この処理が完了した後、フィルター処理とページング インターフェイスと機能を追加します。</span><span class="sxs-lookup"><span data-stu-id="d058c-152">Once this is complete, we will add the filtering and paging interfaces and functionality.</span></span>

<span data-ttu-id="d058c-153">開く、 `ManageUsers.aspx`  ページで、`Administration`フォルダー、GridView の追加の設定とその`ID`に`UserAccounts`です。</span><span class="sxs-lookup"><span data-stu-id="d058c-153">Open the `ManageUsers.aspx` page in the `Administration` folder and add a GridView, setting its `ID` to `UserAccounts`.</span></span> <span data-ttu-id="d058c-154">GridView を使用して、ユーザー アカウントのセットにバインドするコードの記述は、すぐに、`Membership`クラスの`GetAllUsers`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="d058c-154">In a moment, we will write code to bind the set of user accounts to the GridView using the `Membership` class's `GetAllUsers` method.</span></span> <span data-ttu-id="d058c-155">前のチュートリアルで説明した、GetAllUsers メソッドが返されます、`MembershipUserCollection`コレクションであるオブジェクトの`MembershipUser`オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="d058c-155">As discussed in earlier tutorials, the GetAllUsers method returns a `MembershipUserCollection` object, which is a collection of `MembershipUser` objects.</span></span> <span data-ttu-id="d058c-156">各`MembershipUser`コレクション内のようなプロパティが含まれています。 `UserName`、 `Email`、`IsApproved`のようにします。</span><span class="sxs-lookup"><span data-stu-id="d058c-156">Each `MembershipUser` in the collection includes properties like `UserName`, `Email`, `IsApproved`, and so on.</span></span>

<span data-ttu-id="d058c-157">GridView で目的のユーザー アカウント情報を表示するために設定、GridView の`AutoGenerateColumns`プロパティを False の BoundFields を追加し、 `UserName`、 `Email`、および`Comment`プロパティとの CheckBoxFields、 `IsApproved`、`IsLockedOut`、および`IsOnline`プロパティです。</span><span class="sxs-lookup"><span data-stu-id="d058c-157">In order to display the desired user account information in the GridView, set the GridView's `AutoGenerateColumns` property to False and add BoundFields for the `UserName`, `Email`, and `Comment` properties and CheckBoxFields for the `IsApproved`, `IsLockedOut`, and `IsOnline` properties.</span></span> <span data-ttu-id="d058c-158">コントロールの宣言型マークアップ、または [フィールド] ダイアログ ボックスを使用して、この構成を適用できます。</span><span class="sxs-lookup"><span data-stu-id="d058c-158">This configuration can be applied through the control's declarative markup or via the Fields dialog box.</span></span> <span data-ttu-id="d058c-159">図 3 は、フィールドの自動生成チェック ボックスがオフになっていると、BoundFields と CheckBoxFields が追加して構成した後に、フィールドのスクリーン ショットのダイアログ ボックスを示します。</span><span class="sxs-lookup"><span data-stu-id="d058c-159">Figure 3 shows a screen shot of the Fields dialog box after the Auto-generate fields checkbox has been unchecked and the BoundFields and CheckBoxFields have been added and configured.</span></span>


<span data-ttu-id="d058c-160">[![次の 3 つ BoundFields と 3 つ CheckBoxFields GridView を追加します。](building-an-interface-to-select-one-user-account-from-many-cs/_static/image8.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="d058c-160">[![Add Three BoundFields and Three CheckBoxFields to the GridView](building-an-interface-to-select-one-user-account-from-many-cs/_static/image8.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image7.png)</span></span>

<span data-ttu-id="d058c-161">**図 3**: 次の 3 つ BoundFields の追加と GridView に 3 つの CheckBoxFields ([フルサイズのイメージを表示するをクリックして](building-an-interface-to-select-one-user-account-from-many-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="d058c-161">**Figure 3**: Add Three BoundFields and Three CheckBoxFields to the GridView  ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-cs/_static/image9.png))</span></span>


<span data-ttu-id="d058c-162">構成した後、GridView に、宣言型マークアップが、次のようになっていること確認します。</span><span class="sxs-lookup"><span data-stu-id="d058c-162">After configuring your GridView, ensure that its declarative markup resembles the following:</span></span>

[!code-aspx[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample4.aspx)]

<span data-ttu-id="d058c-163">次に、ユーザー アカウントを GridView にバインドするコードを記述する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d058c-163">Next, we need to write code that binds the user accounts to the GridView.</span></span> <span data-ttu-id="d058c-164">という名前のメソッドを作成する`BindUserAccounts`してこのタスクを実行しからを呼び出して、`Page_Load`最初のページ アクセス時にイベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="d058c-164">Create a method named `BindUserAccounts` to perform this task and then call it from the `Page_Load` event handler on the first page visit.</span></span>

[!code-csharp[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample5.cs)]

<span data-ttu-id="d058c-165">ブラウザーでページをテストするのにはしばらくを実行します。</span><span class="sxs-lookup"><span data-stu-id="d058c-165">Take a moment to test the page through a browser.</span></span> <span data-ttu-id="d058c-166">図 4 に示す、 `UserAccounts` GridView がシステムにユーザー名、電子メール アドレス、およびすべてのユーザーには、その他の関連するアカウント情報を一覧表示されます。</span><span class="sxs-lookup"><span data-stu-id="d058c-166">As Figure 4 shows, the `UserAccounts` GridView lists the username, email address, and other pertinent account information for all users in the system.</span></span>


<span data-ttu-id="d058c-167">[![ユーザー アカウントが GridView で一覧表示します。](building-an-interface-to-select-one-user-account-from-many-cs/_static/image11.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="d058c-167">[![The User Accounts are Listed in the GridView](building-an-interface-to-select-one-user-account-from-many-cs/_static/image11.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image10.png)</span></span>

<span data-ttu-id="d058c-168">**図 4**: GridView に、ユーザー アカウントが表示されます ([フルサイズのイメージを表示するをクリックして](building-an-interface-to-select-one-user-account-from-many-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="d058c-168">**Figure 4**: The User Accounts are Listed in the GridView  ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-cs/_static/image12.png))</span></span>


## <a name="step-3-filtering-the-results-by-the-first-letter-of-the-username"></a><span data-ttu-id="d058c-169">手順 3: ユーザー名の最初の文字が結果のフィルター処理</span><span class="sxs-lookup"><span data-stu-id="d058c-169">Step 3: Filtering the Results by the First Letter of the Username</span></span>

<span data-ttu-id="d058c-170">現在、 `UserAccounts` GridView を示しています*すべて*ユーザー アカウントです。</span><span class="sxs-lookup"><span data-stu-id="d058c-170">Currently the `UserAccounts` GridView shows *all* of the user accounts.</span></span> <span data-ttu-id="d058c-171">数百または数千のユーザー アカウントと web サイトの場合は、すぐに表示されているアカウントを縮小できるユーザーであるが不可欠です。</span><span class="sxs-lookup"><span data-stu-id="d058c-171">For websites with hundreds or thousands of user accounts, it is imperative that user be able to quickly pare down the displayed accounts.</span></span> <span data-ttu-id="d058c-172">これは、あるページにフィルターを追加することで実現できます。</span><span class="sxs-lookup"><span data-stu-id="d058c-172">This can be accomplished by adding filtering LinkButtons to the page.</span></span> <span data-ttu-id="d058c-173">ページにある 27 を追加してみましょう。: アルファベットの各文字の 1 つの LinkButton と共にすべてという 1 つです。</span><span class="sxs-lookup"><span data-stu-id="d058c-173">Let's add 27 LinkButtons to the page: one titled All along with one LinkButton for each letter of the alphabet.</span></span> <span data-ttu-id="d058c-174">GridView の訪問者には、すべての LinkButton がクリックすると、すべてのユーザーが表示されます。</span><span class="sxs-lookup"><span data-stu-id="d058c-174">If a visitor clicks the All LinkButton, the GridView will show all of the users.</span></span> <span data-ttu-id="d058c-175">特定の文字をクリックした場合は、ユーザー名が、選択した文字で開始しているユーザーのみが表示されます。</span><span class="sxs-lookup"><span data-stu-id="d058c-175">If they click a particular letter, only those users whose username starts with the selected letter will be displayed.</span></span>

<span data-ttu-id="d058c-176">最初のタスクでは、27 LinkButton コントロールを追加します。</span><span class="sxs-lookup"><span data-stu-id="d058c-176">Our first task is to add the 27 LinkButton controls.</span></span> <span data-ttu-id="d058c-177">27 あるを宣言して、作成する 1 つのオプションを一度に 1 つです。</span><span class="sxs-lookup"><span data-stu-id="d058c-177">One option would be to create the 27 LinkButtons declaratively, one at a time.</span></span> <span data-ttu-id="d058c-178">柔軟なアプローチを持つリピータ コントロールを使用する、 `ItemTemplate` LinkButton を表示し、としてリピータにフィルター処理オプションをバインドする、`string`配列。</span><span class="sxs-lookup"><span data-stu-id="d058c-178">A more flexible approach is to use a Repeater control with an `ItemTemplate` that renders a LinkButton and then binds the filtering options to the Repeater as a `string` array.</span></span>

<span data-ttu-id="d058c-179">リピータ コントロール上のページを追加するスタート、 `UserAccounts` GridView です。</span><span class="sxs-lookup"><span data-stu-id="d058c-179">Start by adding a Repeater control to the page above the `UserAccounts` GridView.</span></span> <span data-ttu-id="d058c-180">リピータの設定`ID`プロパティを`FilteringUI`です。</span><span class="sxs-lookup"><span data-stu-id="d058c-180">Set the Repeater's `ID` property to `FilteringUI`.</span></span> <span data-ttu-id="d058c-181">リピータのテンプレートを構成できるようにその`ItemTemplate`LinkButton をレンダリングが`Text`と`CommandName`プロパティ、現在の配列要素にバインドされます。</span><span class="sxs-lookup"><span data-stu-id="d058c-181">Configure the Repeater's templates so that its `ItemTemplate` renders a LinkButton whose `Text` and `CommandName` properties are bound to the current array element.</span></span> <span data-ttu-id="d058c-182">示したように、 <a id="_msoanchor_3"> </a> [*ロールをユーザーに割り当てる*](../roles/assigning-roles-to-users-cs.md)チュートリアルでは、これを使用して、 `Container.DataItem` databinding 構文です。</span><span class="sxs-lookup"><span data-stu-id="d058c-182">As we saw in the <a id="_msoanchor_3"></a>[*Assigning Roles to Users*](../roles/assigning-roles-to-users-cs.md) tutorial, this can be accomplished using the `Container.DataItem` databinding syntax.</span></span> <span data-ttu-id="d058c-183">リピータを使用して`SeparatorTemplate`を各リンクの間で縦線を表示します。</span><span class="sxs-lookup"><span data-stu-id="d058c-183">Use the Repeater's `SeparatorTemplate` to display a vertical line between each link.</span></span>

[!code-aspx[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample6.aspx)]

<span data-ttu-id="d058c-184">このリピータ必要なフィルタ リング オプションを設定するには、という名前のメソッドを作成`BindFilteringUI`です。</span><span class="sxs-lookup"><span data-stu-id="d058c-184">To populate this Repeater with the desired filtering options, create a method named `BindFilteringUI`.</span></span> <span data-ttu-id="d058c-185">このメソッドを呼び出すことを確認する、`Page_Load`イベント ハンドラーに、最初のページ読み込み。</span><span class="sxs-lookup"><span data-stu-id="d058c-185">Be sure to call this method from the `Page_Load` event handler on the first page load.</span></span>

[!code-csharp[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample7.cs)]

<span data-ttu-id="d058c-186">このメソッドでは、フィルター処理オプションを指定の要素として、`string`配列`filterOptions`です。</span><span class="sxs-lookup"><span data-stu-id="d058c-186">This method specifies the filtering options as elements in the `string` array `filterOptions`.</span></span> <span data-ttu-id="d058c-187">リピータがの LinkButton を表示、配列内の各要素に対してその`Text`と`CommandName`配列要素の値に割り当てられたプロパティ。</span><span class="sxs-lookup"><span data-stu-id="d058c-187">For each element in the array, the Repeater will render a LinkButton with its `Text` and `CommandName` properties assigned to the value of the array element.</span></span>

<span data-ttu-id="d058c-188">図 5 は、`ManageUsers.aspx`ページをブラウザーで表示する場合。</span><span class="sxs-lookup"><span data-stu-id="d058c-188">Figure 5 shows the `ManageUsers.aspx` page when viewed through a browser.</span></span>


<span data-ttu-id="d058c-189">[![リピータ 27 フィルターのあるを一覧表示します。](building-an-interface-to-select-one-user-account-from-many-cs/_static/image14.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="d058c-189">[![The Repeater Lists 27 Filtering LinkButtons](building-an-interface-to-select-one-user-account-from-many-cs/_static/image14.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image13.png)</span></span>

<span data-ttu-id="d058c-190">**図 5**:「Repeater を一覧表示 27 フィルタ リングある ([フルサイズのイメージを表示するには、をクリックして](building-an-interface-to-select-one-user-account-from-many-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="d058c-190">**Figure 5**: The Repeater Lists 27 Filtering LinkButtons  ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-cs/_static/image15.png))</span></span>


> [!NOTE]
> <span data-ttu-id="d058c-191">ユーザー名を数字や句読点などの任意の文字で開始可能性があります。</span><span class="sxs-lookup"><span data-stu-id="d058c-191">Usernames may start with any character, including numbers and punctuation.</span></span> <span data-ttu-id="d058c-192">これらのアカウントを表示するのには、管理者は、すべて LinkButton オプションを使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d058c-192">In order to view these accounts, the administrator will have to use the All LinkButton option.</span></span> <span data-ttu-id="d058c-193">また、数字で始まるすべてのユーザー アカウントを返す LinkButton を追加できます。</span><span class="sxs-lookup"><span data-stu-id="d058c-193">Alternatively, you could add a LinkButton to return all user accounts that start with a number.</span></span> <span data-ttu-id="d058c-194">私のままに練習として、リーダーの。</span><span class="sxs-lookup"><span data-stu-id="d058c-194">I leave this as an exercise for the reader.</span></span>


<span data-ttu-id="d058c-195">フィルターのあるをクリックするとポストバックが発生させ、リピータの`ItemCommand`イベント、きたところにあるために、グリッド内の変更はありませんが、結果をフィルター処理するためのコードを記述します。</span><span class="sxs-lookup"><span data-stu-id="d058c-195">Clicking any of the filtering LinkButtons causes a postback and raises the Repeater's `ItemCommand` event, but there's no change in the grid because we've yet to write any code to filter the results.</span></span> <span data-ttu-id="d058c-196">`Membership`クラスが含まれています、 [ `FindUsersByName`メソッド](https://technet.microsoft.com/library/system.web.security.membership.findusersbyname.aspx)それらのユーザー アカウントを指定した検索パターンに一致するユーザー名を返します。</span><span class="sxs-lookup"><span data-stu-id="d058c-196">The `Membership` class includes a [`FindUsersByName` method](https://technet.microsoft.com/library/system.web.security.membership.findusersbyname.aspx) that returns those user accounts whose username matches a specified search pattern.</span></span> <span data-ttu-id="d058c-197">このメソッドを使用しているユーザー名がで指定された文字で始めるには、これらのユーザー アカウントを取得できます、`CommandName`のフィルター選択された LinkButton がクリックされたことです。</span><span class="sxs-lookup"><span data-stu-id="d058c-197">We can use this method to retrieve just those user accounts whose usernames start with the letter specified by the `CommandName` of the filtered LinkButton that was clicked.</span></span>

<span data-ttu-id="d058c-198">更新することで開始、`ManageUser.aspx`ページの分離コード クラスという名前のプロパティが含まれるように`UsernameToMatch`です。</span><span class="sxs-lookup"><span data-stu-id="d058c-198">Start by updating the `ManageUser.aspx` page's code-behind class so that it includes a property named `UsernameToMatch`.</span></span> <span data-ttu-id="d058c-199">このプロパティには、ポストバック間でのユーザー名のフィルター文字列が引き続き発生します。</span><span class="sxs-lookup"><span data-stu-id="d058c-199">This property persists the username filter string across postbacks:</span></span>

[!code-csharp[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample8.cs)]

<span data-ttu-id="d058c-200">`UsernameToMatch`プロパティに割り当てられている値を格納する、 `ViewState` UsernameToMatch キーを使用してコレクション。</span><span class="sxs-lookup"><span data-stu-id="d058c-200">The `UsernameToMatch` property stores its value it is assigned into the `ViewState` collection using the key UsernameToMatch.</span></span> <span data-ttu-id="d058c-201">このプロパティの値が読み取られると、確認に値が存在するかどうか、`ViewState`コレクションです。 ない場合、既定値、空の文字列を返します。</span><span class="sxs-lookup"><span data-stu-id="d058c-201">When this property's value is read, it checks to see if a value exists in the `ViewState` collection; if not, it returns the default value, an empty string.</span></span> <span data-ttu-id="d058c-202">`UsernameToMatch`プロパティは、つまり、プロパティへの変更がポストバック間で永続化できるように状態を表示する値を保持する、一般的なパターンを示します。</span><span class="sxs-lookup"><span data-stu-id="d058c-202">The `UsernameToMatch` property exhibits a common pattern, namely persisting a value to view state so that any changes to the property are persisted across postbacks.</span></span> <span data-ttu-id="d058c-203">このパターンの詳細については、「[について ASP.NET ビューステート](https://msdn.microsoft.com/library/ms972976.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="d058c-203">For more information on this pattern, read [Understanding ASP.NET View State](https://msdn.microsoft.com/library/ms972976.aspx).</span></span>

<span data-ttu-id="d058c-204">次に、更新、`BindUserAccounts`呼び出し元の代わりにメソッド`Membership.GetAllUsers`、呼び出し`Membership.FindUsersByName`の値を渡して、 `UsernameToMatch` SQL ワイルドカード文字が付いたプロパティ % です。</span><span class="sxs-lookup"><span data-stu-id="d058c-204">Next, update the `BindUserAccounts` method so that instead of calling `Membership.GetAllUsers`, it calls `Membership.FindUsersByName`, passing in the value of the `UsernameToMatch` property appended with the SQL wildcard character, %.</span></span>

[!code-csharp[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample9.cs)]

<span data-ttu-id="d058c-205">ユーザー名は、文字 A で始まるには、これらのユーザーを表示するには、次のように設定します。、`UsernameToMatch`プロパティ A をまず`BindUserAccounts`です。</span><span class="sxs-lookup"><span data-stu-id="d058c-205">To display just those users whose username starts with the letter A, set the `UsernameToMatch` property to A and then call `BindUserAccounts`.</span></span> <span data-ttu-id="d058c-206">呼び出しでこの結果`Membership.FindUsersByName("A%")`、A. 同様に、返されるで始まるすべてのユーザー名を返しますが*すべて*、ユーザーの割り当てに空の文字列、`UsernameToMatch`プロパティできるように、`BindUserAccounts`メソッドには呼び出す`Membership.FindUsersByName("%")`それによって、すべてのユーザー アカウントを取得します。</span><span class="sxs-lookup"><span data-stu-id="d058c-206">This would result in a call to `Membership.FindUsersByName("A%")`, which will return all users whose username starts with A. Likewise, to return *all* users, assign an empty string to the `UsernameToMatch` property so that the `BindUserAccounts` method will invoke `Membership.FindUsersByName("%")`, thereby returning all user accounts.</span></span>

<span data-ttu-id="d058c-207">リピータのイベント ハンドラーを作成する`ItemCommand`イベント。</span><span class="sxs-lookup"><span data-stu-id="d058c-207">Create an event handler for the Repeater's `ItemCommand` event.</span></span> <span data-ttu-id="d058c-208">このイベントは、あるフィルターのいずれかをクリックするとします。クリックされた LinkButton の渡された`CommandName`を通じて値、`RepeaterCommandEventArgs`オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="d058c-208">This event is raised whenever one of the filter LinkButtons is clicked; it is passed the clicked LinkButton's `CommandName` value through the `RepeaterCommandEventArgs` object.</span></span> <span data-ttu-id="d058c-209">適切な値を割り当てる必要があります、`UsernameToMatch`プロパティと、呼び出し、`BindUserAccounts`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="d058c-209">We need to assign the appropriate value to the `UsernameToMatch` property and then call the `BindUserAccounts` method.</span></span> <span data-ttu-id="d058c-210">場合、`CommandName`はすべてに空の文字列を割り当てる`UsernameToMatch`すべてのユーザー アカウントが表示されるようにします。</span><span class="sxs-lookup"><span data-stu-id="d058c-210">If the `CommandName` is All, assign an empty string to `UsernameToMatch` so that all user accounts are displayed.</span></span> <span data-ttu-id="d058c-211">それ以外の場合、割り当て、`CommandName`値を`UsernameToMatch`です。</span><span class="sxs-lookup"><span data-stu-id="d058c-211">Otherwise, assign the `CommandName` value to `UsernameToMatch`.</span></span>

[!code-csharp[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample10.cs)]

<span data-ttu-id="d058c-212">このコードでフィルタ リングの機能をテストします。</span><span class="sxs-lookup"><span data-stu-id="d058c-212">With this code in place, test out the filtering functionality.</span></span> <span data-ttu-id="d058c-213">ページが最初にアクセスされると、すべてのユーザー アカウントが表示されます (戻るは図 5 を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="d058c-213">When the page is first visited, all user accounts are displayed (refer back to Figure 5).</span></span> <span data-ttu-id="d058c-214">A LinkButton がクリックすると、ポストバックを発生させるし、A で始まるユーザー アカウントのみを表示する、結果をフィルター処理します。</span><span class="sxs-lookup"><span data-stu-id="d058c-214">Clicking the A LinkButton causes a postback and filters the results, displaying only those user accounts that start with A .</span></span>


<span data-ttu-id="d058c-215">[![フィルターのあるを使用して、ユーザー名が特定の英字で始まるそれらのユーザーを表示](building-an-interface-to-select-one-user-account-from-many-cs/_static/image17.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="d058c-215">[![Use the Filtering LinkButtons to Display those Users Whose Username Starts with a Certain Letter](building-an-interface-to-select-one-user-account-from-many-cs/_static/image17.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image16.png)</span></span>

<span data-ttu-id="d058c-216">**図 6**: フィルターのあるを使用して、それらのユーザーをユーザー名から始まり、ある文字を表示 ([フルサイズのイメージを表示するをクリックして](building-an-interface-to-select-one-user-account-from-many-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="d058c-216">**Figure 6**: Use the Filtering LinkButtons to Display those Users Whose Username Starts with a Certain Letter  ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-cs/_static/image18.png))</span></span>


## <a name="step-4-updating-the-gridview-to-use-paging"></a><span data-ttu-id="d058c-217">手順 4: ページングを使用して GridView の更新</span><span class="sxs-lookup"><span data-stu-id="d058c-217">Step 4: Updating the GridView to Use Paging</span></span>

<span data-ttu-id="d058c-218">図 5 と 6 に示すように GridView には、すべてから返されるレコードの一覧表示、`FindUsersByName`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="d058c-218">The GridView shown in Figures 5 and 6 lists all of the records returned from the `FindUsersByName` method.</span></span> <span data-ttu-id="d058c-219">数百または数千のユーザー アカウントがある場合につながります情報の過負荷 (同様にすべての LinkButton をクリックしたとき、または最初に、ページにアクセスしたとき) に、すべてのアカウントを表示するときにします。</span><span class="sxs-lookup"><span data-stu-id="d058c-219">If there are hundreds or thousands of user accounts this can lead to information overload when viewing all of the accounts (as is the case when clicking the All LinkButton or when initially visiting the page).</span></span> <span data-ttu-id="d058c-220">管理しやすいチャンクでユーザー アカウントを表示するには、一度に 10 個のユーザー アカウントを表示する GridView を構成してみましょう。</span><span class="sxs-lookup"><span data-stu-id="d058c-220">To help present the user accounts in more manageable chunks, let's configure the GridView to display 10 user accounts at a time.</span></span>

<span data-ttu-id="d058c-221">GridView コントロールには、ページングの 2 つの種類が用意されています。</span><span class="sxs-lookup"><span data-stu-id="d058c-221">The GridView control offers two types of paging:</span></span>

- <span data-ttu-id="d058c-222">**既定のページング**- 簡単に実装しますが、非効率的です。</span><span class="sxs-lookup"><span data-stu-id="d058c-222">**Default paging** - easy to implement, but inefficient.</span></span> <span data-ttu-id="d058c-223">簡単に言うと、既定値が GridView でページングが必要ですが*すべて*そのデータ ソースからレコードのです。</span><span class="sxs-lookup"><span data-stu-id="d058c-223">In a nutshell, with default paging the GridView expects *all* of the records from its data source.</span></span> <span data-ttu-id="d058c-224">表示のみレコードの適切なページです。</span><span class="sxs-lookup"><span data-stu-id="d058c-224">It then only displays the appropriate page of records.</span></span>
- <span data-ttu-id="d058c-225">**カスタム ページング**-より多くの作業を実装する必要がありますが、既定のデータのページング カスタム ソースが表示するレコードの正確なセットだけを返すためにのページングよりも効率的です。</span><span class="sxs-lookup"><span data-stu-id="d058c-225">**Custom paging** - requires more work to implement, but is more efficient than default paging because with custom paging the data source returns only the precise set of records to display.</span></span>

<span data-ttu-id="d058c-226">数千のレコードをページングするとき、既定およびカスタム ページングのパフォーマンスの差を大幅に指定できます。</span><span class="sxs-lookup"><span data-stu-id="d058c-226">The performance difference between default and custom paging can be quite substantial when paging through thousands of records.</span></span> <span data-ttu-id="d058c-227">構築おため、仮定し、このインターフェイスが数百または数千のユーザー アカウントを更新した後、カスタム ページングを使用してみましょう可能性があります。</span><span class="sxs-lookup"><span data-stu-id="d058c-227">Because we are building this interface assuming that there may be hundreds or thousands of user accounts, let's use custom paging.</span></span>

> [!NOTE]
> <span data-ttu-id="d058c-228">既定とカスタム ページングを実装するカスタム ページングに関連する課題間の相違点の詳細についてを参照してください[効率的にから大規模な量のデータのページング](https://asp.net/learn/data-access/tutorial-25-cs.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="d058c-228">For a more thorough discussion on the differences between default and custom paging, as well as the challenges involved in implementing custom paging, refer to [Efficiently Paging Through Large Amounts of Data](https://asp.net/learn/data-access/tutorial-25-cs.aspx).</span></span> <span data-ttu-id="d058c-229">既定およびカスタム ページングのパフォーマンスの差の分析、次を参照してください。 [ASP.NET での SQL Server 2005 でカスタム ページング](http://aspnet.4guysfromrolla.com/articles/031506-1.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="d058c-229">For some analysis of the performance difference between default and custom paging, see [Custom Paging in ASP.NET with SQL Server 2005](http://aspnet.4guysfromrolla.com/articles/031506-1.aspx).</span></span>


<span data-ttu-id="d058c-230">カスタム ページングを実装するには、GridView によって表示されているレコードの正確なサブセットを取得するには、その機構まず必要あります。</span><span class="sxs-lookup"><span data-stu-id="d058c-230">To implement custom paging we first need some mechanism by which to retrieve the precise subset of records being displayed by the GridView.</span></span> <span data-ttu-id="d058c-231">良いニュースを`Membership`クラスの`FindUsersByName`メソッドにより、ページのインデックスと、ページ サイズを指定するオーバー ロードがあり、そのレコードの範囲内にあるユーザー アカウントのみを返します。</span><span class="sxs-lookup"><span data-stu-id="d058c-231">The good news is that the `Membership` class's `FindUsersByName` method has an overload that allows us to specify the page index and page size, and returns only those user accounts that fall within that range of records.</span></span>

<span data-ttu-id="d058c-232">特に、このオーバー ロードには、次の署名: [ `FindUsersByName(usernameToMatch, pageIndex, pageSize, totalRecords)`](https://msdn.microsoft.com/library/fa5st8b2.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="d058c-232">In particular, this overload has the following signature: [`FindUsersByName(usernameToMatch, pageIndex, pageSize, totalRecords)`](https://msdn.microsoft.com/library/fa5st8b2.aspx).</span></span>

<span data-ttu-id="d058c-233">*PageIndex*パラメーターは、返されるユーザー アカウントのページを指定します。*pageSize*ページごとに表示するレコードの数を示します。</span><span class="sxs-lookup"><span data-stu-id="d058c-233">The *pageIndex* parameter specifies the page of user accounts to return; *pageSize* indicates how many records to display per page.</span></span> <span data-ttu-id="d058c-234">*TotalRecords*パラメーターは、`out`ユーザー ストアに合計ユーザー アカウントの数を返すパラメーターです。</span><span class="sxs-lookup"><span data-stu-id="d058c-234">The *totalRecords* parameter is an `out` parameter that returns the number of total user accounts in the user store.</span></span>

> [!NOTE]
> <span data-ttu-id="d058c-235">によって返されるデータ`FindUsersByName`%username; に並べ替えて、並べ替えの条件をカスタマイズすることはできません。</span><span class="sxs-lookup"><span data-stu-id="d058c-235">The data returned by `FindUsersByName` is sorted by username; the sort criteria cannot be customized.</span></span>


<span data-ttu-id="d058c-236">GridView は、のみ、ObjectDataSource コントロールにバインドすると、カスタム ページングを利用を構成できます。</span><span class="sxs-lookup"><span data-stu-id="d058c-236">The GridView can be configured to utilize custom paging, but only when bound to an ObjectDataSource control.</span></span> <span data-ttu-id="d058c-237">カスタム ページングを実装する、ObjectDataSource コントロールの 2 つの方法が必要ですいずれかの開始行インデックスおよび表示するにはレコードの最大数に渡されます; スパン内にあるレコードの正確なサブセットを返しますと。およびを介してページングされるレコードの合計数を返すメソッド。</span><span class="sxs-lookup"><span data-stu-id="d058c-237">For the ObjectDataSource control to implement custom paging, it requires two methods: one that is passed a start row index and the maximum number of records to display, and returns the precise subset of records that fall within that span; and a method that returns the total number of records being paged through.</span></span> <span data-ttu-id="d058c-238">`FindUsersByName`オーバー ロードが、ページのインデックスと、ページ サイズを受け取り、を通じてレコードの合計数を返します、`out`パラメーター。</span><span class="sxs-lookup"><span data-stu-id="d058c-238">The `FindUsersByName` overload accepts a page index and page size, and returns the total number of records through an `out` parameter.</span></span> <span data-ttu-id="d058c-239">したがって、インターフェイスの不一致があります。</span><span class="sxs-lookup"><span data-stu-id="d058c-239">So there is an interface mismatch here.</span></span>

<span data-ttu-id="d058c-240">1 つのオプションは、ObjectDataSource が必要ですが、してから内部的にインターフェイスを公開するプロキシ クラスを作成すること、`FindUsersByName`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="d058c-240">One option would be to create a proxy class that exposes the interface the ObjectDataSource expects, and then internally calls the `FindUsersByName` method.</span></span> <span data-ttu-id="d058c-241">別のオプション - と、この記事の内容を使用します - 独自ページング インターフェイスを作成して、GridView の組み込みのページング インターフェイスの代わりに使用するがします。</span><span class="sxs-lookup"><span data-stu-id="d058c-241">Another option - and the one we'll use for this article - is to create our own paging interface and use that instead of the GridView's built-in paging interface.</span></span>

### <a name="creating-a-first-previous-next-last-paging-interface"></a><span data-ttu-id="d058c-242">まず、作成する前に、ページング インターフェイスを次に、前回</span><span class="sxs-lookup"><span data-stu-id="d058c-242">Creating a First, Previous, Next, Last Paging Interface</span></span>

<span data-ttu-id="d058c-243">最初、Previous、次に、最後にあると、ページング インターフェイスを構築してみましょう。</span><span class="sxs-lookup"><span data-stu-id="d058c-243">Let's build a paging interface with First, Previous, Next, and Last LinkButtons.</span></span> <span data-ttu-id="d058c-244">最初の LinkButton がクリックするは前戻ります彼前のページに対し、データの最初のページにユーザーになります。</span><span class="sxs-lookup"><span data-stu-id="d058c-244">The First LinkButton, when clicked, will take the user to the first page of data, whereas Previous will return him to the previous page.</span></span> <span data-ttu-id="d058c-245">同様に、次へと最後はユーザーへの移動次と最後のページで、それぞれします。</span><span class="sxs-lookup"><span data-stu-id="d058c-245">Likewise, Next and Last will move the user to the next and last page, respectively.</span></span> <span data-ttu-id="d058c-246">下にある 4 つの LinkButton コントロールを追加、 `UserAccounts` GridView です。</span><span class="sxs-lookup"><span data-stu-id="d058c-246">Add the four LinkButton controls beneath the `UserAccounts` GridView.</span></span>

[!code-aspx[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample11.aspx)]

<span data-ttu-id="d058c-247">LinkButton の各イベント ハンドラーを次に、作成`Click`イベント。</span><span class="sxs-lookup"><span data-stu-id="d058c-247">Next, create an event handler for each of the LinkButton's `Click` events.</span></span>

<span data-ttu-id="d058c-248">図 7 は、Visual Web Developer のデザイン ビューで表示したときに、次の 4 つあるを示します。</span><span class="sxs-lookup"><span data-stu-id="d058c-248">Figure 7 shows the four LinkButtons when viewed through the Visual Web Developer Design view.</span></span>


<span data-ttu-id="d058c-249">[![最初、直前の動作を次に、追加し、最後の GridView の下にあります。](building-an-interface-to-select-one-user-account-from-many-cs/_static/image20.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="d058c-249">[![Add First, Previous, Next, and Last LinkButtons Beneath the GridView](building-an-interface-to-select-one-user-account-from-many-cs/_static/image20.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image19.png)</span></span>

<span data-ttu-id="d058c-250">**図 7**: 最初の追加、Previous、次へ] および [GridView 下にある最後のある ([フルサイズのイメージを表示するをクリックして](building-an-interface-to-select-one-user-account-from-many-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="d058c-250">**Figure 7**: Add First, Previous, Next, and Last LinkButtons Beneath the GridView  ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-cs/_static/image21.png))</span></span>


### <a name="keeping-track-of-the-current-page-index"></a><span data-ttu-id="d058c-251">現在のページ インデックスの追跡</span><span class="sxs-lookup"><span data-stu-id="d058c-251">Keeping Track of the Current Page Index</span></span>

<span data-ttu-id="d058c-252">ユーザーが最初にアクセスすると、`ManageUsers.aspx`ボタン、フィルター選択のいずれかのページまたはクリック数、GridView でデータの最初のページを表示したいです。</span><span class="sxs-lookup"><span data-stu-id="d058c-252">When a user first visits the `ManageUsers.aspx` page or clicks one of the filtering buttons, we want to display the first page of data in the GridView.</span></span> <span data-ttu-id="d058c-253">ただし、ユーザーでは、あるナビゲーションの 1 つクリックすると、ときに、ページのインデックスを更新する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d058c-253">When the user clicks one of the navigation LinkButtons, however, we need to update the page index.</span></span> <span data-ttu-id="d058c-254">ページのインデックスと 1 ページに表示するレコードの数を維持するには、ページの分離コード クラスに次の 2 つのプロパティを追加します。</span><span class="sxs-lookup"><span data-stu-id="d058c-254">To maintain the page index and the number of records to display per page, add the following two properties to the page's code-behind class:</span></span>

[!code-csharp[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample12.cs)]

<span data-ttu-id="d058c-255">同様に、 `UsernameToMatch` 、プロパティ、`PageIndex`プロパティの状態を表示するのには、その値が引き続き発生します。</span><span class="sxs-lookup"><span data-stu-id="d058c-255">Like the `UsernameToMatch` property, the `PageIndex` property persists its value to view state.</span></span> <span data-ttu-id="d058c-256">読み取り専用`PageSize`10、ハード コーディングされた値を返します。</span><span class="sxs-lookup"><span data-stu-id="d058c-256">The read-only `PageSize` property returns a hard-coded value, 10.</span></span> <span data-ttu-id="d058c-257">招待するには、関心のリーダーと同様のパターンを使用するには、このプロパティを更新する`PageIndex`、およびその強化するために、`ManageUsers.aspx`ページごとに表示するユーザー アカウントの数のページをページにアクセスするユーザーが指定できるようにします。</span><span class="sxs-lookup"><span data-stu-id="d058c-257">I invite the interested reader to update this property to use the same pattern as `PageIndex`, and then to augment the `ManageUsers.aspx` page such that the person visiting the page can specify how many user accounts to display per page.</span></span>

### <a name="retrieving-just-the-current-pages-records-updating-the-page-index-and-enabling-and-disabling-the-paging-interface-linkbuttons"></a><span data-ttu-id="d058c-258">現在のページのレコードだけを取得する、ページ インデックスを更新して有効化、およびページング インターフェイスあるを無効にします。</span><span class="sxs-lookup"><span data-stu-id="d058c-258">Retrieving Just the Current Page's Records, Updating the Page Index, and Enabling and Disabling the Paging Interface LinkButtons</span></span>

<span data-ttu-id="d058c-259">場所でのページング インターフェイスおよび`PageIndex`と`PageSize`プロパティの追加、更新する準備が整いました、`BindUserAccounts`メソッドを使用する適切なので`FindUsersByName`オーバー ロードします。</span><span class="sxs-lookup"><span data-stu-id="d058c-259">With the paging interface in place and the `PageIndex` and `PageSize` properties added, we are ready to update the `BindUserAccounts` method so that it uses the appropriate `FindUsersByName` overload.</span></span> <span data-ttu-id="d058c-260">さらに、して、このメソッドは、有効にするにまたはによってどのようなページが表示されているページング インターフェイスを無効にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="d058c-260">Additionally, we need to have this method enable or disable the paging interface depending on what page is being displayed.</span></span> <span data-ttu-id="d058c-261">データの最初のページを表示すると、最初と前のリンクを無効にする必要があります。最後のページを表示するときに、次に、前回を無効にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="d058c-261">When viewing the first page of data, the First and Previous links should be disabled; Next and Last should be disabled when viewing the last page.</span></span>

<span data-ttu-id="d058c-262">`BindUserAccounts` メソッドを次のコードで更新します。</span><span class="sxs-lookup"><span data-stu-id="d058c-262">Update the `BindUserAccounts` method with the following code:</span></span>

[!code-csharp[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample13.cs)]

<span data-ttu-id="d058c-263">最後のパラメーターによってを介してページングされるレコードの合計数が決定されるに注意してください、`FindUsersByName`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="d058c-263">Note that the total number of records being paged through is determined by the last parameter of the `FindUsersByName` method.</span></span> <span data-ttu-id="d058c-264">これは、`out`パラメーター、まずこの値を保持する変数を宣言する必要がありますので (`totalRecords`) でのプレフィックスを付加、`out`キーワード。</span><span class="sxs-lookup"><span data-stu-id="d058c-264">This is an `out` parameter, so we need to first declare a variable to hold this value (`totalRecords`) and then prefix it with the `out` keyword.</span></span>

<span data-ttu-id="d058c-265">ユーザー アカウントの指定したページが返された後、4 つあるか、有効または無効に、データの最初と最後のページが表示されているかどうかによって異なります。</span><span class="sxs-lookup"><span data-stu-id="d058c-265">After the specified page of user accounts are returned, the four LinkButtons are either enabled or disabled, depending on whether the first or last page of data is being viewed.</span></span>

<span data-ttu-id="d058c-266">最後の手順では 4 つあるのに対して、コードを記述する`Click`イベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="d058c-266">The last step is to write the code for the four LinkButtons' `Click` event handlers.</span></span> <span data-ttu-id="d058c-267">これらのイベント ハンドラーを更新する必要があります、`PageIndex`プロパティへの呼び出しを使用して GridView にデータをバインドし、`BindUserAccounts`です。</span><span class="sxs-lookup"><span data-stu-id="d058c-267">These event handlers need to update the `PageIndex` property and then rebind the data to the GridView via a call to `BindUserAccounts`.</span></span> <span data-ttu-id="d058c-268">最初、Previous、および次のイベント ハンドラーは、非常に単純です。</span><span class="sxs-lookup"><span data-stu-id="d058c-268">The First, Previous, and Next event handlers are very simple.</span></span> <span data-ttu-id="d058c-269">`Click`イベント ハンドラーの最後の LinkButton ただしはもう少し複雑なため、最後のページ インデックスを特定するために表示されるレコードの数を決定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d058c-269">The `Click` event handler for the Last LinkButton, however, is a bit more complex because we need to determine how many records are being displayed in order to determine the last page index.</span></span>

[!code-csharp[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample14.cs)]

<span data-ttu-id="d058c-270">図 8 と 9 は、アクションで、カスタム ページング インターフェイスを表示します。</span><span class="sxs-lookup"><span data-stu-id="d058c-270">Figures 8 and 9 show the custom paging interface in action.</span></span> <span data-ttu-id="d058c-271">図 8 は、`ManageUsers.aspx`ページのすべてのユーザー アカウントのデータの最初のページを表示するときにします。</span><span class="sxs-lookup"><span data-stu-id="d058c-271">Figure 8 shows the `ManageUsers.aspx` page when viewing the first page of data for all user accounts.</span></span> <span data-ttu-id="d058c-272">13 アカウント 10 行だけが表示されることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="d058c-272">Note that only 10 of the 13 accounts are displayed.</span></span> <span data-ttu-id="d058c-273">更新プログラム、ポストバックを発生させる次へ または最後のリンクをクリックして、 `PageIndex` 1、およびバインド グリッドへのアカウントのユーザーの 2 ページ目に (図 9 を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="d058c-273">Clicking the Next or Last link causes a postback, updates the `PageIndex` to 1, and binds the second page of user accounts to the grid (see Figure 9).</span></span>


<span data-ttu-id="d058c-274">[![最初の 10 ユーザー アカウントが表示されます。](building-an-interface-to-select-one-user-account-from-many-cs/_static/image23.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="d058c-274">[![The First 10 User Accounts are Displayed](building-an-interface-to-select-one-user-account-from-many-cs/_static/image23.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image22.png)</span></span>

<span data-ttu-id="d058c-275">**図 8**: の最初の 10 ユーザー アカウントが表示されます ([フルサイズのイメージを表示するをクリックして](building-an-interface-to-select-one-user-account-from-many-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="d058c-275">**Figure 8**: The First 10 User Accounts are Displayed  ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-cs/_static/image24.png))</span></span>


<span data-ttu-id="d058c-276">[![ユーザー アカウントの 2 ページ目を表示する次のリンクをクリックして](building-an-interface-to-select-one-user-account-from-many-cs/_static/image26.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="d058c-276">[![Clicking the Next Link Displays the Second Page of User Accounts](building-an-interface-to-select-one-user-account-from-many-cs/_static/image26.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image25.png)</span></span>

<span data-ttu-id="d058c-277">**図 9**: 次のリンクをクリックすると、2 番目のページのユーザー アカウントが表示されます ([フルサイズのイメージを表示するをクリックして](building-an-interface-to-select-one-user-account-from-many-cs/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="d058c-277">**Figure 9**: Clicking the Next Link Displays the Second Page of User Accounts  ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-cs/_static/image27.png))</span></span>


## <a name="summary"></a><span data-ttu-id="d058c-278">まとめ</span><span class="sxs-lookup"><span data-stu-id="d058c-278">Summary</span></span>

<span data-ttu-id="d058c-279">多くの場合、管理者は、ユーザー アカウントの一覧から選択する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d058c-279">Administrators often need to select a user from the list of accounts.</span></span> <span data-ttu-id="d058c-280">前のチュートリアルで、ユーザーが、設定のドロップダウン リストを使用してきましたが、このアプローチのスケーラビリティが得られない。</span><span class="sxs-lookup"><span data-stu-id="d058c-280">In previous tutorials we looked at using a drop-down list populated with the users, but this approach does not scale well.</span></span> <span data-ttu-id="d058c-281">このチュートリアルではため、探索がより優れた代替: ページングされた GridView にある結果が表示されます、フィルターを適用できるインターフェイス。</span><span class="sxs-lookup"><span data-stu-id="d058c-281">In this tutorial we explored a better alternative: a filterable interface whose results are displayed in a paged GridView.</span></span> <span data-ttu-id="d058c-282">このユーザー インターフェイスを持つ管理者できます迅速かつ効率的に見つけて何千もの間で 1 つのユーザー アカウントを選択します。</span><span class="sxs-lookup"><span data-stu-id="d058c-282">With this user interface, administrators can quickly and efficiently locate and select one user account among thousands.</span></span>

<span data-ttu-id="d058c-283">満足プログラミング!</span><span class="sxs-lookup"><span data-stu-id="d058c-283">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="d058c-284">関連項目</span><span class="sxs-lookup"><span data-stu-id="d058c-284">Further Reading</span></span>

<span data-ttu-id="d058c-285">このチュートリアルで説明したトピックの詳細については、次の情報を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d058c-285">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="d058c-286">ASP.NET での SQL Server 2005 でのカスタムのページング</span><span class="sxs-lookup"><span data-stu-id="d058c-286">Custom Paging in ASP.NET with SQL Server 2005</span></span>](http://aspnet.4guysfromrolla.com/articles/031506-1.aspx)
- [<span data-ttu-id="d058c-287">効率的に大量のデータのページング</span><span class="sxs-lookup"><span data-stu-id="d058c-287">Efficiently Paging Through Large Amounts of Data</span></span>](https://asp.net/learn/data-access/tutorial-25-cs.aspx)
- [<span data-ttu-id="d058c-288">独自の web サイト管理ツールのローリング</span><span class="sxs-lookup"><span data-stu-id="d058c-288">Rolling Your Own Website Administration Tool</span></span>](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx)

### <a name="about-the-author"></a><span data-ttu-id="d058c-289">作成者について</span><span class="sxs-lookup"><span data-stu-id="d058c-289">About the Author</span></span>

<span data-ttu-id="d058c-290">Scott Mitchell、複数の受け取りますブックの作成者と 4GuysFromRolla.com の創設者は、Microsoft の Web テクノロジと 1998 年取り組んできました。</span><span class="sxs-lookup"><span data-stu-id="d058c-290">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="d058c-291">Scott は、コンサルタント、トレーナー、ライターとして機能します。</span><span class="sxs-lookup"><span data-stu-id="d058c-291">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="d058c-292">最新の著書 *[Sam 学べる自分で ASP.NET 2.0 が 24 時間以内に](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)* です。</span><span class="sxs-lookup"><span data-stu-id="d058c-292">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="d058c-293">Scott に到達できる[ mitchell@4guysfromrolla.com ](mailto:mitchell@4guysfromrolla.com)または彼のブログでを介して[ http://ScottOnWriting.NET](http://scottonwriting.net/)です。</span><span class="sxs-lookup"><span data-stu-id="d058c-293">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="d058c-294">感謝の特別な</span><span class="sxs-lookup"><span data-stu-id="d058c-294">Special Thanks To</span></span>

<span data-ttu-id="d058c-295">このチュートリアルの系列は既に多くの便利なレビュー担当者によって確認済みです。</span><span class="sxs-lookup"><span data-stu-id="d058c-295">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="d058c-296">このチュートリアルのレビュー担当者の潜在顧客が Alicja Maziarz しました。</span><span class="sxs-lookup"><span data-stu-id="d058c-296">Lead reviewer for this tutorial was Alicja Maziarz.</span></span> <span data-ttu-id="d058c-297">今後、MSDN の記事を確認することに関心のあるですか。</span><span class="sxs-lookup"><span data-stu-id="d058c-297">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="d058c-298">場合は、ドロップ me 一度に 1 行ずつ [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="d058c-298">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="d058c-299">次へ</span><span class="sxs-lookup"><span data-stu-id="d058c-299">Next</span></span>](recovering-and-changing-passwords-cs.md)
