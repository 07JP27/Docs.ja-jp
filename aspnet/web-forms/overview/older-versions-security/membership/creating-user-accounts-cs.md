---
uid: web-forms/overview/older-versions-security/membership/creating-user-accounts-cs
title: ユーザー アカウント (c#) の作成 |Microsoft ドキュメント
author: rick-anderson
description: このチュートリアルでは、フレームワークを使用して、メンバーシップ (SqlMembershipProvider) を使用して新しいユーザー アカウントを作成するをについて説明します。 新しい us を作成する方法が表示されます。
ms.author: aspnetcontent
manager: wpickett
ms.date: 01/18/2008
ms.topic: article
ms.assetid: f175278c-6079-4d91-b9b4-2493ed43d9ec
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-security/membership/creating-user-accounts-cs
msc.type: authoredcontent
ms.openlocfilehash: e00417639fba71083cbf392db5d5078561ab26e3
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/06/2018
---
<a name="creating-user-accounts-c"></a><span data-ttu-id="34b6a-104">ユーザー アカウントの作成 (c#)</span><span class="sxs-lookup"><span data-stu-id="34b6a-104">Creating User Accounts (C#)</span></span>
====================
<span data-ttu-id="34b6a-105">によって[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="34b6a-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="34b6a-106">[コードをダウンロードする](http://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/ASPNET_Security_Tutorial_05_CS.zip)または[PDF のダウンロード](http://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/aspnet_tutorial05_CreatingUsers_cs.pdf)</span><span class="sxs-lookup"><span data-stu-id="34b6a-106">[Download Code](http://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/ASPNET_Security_Tutorial_05_CS.zip) or [Download PDF](http://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/aspnet_tutorial05_CreatingUsers_cs.pdf)</span></span>

> <span data-ttu-id="34b6a-107">このチュートリアルでは、フレームワークを使用して、メンバーシップ (SqlMembershipProvider) を使用して新しいユーザー アカウントを作成するをについて説明します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-107">In this tutorial we will explore using the Membership framework (via the SqlMembershipProvider) to create new user accounts.</span></span> <span data-ttu-id="34b6a-108">新しいユーザーを作成し、ASP プログラムと方法が表示されます。NET の組み込みの CreateUserWizard コントロール。</span><span class="sxs-lookup"><span data-stu-id="34b6a-108">We will see how to create new users programmatically and through ASP.NET's built-in CreateUserWizard control.</span></span>


## <a name="introduction"></a><span data-ttu-id="34b6a-109">はじめに</span><span class="sxs-lookup"><span data-stu-id="34b6a-109">Introduction</span></span>

<span data-ttu-id="34b6a-110"><a id="_msoanchor_1"> </a>[前のチュートリアル](creating-the-membership-schema-in-sql-server-cs.md)アプリケーション サービスのスキーマのデータベースで、追加のテーブル、ビュー、およびストアド プロシージャで必要なインストール、`SqlMembershipProvider`と`SqlRoleProvider`です。</span><span class="sxs-lookup"><span data-stu-id="34b6a-110">In the <a id="_msoanchor_1"></a>[preceding tutorial](creating-the-membership-schema-in-sql-server-cs.md) we installed the application services schema in a database, which added the tables, views, and stored procedures needed by the `SqlMembershipProvider` and `SqlRoleProvider`.</span></span> <span data-ttu-id="34b6a-111">これにより、このシリーズのチュートリアルの残りの必要がありますが、インフラストラクチャが作成されます。</span><span class="sxs-lookup"><span data-stu-id="34b6a-111">This created the infrastructure we will need for the remainder of the tutorials in this series.</span></span> <span data-ttu-id="34b6a-112">このチュートリアルではについて学びますメンバーシップ フレームワークを使用して (を使用して、 `SqlMembershipProvider`) 新しいユーザー アカウントを作成します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-112">In this tutorial we will explore using the Membership framework (via the `SqlMembershipProvider`) to create new user accounts.</span></span> <span data-ttu-id="34b6a-113">新しいユーザーを作成し、ASP プログラムと方法が表示されます。NET の組み込みの CreateUserWizard コントロール。</span><span class="sxs-lookup"><span data-stu-id="34b6a-113">We will see how to create new users programmatically and through ASP.NET's built-in CreateUserWizard control.</span></span>

<span data-ttu-id="34b6a-114">新しいユーザー アカウントを作成する方法を学習するには、だけでなくも必要になりますで最初に作成したデモの web サイトを更新、  *<a id="_msoanchor_2"> </a>[フォーム認証の概要を](../introduction/an-overview-of-forms-authentication-cs.md)*チュートリアルおよび強化し、  *<a id="https://www.asp.net/learn/security/tutorial-03-cs.aspx"> </a>フォーム認証の構成と高度なトピック*チュートリアルです。</span><span class="sxs-lookup"><span data-stu-id="34b6a-114">In addition to learning how to create new user accounts, we will also need to update the demo website we first created in the *<a id="_msoanchor_2"></a>[An Overview of Forms Authentication](../introduction/an-overview-of-forms-authentication-cs.md)* tutorial and then enhanced in the *<a id="https://www.asp.net/learn/security/tutorial-03-cs.aspx"></a> Forms Authentication Configuration and Advanced Topics* tutorial.</span></span> <span data-ttu-id="34b6a-115">デモ web アプリケーションには、ハード コーディングされたユーザー名とパスワードの組み合わせに対してユーザーの資格情報を検証するログイン ページがあります。</span><span class="sxs-lookup"><span data-stu-id="34b6a-115">Our demo web application has a login page that validates users' credentials against hard-coded username/password pairs.</span></span> <span data-ttu-id="34b6a-116">さらに、`Global.asax`カスタムを作成するコードが含まれています`IPrincipal`と`IIdentity`認証済みユーザーのオブジェクト。</span><span class="sxs-lookup"><span data-stu-id="34b6a-116">Moreover, `Global.asax` includes code that creates custom `IPrincipal` and `IIdentity` objects for authenticated users.</span></span> <span data-ttu-id="34b6a-117">メンバーシップ framework に対するユーザーの資格情報を検証し、プリンシパルと id のカスタム ロジックを削除するログイン ページを更新します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-117">We will update the login page to validate users' credentials against the Membership framework and remove the custom principal and identity logic.</span></span>

<span data-ttu-id="34b6a-118">開始しましょう!</span><span class="sxs-lookup"><span data-stu-id="34b6a-118">Let's get started!</span></span>

## <a name="the-forms-authentication-and-membership-checklist"></a><span data-ttu-id="34b6a-119">フォーム認証とメンバーシップのチェックリスト</span><span class="sxs-lookup"><span data-stu-id="34b6a-119">The Forms Authentication and Membership Checklist</span></span>

<span data-ttu-id="34b6a-120">メンバーシップ framework での作業を始める前に、もう一度このポイントに達するに移動しました、重要な手順を確認してみましょう。</span><span class="sxs-lookup"><span data-stu-id="34b6a-120">Before we begin working with the Membership framework, let's take a moment to review the important steps we have taken to reach this point.</span></span> <span data-ttu-id="34b6a-121">使用してメンバーシップ framework を使用する場合、`SqlMembershipProvider`フォーム ベース認証のシナリオで、次の手順は web アプリケーションにメンバーシップ機能を実装する前に実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="34b6a-121">When using the Membership framework with the `SqlMembershipProvider` in a forms-based authentication scenario, the following steps need to be performed prior to implementing Membership functionality in your web application:</span></span>

1. <span data-ttu-id="34b6a-122">**フォーム ベース認証を有効にします。**</span><span class="sxs-lookup"><span data-stu-id="34b6a-122">**Enable forms-based authentication.**</span></span> <span data-ttu-id="34b6a-123">説明したよう *<a id="_msoanchor_4"> </a>[フォーム認証の概要を](../introduction/an-overview-of-forms-authentication-cs.md)*、編集してフォーム認証が有効になっている`Web.config`と設定、 `<authentication>`要素の`mode`属性を`Forms`です。</span><span class="sxs-lookup"><span data-stu-id="34b6a-123">As we discussed in *<a id="_msoanchor_4"></a>[An Overview of Forms Authentication](../introduction/an-overview-of-forms-authentication-cs.md)*, forms authentication is enabled by editing `Web.config` and setting the `<authentication>` element's `mode` attribute to `Forms`.</span></span> <span data-ttu-id="34b6a-124">フォーム認証が有効になっている、受信要求ごとについて、*フォーム認証チケット*、存在する場合、識別、リクエスターです。</span><span class="sxs-lookup"><span data-stu-id="34b6a-124">With forms authentication enabled, each incoming request is examined for a *forms authentication ticket*, which, if present, identifies the requestor.</span></span>
2. <span data-ttu-id="34b6a-125">**アプリケーション サービスのスキーマを適切なデータベースに追加します。**</span><span class="sxs-lookup"><span data-stu-id="34b6a-125">**Add the application services schema to the appropriate database.**</span></span> <span data-ttu-id="34b6a-126">使用する場合、`SqlMembershipProvider`アプリケーション サービスのスキーマをデータベースにインストールする必要があります。</span><span class="sxs-lookup"><span data-stu-id="34b6a-126">When using the `SqlMembershipProvider` we need to install the application services schema to a database.</span></span> <span data-ttu-id="34b6a-127">通常このスキーマは、アプリケーションのデータ モデルを保持するのと同じデータベースに追加されます。</span><span class="sxs-lookup"><span data-stu-id="34b6a-127">Usually this schema is added to the same database that holds the application's data model.</span></span> <span data-ttu-id="34b6a-128"> *<a id="_msoanchor_5"> </a>[メンバーシップ スキーマを作成する SQL Server で](creating-the-membership-schema-in-sql-server-cs.md)*チュートリアルを使用して調べる、`aspnet_regsql.exe`これを実現するツールです。</span><span class="sxs-lookup"><span data-stu-id="34b6a-128">The *<a id="_msoanchor_5"></a>[Creating the Membership Schema in SQL Server](creating-the-membership-schema-in-sql-server-cs.md)* tutorial looked at using the `aspnet_regsql.exe` tool to accomplish this.</span></span>
3. <span data-ttu-id="34b6a-129">**手順 2 からデータベースを参照する Web アプリケーションの設定をカスタマイズします。**</span><span class="sxs-lookup"><span data-stu-id="34b6a-129">**Customize the Web Application's Settings to reference the database from step 2.**</span></span> <span data-ttu-id="34b6a-130">*メンバーシップ スキーマを作成する SQL Server で*チュートリアルでは、web アプリケーションを構成する 2 つの方法を示しましたできるように、`SqlMembershipProvider`手順 2. で選択したデータベースを使用: 変更することによって、`LocalSqlServer`接続文字列名です。または手順 2 をフレームワークのメンバーシップ プロバイダーの一覧に新しい登録済みのプロバイダーを追加してからデータベースを使用して新しいプロバイダーをカスタマイズします。</span><span class="sxs-lookup"><span data-stu-id="34b6a-130">The *Creating the Membership Schema in SQL Server* tutorial showed two ways to configure the web application so that the `SqlMembershipProvider` would use the database selected in step 2: by modifying the `LocalSqlServer` connection string name; or by adding a new registered provider to the list of Membership framework providers and customizing that new provider to use the database from step 2.</span></span>

<span data-ttu-id="34b6a-131">Web アプリケーションの構築を使用する場合、`SqlMembershipProvider`フォーム ベース認証する必要がありますを使用する前にこれら 3 つの手順を実行して、`Membership`クラスや ASP.NET ログイン Web コントロールです。</span><span class="sxs-lookup"><span data-stu-id="34b6a-131">When building a web application that uses the `SqlMembershipProvider` and forms-based authentication, you will need to perform these three steps before using the `Membership` class or the ASP.NET Login Web controls.</span></span> <span data-ttu-id="34b6a-132">前のチュートリアルで既にこれらの手順を実行してから、メンバーシップ framework の使用を開始する準備ができました!</span><span class="sxs-lookup"><span data-stu-id="34b6a-132">Since we already performed these steps in previous tutorials, we are ready to start using the Membership framework!</span></span>

## <a name="step-1-adding-new-aspnet-pages"></a><span data-ttu-id="34b6a-133">手順 1: 新規の ASP.NET ページの追加</span><span class="sxs-lookup"><span data-stu-id="34b6a-133">Step 1: Adding New ASP.NET Pages</span></span>

<span data-ttu-id="34b6a-134">このチュートリアルで、次の 3 お検査各種のメンバーシップに関連する関数と機能します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-134">In this tutorial and the next three we will be examining various Membership-related functions and capabilities.</span></span> <span data-ttu-id="34b6a-135">一連のトピックでは、これらのチュートリアル全体で検証を実装する ASP.NET ページが必要ですが。</span><span class="sxs-lookup"><span data-stu-id="34b6a-135">We will need a series of ASP.NET pages to implement the topics examined throughout these tutorials.</span></span> <span data-ttu-id="34b6a-136">これらのページと、サイト マップ ファイルを作成しましょう`(Web.sitemap)`です。</span><span class="sxs-lookup"><span data-stu-id="34b6a-136">Let's create those pages and then a site map file `(Web.sitemap)`.</span></span>

<span data-ttu-id="34b6a-137">という名前のプロジェクトに新しいフォルダーを作成して開始`Membership`です。</span><span class="sxs-lookup"><span data-stu-id="34b6a-137">Start by creating a new folder in the project named `Membership`.</span></span> <span data-ttu-id="34b6a-138">次に 5 つの新しい ASP.NET ページを追加、`Membership`フォルダーで、各ページのリンク、`Site.master`マスター ページ。</span><span class="sxs-lookup"><span data-stu-id="34b6a-138">Next, add five new ASP.NET pages to the `Membership` folder, linking each page with the `Site.master` master page.</span></span> <span data-ttu-id="34b6a-139">ページの名前を付けます。</span><span class="sxs-lookup"><span data-stu-id="34b6a-139">Name the pages:</span></span>

- `CreatingUserAccounts.aspx`
- `UserBasedAuthorization.aspx`
- `EnhancedCreateUserWizard.aspx`
- `AdditionalUserInfo.aspx`
- `Guestbook.aspx`

<span data-ttu-id="34b6a-140">この時点で、プロジェクトのソリューション エクスプ ローラーはのスクリーン ショット、図 1 に示すようになります。</span><span class="sxs-lookup"><span data-stu-id="34b6a-140">At this point your project's Solution Explorer should look similar to the screen shot shown in Figure 1.</span></span>


<span data-ttu-id="34b6a-141">[![メンバーシップ フォルダーに 5 つの新しいページが追加されました](creating-user-accounts-cs/_static/image2.png)](creating-user-accounts-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="34b6a-141">[![Five New Pages Have Been Added to the Membership Folder](creating-user-accounts-cs/_static/image2.png)](creating-user-accounts-cs/_static/image1.png)</span></span>

<span data-ttu-id="34b6a-142">**図 1**: 5 新しいページに追加されている、`Membership`フォルダー ([フルサイズのイメージを表示するをクリックして](creating-user-accounts-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="34b6a-142">**Figure 1**: Five New Pages Have Been Added to the `Membership` Folder  ([Click to view full-size image](creating-user-accounts-cs/_static/image3.png))</span></span>


<span data-ttu-id="34b6a-143">各ページ、この時点では 2 つのコンテンツ コントロールは、マスター ページの contentplaceholders にごとに 1 つ:`MainContent`と`LoginContent`です。</span><span class="sxs-lookup"><span data-stu-id="34b6a-143">Each page should, at this point, have the two Content controls, one for each of the master page's ContentPlaceHolders: `MainContent` and `LoginContent`.</span></span>

[!code-aspx[Main](creating-user-accounts-cs/samples/sample1.aspx)]

<span data-ttu-id="34b6a-144">注意してください、 `LoginContent` ContentPlaceHolder の既定のマークアップにログオンするか、いったんログオフして、ユーザーが認証されるかどうかに応じて、サイトからへのリンクが表示されます。</span><span class="sxs-lookup"><span data-stu-id="34b6a-144">Recall that the `LoginContent` ContentPlaceHolder's default markup displays a link to log on or log off the site, depending on whether the user is authenticated.</span></span> <span data-ttu-id="34b6a-145">存在、`Content2`コンテンツ コントロール、ただし、マスター ページの既定のマークアップをオーバーライドします。</span><span class="sxs-lookup"><span data-stu-id="34b6a-145">The presence of the `Content2` Content control, however, overrides the master page's default markup.</span></span> <span data-ttu-id="34b6a-146">説明したよう *<a id="_msoanchor_6"> </a>[フォーム認証の概要を](../introduction/an-overview-of-forms-authentication-cs.md)*チュートリアルでは、これはページの左の列にログインに関連するオプションを表示しない場所おで役に立ちます。</span><span class="sxs-lookup"><span data-stu-id="34b6a-146">As we discussed in *<a id="_msoanchor_6"></a>[An Overview of Forms Authentication](../introduction/an-overview-of-forms-authentication-cs.md)* tutorial, this is useful in pages where we do not want to display login-related options in the left column.</span></span>

<span data-ttu-id="34b6a-147">これらの 5 ページでは、ただし、表示することのマスター ページの既定のマークアップ、 `LoginContent` ContentPlaceHolder です。</span><span class="sxs-lookup"><span data-stu-id="34b6a-147">For these five pages, however, we want to show the master page's default markup for the `LoginContent` ContentPlaceHolder.</span></span> <span data-ttu-id="34b6a-148">このため、削除の宣言型マークアップ、`Content2`コンテンツ コントロールです。</span><span class="sxs-lookup"><span data-stu-id="34b6a-148">Therefore, remove the declarative markup for the `Content2` Content control.</span></span> <span data-ttu-id="34b6a-149">その後、1 つだけのコンテンツ コントロールを含めるそれぞれ 5 つのページのマークアップの必要があります。</span><span class="sxs-lookup"><span data-stu-id="34b6a-149">After doing so, each of the five page's markup should contain just one Content control.</span></span>

## <a name="step-2-creating-the-site-map"></a><span data-ttu-id="34b6a-150">手順 2: サイト マップを作成します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-150">Step 2: Creating the Site Map</span></span>

<span data-ttu-id="34b6a-151">最も単純な web サイトを除くすべては、何らかの形式の移動ユーザー インターフェイスを実装する必要があります。</span><span class="sxs-lookup"><span data-stu-id="34b6a-151">All but the most trivial websites need to implement some form of a navigational user interface.</span></span> <span data-ttu-id="34b6a-152">移動ユーザー インターフェイスは、サイトのさまざまなセクションへのリンクの単純なリストにあります。</span><span class="sxs-lookup"><span data-stu-id="34b6a-152">The navigation user interface may be a simple list of links to the various sections of the site.</span></span> <span data-ttu-id="34b6a-153">また、これらのリンクは、メニューやツリー ビューに配置可能性があります。</span><span class="sxs-lookup"><span data-stu-id="34b6a-153">Alternatively, these links may be arranged into menus or tree views.</span></span> <span data-ttu-id="34b6a-154">開発者はページ、ナビゲーションのユーザー インターフェイスの作成は、ストーリーの半分だけです。</span><span class="sxs-lookup"><span data-stu-id="34b6a-154">As page developers, creating the navigational user interface is only half of the story.</span></span> <span data-ttu-id="34b6a-155">保守し、更新可能な方法で、サイトの論理構造を定義するなんらかの手段も必要です。</span><span class="sxs-lookup"><span data-stu-id="34b6a-155">We also need some means to define the site's logical structure in a maintainable and updateable fashion.</span></span> <span data-ttu-id="34b6a-156">新しいページを追加または既存のページが削除される、– サイト マップ – 1 つのソースを更新したいし、が、サイトのナビゲーションのユーザー インターフェイス間で、これらの変更が反映されます。</span><span class="sxs-lookup"><span data-stu-id="34b6a-156">As new pages are added or existing pages removed, we want to be able to update a single source – the site map – and have those modifications reflected across the site's navigational user interface.</span></span>

<span data-ttu-id="34b6a-157">– サイト マップを定義して、サイト マップに基づくナビゲーションのユーザー インターフェイスを実装する – これら 2 つのタスクは簡単に、サイト マップ framework 感謝実行およびナビゲーションの Web コントロールを ASP.NET version 2.0 で追加します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-157">These two tasks – defining the site map and implementing a navigational user interface based on the site map – are easy to accomplish thanks to the Site Map framework and the Navigation Web controls added in ASP.NET version 2.0.</span></span> <span data-ttu-id="34b6a-158">サイト マップを定義する開発者向けサイト マップ フレームワークを利用して、そのプログラムの API を使用してアクセスするために (、 [ `SiteMap`クラス](https://msdn.microsoft.com/library/system.web.sitemap.aspx))。</span><span class="sxs-lookup"><span data-stu-id="34b6a-158">The Site Map framework allows for a developer to define a site map and then to access it through a programmatic API (the [`SiteMap` class](https://msdn.microsoft.com/library/system.web.sitemap.aspx)).</span></span> <span data-ttu-id="34b6a-159">組み込みナビゲーション Web コントロールにはが含まれて、[メニュー コントロール](https://msdn.microsoft.com/library/bz09dy46.aspx)、 [TreeView コントロール](https://msdn.microsoft.com/library/3eafky27.aspx)、および[サイト マップ パス コントロール](https://msdn.microsoft.com/library/3eafky27.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="34b6a-159">The built-in Navigation Web controls include a [Menu control](https://msdn.microsoft.com/library/bz09dy46.aspx), the [TreeView control](https://msdn.microsoft.com/library/3eafky27.aspx), and the [SiteMapPath control](https://msdn.microsoft.com/library/3eafky27.aspx).</span></span>

<span data-ttu-id="34b6a-160">メンバーシップとロールのフレームワークと同様に、サイト マップ framework は上に構築される、[プロバイダー モデル](http://aspnet.4guysfromrolla.com/articles/101905-1.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="34b6a-160">Like the Membership and Roles frameworks, the Site Map framework is built atop the [provider model](http://aspnet.4guysfromrolla.com/articles/101905-1.aspx).</span></span> <span data-ttu-id="34b6a-161">サイト マップ プロバイダー クラスのジョブがによって使用されるメモリ内構造を作成するには、 `SiteMap` XML ファイルまたはデータベース テーブルなどの永続的なデータ ストアからのクラスです。</span><span class="sxs-lookup"><span data-stu-id="34b6a-161">The job of the Site Map provider class is to generate the in-memory structure used by the `SiteMap` class from a persistent data store, such as an XML file or a database table.</span></span> <span data-ttu-id="34b6a-162">.NET Framework がデータを読み取り、サイト マップ XML ファイルから既定のサイト マップ プロバイダーが付属しています ([`XmlSiteMapProvider`](https://msdn.microsoft.com/library/system.web.xmlsitemapprovider.aspx))、これは、プロバイダーは、このチュートリアルで使用します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-162">The .NET Framework ships with a default Site Map provider that reads the site map data from an XML file ([`XmlSiteMapProvider`](https://msdn.microsoft.com/library/system.web.xmlsitemapprovider.aspx)), and this is the provider we will be using in this tutorial.</span></span> <span data-ttu-id="34b6a-163">代替サイト マップ プロバイダー実装によって、このチュートリアルの最後に、さらに測定値のセクションを参照してください。</span><span class="sxs-lookup"><span data-stu-id="34b6a-163">For some alternate Site Map provider implementations, refer to the Further Readings section at the end of this tutorial.</span></span>

<span data-ttu-id="34b6a-164">既定のサイト マップ プロバイダーには、適切にフォーマットされた XML という名前のファイルが必要ですが`Web.sitemap`ルート ディレクトリが存在します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-164">The default Site Map provider expects a properly-formatted XML file named `Web.sitemap` to exist the root directory.</span></span> <span data-ttu-id="34b6a-165">この既定のプロバイダーを使用していることからは、このようなファイルを追加し、適切な XML 形式で、サイト マップの構造を定義する必要があります。</span><span class="sxs-lookup"><span data-stu-id="34b6a-165">Since we are using this default provider, we need to add such a file and define the site map's structure in the appropriate XML format.</span></span> <span data-ttu-id="34b6a-166">ファイルを追加するには、ソリューション エクスプ ローラーでプロジェクト名を右クリックし、新しい項目の追加を選択します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-166">To add the file, right-click on the project name in Solution Explorer and choose Add New Item.</span></span> <span data-ttu-id="34b6a-167">サイト マップという名前の種類のファイルを追加することを選択 ダイアログ ボックスから`Web.sitemap`です。</span><span class="sxs-lookup"><span data-stu-id="34b6a-167">From the dialog box, opt to add a file of type Site Map named `Web.sitemap`.</span></span>


<span data-ttu-id="34b6a-168">[![プロジェクトのルート ディレクトリに Web.sitemap をという名前のファイルを追加します。](creating-user-accounts-cs/_static/image5.png)](creating-user-accounts-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="34b6a-168">[![Add a File Named Web.sitemap to the Project's Root Directory](creating-user-accounts-cs/_static/image5.png)](creating-user-accounts-cs/_static/image4.png)</span></span>

<span data-ttu-id="34b6a-169">**図 2**: ファイルの名前を追加`Web.sitemap`プロジェクトのルート ディレクトリに ([フルサイズのイメージを表示するをクリックして](creating-user-accounts-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="34b6a-169">**Figure 2**: Add a File Named `Web.sitemap` to the Project's Root Directory  ([Click to view full-size image](creating-user-accounts-cs/_static/image6.png))</span></span>


<span data-ttu-id="34b6a-170">XML サイト マップ ファイルは、階層構造として、web サイトの構造を定義します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-170">The XML site map file defines the website's structure as a hierarchy.</span></span> <span data-ttu-id="34b6a-171">この階層関係がの先祖を使用して XML ファイルでモデル化されて、`<siteMapNode>`要素。</span><span class="sxs-lookup"><span data-stu-id="34b6a-171">This hierarchical relationship is modeled in the XML file via the ancestry of the `<siteMapNode>` elements.</span></span> <span data-ttu-id="34b6a-172">`Web.sitemap`始める必要があります、`<siteMap>`を正確に 1 つの親ノード`<siteMapNode>`子。</span><span class="sxs-lookup"><span data-stu-id="34b6a-172">The `Web.sitemap` must start with a `<siteMap>` parent node that has precisely one `<siteMapNode>` child.</span></span> <span data-ttu-id="34b6a-173">この最上位`<siteMapNode>`要素が、階層のルートを表し、子孫のノードの任意の数を含めることがあります。</span><span class="sxs-lookup"><span data-stu-id="34b6a-173">This top-level `<siteMapNode>` element represents the root of the hierarchy, and may have an arbitrary number of descendent nodes.</span></span> <span data-ttu-id="34b6a-174">各`<siteMapNode>`要素を含める必要があります、`title`属性を含めることができます必要に応じて`url`と`description`; 他の属性ごと、空でない`url`属性は一意である必要があります。</span><span class="sxs-lookup"><span data-stu-id="34b6a-174">Each `<siteMapNode>` element must include a `title` attribute and may optionally include `url` and `description` attributes, among others; each non-empty `url` attribute must be unique.</span></span>

<span data-ttu-id="34b6a-175">次の XML を入力、`Web.sitemap`ファイル。</span><span class="sxs-lookup"><span data-stu-id="34b6a-175">Enter the following XML into the `Web.sitemap` file:</span></span>

[!code-xml[Main](creating-user-accounts-cs/samples/sample2.xml)]

<span data-ttu-id="34b6a-176">上記のサイト マップ マークアップでは、図 3 に示すように階層を定義します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-176">The above site map markup defines the hierarchy shown in Figure 3.</span></span>


<span data-ttu-id="34b6a-177">[![サイト マップが階層ナビゲーション構造体を表します](creating-user-accounts-cs/_static/image8.png)](creating-user-accounts-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="34b6a-177">[![The Site Map Represents a Hierarchical Navigational Structure](creating-user-accounts-cs/_static/image8.png)](creating-user-accounts-cs/_static/image7.png)</span></span>

<span data-ttu-id="34b6a-178">**図 3**: サイト マップが階層ナビゲーション構造体を表します ([フルサイズのイメージを表示するをクリックして](creating-user-accounts-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="34b6a-178">**Figure 3**: The Site Map Represents a Hierarchical Navigational Structure  ([Click to view full-size image](creating-user-accounts-cs/_static/image9.png))</span></span>


## <a name="step-3-updating-the-master-page-to-include-a-navigational-user-interface"></a><span data-ttu-id="34b6a-179">手順 3: 移動ユーザー インターフェイスを挿入するマスター ページを更新します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-179">Step 3: Updating the Master Page to Include a Navigational User Interface</span></span>

<span data-ttu-id="34b6a-180">ASP.NET には、ユーザー インターフェイスを設計するためのナビゲーション関連の Web コントロールの数が含まれています。</span><span class="sxs-lookup"><span data-stu-id="34b6a-180">ASP.NET includes a number of navigation-related Web controls for designing a user interface.</span></span> <span data-ttu-id="34b6a-181">これらには、メニューの TreeView、およびサイト マップ パス コントロールが含まれます。</span><span class="sxs-lookup"><span data-stu-id="34b6a-181">These include the Menu, TreeView, and the SiteMapPath controls.</span></span> <span data-ttu-id="34b6a-182">メニューを TreeView のコントロールは、サイト マップ パスには、その先祖と参照される現在のノードを示す階層リンクが表示されますが、それぞれメニューや、ツリー内のサイト マップ構造をレンダリングします。</span><span class="sxs-lookup"><span data-stu-id="34b6a-182">The Menu and TreeView controls render the site map structure in a menu or a tree, respectively, whereas the SiteMapPath displays a breadcrumb that shows the current node being visited as well as its ancestors.</span></span> <span data-ttu-id="34b6a-183">サイト マップ データが Web コントロール、SiteMapDataSource を使用してその他のデータにバインドでき、経由でプログラムからアクセスできる、`SiteMap`クラスです。</span><span class="sxs-lookup"><span data-stu-id="34b6a-183">The site map data can be bound to other data Web controls using the SiteMapDataSource and can be accessed programmatically via the `SiteMap` class.</span></span>

<span data-ttu-id="34b6a-184">サイト マップ フレームワークとナビゲーション コントロールの完全な詳細については、このチュートリアル シリーズの範囲外ですが、以降ではなくみましょう独自移動ユーザー インターフェイスの作成時間をかけて代わりに借用で使用される my  *[ASP.NET 2.0 のデータを扱う](../../data-access/index.md)*チュートリアル シリーズは、図 4 に示すように、ナビゲーション リンクの 2 つが深い箇条書きリストを表示する Repeater コントロールを使用します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-184">Since a thorough discussion of the Site Map framework and the Navigation controls is beyond the scope of this tutorial series, rather than spend time crafting our own navigational user interface let's instead borrow the one used in my *[Working with Data in ASP.NET 2.0](../../data-access/index.md)* tutorial series, which uses a Repeater control to display a two-deep bulleted list of navigation links, as shown in Figure 4.</span></span>

### <a name="adding-a-two-level-list-of-links-in-the-left-column"></a><span data-ttu-id="34b6a-185">左の列に 2 つのレベルのリンクの一覧を追加します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-185">Adding a Two-Level List of Links in the Left Column</span></span>

<span data-ttu-id="34b6a-186">このインターフェイスを作成するには、次に示す宣言型マークアップを追加、`Site.master`マスター ページの左の列をテキスト"TODO: メニューここに表示されます。"現在が存在します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-186">To create this interface, add the following declarative markup to the `Site.master` master page's left column where the text "TODO: Menu will go here..." currently resides.</span></span>

[!code-aspx[Main](creating-user-accounts-cs/samples/sample3.aspx)]

<span data-ttu-id="34b6a-187">上記のマークアップがという名前のリピータ コントロールをバインド`menu`で定義されているサイト マップの階層が返されます、SiteMapDataSource に`Web.sitemap`です。</span><span class="sxs-lookup"><span data-stu-id="34b6a-187">The above markup binds a Repeater control named `menu` to a SiteMapDataSource, which returns the site map hierarchy defined in `Web.sitemap`.</span></span> <span data-ttu-id="34b6a-188">以降、SiteMapDataSource コントロールの[`ShowStartingNode`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sitemapdatasource.showstartingnode.aspx)以降「ホーム」ノードの子孫で、サイト マップの階層を返すを開始、False に設定されています。</span><span class="sxs-lookup"><span data-stu-id="34b6a-188">Since the SiteMapDataSource control's [`ShowStartingNode` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sitemapdatasource.showstartingnode.aspx) is set to False it starts returning the site map's hierarchy starting with the descendents of the "Home" node.</span></span> <span data-ttu-id="34b6a-189">リピータのそれぞれ表示これらのノード (現在だけ「メンバーシップ」)、`<li>`要素。</span><span class="sxs-lookup"><span data-stu-id="34b6a-189">The Repeater displays each of these nodes (currently just "Membership") in an `<li>` element.</span></span> <span data-ttu-id="34b6a-190">Repeater を別の内部では、入れ子になった順序なしリストで現在のノードの子が表示されます。</span><span class="sxs-lookup"><span data-stu-id="34b6a-190">Another, inner Repeater then displays the current node's children in a nested unordered list.</span></span>

<span data-ttu-id="34b6a-191">図 4 は、手順 2. で作成したサイト マップ構造を持つ、上記のマークアップの表示される出力を示します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-191">Figure 4 shows the above markup's rendered output with the site map structure we created in Step 2.</span></span> <span data-ttu-id="34b6a-192">リピータ マークアップ バニラ順序なしリストです。定義されているカスケード スタイル シート規則`Styles.css`見た目心地よいレイアウトを担当します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-192">The Repeater renders vanilla unordered list markup; the cascading style sheet rules defined in `Styles.css` are responsible for the aesthetically-pleasing layout.</span></span> <span data-ttu-id="34b6a-193">上記のマークアップのしくみの詳細についてを参照してください、[マスター ページとサイト ナビゲーション](https://asp.net/learn/data-access/tutorial-03-cs.aspx)チュートリアルです。</span><span class="sxs-lookup"><span data-stu-id="34b6a-193">For a more detailed description of how the above markup works, refer to the [Master Pages and Site Navigation](https://asp.net/learn/data-access/tutorial-03-cs.aspx) tutorial.</span></span>


<span data-ttu-id="34b6a-194">[![ナビゲーションのユーザー インターフェイスが表示されるリストを使用して入れ子になった順序なし](creating-user-accounts-cs/_static/image11.png)](creating-user-accounts-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="34b6a-194">[![The Navigational User Interface is Rendered Using Nested Unordered Lists](creating-user-accounts-cs/_static/image11.png)](creating-user-accounts-cs/_static/image10.png)</span></span>

<span data-ttu-id="34b6a-195">**図 4**: ナビゲーションのユーザー インターフェイスが表示されるリストを使用して入れ子になった順序付けられていない ([フルサイズのイメージを表示するをクリックして](creating-user-accounts-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="34b6a-195">**Figure 4**: The Navigational User Interface is Rendered Using Nested Unordered Lists  ([Click to view full-size image](creating-user-accounts-cs/_static/image12.png))</span></span>


### <a name="adding-breadcrumb-navigation"></a><span data-ttu-id="34b6a-196">階層リンク バー ナビゲーションを追加します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-196">Adding Breadcrumb Navigation</span></span>

<span data-ttu-id="34b6a-197">左の列内のリンクの一覧、に加えてみましょうもがある各ページの 表示、[階層リンク](http://en.wikipedia.org/wiki/Breadcrumb_%28navigation%29)です。</span><span class="sxs-lookup"><span data-stu-id="34b6a-197">In addition to the list of links in the left column, let's also have each page display a [breadcrumb](http://en.wikipedia.org/wiki/Breadcrumb_%28navigation%29).</span></span> <span data-ttu-id="34b6a-198">階層リンクは、すぐに、サイト階層内の現在位置をユーザーに表示されるナビゲーションのユーザー インターフェイス要素です。</span><span class="sxs-lookup"><span data-stu-id="34b6a-198">A breadcrumb is a navigational user interface element that quickly shows users their current position within the site hierarchy.</span></span> <span data-ttu-id="34b6a-199">サイト マップ パス コントロールは、サイト マップ内の現在のページの場所を特定する、サイト マップ フレームワークを使用し、し、この情報に基づいて階層リンク バーを表示します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-199">The SiteMapPath control uses the Site Map framework to determine the current page's location in the site map and then displays a breadcrumb based on this information.</span></span>

<span data-ttu-id="34b6a-200">具体的には、追加、`<span>`要素、マスター ページのヘッダーを`<div>`要素、し、新しい設定`<span>`要素の`class`属性を「階層リンク バー」にします。</span><span class="sxs-lookup"><span data-stu-id="34b6a-200">Specifically, add a `<span>` element to the master page's header `<div>` element, and set the new `<span>` element's `class` attribute to "breadcrumb".</span></span> <span data-ttu-id="34b6a-201">(、`Styles.css`クラスには、「階層リンク バー」クラスのルールが含まれています)。次に、この新規作成 をサイト マップ パスを追加`<span>`要素。</span><span class="sxs-lookup"><span data-stu-id="34b6a-201">(The `Styles.css` class contains a rule for a "breadcrumb" class.) Next, add a SiteMapPath to this new `<span>` element.</span></span>

[!code-aspx[Main](creating-user-accounts-cs/samples/sample4.aspx)]

<span data-ttu-id="34b6a-202">図 5 にアクセスしたときに、サイト マップ パスの出力を示しています`~/Membership/CreatingUserAccounts.aspx`です。</span><span class="sxs-lookup"><span data-stu-id="34b6a-202">Figure 5 shows the output of the SiteMapPath when visiting `~/Membership/CreatingUserAccounts.aspx`.</span></span>


<span data-ttu-id="34b6a-203">[![階層リンクには、現在のページが表示されます。 および、サイトでは、その先祖のマップ](creating-user-accounts-cs/_static/image14.png)](creating-user-accounts-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="34b6a-203">[![The Breadcrumb Displays the Current Page and its Ancestors in the Site Map](creating-user-accounts-cs/_static/image14.png)](creating-user-accounts-cs/_static/image13.png)</span></span>

<span data-ttu-id="34b6a-204">**図 5**: 階層リンク、サイト マップでの現在のページとその先祖の表示 ([フルサイズのイメージを表示するをクリックして](creating-user-accounts-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="34b6a-204">**Figure 5**: The Breadcrumb Displays the Current Page and its Ancestors in the Site Map  ([Click to view full-size image](creating-user-accounts-cs/_static/image15.png))</span></span>


## <a name="step-4-removing-the-custom-principal-and-identity-logic"></a><span data-ttu-id="34b6a-205">手順 4: カスタム プリンシパルと Id ロジックの削除</span><span class="sxs-lookup"><span data-stu-id="34b6a-205">Step 4: Removing the Custom Principal and Identity Logic</span></span>

<span data-ttu-id="34b6a-206"> *<a id="_msoanchor_7"> </a>[フォーム認証の構成と高度なトピック](../introduction/forms-authentication-configuration-and-advanced-topics-cs.md)*チュートリアルに認証されたユーザーにカスタム プリンシパルと id オブジェクトを関連付ける方法を説明しました。</span><span class="sxs-lookup"><span data-stu-id="34b6a-206">In the *<a id="_msoanchor_7"></a>[Forms Authentication Configuration and Advanced Topics](../introduction/forms-authentication-configuration-and-advanced-topics-cs.md)* tutorial we saw how to associate custom principal and identity objects to the authenticated user.</span></span> <span data-ttu-id="34b6a-207">内のイベント ハンドラーを作成することでこれを実現お`Global.asax`のアプリケーションの`PostAuthenticateRequest`後に発生するイベント、`FormsAuthenticationModule`がユーザーを認証します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-207">We accomplished this by creating an event handler in `Global.asax` for the application's `PostAuthenticateRequest` event, which fires after the `FormsAuthenticationModule` has authenticated the user.</span></span> <span data-ttu-id="34b6a-208">このイベント ハンドラーで置き換えました、`GenericPrincipal`と`FormsIdentity`によって追加されたオブジェクト、`FormsAuthenticationModule`で、`CustomPrincipal`と`CustomIdentity`そのチュートリアルで作成したオブジェクトします。</span><span class="sxs-lookup"><span data-stu-id="34b6a-208">In this event handler we replaced the `GenericPrincipal` and `FormsIdentity` objects added by the `FormsAuthenticationModule` with the `CustomPrincipal` and `CustomIdentity` objects we created in that tutorial.</span></span>

<span data-ttu-id="34b6a-209">カスタム プリンシパル オブジェクトと id オブジェクトはほとんどの場合、特定のシナリオで役に立ちますが、`GenericPrincipal`と`FormsIdentity`オブジェクトで十分です。</span><span class="sxs-lookup"><span data-stu-id="34b6a-209">While custom principal and identity objects are useful in certain scenarios, in most cases the `GenericPrincipal` and `FormsIdentity` objects are sufficient.</span></span> <span data-ttu-id="34b6a-210">したがって、既定の動作に戻るには価値のあることと思います。</span><span class="sxs-lookup"><span data-stu-id="34b6a-210">Consequently, I think it would be worthwhile to return to the default behavior.</span></span> <span data-ttu-id="34b6a-211">削除するか、コメント アウトすることによってこの変更を行う、`PostAuthenticateRequest`イベント ハンドラーまたは削除することによって、`Global.asax`完全ファイルします。</span><span class="sxs-lookup"><span data-stu-id="34b6a-211">Make this change by either removing or commenting out the `PostAuthenticateRequest` event handler or by deleting the `Global.asax` file entirely.</span></span>

## <a name="step-5-programmatically-creating-a-new-user"></a><span data-ttu-id="34b6a-212">手順 5: 新しいユーザーをプログラムで作成します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-212">Step 5: Programmatically Creating a New User</span></span>

<span data-ttu-id="34b6a-213">メンバーシップ フレームワークを使用して新しいユーザー アカウントを作成する、`Membership`クラスの[`CreateUser`メソッド](https://msdn.microsoft.com/library/system.web.security.membership.createuser.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="34b6a-213">To create a new user account through the Membership framework use the `Membership` class's [`CreateUser` method](https://msdn.microsoft.com/library/system.web.security.membership.createuser.aspx).</span></span> <span data-ttu-id="34b6a-214">このメソッドには、ユーザー名、パスワード、およびその他のユーザーに関連するフィールドのパラメーターに入力します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-214">This method has input parameters for the username, password, and other user-related fields.</span></span> <span data-ttu-id="34b6a-215">呼び出しでは、上の 構成済みのメンバーシップ プロバイダーを新しいユーザー アカウントの作成を委任し、返しますが、、 [ `MembershipUser`オブジェクト](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx)だけで作成されたユーザー アカウントを表すです。</span><span class="sxs-lookup"><span data-stu-id="34b6a-215">On invocation, it delegates the creation of the new user account to the configured Membership provider and then returns a [`MembershipUser` object](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx) representing the just-created user account.</span></span>

<span data-ttu-id="34b6a-216">`CreateUser`メソッドが 4 つのオーバー ロードが、異なる数の入力パラメーターを入力します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-216">The `CreateUser` method has four overloads, each accepting a different number of input parameters:</span></span>

- [`CreateUser(username, password)`](https://msdn.microsoft.com/library/d8t4h2es.aspx)
- [`CreateUser(username, password, email)`](https://msdn.microsoft.com/library/t8yy6w3h.aspx)
- [`CreateUser(username, password, email, passwordQuestion, passwordAnswer, isApproved, MembershipCreateStatus)`](https://msdn.microsoft.com/library/82xx2e62.aspx)
- [`CreateUser(username, password, email, passwordQuestion, passwordAnswer, isApproved, providerUserKey, MembershipCreateStatus)`](https://msdn.microsoft.com/library/ms152012.aspx)

<span data-ttu-id="34b6a-217">これら 4 つのオーバー ロードは、収集される情報の量によって異なります。</span><span class="sxs-lookup"><span data-stu-id="34b6a-217">These four overloads differ on the amount of information that is collected.</span></span> <span data-ttu-id="34b6a-218">最初のオーバー ロードでは、たとえばが必要がユーザー名とパスワードのみ、新しいユーザー アカウントの 2 つ目では、ユーザーの電子メール アドレスも必要です。</span><span class="sxs-lookup"><span data-stu-id="34b6a-218">The first overload, for example, requires just the username and password for the new user account, whereas the second one also requires the user's email address.</span></span>

<span data-ttu-id="34b6a-219">新しいユーザー アカウントの作成に必要な情報が、メンバーシップ プロバイダーの構成設定に依存しているために、これらのオーバー ロードが存在します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-219">These overloads exist because the information needed to create a new user account depends on the Membership provider's configuration settings.</span></span> <span data-ttu-id="34b6a-220"> *<a id="_msoanchor_8"> </a>[メンバーシップ スキーマを作成する SQL Server で](creating-the-membership-schema-in-sql-server-cs.md)*でメンバーシップ プロバイダーの構成設定の指定を調べるおチュートリアル`Web.config`です。</span><span class="sxs-lookup"><span data-stu-id="34b6a-220">In the *<a id="_msoanchor_8"></a>[Creating the Membership Schema in SQL Server](creating-the-membership-schema-in-sql-server-cs.md)* tutorial we examined specifying Membership provider configuration settings in `Web.config`.</span></span> <span data-ttu-id="34b6a-221">表 2 には、構成設定の完全な一覧が含まれています。</span><span class="sxs-lookup"><span data-stu-id="34b6a-221">Table 2 included a complete list of the configuration settings.</span></span>

<span data-ttu-id="34b6a-222">1 つそのようなメンバーシップ プロバイダーの構成設定にどのような影響を与えます`CreateUser`オーバー ロードを使用することがありますが、`requiresQuestionAndAnswer`設定します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-222">One such Membership provider configuration setting that impacts what `CreateUser` overloads may be used is the `requiresQuestionAndAnswer` setting.</span></span> <span data-ttu-id="34b6a-223">場合`requiresQuestionAndAnswer`に設定されている`true`(既定)、し、新しいユーザー アカウントを作成するときに、セキュリティの質問と回答を指定お必要があります。</span><span class="sxs-lookup"><span data-stu-id="34b6a-223">If `requiresQuestionAndAnswer` is set to `true` (the default), then when creating a new user account we must specify a security question and answer.</span></span> <span data-ttu-id="34b6a-224">この情報は後で、ユーザーをリセットまたはパスワードを変更する必要がある場合に使用します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-224">This information is later used if the user needs to reset or change their password.</span></span> <span data-ttu-id="34b6a-225">具体的には、その時点でのセキュリティの質問を表示されているとリセットまたはパスワードを変更するために正しい解答を入力する必要があります。</span><span class="sxs-lookup"><span data-stu-id="34b6a-225">Specifically, at that time they are shown the security question and they must enter the correct answer in order to reset or change their password.</span></span> <span data-ttu-id="34b6a-226">したがって場合、`requiresQuestionAndAnswer`に設定されている`true`最初の 2 つのいずれかを呼び出して、`CreateUser`のセキュリティの質問と回答が見つからないため、例外の結果をオーバー ロードします。</span><span class="sxs-lookup"><span data-stu-id="34b6a-226">Consequently, if the `requiresQuestionAndAnswer` is set to `true` then calling either of the first two `CreateUser` overloads results in an exception because the security question and answer are missing.</span></span> <span data-ttu-id="34b6a-227">アプリケーションがセキュリティの質問と解答を要求するように現在構成されているためにはユーザーをプログラムで作成するときに、後者の 2 つのオーバー ロードのいずれかを使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="34b6a-227">Since our application is currently configured to require a security question and answer, we will need to use one of the latter two overloads when creating user's programmatically.</span></span>

<span data-ttu-id="34b6a-228">使用して説明するために、`CreateUser`メソッド、ユーザーに、名前、パスワード、電子メール、および定義済みのセキュリティの質問に対する回答を求めるおユーザー インターフェイスを作成してみましょう。</span><span class="sxs-lookup"><span data-stu-id="34b6a-228">To illustrate using the `CreateUser` method, let's create a user interface where we prompt the user for their name, password, email, and an answer to a pre-defined security question.</span></span> <span data-ttu-id="34b6a-229">開く、 `CreatingUserAccounts.aspx`  ページで、`Membership`フォルダー コンテンツ コントロールに次の Web コントロールを追加。</span><span class="sxs-lookup"><span data-stu-id="34b6a-229">Open the `CreatingUserAccounts.aspx` page in the `Membership` folder and add the following Web controls to the Content control:</span></span>

- <span data-ttu-id="34b6a-230">という名前のテキスト ボックス `Username`</span><span class="sxs-lookup"><span data-stu-id="34b6a-230">A TextBox named `Username`</span></span>
- <span data-ttu-id="34b6a-231">という名前のテキスト ボックス`Password`が`TextMode`プロパティに設定 `Password`</span><span class="sxs-lookup"><span data-stu-id="34b6a-231">A TextBox named `Password`, whose `TextMode` property is set to `Password`</span></span>
- <span data-ttu-id="34b6a-232">という名前のテキスト ボックス `Email`</span><span class="sxs-lookup"><span data-stu-id="34b6a-232">A TextBox named `Email`</span></span>
- <span data-ttu-id="34b6a-233">という名前のラベル`SecurityQuestion`でその`Text`プロパティをクリア</span><span class="sxs-lookup"><span data-stu-id="34b6a-233">A Label named `SecurityQuestion` with its `Text` property cleared out</span></span>
- <span data-ttu-id="34b6a-234">という名前のテキスト ボックス `SecurityAnswer`</span><span class="sxs-lookup"><span data-stu-id="34b6a-234">A TextBox named `SecurityAnswer`</span></span>
- <span data-ttu-id="34b6a-235">という名前のボタン`CreateAccountButton`テキスト プロパティが設定される「、ユーザー アカウントを作成する」を</span><span class="sxs-lookup"><span data-stu-id="34b6a-235">A Button named `CreateAccountButton` whose Text property is set to "Create the User Account"</span></span>
- <span data-ttu-id="34b6a-236">という名前のラベル コントロール`CreateAccountResults`でその`Text`プロパティをクリア</span><span class="sxs-lookup"><span data-stu-id="34b6a-236">A Label control named `CreateAccountResults` with its `Text` property cleared out</span></span>

<span data-ttu-id="34b6a-237">この時点で、画面は、スクリーン ショット図 6 に示すようになります。</span><span class="sxs-lookup"><span data-stu-id="34b6a-237">At this point your screen should look similar to the screen shot shown in Figure 6.</span></span>


<span data-ttu-id="34b6a-238">[![CreatingUserAccounts.aspx ページにさまざまな Web コントロールを追加します。](creating-user-accounts-cs/_static/image17.png)](creating-user-accounts-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="34b6a-238">[![Add the Various Web Controls to the CreatingUserAccounts.aspx Page](creating-user-accounts-cs/_static/image17.png)](creating-user-accounts-cs/_static/image16.png)</span></span>

<span data-ttu-id="34b6a-239">**図 6**: さまざまな Web コントロールを追加、`CreatingUserAccounts.aspx`ページ ([フルサイズのイメージを表示するをクリックして](creating-user-accounts-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="34b6a-239">**Figure 6**: Add the Various Web Controls to the `CreatingUserAccounts.aspx` Page  ([Click to view full-size image](creating-user-accounts-cs/_static/image18.png))</span></span>


<span data-ttu-id="34b6a-240">`SecurityQuestion`ラベルと`SecurityAnswer` ボックスには定義済みのセキュリティの質問を表示し、ユーザーの応答を収集するためのものです。</span><span class="sxs-lookup"><span data-stu-id="34b6a-240">The `SecurityQuestion` Label and `SecurityAnswer` TextBox are intended to display a pre-defined security question and collect the user's answer.</span></span> <span data-ttu-id="34b6a-241">独自のセキュリティの質問を定義するには、各ユーザーを許可することはユーザー単位のユーザーごとにセキュリティの質問と回答の両方が格納されていることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="34b6a-241">Note that both the security question and answer are stored on a user-by-user basis, so it is possible to allow each user to define their own security question.</span></span> <span data-ttu-id="34b6a-242">ただし、つまり、ユニバーサル セキュリティ質問を使用することにしましたが、この例の場合:「好きな色は何ですか?」</span><span class="sxs-lookup"><span data-stu-id="34b6a-242">However, for this example I have decided to use a universal security question, namely: "What is your favorite color?"</span></span>

<span data-ttu-id="34b6a-243">この定義済みのセキュリティの質問を実装するのには、という名前のページの分離コード クラスに定数を追加`passwordQuestion`セキュリティの質問を割り当てることです。</span><span class="sxs-lookup"><span data-stu-id="34b6a-243">To implement this pre-defined security question, add a constant to the page's code-behind class named `passwordQuestion`, assigning it the security question.</span></span> <span data-ttu-id="34b6a-244">次に、`Page_Load`イベント ハンドラー、割り当てにこの定数、`SecurityQuestion`ラベルの`Text`プロパティ。</span><span class="sxs-lookup"><span data-stu-id="34b6a-244">Then, in the `Page_Load` event handler, assign this constant to the `SecurityQuestion` Label's `Text` property:</span></span>

[!code-csharp[Main](creating-user-accounts-cs/samples/sample5.cs)]

<span data-ttu-id="34b6a-245">イベント ハンドラーを次に、作成、`CreateAccountButton`の`Click`イベントし、次のコードを追加します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-245">Next, create an event handler for the `CreateAccountButton`'s `Click` event and add the following code:</span></span>

[!code-csharp[Main](creating-user-accounts-cs/samples/sample6.cs)]

<span data-ttu-id="34b6a-246">`Click`という名前の変数を定義してイベント ハンドラーを起動`createStatus`型の[ `MembershipCreateStatus`](https://msdn.microsoft.com/library/system.web.security.membershipcreatestatus.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="34b6a-246">The `Click` event handler starts by defining a variable named `createStatus` of type [`MembershipCreateStatus`](https://msdn.microsoft.com/library/system.web.security.membershipcreatestatus.aspx).</span></span> <span data-ttu-id="34b6a-247">`MembershipCreateStatus` 状態を示す列挙体には、`CreateUser`操作します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-247">`MembershipCreateStatus` is an enumeration that indicates the status of the `CreateUser` operation.</span></span> <span data-ttu-id="34b6a-248">たとえば、ユーザー アカウントが正常に作成、表示された`MembershipCreateStatus`インスタンスの値に設定されます`Success`以外の場合は、別のに対して、同じユーザー名を持つユーザーが既に存在するために、操作が失敗した場合の値に設定されます`DuplicateUserName`.</span><span class="sxs-lookup"><span data-stu-id="34b6a-248">For example, if the user account is created successfully, the resulting `MembershipCreateStatus` instance will be set to a value of `Success`; on the other hand, if the operation fails because there already exists a user with the same username, it will be set to a value of `DuplicateUserName`.</span></span> <span data-ttu-id="34b6a-249">`CreateUser`使用のオーバー ロードに渡す必要があります、`MembershipCreateStatus`インスタンスとしてメソッドに、`out`パラメーター。</span><span class="sxs-lookup"><span data-stu-id="34b6a-249">In the `CreateUser` overload we use, we need to pass a `MembershipCreateStatus` instance into the method as an `out` parameter.</span></span> <span data-ttu-id="34b6a-250">このパラメーターは内で適切な値に設定されて、`CreateUser`メソッド、およびおは、ユーザー アカウントが正常に作成されたかどうかを決定するメソッドの呼び出し後の値を調べることができます。</span><span class="sxs-lookup"><span data-stu-id="34b6a-250">This parameter is set to the appropriate value within the `CreateUser` method, and we can examine its value after the method call to determine whether the user account was successfully created.</span></span>

<span data-ttu-id="34b6a-251">呼び出した後`CreateUser`を渡して、 `createStatus`、`switch`に割り当てられている値に応じて、適切なメッセージを出力するステートメントを使用`createStatus`です。</span><span class="sxs-lookup"><span data-stu-id="34b6a-251">After calling `CreateUser`, passing in `createStatus`, a `switch` statement is used to output an appropriate message depending on the value assigned to `createStatus`.</span></span> <span data-ttu-id="34b6a-252">図 7 は、新しいユーザーが正常に作成されたときに出力を示します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-252">Figures 7 shows the output when a new user has successfully been created.</span></span> <span data-ttu-id="34b6a-253">図 8 と 9 は、ユーザー アカウントを作成していない場合、出力を表示します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-253">Figures 8 and 9 show the output when the user account is not created.</span></span> <span data-ttu-id="34b6a-254">図 8 には、訪問者は、メンバーシップ プロバイダーの構成設定に記述されたパスワードの強度の要件を満たしていない、5 文字のパスワードを入力します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-254">In Figure 8, the visitor entered a five-letter password, which does not meet the password strength requirements spelled out in the Membership provider's configuration settings.</span></span> <span data-ttu-id="34b6a-255">図 9 に訪問者は既存のユーザー名 (図 7 に作成されたもの) でユーザー アカウントを作成しようとしています。</span><span class="sxs-lookup"><span data-stu-id="34b6a-255">In Figure 9, the visitor is attempting to create a user account with an existing username (the one created in Figure 7).</span></span>


<span data-ttu-id="34b6a-256">[![新しいユーザー アカウントが正常に作成されました](creating-user-accounts-cs/_static/image20.png)](creating-user-accounts-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="34b6a-256">[![A New User Account is Successfully Created](creating-user-accounts-cs/_static/image20.png)](creating-user-accounts-cs/_static/image19.png)</span></span>

<span data-ttu-id="34b6a-257">**図 7**:、新しいユーザー アカウントが正常に作成されました ([フルサイズのイメージを表示するをクリックして](creating-user-accounts-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="34b6a-257">**Figure 7**: A New User Account is Successfully Created  ([Click to view full-size image](creating-user-accounts-cs/_static/image21.png))</span></span>


<span data-ttu-id="34b6a-258">[![指定のパスワードは脆弱すぎるために、ユーザー アカウントは作成されません。](creating-user-accounts-cs/_static/image23.png)](creating-user-accounts-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="34b6a-258">[![The User Account is Not Created Because the Supplied Password is Too Weak](creating-user-accounts-cs/_static/image23.png)](creating-user-accounts-cs/_static/image22.png)</span></span>

<span data-ttu-id="34b6a-259">**図 8**: 指定されたパスワードが脆弱すぎますため、ユーザー アカウントは作成されません ([フルサイズのイメージを表示するをクリックして](creating-user-accounts-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="34b6a-259">**Figure 8**: The User Account is Not Created Because the Supplied Password is Too Weak  ([Click to view full-size image](creating-user-accounts-cs/_static/image24.png))</span></span>


<span data-ttu-id="34b6a-260">[![ユーザー アカウントが作成されたため、ユーザー名は既に使用中](creating-user-accounts-cs/_static/image26.png)](creating-user-accounts-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="34b6a-260">[![The User Account is Not Created Because the Username is Already in Use](creating-user-accounts-cs/_static/image26.png)](creating-user-accounts-cs/_static/image25.png)</span></span>

<span data-ttu-id="34b6a-261">**図 9**: ユーザー アカウントが作成されたため、ユーザー名は既に使用中 ([フルサイズのイメージを表示するをクリックして](creating-user-accounts-cs/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="34b6a-261">**Figure 9**: The User Account is Not Created Because the Username is Already in Use  ([Click to view full-size image](creating-user-accounts-cs/_static/image27.png))</span></span>


> [!NOTE]
> <span data-ttu-id="34b6a-262">最初の 2 つのいずれかを使用するときに、成功または失敗を判断する方法の思う`CreateUser`もメソッドがオーバー ロードの型のパラメーターを持つ`MembershipCreateStatus`です。</span><span class="sxs-lookup"><span data-stu-id="34b6a-262">You may be wondering how to determine success or failure when using one of the first two `CreateUser` method overloads, neither of which has a parameter of type `MembershipCreateStatus`.</span></span> <span data-ttu-id="34b6a-263">これらの最初の 2 つのオーバー ロードをスロー、 [ `MembershipCreateUserException`例外](https://msdn.microsoft.com/library/system.web.security.membershipcreateuserexception.aspx)を含む、障害発生した場合に、 [ `StatusCode`プロパティ](https://msdn.microsoft.com/library/system.web.security.membershipcreateuserexception.statuscode.aspx)型の`MembershipCreateStatus`します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-263">These first two overloads throw a [`MembershipCreateUserException` exception](https://msdn.microsoft.com/library/system.web.security.membershipcreateuserexception.aspx) in the face of a failure, which includes a [`StatusCode` property](https://msdn.microsoft.com/library/system.web.security.membershipcreateuserexception.statuscode.aspx) of type `MembershipCreateStatus`.</span></span>


<span data-ttu-id="34b6a-264">少数のユーザー アカウントを作成した後の内容を一覧表示して、アカウントが作成されたことを確認してください、`aspnet_Users`と`aspnet_Membership`内のテーブル、`SecurityTutorials.mdf`データベース。</span><span class="sxs-lookup"><span data-stu-id="34b6a-264">After creating a few user accounts, verify that the accounts have been created by listing the contents of the `aspnet_Users` and `aspnet_Membership` tables in the `SecurityTutorials.mdf` database.</span></span> <span data-ttu-id="34b6a-265">図 10 に示す経由で 2 つのユーザーを追加した、`CreatingUserAccounts.aspx`ページ: Tito としました。</span><span class="sxs-lookup"><span data-stu-id="34b6a-265">As Figure 10 shows, I have added two users via the `CreatingUserAccounts.aspx` page: Tito and Bruce.</span></span>


<span data-ttu-id="34b6a-266">[![メンバーシップ ユーザーのストアに 2 人のユーザーがある: Tito とブルース](creating-user-accounts-cs/_static/image29.png)](creating-user-accounts-cs/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="34b6a-266">[![There are Two Users in the Membership User Store: Tito and Bruce](creating-user-accounts-cs/_static/image29.png)](creating-user-accounts-cs/_static/image28.png)</span></span>

<span data-ttu-id="34b6a-267">**図 10**: メンバーシップ ユーザーのストアに 2 人のユーザーがある: Tito とブルース ([フルサイズのイメージを表示するをクリックして](creating-user-accounts-cs/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="34b6a-267">**Figure 10**: There are Two Users in the Membership User Store: Tito and Bruce  ([Click to view full-size image](creating-user-accounts-cs/_static/image30.png))</span></span>


<span data-ttu-id="34b6a-268">メンバーシップ ユーザーのストアは今すぐ、ブルースと Tito のアカウントの情報が含まれていますが、まだを実装しなければならなくブルースまたは Tito サイトにログオンできるようにする機能。</span><span class="sxs-lookup"><span data-stu-id="34b6a-268">While the Membership user store now includes Bruce and Tito's account information, we have yet to implement functionality that allows for Bruce or Tito to log on to the site.</span></span> <span data-ttu-id="34b6a-269">現時点では、`Login.aspx`ユーザーの資格情報を検証はハード コーディングされた一連のユーザー名とパスワードの組み合わせ: に対して*いない*メンバーシップ フレームワークに対して指定された資格情報を検証します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-269">Currently, `Login.aspx` validates the user's credentials against a hard-coded set of username/password pairs – it does *not* validate the supplied credentials against the Membership framework.</span></span> <span data-ttu-id="34b6a-270">今すぐに新しいユーザー アカウントを表示するため、`aspnet_Users`と`aspnet_Membership`で十分にテーブルになります。</span><span class="sxs-lookup"><span data-stu-id="34b6a-270">For now seeing the new user accounts in the `aspnet_Users` and `aspnet_Membership` tables will have to suffice.</span></span> <span data-ttu-id="34b6a-271">チュートリアルでは、[次へ]、  *<a id="_msoanchor_9"> </a>[を検証するユーザー資格情報に対して、メンバーシップ ユーザー ストア](validating-user-credentials-against-the-membership-user-store-cs.md)*、メンバーシップ ストアに対して検証へのログイン ページを更新します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-271">In the next tutorial, *<a id="_msoanchor_9"></a>[Validating User Credentials Against the Membership User Store](validating-user-credentials-against-the-membership-user-store-cs.md)*, we will update the login page to validate against the Membership store.</span></span>

> [!NOTE]
> <span data-ttu-id="34b6a-272">すべてのユーザーが表示されない場合、`SecurityTutorials.mdf`データベースである可能性があります、web アプリケーションが既定のメンバーシップ プロバイダーを使用しているため`AspNetSqlMembershipProvider`が使用される、`ASPNETDB.mdf`ユーザー ストアとしてのデータベースです。</span><span class="sxs-lookup"><span data-stu-id="34b6a-272">If you do not see any users in your `SecurityTutorials.mdf` database, it may be because your web application is using the default Membership provider, `AspNetSqlMembershipProvider`, which uses the `ASPNETDB.mdf` database as its user store.</span></span> <span data-ttu-id="34b6a-273">この問題を特定するのには、ソリューション エクスプ ローラーで [更新] ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="34b6a-273">To determine if this is the problem, click the Refresh button in the Solution Explorer.</span></span> <span data-ttu-id="34b6a-274">という名前のデータベース`ASPNETDB.mdf`に追加された、`App_Data`フォルダーで、これが問題です。</span><span class="sxs-lookup"><span data-stu-id="34b6a-274">If a database named `ASPNETDB.mdf` has been added to the `App_Data` folder, this is the problem.</span></span> <span data-ttu-id="34b6a-275">手順 4 に戻り、  *<a id="_msoanchor_10"> </a>[メンバーシップ スキーマを作成する SQL Server で](creating-the-membership-schema-in-sql-server-cs.md)*手順については、メンバーシップ プロバイダーを正しく構成する方法のチュートリアルです。</span><span class="sxs-lookup"><span data-stu-id="34b6a-275">Return to Step 4 of the *<a id="_msoanchor_10"></a>[Creating the Membership Schema in SQL Server](creating-the-membership-schema-in-sql-server-cs.md)* tutorial for instructions on how to properly configure the Membership provider.</span></span>


<span data-ttu-id="34b6a-276">ほとんどのユーザー アカウントのシナリオを作成、ユーザー名、パスワード、電子メール、および新しいアカウントを作成する時点で、必要なその他の情報を入力するいくつかのインターフェイスの訪問者が表示されます。</span><span class="sxs-lookup"><span data-stu-id="34b6a-276">In most create user account scenarios, the visitor is presented with some interface to enter their username, password, email, and other essential information, at which point a new account is created.</span></span> <span data-ttu-id="34b6a-277">このステップでおを手動でこのようなインターフェイスの構築に検査しを使用する方法を説明し、`Membership.CreateUser`をプログラムで新しいユーザー アカウントを追加する方法、ユーザーの入力を基にします。</span><span class="sxs-lookup"><span data-stu-id="34b6a-277">In this step we looked at building such an interface by hand and then saw how to use the `Membership.CreateUser` method to programmatically add the new user account based on the user's inputs.</span></span> <span data-ttu-id="34b6a-278">このコードは、新しいユーザー アカウントを作成しました。</span><span class="sxs-lookup"><span data-stu-id="34b6a-278">Our code, however, just created the new user account.</span></span> <span data-ttu-id="34b6a-279">補足情報だけが作成したユーザー アカウントでは、サイトにユーザーのログインまたはユーザーに確認の電子メールを送信するなどの操作は実行しませんでした。</span><span class="sxs-lookup"><span data-stu-id="34b6a-279">It did not perform any follow up actions, like logging in the user to the site under the just-created user account, or sending a confirmation email to the user.</span></span> <span data-ttu-id="34b6a-280">追加の手順で、ボタンのコードを追加が必要になります`Click`イベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="34b6a-280">These additional steps would require additional code in the Button's `Click` event handler.</span></span>

<span data-ttu-id="34b6a-281">ASP.NET は CreateUserWizard コントロールでは、メンバーシップ フレームワークで、アカウントを作成し、後のアカウントを実行すること、新しいユーザー アカウントを作成するためのユーザー インターフェイスの表示から、ユーザーのアカウントの作成プロセスを処理するものでは付属しています作成などのタスク、確認の電子メールを送信するだけで作成されたユーザーをサイトにログインします。</span><span class="sxs-lookup"><span data-stu-id="34b6a-281">ASP.NET ships with the CreateUserWizard control, which is designed to handle the user account creation process, from rendering a user interface for creating new user accounts, to creating the account in the Membership framework and performing post-account creation tasks, such as sending a confirmation email and logging the just-created user into the site.</span></span> <span data-ttu-id="34b6a-282">CreateUserWizard コントロールを使用するは、ページには、ツールボックスから CreateUserWizard コントロールをドラッグして、いくつかのプロパティを設定と同じくらい簡単です。</span><span class="sxs-lookup"><span data-stu-id="34b6a-282">Using the CreateUserWizard control is as simple as dragging the CreateUserWizard control from the Toolbox onto a page, and then setting a few properties.</span></span> <span data-ttu-id="34b6a-283">ほとんどの場合、1 行のコードを記述する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="34b6a-283">In most cases, you won't need to write a single line of code.</span></span> <span data-ttu-id="34b6a-284">手順 6 で詳細に高度なこのコントロールについて学びます。</span><span class="sxs-lookup"><span data-stu-id="34b6a-284">We will explore this nifty control in detail in Step 6.</span></span>

<span data-ttu-id="34b6a-285">新しいユーザー アカウントは、一般的なアカウントを作成する web ページを介してのみ作成される場合、可能性は高くありませんを使用するコードを記述する必要がこれまで、`CreateUser`メソッド、CreateUserWizard コントロールとして可能性がありますニーズを満たします。</span><span class="sxs-lookup"><span data-stu-id="34b6a-285">If new user accounts are only created through a typical Create Account web page, it is unlikely that you will ever need to write code that uses the `CreateUser` method, as the CreateUserWizard control will likely meet your needs.</span></span> <span data-ttu-id="34b6a-286">ただし、`CreateUser`詳細にカスタマイズされたアカウントを作成するユーザー エクスペリエンスをする必要があるか、別のインターフェイスから新しいユーザー アカウントをプログラムで作成する必要がある場合は、メソッドはシナリオに便利です。</span><span class="sxs-lookup"><span data-stu-id="34b6a-286">However, the `CreateUser` method is handy in scenarios where you need a highly customized Create Account user experience or when you need to programmatically create new user accounts through an alternative interface.</span></span> <span data-ttu-id="34b6a-287">たとえば、ユーザーが他のアプリケーションからユーザー情報を含む XML ファイルをアップロードできるページがあるとします。</span><span class="sxs-lookup"><span data-stu-id="34b6a-287">For example, you might have a page that allows a user to upload an XML file that contains user information from some other application.</span></span> <span data-ttu-id="34b6a-288">ページが解析してアップロードされた XML の内容をファイルして呼び出すことによって、XML で表されるユーザーごとに新しいアカウントを作成、`CreateUser`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="34b6a-288">The page might parses the contents of the uploaded XML file and create a new account for each user represented in the XML by calling the `CreateUser` method.</span></span>

## <a name="step-6-creating-a-new-user-with-the-createuserwizard-control"></a><span data-ttu-id="34b6a-289">手順 6: CreateUserWizard コントロールで、新しいユーザーを作成します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-289">Step 6: Creating a New User with the CreateUserWizard Control</span></span>

<span data-ttu-id="34b6a-290">ASP.NET は、ログイン Web コントロールの数が付属しています。</span><span class="sxs-lookup"><span data-stu-id="34b6a-290">ASP.NET ships with a number of Login Web controls.</span></span> <span data-ttu-id="34b6a-291">これらのコントロールは、一般的なユーザー アカウントおよびログインに関連する様々 な構成を支援します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-291">These controls aid in many common user account- and login-related scenarios.</span></span> <span data-ttu-id="34b6a-292">[CreateUserWizard コントロール](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/login/createuserwizard.aspx)メンバーシップ フレームワークに新しいユーザー アカウントを追加するためのユーザー インターフェイスを提供するものでは、このような 1 つのコントロールがします。</span><span class="sxs-lookup"><span data-stu-id="34b6a-292">The [CreateUserWizard control](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/login/createuserwizard.aspx) is one such control that is designed to present a user interface for adding a new user account to the Membership framework.</span></span>

<span data-ttu-id="34b6a-293">その他のログインに関連する Web コントロールの多くのように 1 行のコードを記述することがなく、CreateUserWizard を使用できます。</span><span class="sxs-lookup"><span data-stu-id="34b6a-293">Like many of the other Login-related Web controls, the CreateUserWizard can be used without writing a single line of code.</span></span> <span data-ttu-id="34b6a-294">メンバーシップ プロバイダーの構成設定と、内部での呼び出しに基づくユーザー インターフェイスを直感的に提供、`Membership`クラスの`CreateUser`ユーザーが必要な情報を入力し、「ユーザーの作成」ボタンをクリックした後にします。</span><span class="sxs-lookup"><span data-stu-id="34b6a-294">It intuitively provides a user interface based on the Membership provider's configuration settings and internally calls the `Membership` class's `CreateUser` method after the user enters the necessary information and clicks the "Create User" button.</span></span> <span data-ttu-id="34b6a-295">CreateUserWizard コントロールでは、非常にカスタマイズできます。</span><span class="sxs-lookup"><span data-stu-id="34b6a-295">The CreateUserWizard control is extremely customizable.</span></span> <span data-ttu-id="34b6a-296">アカウントの作成プロセスのさまざまなステージ中に発生するイベントのホストがあります。</span><span class="sxs-lookup"><span data-stu-id="34b6a-296">There are a host of events that fire during various stages of the account creation process.</span></span> <span data-ttu-id="34b6a-297">アカウントの作成ワークフローにカスタム ロジックを挿入する、必要に応じて、イベント ハンドラーを作成できます。</span><span class="sxs-lookup"><span data-stu-id="34b6a-297">We can create event handlers, as needed, to inject custom logic into the account creation workflow.</span></span> <span data-ttu-id="34b6a-298">さらに、CreateUserWizard の外観は、非常に柔軟性があります。</span><span class="sxs-lookup"><span data-stu-id="34b6a-298">Furthermore, the CreateUserWizard's appearance is very flexible.</span></span> <span data-ttu-id="34b6a-299">既定のインターフェイスの外観を定義するプロパティの数があります。必要に応じて、コントロールをテンプレートに変換できるまたは追加のユーザーの登録手順」を追加することがあります。</span><span class="sxs-lookup"><span data-stu-id="34b6a-299">There are a number of properties that define the appearance of the default interface; if necessary, the control can be converted into a template or additional user registration "steps" may be added.</span></span>

<span data-ttu-id="34b6a-300">CreateUserWizard コントロールの既定のインターフェイスと動作を使用して見てから始めましょう。</span><span class="sxs-lookup"><span data-stu-id="34b6a-300">Let's start with a look at using the CreateUserWizard control's default interface and behavior.</span></span> <span data-ttu-id="34b6a-301">コントロールのプロパティおよびイベントを使用して外観をカスタマイズする方法から見ていきましょう。</span><span class="sxs-lookup"><span data-stu-id="34b6a-301">We'll then explore how to customize the appearance via the control's properties and events.</span></span>

### <a name="examining-the-createuserwizards-default-interface-and-behavior"></a><span data-ttu-id="34b6a-302">CreateUserWizard の既定のインターフェイスと動作の確認</span><span class="sxs-lookup"><span data-stu-id="34b6a-302">Examining the CreateUserWizard's Default Interface and Behavior</span></span>

<span data-ttu-id="34b6a-303">戻り、 `CreatingUserAccounts.aspx`  ページで、`Membership`フォルダーで、デザインまたは分割モードに切り替えるし、ページの上部に CreateUserWizard コントロールを追加します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-303">Return to the `CreatingUserAccounts.aspx` page in the `Membership` folder, switch to the Design or Split mode, and then add a CreateUserWizard control to the top of the page.</span></span> <span data-ttu-id="34b6a-304">ツールボックスのログイン コントロール セクションをファイリング CreateUserWizard コントロール。</span><span class="sxs-lookup"><span data-stu-id="34b6a-304">The CreateUserWizard control is filed under the Toolbox's Login controls section.</span></span> <span data-ttu-id="34b6a-305">コントロールを追加すると、次のように設定します。 その`ID`プロパティを`RegisterUser`です。</span><span class="sxs-lookup"><span data-stu-id="34b6a-305">After adding the control, set its `ID` property to `RegisterUser`.</span></span> <span data-ttu-id="34b6a-306">画面は、図 11 と、CreateUserWizard は、新しいユーザーのユーザー名、パスワード、電子メール アドレス、およびセキュリティの質問および回答のテキスト ボックスを持つインターフェイスをレンダリングします。</span><span class="sxs-lookup"><span data-stu-id="34b6a-306">As the screen shot in Figure 11 shows, the CreateUserWizard renders an interface with textboxes for the new user's username, password, email address, and security question and answer.</span></span>


<span data-ttu-id="34b6a-307">[![CreateUserWizard コントロール レンダリング汎用的なユーザー インターフェイスを作成します。](creating-user-accounts-cs/_static/image32.png)](creating-user-accounts-cs/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="34b6a-307">[![The CreateUserWizard Control Renders a Generic Create User Interface](creating-user-accounts-cs/_static/image32.png)](creating-user-accounts-cs/_static/image31.png)</span></span>

<span data-ttu-id="34b6a-308">**図 11**: CreateUserWizard コントロールは、汎用的な作成ユーザー インターフェイスをレンダリング ([フルサイズのイメージを表示するをクリックして](creating-user-accounts-cs/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="34b6a-308">**Figure 11**: The CreateUserWizard Control Renders a Generic Create User Interface  ([Click to view full-size image](creating-user-accounts-cs/_static/image33.png))</span></span>


<span data-ttu-id="34b6a-309">手順 5 で作成したインターフェイスを持つ CreateUserWizard コントロールによって生成される既定のユーザー インターフェイスを比較する時点を見てみましょう。</span><span class="sxs-lookup"><span data-stu-id="34b6a-309">Let's take a moment to compare the default user interface generated by the CreateUserWizard control with the interface we created in Step 5.</span></span> <span data-ttu-id="34b6a-310">まず、CreateUserWizard コントロールによりセキュリティの質問と回答の両方を指定するビジター、一方、手動で作成されたインターフェイスは、定義済みのセキュリティの質問を使用します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-310">For starters, the CreateUserWizard control allows the visitor to specify both the security question and answer, whereas our manually-created interface used a pre-defined security question.</span></span> <span data-ttu-id="34b6a-311">インターフェイスのフォームのフィールドに検証を実装するまだがありましたが、CreateUserWizard コントロールのインターフェイスにはからも検証コントロールが含まれます。</span><span class="sxs-lookup"><span data-stu-id="34b6a-311">The CreateUserWizard control's interface also includes validation controls, whereas we had yet to implement validation on our interface's form fields.</span></span> <span data-ttu-id="34b6a-312">および CreateUserWizard コントロール インターフェイスには (テキストを入力"Password"と「パスワードの比較」のテキスト ボックスが等しいことを確認 CompareValidator) と共に「パスワードの確認」textbox が含まれています。</span><span class="sxs-lookup"><span data-stu-id="34b6a-312">And the CreateUserWizard control interface includes a "Confirm Password" textbox (along with a CompareValidator to ensure that the text entered the "Password" and "Compare Password" textboxes are equal).</span></span>

<span data-ttu-id="34b6a-313">興味深いは、ユーザー インターフェイスを表示するときは CreateUserWizard コントロールがメンバーシップ プロバイダーの構成設定を参照しているです。</span><span class="sxs-lookup"><span data-stu-id="34b6a-313">What's interesting is that the CreateUserWizard control consults the Membership provider's configuration settings when rendering its user interface.</span></span> <span data-ttu-id="34b6a-314">たとえば、セキュリティの質問と回答のテキスト ボックスが表示される場合のみ`requiresQuestionAndAnswer`が True に設定します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-314">For example, the security question and answer textboxes are only displayed if `requiresQuestionAndAnswer` is set to True.</span></span> <span data-ttu-id="34b6a-315">CreateUserWizard が自動的に設定パスワードの強度の要件が満たされていることを確認する RegularExpressionValidator コントロールを追加同様に、その`ErrorMessage`と`ValidationExpression`プロパティに基づいて、 `minRequiredPasswordLength`、 `minRequiredNonalphanumericCharacters`、および`passwordStrengthRegularExpression`構成設定。</span><span class="sxs-lookup"><span data-stu-id="34b6a-315">Likewise, CreateUserWizard automatically adds a RegularExpressionValidator control to ensure that the password strength requirements are met, and sets its `ErrorMessage` and `ValidationExpression` properties based on the `minRequiredPasswordLength`, `minRequiredNonalphanumericCharacters`, and `passwordStrengthRegularExpression` configuration settings.</span></span>

<span data-ttu-id="34b6a-316">CreateUserWizard コントロールでは、その名前からわかるようにはから派生した、[ウィザード コントロール](https://msdn.microsoft.com/library/s2etd1ek.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="34b6a-316">The CreateUserWizard control, as its name implies, is derived from the [Wizard control](https://msdn.microsoft.com/library/s2etd1ek.aspx).</span></span> <span data-ttu-id="34b6a-317">ウィザードのコントロールは、インターフェイスを提供する、マルチ ステップ タスクを完了するために設計されています。</span><span class="sxs-lookup"><span data-stu-id="34b6a-317">Wizard controls are designed to provide an interface for completing multi-step tasks.</span></span> <span data-ttu-id="34b6a-318">ウィザード コントロールでの任意の数を含めることがあります`WizardSteps`それぞれが、HTML を定義するテンプレート、および Web を制御する手順。</span><span class="sxs-lookup"><span data-stu-id="34b6a-318">A Wizard control may have an arbitrary number of `WizardSteps`, each of which is a template that defines the HTML and Web controls for that step.</span></span> <span data-ttu-id="34b6a-319">ウィザード コントロールは、最初の初期状態が表示されます。 `WizardStep`、ナビゲーション コントロールを次に、1 つのステップから続行するか、前の手順に戻るには、ユーザーを許可するとします。</span><span class="sxs-lookup"><span data-stu-id="34b6a-319">The Wizard control initially displays the first `WizardStep`, along with navigation controls that permit the user to proceed from one step to the next, or to return to previous steps.</span></span>

<span data-ttu-id="34b6a-320">図 11 では宣言型マークアップは 2 つの CreateUserWizard コントロールの既定のインターフェイスが含まれます `WizardSteps:`</span><span class="sxs-lookup"><span data-stu-id="34b6a-320">As the declarative markup in Figure 11 shows, the CreateUserWizard control's default interface includes two `WizardSteps:`</span></span>

- <span data-ttu-id="34b6a-321">[`CreateUserWizardStep`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizardstep.aspx) – 新しいユーザー アカウントを作成するための情報を収集するインターフェイスをレンダリングします。</span><span class="sxs-lookup"><span data-stu-id="34b6a-321">[`CreateUserWizardStep`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizardstep.aspx) – renders the interface to collect information for creating the new user account.</span></span> <span data-ttu-id="34b6a-322">これは、図 11 に示されたステップです。</span><span class="sxs-lookup"><span data-stu-id="34b6a-322">This is the step shown in Figure 11.</span></span>
- <span data-ttu-id="34b6a-323">[`CompleteWizardStep`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.completewizardstep.aspx) – アカウントが正常に作成されたことを示すメッセージを表示します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-323">[`CompleteWizardStep`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.completewizardstep.aspx) – renders a message indicating that the account has successfully been created.</span></span>

<span data-ttu-id="34b6a-324">これらの手順のいずれかのテンプレートを変換することで、または独自の追加によって、CreateUserWizard の外観と動作を変更できます`WizardSteps`です。</span><span class="sxs-lookup"><span data-stu-id="34b6a-324">The CreateUserWizard's appearance and behavior can be modified by converting either of these steps to templates, or by adding your own `WizardSteps`.</span></span> <span data-ttu-id="34b6a-325">追加することを見ていきましょう、`WizardStep`で登録インターフェイスを*追加のユーザー情報を格納する*チュートリアルです。</span><span class="sxs-lookup"><span data-stu-id="34b6a-325">We will look at adding a `WizardStep` to the registration interface in the *Storing Additional User Information* tutorial.</span></span>

<span data-ttu-id="34b6a-326">CreateUserWizard コントロールが動作を確認してみましょう。</span><span class="sxs-lookup"><span data-stu-id="34b6a-326">Let's see the CreateUserWizard control in action.</span></span> <span data-ttu-id="34b6a-327">参照してください、`CreatingUserAccounts.aspx`ページがブラウザーを使用します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-327">Visit the `CreatingUserAccounts.aspx` page through a browser.</span></span> <span data-ttu-id="34b6a-328">CreateUserWizard のインターフェイスにいくつかの無効な値を入力して起動します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-328">Start by entering some invalid values into the CreateUserWizard's interface.</span></span> <span data-ttu-id="34b6a-329">パスワードの強度の要件、または空したまま、「ユーザー名」の textbox に準拠していないパスワードを入力してください。</span><span class="sxs-lookup"><span data-stu-id="34b6a-329">Try entering a password that doesn't conform to the password strength requirements, or leaving the "User Name" textbox empty.</span></span> <span data-ttu-id="34b6a-330">CreateUserWizard 適切なエラー メッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="34b6a-330">The CreateUserWizard will display an appropriate error message.</span></span> <span data-ttu-id="34b6a-331">図 12 は、条件が不十分な強力なパスワードを使用してユーザーを作成しようとするときに出力を示します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-331">Figure 12 shows the output when attempting to create a user with an insufficiently strong password.</span></span>


<span data-ttu-id="34b6a-332">[![CreateUserWizard 検証コントロールを自動的に挿入します。](creating-user-accounts-cs/_static/image35.png)](creating-user-accounts-cs/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="34b6a-332">[![The CreateUserWizard Automatically Injects Validation Controls](creating-user-accounts-cs/_static/image35.png)](creating-user-accounts-cs/_static/image34.png)</span></span>

<span data-ttu-id="34b6a-333">**図 12**:「CreateUserWizard 自動的挿入の検証コントロール ([フルサイズ イメージを表示するに、をクリックして](creating-user-accounts-cs/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="34b6a-333">**Figure 12**: The CreateUserWizard Automatically Injects Validation Controls  ([Click to view full-size image](creating-user-accounts-cs/_static/image36.png))</span></span>


<span data-ttu-id="34b6a-334">次は CreateUserWizard に適切な値を入力し、「ユーザーの作成」ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="34b6a-334">Next, enter appropriate values into the CreateUserWizard and click the "Create User" button.</span></span> <span data-ttu-id="34b6a-335">必要なフィールドが入力されているし、パスワードの強度が十分でと仮定した場合は CreateUserWizard されメンバーシップ フレームワークを通じて、新しいユーザー アカウントを作成、表示されます、`CompleteWizardStep`のインターフェイスを (図 13 を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="34b6a-335">Assuming the required fields have been entered and the password's strength is sufficient, the CreateUserWizard will create a new user account through the Membership framework and then display the `CompleteWizardStep`'s interface (see Figure 13).</span></span> <span data-ttu-id="34b6a-336">バック グラウンドで、CreateUserWizard を呼び出す、`Membership.CreateUser`メソッド、手順 5. で行ったのと同じようにします。</span><span class="sxs-lookup"><span data-stu-id="34b6a-336">Behind the scenes, the CreateUserWizard calls the `Membership.CreateUser` method, just like we did in Step 5.</span></span>


<span data-ttu-id="34b6a-337">[![新しいユーザー アカウントが正常に作成されました](creating-user-accounts-cs/_static/image38.png)](creating-user-accounts-cs/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="34b6a-337">[![A New User Account has Successfully Been Created](creating-user-accounts-cs/_static/image38.png)](creating-user-accounts-cs/_static/image37.png)</span></span>

<span data-ttu-id="34b6a-338">**図 13**:、新しいユーザー アカウントが正常に作成された ([フルサイズのイメージを表示するをクリックして](creating-user-accounts-cs/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="34b6a-338">**Figure 13**: A New User Account has Successfully Been Created  ([Click to view full-size image](creating-user-accounts-cs/_static/image39.png))</span></span>


> [!NOTE]
> <span data-ttu-id="34b6a-339">図 13 に示す、`CompleteWizardStep`のインターフェイスには、[続行] ボタンが含まれています。</span><span class="sxs-lookup"><span data-stu-id="34b6a-339">As Figure 13 shows, the `CompleteWizardStep`'s interface includes a Continue button.</span></span> <span data-ttu-id="34b6a-340">ただし、この時点でクリックすると、単にすると、同じページに訪問者を残したまま、ポストバックを実行します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-340">However, at this point clicking it just performs a postback, leaving the visitor on the same page.</span></span> <span data-ttu-id="34b6a-341">「CreateUserWizard の外観とそのプロパティを使用して動作をカスタマイズする」セクションを見てみましょうに訪問者の送信は、このボタンがどのように`Default.aspx`(またはその他のいくつかのページ)。</span><span class="sxs-lookup"><span data-stu-id="34b6a-341">In the "Customizing the CreateUserWizard's Appearance and Behavior Through Its Properties" section we will look at how you can have this button send the visitor to `Default.aspx` (or some other page).</span></span>


<span data-ttu-id="34b6a-342">新しいユーザー アカウントを作成すると、Visual Studio に戻り、確認、`aspnet_Users`と`aspnet_Membership`テーブルをアカウントが正常に作成されたことを確認する図 10 で行ったようにします。</span><span class="sxs-lookup"><span data-stu-id="34b6a-342">After creating a new user account, return to Visual Studio and examine the `aspnet_Users` and `aspnet_Membership` tables like we did in Figure 10 to verify that the account was successfully created.</span></span>

### <a name="customizing-the-createuserwizards-behavior-and-appearance-through-its-properties"></a><span data-ttu-id="34b6a-343">CreateUserWizard の動作とそのプロパティを使用した外観をカスタマイズします。</span><span class="sxs-lookup"><span data-stu-id="34b6a-343">Customizing the CreateUserWizard's Behavior and Appearance Through Its Properties</span></span>

<span data-ttu-id="34b6a-344">さまざまなプロパティを使用の方法でカスタマイズする、CreateUserWizard `WizardSteps`、およびイベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="34b6a-344">The CreateUserWizard can be customized in a variety of ways, through properties, `WizardSteps`, and event handlers.</span></span> <span data-ttu-id="34b6a-345">このセクションの内容を見てみましょうのプロパティを使用したコントロールの外観をカスタマイズする方法次のセクションでは、イベント ハンドラーからコントロールの動作を拡張する、します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-345">In this section we will look at how to customize the control's appearance through its properties; the next section looks at extending the control's behavior through event handlers.</span></span>

<span data-ttu-id="34b6a-346">CreateUserWizard コントロールの既定のユーザー インターフェイスに表示されるテキストのほぼすべて、多種多様なプロパティをカスタマイズできます。</span><span class="sxs-lookup"><span data-stu-id="34b6a-346">Virtually all of the text displayed in the CreateUserWizard control's default user interface can be customized through its plethora of properties.</span></span> <span data-ttu-id="34b6a-347">テキスト ボックスの左側に表示される「ユーザー名」、"Password"、「パスワードの確認」、「電子メール」、「セキュリティの質問」および「セキュリティ返答」のラベルをカスタマイズするなど、 [ `UserNameLabelText` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.usernamelabeltext.aspx)、 [ `PasswordLabelText` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.passwordlabeltext.aspx)、 [ `ConfirmPasswordLabelText` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.confirmpasswordlabeltext.aspx)、 [ `EmailLabelText` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.emaillabeltext.aspx)、 [ `QuestionLabelText` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.questionlabeltext.aspx)、および[ `AnswerLabelText` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.answerlabeltext.aspx)プロパティ、それぞれします。</span><span class="sxs-lookup"><span data-stu-id="34b6a-347">For example, the "User Name", "Password", "Confirm Password", "E-mail", "Security Question", and "Security Answer" labels displayed to the left of the textboxes can be customized by the [`UserNameLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.usernamelabeltext.aspx), [`PasswordLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.passwordlabeltext.aspx), [`ConfirmPasswordLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.confirmpasswordlabeltext.aspx), [`EmailLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.emaillabeltext.aspx), [`QuestionLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.questionlabeltext.aspx), and [`AnswerLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.answerlabeltext.aspx) properties, respectively.</span></span> <span data-ttu-id="34b6a-348">同様に、「ユーザーの作成」と"Continue"のボタンのテキストを指定するためのプロパティがある、`CreateUserWizardStep`と`CompleteWizardStep`にもこれらのボタンは、ボタン、ある、または ImageButtons としてレンダリングされます。</span><span class="sxs-lookup"><span data-stu-id="34b6a-348">Likewise, there are properties for specifying the text for the "Create User" and "Continue" buttons in the `CreateUserWizardStep` and `CompleteWizardStep`, as well as if these buttons are rendered as Buttons, LinkButtons, or ImageButtons.</span></span>

<span data-ttu-id="34b6a-349">色、罫線、フォント、および他のビジュアル要素は、スタイル プロパティのホストを構成できます。</span><span class="sxs-lookup"><span data-stu-id="34b6a-349">The colors, borders, fonts, and other visual elements are configurable through a host of style properties.</span></span> <span data-ttu-id="34b6a-350">CreateUserWizard コントロール自体が、一般的な Web コントロール スタイルのプロパティ – `BackColor`、 `BorderStyle`、 `CssClass`、`Font`などのの特定のセクションの表示方法を定義するためのスタイル プロパティの数があると、CreateUserWizard のインターフェイスです。</span><span class="sxs-lookup"><span data-stu-id="34b6a-350">The CreateUserWizard control itself has the common Web control style properties – `BackColor`, `BorderStyle`, `CssClass`, `Font`, and so on – and there are a number of style properties for defining the appearance for particular sections of the CreateUserWizard's interface.</span></span> <span data-ttu-id="34b6a-351">[ `TextBoxStyle`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.textboxstyle.aspx)のインスタンスのテキスト ボックスのスタイルを定義、`CreateUserWizardStep`中、 [ `TitleTextStyle`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.titletextstyle.aspx)("へのサインアップ、新しいタイトルのスタイルを定義しますアカウント")。</span><span class="sxs-lookup"><span data-stu-id="34b6a-351">The [`TextBoxStyle` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.textboxstyle.aspx), for instance, defines the styles for the textboxes in the `CreateUserWizardStep`, while the [`TitleTextStyle` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.titletextstyle.aspx) defines the style for the title ("Sign Up for Your New Account").</span></span>

<span data-ttu-id="34b6a-352">外観に関連するプロパティに加えてには、さまざまな CreateUserWizard コントロールの動作に影響するプロパティがあります。</span><span class="sxs-lookup"><span data-stu-id="34b6a-352">In addition to the appearance-related properties, there are a number of properties that affect the CreateUserWizard control's behavior.</span></span> <span data-ttu-id="34b6a-353">[ `DisplayCancelButton`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.wizard.displaycancelbutton.aspx)場合、true の場合、表示する (既定値は False)、「ユーザーの作成」ボタンの横の [キャンセル] ボタンを設定します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-353">The [`DisplayCancelButton` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.wizard.displaycancelbutton.aspx), if set to True, displays a Cancel button next to the "Create User" button (the default value is False).</span></span> <span data-ttu-id="34b6a-354">[キャンセル] ボタンを表示する場合にも設定して、 [ `CancelDestinationPageUrl`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.continuedestinationpageurl.aspx)ユーザーは [キャンセル] をクリックした後に送信されるページを指定します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-354">If you display the Cancel button, be sure to also set the [`CancelDestinationPageUrl` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.continuedestinationpageurl.aspx), which specifies the page the user is sent to after clicking Cancel.</span></span> <span data-ttu-id="34b6a-355">[続行] ボタン、前のセクションで説明したとおり、`CompleteWizardStep`のインターフェイスは、ポストバックを発生させるが、同じページに訪問者のままにします。</span><span class="sxs-lookup"><span data-stu-id="34b6a-355">As noted in the previous section, the Continue button in the `CompleteWizardStep`'s interface causes a postback, but leaves the visitor on the same page.</span></span> <span data-ttu-id="34b6a-356">[続行] ボタンをクリックした後、その他のいくつかのページに訪問者を送信するで URL を指定するだけ、 [ `ContinueDestinationPageUrl`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.continuedestinationpageurl.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="34b6a-356">To send the visitor to some other page after clicking the Continue button, simply specify the URL in the [`ContinueDestinationPageUrl` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.continuedestinationpageurl.aspx).</span></span>

<span data-ttu-id="34b6a-357">説明を更新、 `RegisterUser` CreateUserWizard コントロールを [キャンセル] ボタンを表示して、訪問者を送信する`Default.aspx`[キャンセル] または [続行] ボタンがクリックされたとき。</span><span class="sxs-lookup"><span data-stu-id="34b6a-357">Let's update the `RegisterUser` CreateUserWizard control to show a Cancel button and to send the visitor to `Default.aspx` when the Cancel or Continue buttons are clicked.</span></span> <span data-ttu-id="34b6a-358">これを実現するには設定、`DisplayCancelButton`プロパティを True にあり、両方は、`CancelDestinationPageUrl`と`ContinueDestinationPageUrl`プロパティを"~/Default.aspx"です。</span><span class="sxs-lookup"><span data-stu-id="34b6a-358">To accomplish this, set the `DisplayCancelButton` property to True and both the `CancelDestinationPageUrl` and `ContinueDestinationPageUrl` properties to "~/Default.aspx".</span></span> <span data-ttu-id="34b6a-359">図 14 では、ブラウザーで表示したときに、更新された CreateUserWizard を示します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-359">Figure 14 shows the updated CreateUserWizard when viewed through a browser.</span></span>


<span data-ttu-id="34b6a-360">[![CreateUserWizardStep には、[キャンセル] ボタンが含まれています。](creating-user-accounts-cs/_static/image41.png)](creating-user-accounts-cs/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="34b6a-360">[![The CreateUserWizardStep Includes a Cancel Button](creating-user-accounts-cs/_static/image41.png)](creating-user-accounts-cs/_static/image40.png)</span></span>

<span data-ttu-id="34b6a-361">**図 14**: `CreateUserWizardStep` [キャンセル] ボタンが含まれています ([フルサイズのイメージを表示するをクリックして](creating-user-accounts-cs/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="34b6a-361">**Figure 14**: The `CreateUserWizardStep` Includes a Cancel Button  ([Click to view full-size image](creating-user-accounts-cs/_static/image42.png))</span></span>


<span data-ttu-id="34b6a-362">訪問者は、ユーザー名、パスワード、電子メール アドレス、およびセキュリティの質問と解答を入力し、「ユーザーの作成」をクリックすると、新しいユーザー アカウントが作成され、訪問者が新しく作成されたユーザーとしてログインしています。</span><span class="sxs-lookup"><span data-stu-id="34b6a-362">When a visitor enters a username, password, email address, and security question and answer and clicks "Create User," a new user account is created and the visitor is logged in as that newly created user.</span></span> <span data-ttu-id="34b6a-363">ページにアクセスするユーザーが自分の新しいアカウントを作成すると仮定すると、これが目的の動作である可能性がありますです。</span><span class="sxs-lookup"><span data-stu-id="34b6a-363">Assuming that the person visiting the page is creating a new account for themselves, this is likely the desired behavior.</span></span> <span data-ttu-id="34b6a-364">ただし、新しいユーザー アカウントを追加する管理者を許可することがあります。</span><span class="sxs-lookup"><span data-stu-id="34b6a-364">However, you may want to allow Administrators to add new user accounts.</span></span> <span data-ttu-id="34b6a-365">これにより、ユーザー アカウントが作成されますが、管理者はまま残り、ログインしている、管理者として (新しく作成したアカウントではなく)。</span><span class="sxs-lookup"><span data-stu-id="34b6a-365">In doing so, the user account would be created, but the Administrator would remain logged in as an Administrator (and not as the newly created account).</span></span> <span data-ttu-id="34b6a-366">この動作は、ブール値を変更できます[`LoginCreatedUser`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.logincreateduser.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="34b6a-366">This behavior can be modified through the Boolean [`LoginCreatedUser` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.logincreateduser.aspx).</span></span>

<span data-ttu-id="34b6a-367">メンバーシップ フレームワーク内のユーザー アカウントを含む承認済みのフラグです。承認されていないユーザーが、サイトにログインできません。</span><span class="sxs-lookup"><span data-stu-id="34b6a-367">User accounts in the Membership framework contain an approved flag; users who are not approved are unable to log into the site.</span></span> <span data-ttu-id="34b6a-368">既定では、新しく作成したアカウントは承認されると、ユーザーがすぐに、サイトにログインできるようにマークされます。</span><span class="sxs-lookup"><span data-stu-id="34b6a-368">By default, a newly created account is marked as approved, allowing the user to log into the site immediately.</span></span> <span data-ttu-id="34b6a-369">ただし、承認されていないとしてマークされている新しいユーザー アカウントを持っていることです。</span><span class="sxs-lookup"><span data-stu-id="34b6a-369">It is possible, however, to have new user accounts marked as unapproved.</span></span> <span data-ttu-id="34b6a-370">管理者は; でログインすることが、新しいユーザーを手動で承認する必要があります。または、ユーザーがログオンを許可する前に、サインアップ時に入力した電子メール アドレスが有効であることを確認する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="34b6a-370">Perhaps you want an Administrator to manually approve new users before they can log in; or maybe you want to verify that the email address entered at signup is valid before permitting a user to log on.</span></span> <span data-ttu-id="34b6a-371">これは、場合でも、作成できる、新しく作成したユーザー アカウントは CreateUserWizard コントロールの設定によって、承認されていないとマーク[`DisableCreatedUser`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.disablecreateduser.aspx)True (既定値は False) にします。</span><span class="sxs-lookup"><span data-stu-id="34b6a-371">Whatever the case may be, you can have the newly created user account marked as unapproved by setting the CreateUserWizard control's [`DisableCreatedUser` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.disablecreateduser.aspx) to True (the default is False).</span></span>

<span data-ttu-id="34b6a-372">ノートの他の動作に関連するプロパティには、`AutoGeneratePassword`と`MailDefinition`です。</span><span class="sxs-lookup"><span data-stu-id="34b6a-372">Other behavior-related properties of note include `AutoGeneratePassword` and `MailDefinition`.</span></span> <span data-ttu-id="34b6a-373">場合、 [ `AutoGeneratePassword`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.autogeneratepassword.aspx)を True に設定されている、 `CreateUserWizardStep` "Password"と「パスワードの確認」textboxes; には表示されません代わりに、新しく作成したユーザーのパスワードが自動的に生成を使用して、 `Membership`クラスの[`GeneratePassword`メソッド](https://msdn.microsoft.com/library/system.web.security.membership.generatepassword.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="34b6a-373">If the [`AutoGeneratePassword` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.autogeneratepassword.aspx) is set to True, the `CreateUserWizardStep` does not display the "Password" and "Confirm Password" textboxes; instead, the newly-created user's password is automatically generated using the `Membership` class's [`GeneratePassword` method](https://msdn.microsoft.com/library/system.web.security.membership.generatepassword.aspx).</span></span> <span data-ttu-id="34b6a-374">`GeneratePassword`メソッドは、構成されたパスワードの強度の要件を満たすために英数字以外の文字のための十分な数と指定された長さのパスワードを構築します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-374">The `GeneratePassword` method constructs a password of a specified length and with a sufficient number of non-alphanumeric characters to satisfy the configured password strength requirements.</span></span>

<span data-ttu-id="34b6a-375">[ `MailDefinition`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.maildefinition.aspx)アカウントの作成プロセス中に指定した電子メール アドレスに電子メールを送信する場合に便利です。</span><span class="sxs-lookup"><span data-stu-id="34b6a-375">The [`MailDefinition` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.maildefinition.aspx) is useful if you want to send an email to the email address specified during the account creation process.</span></span> <span data-ttu-id="34b6a-376">`MailDefinition`プロパティには、構築された電子メール メッセージに関する情報を定義するためのサブプロパティのシリーズが含まれています。</span><span class="sxs-lookup"><span data-stu-id="34b6a-376">The `MailDefinition` property includes a series of subproperties for defining information about the constructed email message.</span></span> <span data-ttu-id="34b6a-377">これらのサブプロパティがなどのオプションを含める`Subject`、 `Priority`、 `IsBodyHtml`、 `From`、 `CC`、および`BodyFileName`です。</span><span class="sxs-lookup"><span data-stu-id="34b6a-377">These subproperties include options like `Subject`, `Priority`, `IsBodyHtml`, `From`, `CC`, and `BodyFileName`.</span></span> <span data-ttu-id="34b6a-378">[ `BodyFileName`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.maildefinition.bodyfilename.aspx)テキスト ファイルまたは電子メール メッセージの本文を含む HTML ファイルをポイントします。</span><span class="sxs-lookup"><span data-stu-id="34b6a-378">The [`BodyFileName` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.maildefinition.bodyfilename.aspx) points to a text or HTML file that contains the body for the email message.</span></span> <span data-ttu-id="34b6a-379">本文は、事前に定義された 2 つのプレース ホルダーをサポートしています:`<%UserName%>`と`<%Password%>`です。</span><span class="sxs-lookup"><span data-stu-id="34b6a-379">The body supports two pre-defined placeholders: `<%UserName%>` and `<%Password%>`.</span></span> <span data-ttu-id="34b6a-380">これらのプレース ホルダーに存在する場合、`BodyFileName`ファイルでは、だけが作成したユーザーの名前とパスワードに置き換えられます。</span><span class="sxs-lookup"><span data-stu-id="34b6a-380">These placeholders, if present in the `BodyFileName` file, will be replaced with the just-created user's name and password.</span></span>

> [!NOTE]
> <span data-ttu-id="34b6a-381">`CreateUserWizard`コントロールの`MailDefinition`プロパティには、新しいアカウントの作成時に送信される電子メール メッセージの詳細だけを指定します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-381">The `CreateUserWizard` control's `MailDefinition` property just specifies details about the email message that is sent when a new account is created.</span></span> <span data-ttu-id="34b6a-382">電子メール メッセージを実際に送信する方法については含まれません (つまり、SMTP サーバーまたはメール ドロップ ディレクトリが使用されているか、すべて認証情報、およびなど)。</span><span class="sxs-lookup"><span data-stu-id="34b6a-382">It does not include any details on how the email message is actually sent (that is, whether an SMTP server or mail drop directory is used, any authentication information, and so on).</span></span> <span data-ttu-id="34b6a-383">これらの低レベルの詳細で定義されている必要があります、 `<system.net>` 」の「`Web.config`です。</span><span class="sxs-lookup"><span data-stu-id="34b6a-383">These low-level details need to be defined in the `<system.net>` section in `Web.config`.</span></span> <span data-ttu-id="34b6a-384">これらの構成設定と ASP.NET 2.0 から電子メールを送信すると、一般の詳細についてを参照してください、 [SystemNetMail.com でよく寄せられる質問](http://www.systemnetmail.com/)と私の記事[ASP.NET 2.0 で電子メールを送信する](http://aspnet.4guysfromrolla.com/articles/072606-1.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="34b6a-384">For more information on these configuration settings and on sending email from ASP.NET 2.0 in general, refer to the [FAQs at SystemNetMail.com](http://www.systemnetmail.com/) and my article, [Sending Email in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/072606-1.aspx).</span></span>


### <a name="extending-the-createuserwizards-behavior-using-event-handlers"></a><span data-ttu-id="34b6a-385">イベント ハンドラーを使用して CreateUserWizard の動作を拡張します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-385">Extending the CreateUserWizard's Behavior Using Event Handlers</span></span>

<span data-ttu-id="34b6a-386">CreateUserWizard コントロールでは、そのワークフロー内で複数のイベントを発生させます。</span><span class="sxs-lookup"><span data-stu-id="34b6a-386">The CreateUserWizard control raises a number of events during its workflow.</span></span> <span data-ttu-id="34b6a-387">たとえば、訪問者は、ユーザー名、パスワード、および他の関連情報を入力が、「ユーザーの作成」ボタンをクリックして後、CreateUserWizard コントロールが発生させます。 その[`CreatingUser`イベント](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.creatinguser.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="34b6a-387">For example, after a visitor enters their username, password, and other pertinent information and clicks the "Create User" button, the CreateUserWizard control raises its [`CreatingUser` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.creatinguser.aspx).</span></span> <span data-ttu-id="34b6a-388">作成プロセス中に問題がある場合、 [ `CreateUserError`イベント](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createusererror.aspx)が発生します。 ただし、ユーザーが正常に作成される場合は、次に、 [ `CreatedUser`イベント](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createduser.aspx)が発生します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-388">If there is a problem during the create process, the [`CreateUserError` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createusererror.aspx) is fired; however, if the user is successfully created, then the [`CreatedUser` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createduser.aspx) is raised.</span></span> <span data-ttu-id="34b6a-389">生成されるその他の CreateUserWizard コントロール イベントが、これらは、次の 3 つの最も密接もの。</span><span class="sxs-lookup"><span data-stu-id="34b6a-389">There are additional CreateUserWizard control events that get raised, but these are the three most germane ones.</span></span>

<span data-ttu-id="34b6a-390">特定のシナリオで、適切なイベントのイベント ハンドラーを作成することで行うには CreateUserWizard のワークフローをタップすることもできます。</span><span class="sxs-lookup"><span data-stu-id="34b6a-390">In certain scenarios we may want to tap into the CreateUserWizard workflow, which we can do by creating an event handler for the appropriate event.</span></span> <span data-ttu-id="34b6a-391">これを示すためを拡張してみましょう、 `RegisterUser` CreateUserWizard コントロール ユーザー名とパスワードをいくつかのカスタム検証を追加します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-391">To illustrate this, let's enhance the `RegisterUser` CreateUserWizard control to include some custom validation on the username and password.</span></span> <span data-ttu-id="34b6a-392">具体的には、みましょう、CreateUserWizard するように増やしますユーザー名は、先頭または末尾のスペースを含めることはできませんし、ユーザー名に含めることが任意の場所のパスワード。</span><span class="sxs-lookup"><span data-stu-id="34b6a-392">In particular, let's enhance our CreateUserWizard so that usernames cannot contain leading or trailing spaces and the username cannot appear anywhere in the password.</span></span> <span data-ttu-id="34b6a-393">つまり、他のユーザーが"Scott"のようなユーザー名を作成または"Scott"や"Scott.1234"のようなユーザー名/パスワードの組み合わせを阻止します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-393">In short, we want to prevent someone from creating a username like "Scott ", or having a username/password combination like "Scott" and "Scott.1234".</span></span>

<span data-ttu-id="34b6a-394">イベント ハンドラーを作成、これを実現する、`CreatingUser`余分な検証チェックを実行するイベントです。</span><span class="sxs-lookup"><span data-stu-id="34b6a-394">To accomplish this we will create an event handler for the `CreatingUser` event to perform our extra validation checks.</span></span> <span data-ttu-id="34b6a-395">提供されたデータが有効でない場合、作成プロセスをキャンセルする必要があります。</span><span class="sxs-lookup"><span data-stu-id="34b6a-395">If the supplied data is not valid we need to cancel the creation process.</span></span> <span data-ttu-id="34b6a-396">また、ラベルの Web コントロールにユーザー名またはパスワードが無効であるかを説明するメッセージを表示するページを追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="34b6a-396">We also need to add a Label Web control to the page to display a message explaining that the username or password is invalid.</span></span> <span data-ttu-id="34b6a-397">設定、CreateUserWizard コントロールの下にラベル コントロールを追加して、開始、`ID`プロパティを`InvalidUserNameOrPasswordMessage`とその`ForeColor`プロパティを`Red`です。</span><span class="sxs-lookup"><span data-stu-id="34b6a-397">Start by adding a Label control beneath the CreateUserWizard control, setting its `ID` property to `InvalidUserNameOrPasswordMessage` and its `ForeColor` property to `Red`.</span></span> <span data-ttu-id="34b6a-398">クリアしますその`Text`プロパティとその`EnableViewState`と`Visible`プロパティを False にします。</span><span class="sxs-lookup"><span data-stu-id="34b6a-398">Clear out its `Text` property and set its `EnableViewState` and `Visible` properties to False.</span></span>

[!code-aspx[Main](creating-user-accounts-cs/samples/sample7.aspx)]

<span data-ttu-id="34b6a-399">CreateUserWizard コントロールのイベント ハンドラーを次に、作成`CreatingUser`イベント。</span><span class="sxs-lookup"><span data-stu-id="34b6a-399">Next, create an event handler for the CreateUserWizard control's `CreatingUser` event.</span></span> <span data-ttu-id="34b6a-400">作成し、イベント ハンドラー、デザイナーでコントロールを選択し、[プロパティ] ウィンドウに移動します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-400">To create an event handler, select the control in the Designer and then go to the Properties window.</span></span> <span data-ttu-id="34b6a-401">そこから、稲妻のアイコンをクリックし、イベント ハンドラーを作成する適切なイベントをダブルクリックします。</span><span class="sxs-lookup"><span data-stu-id="34b6a-401">From there, click on the lightning bolt icon and then double-click the appropriate event to create the event handler.</span></span>

<span data-ttu-id="34b6a-402">`CreatingUser` イベント ハンドラーに次のコードを追加します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-402">Add the following code to the `CreatingUser` event handler:</span></span>

[!code-csharp[Main](creating-user-accounts-cs/samples/sample8.cs)]

<span data-ttu-id="34b6a-403">ユーザー名と CreateUserWizard コントロールに入力したパスワードがを通じて利用できることに注意してください。 その[ `UserName` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.username.aspx)と[`Password`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.password.aspx)、それぞれします。</span><span class="sxs-lookup"><span data-stu-id="34b6a-403">Note that the username and password entered into the CreateUserWizard control are available through its [`UserName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.username.aspx) and [`Password` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.password.aspx), respectively.</span></span> <span data-ttu-id="34b6a-404">おプロパティを使用して、上記のイベント ハンドラーで指定されたユーザー名に先頭または末尾のスペースが含まれるかどうかと、ユーザー名をパスワードで見つかったかどうかを決定します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-404">We use these properties in the above event handler to determine whether the supplied username contains leading or trailing spaces and whether the username is found within the password.</span></span> <span data-ttu-id="34b6a-405">エラー メッセージが表示されます両方の条件が満たされた場合、`InvalidUserNameOrPasswordMessage`ラベルと、イベント ハンドラーの`e.Cancel`プロパティに設定されている`true`です。</span><span class="sxs-lookup"><span data-stu-id="34b6a-405">If either of these conditions is met, an error message is displayed in the `InvalidUserNameOrPasswordMessage` Label and the event handler's `e.Cancel` property is set to `true`.</span></span> <span data-ttu-id="34b6a-406">場合`e.Cancel`に設定されている`true`、CreateUserWizard short-circuits、ワークフローでは、効果的にユーザー アカウントの作成プロセスをキャンセルします。</span><span class="sxs-lookup"><span data-stu-id="34b6a-406">If `e.Cancel` is set to `true`, the CreateUserWizard short-circuits its workflow, effectively cancelling the user account creation process.</span></span>

<span data-ttu-id="34b6a-407">図 15 のスクリーン ショットを示しています`CreatingUserAccounts.aspx`ユーザーが先頭のスペースを持つユーザー名を入力します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-407">Figure 15 shows a screen shot of `CreatingUserAccounts.aspx` when the user enters a username with leading spaces.</span></span>


<span data-ttu-id="34b6a-408">[![先頭または末尾のスペースでのユーザー名は許可されていません](creating-user-accounts-cs/_static/image44.png)](creating-user-accounts-cs/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="34b6a-408">[![Usernames with Leading or Trailing Spaces are not Permitted](creating-user-accounts-cs/_static/image44.png)](creating-user-accounts-cs/_static/image43.png)</span></span>

<span data-ttu-id="34b6a-409">**図 15**: 先頭または末尾のスペースでのユーザー名は許可されていません ([フルサイズのイメージを表示するをクリックして](creating-user-accounts-cs/_static/image45.png))</span><span class="sxs-lookup"><span data-stu-id="34b6a-409">**Figure 15**: Usernames with Leading or Trailing Spaces are not Permitted  ([Click to view full-size image](creating-user-accounts-cs/_static/image45.png))</span></span>


> [!NOTE]
> <span data-ttu-id="34b6a-410">CreateUserWizard コントロールの使用例を見ていきます`CreatedUser`内のイベント、  *<a id="_msoanchor_11"> </a>[追加のユーザー情報を格納する](storing-additional-user-information-cs.md)*チュートリアルです。</span><span class="sxs-lookup"><span data-stu-id="34b6a-410">We will see an example of using the CreateUserWizard control's `CreatedUser` event in the *<a id="_msoanchor_11"></a>[Storing Additional User Information](storing-additional-user-information-cs.md)* tutorial.</span></span>


## <a name="summary"></a><span data-ttu-id="34b6a-411">まとめ</span><span class="sxs-lookup"><span data-stu-id="34b6a-411">Summary</span></span>

<span data-ttu-id="34b6a-412">`Membership`クラスの`CreateUser`メソッドはメンバーシップ フレームワークで、新しいユーザー アカウントを作成します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-412">The `Membership` class's `CreateUser` method creates a new user account in the Membership framework.</span></span> <span data-ttu-id="34b6a-413">それは、構成済みのメンバーシップ プロバイダーへの呼び出しを代行させることで。</span><span class="sxs-lookup"><span data-stu-id="34b6a-413">It does so by delegating the call to the configured Membership provider.</span></span> <span data-ttu-id="34b6a-414">場合、 `SqlMembershipProvider`、`CreateUser`メソッドを追加するレコード、`aspnet_Users`と`aspnet_Membership`データベース テーブルです。</span><span class="sxs-lookup"><span data-stu-id="34b6a-414">In the case of the `SqlMembershipProvider`, the `CreateUser` method adds a record to the `aspnet_Users` and `aspnet_Membership` database tables.</span></span>

<span data-ttu-id="34b6a-415">プログラムで (で示したように手順 5)、新しいユーザー アカウントを作成できる、中に迅速かつ容易にアプローチでは、CreateUserWizard コントロールを使用します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-415">While new user accounts can be created programmatically (as we saw in Step 5), a faster and easier approach is to use the CreateUserWizard control.</span></span> <span data-ttu-id="34b6a-416">このコントロールは、ユーザー情報を収集し、メンバーシップ フレームワークで、新しいユーザーを作成するための複数のステップ ユーザー インターフェイスを表示します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-416">This control renders a multi-step user interface for collecting user information and creating a new user in the Membership framework.</span></span> <span data-ttu-id="34b6a-417">背後は、このコントロールで使用して同じ`Membership.CreateUser`手順 5 は、コントロールで調べるとメソッドが、ユーザー インターフェイスで、検証コントロールを作成し、コードがまったくを記述することのないユーザー アカウント作成エラーに応答します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-417">Underneath the covers, this control uses the same `Membership.CreateUser` method as examined in Step 5, but the control creates the user interface, validation controls, and responds to user account creation errors without having to write a lick of code.</span></span>

<span data-ttu-id="34b6a-418">この時点でに新しいユーザー アカウントを作成する機能を備えています。</span><span class="sxs-lookup"><span data-stu-id="34b6a-418">At this point we have the functionality in place to create new user accounts.</span></span> <span data-ttu-id="34b6a-419">ただし、まだにログイン ページが 2 番目のチュートリアルでは指定したハード コーディングされた資格情報を検証します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-419">However, the login page still is validating against those hard-coded credentials we specified back in the second tutorial.</span></span> <span data-ttu-id="34b6a-420"><a id="_msoanchor_12"> </a>[次のチュートリアル](validating-user-credentials-against-the-membership-user-store-cs.md)を更新して`Login.aspx`ユーザーを検証するメンバーシップ フレームワークに対して資格情報を提供します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-420">In the <a id="_msoanchor_12"></a>[next tutorial](validating-user-credentials-against-the-membership-user-store-cs.md) we will update `Login.aspx` to validate the user's supplied credentials against the Membership framework.</span></span>

<span data-ttu-id="34b6a-421">満足プログラミング!</span><span class="sxs-lookup"><span data-stu-id="34b6a-421">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="34b6a-422">関連項目</span><span class="sxs-lookup"><span data-stu-id="34b6a-422">Further Reading</span></span>

<span data-ttu-id="34b6a-423">このチュートリアルで説明したトピックの詳細については、次の情報を参照してください。</span><span class="sxs-lookup"><span data-stu-id="34b6a-423">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="34b6a-424">`CreateUser` テクニカル ドキュメント</span><span class="sxs-lookup"><span data-stu-id="34b6a-424">`CreateUser` Technical Documentation</span></span>](https://msdn.microsoft.com/library/system.web.security.membershipprovider.createuser.aspx)
- [<span data-ttu-id="34b6a-425">CreateUserWizard コントロールの概要</span><span class="sxs-lookup"><span data-stu-id="34b6a-425">CreateUserWizard Control Overview</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/login/createuserwizard.aspx)
- [<span data-ttu-id="34b6a-426">ファイル システム ベースのサイト マップ プロバイダーを作成します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-426">Creating a File System-Based Site Map Provider</span></span>](http://aspnet.4guysfromrolla.com/articles/020106-1.aspx)
- [<span data-ttu-id="34b6a-427">ASP.NET 2.0 のウィザード コントロールでステップ バイ ステップのユーザー インターフェイスの作成</span><span class="sxs-lookup"><span data-stu-id="34b6a-427">Creating a Step-by-Step User Interface with the ASP.NET 2.0 Wizard Control</span></span>](http://aspnet.4guysfromrolla.com/articles/061406-1.aspx)
- [<span data-ttu-id="34b6a-428">サイト ナビゲーションの ASP.NET 2.0 を確認します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-428">Examining ASP.NET 2.0's Site Navigation</span></span>](http://aspnet.4guysfromrolla.com/articles/111605-1.aspx)
- [<span data-ttu-id="34b6a-429">マスター ページとサイトのナビゲーション</span><span class="sxs-lookup"><span data-stu-id="34b6a-429">Master Pages and Site Navigation</span></span>](https://asp.net/learn/data-access/tutorial-03-vb.aspx)
- [<span data-ttu-id="34b6a-430">SQL のサイト マップ プロバイダーを待っています。</span><span class="sxs-lookup"><span data-stu-id="34b6a-430">The SQL Site Map Provider You've Been Waiting For</span></span>](https://msdn.microsoft.com/msdnmag/issues/06/02/WickedCode/default.aspx)

### <a name="about-the-author"></a><span data-ttu-id="34b6a-431">作成者について</span><span class="sxs-lookup"><span data-stu-id="34b6a-431">About the Author</span></span>

<span data-ttu-id="34b6a-432">Scott Mitchell、複数の受け取りますブックの作成者と 4GuysFromRolla.com の創設者は、Microsoft の Web テクノロジと 1998 年取り組んできました。</span><span class="sxs-lookup"><span data-stu-id="34b6a-432">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="34b6a-433">Scott は、コンサルタント、トレーナー、ライターとして機能します。</span><span class="sxs-lookup"><span data-stu-id="34b6a-433">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="34b6a-434">最新の著書 *[Sam 学べる自分で ASP.NET 2.0 が 24 時間以内に](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*です。</span><span class="sxs-lookup"><span data-stu-id="34b6a-434">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="34b6a-435">Scott に到達できる[ mitchell@4guysfromrolla.com ](mailto:mitchell@4guysfromrolla.com)または彼のブログでを介して[ http://ScottOnWriting.NET](http://scottonwriting.net/)です。</span><span class="sxs-lookup"><span data-stu-id="34b6a-435">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="34b6a-436">特別に感謝しています.</span><span class="sxs-lookup"><span data-stu-id="34b6a-436">Special Thanks To…</span></span>

<span data-ttu-id="34b6a-437">このチュートリアルの系列は既に多くの便利なレビュー担当者によって確認済みです。</span><span class="sxs-lookup"><span data-stu-id="34b6a-437">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="34b6a-438">このチュートリアルのレビュー担当者の潜在顧客が Teresa マーフィーしました。</span><span class="sxs-lookup"><span data-stu-id="34b6a-438">Lead reviewer for this tutorial was Teresa Murphy.</span></span> <span data-ttu-id="34b6a-439">今後、MSDN の記事を確認することに関心のあるですか。</span><span class="sxs-lookup"><span data-stu-id="34b6a-439">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="34b6a-440">場合は、ドロップ me 一度に 1 行ずつ[ mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)です。</span><span class="sxs-lookup"><span data-stu-id="34b6a-440">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="34b6a-441">[前へ](creating-the-membership-schema-in-sql-server-cs.md)
> [次へ](validating-user-credentials-against-the-membership-user-store-cs.md)</span><span class="sxs-lookup"><span data-stu-id="34b6a-441">[Previous](creating-the-membership-schema-in-sql-server-cs.md)
[Next](validating-user-credentials-against-the-membership-user-store-cs.md)</span></span>
