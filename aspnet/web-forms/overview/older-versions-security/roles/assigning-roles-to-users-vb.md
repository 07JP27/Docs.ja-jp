---
uid: web-forms/overview/older-versions-security/roles/assigning-roles-to-users-vb
title: "(VB) のユーザー ロールの割り当て |Microsoft ドキュメント"
author: rick-anderson
description: "このチュートリアルでは、どのようなユーザー ロールに属しているを管理するために 2 つの ASP.NET ページを構築します。 最初のページは、何を表示する機能が含まれます."
ms.author: aspnetcontent
manager: wpickett
ms.date: 03/24/2008
ms.topic: article
ms.assetid: fd208ee9-69cc-4467-9783-b4e039bdd1d3
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-security/roles/assigning-roles-to-users-vb
msc.type: authoredcontent
ms.openlocfilehash: 528d6f844c68cc7077a86961f9c432e405f22ee7
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/10/2017
---
<a name="assigning-roles-to-users-vb"></a><span data-ttu-id="8e521-104">(VB) のユーザー ロールの割り当てください。</span><span class="sxs-lookup"><span data-stu-id="8e521-104">Assigning Roles to Users (VB)</span></span>
====================
<span data-ttu-id="8e521-105">によって[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="8e521-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="8e521-106">[コードをダウンロードする](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/VB.10.zip)または[PDF のダウンロード](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/aspnet_tutorial10_AssigningRoles_vb.pdf)</span><span class="sxs-lookup"><span data-stu-id="8e521-106">[Download Code](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/VB.10.zip) or [Download PDF](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/aspnet_tutorial10_AssigningRoles_vb.pdf)</span></span>

> <span data-ttu-id="8e521-107">このチュートリアルでは、どのようなユーザー ロールに属しているを管理するために 2 つの ASP.NET ページを構築します。</span><span class="sxs-lookup"><span data-stu-id="8e521-107">In this tutorial we will build two ASP.NET pages to assist with managing what users belong to what roles.</span></span> <span data-ttu-id="8e521-108">最初のページには、特定のロールに属しているユーザーを表示する機能が含まれては特定のユーザーが属するロールと権限を割り当てたり、特定のロールから、特定のユーザーを削除します。</span><span class="sxs-lookup"><span data-stu-id="8e521-108">The first page will include facilities to see what users belong to a given role, what roles a particular user belongs to, and the ability to assign or remove a particular user from a particular role.</span></span> <span data-ttu-id="8e521-109">2 番目のページには、新しく作成されたユーザーが所属するロールを指定するステップが含まれるように CreateUserWizard コントロールを補強おがされます。</span><span class="sxs-lookup"><span data-stu-id="8e521-109">In the second page we will augment the CreateUserWizard control so that it includes a step to specify what roles the newly created user belongs to.</span></span> <span data-ttu-id="8e521-110">これは、管理者が新しいユーザー アカウントを作成することであるシナリオで役に立ちます。</span><span class="sxs-lookup"><span data-stu-id="8e521-110">This is useful in scenarios where an administrator is able to create new user accounts.</span></span>


## <a name="introduction"></a><span data-ttu-id="8e521-111">はじめに</span><span class="sxs-lookup"><span data-stu-id="8e521-111">Introduction</span></span>

<span data-ttu-id="8e521-112"><a id="_msoanchor_1"> </a>[前のチュートリアル](creating-and-managing-roles-vb.md)ロール フレームワークを調べると、 `SqlRoleProvider`; を使用する方法を説明しました、`Roles`クラスを作成、取得、およびロールを削除します。</span><span class="sxs-lookup"><span data-stu-id="8e521-112">The <a id="_msoanchor_1"></a>[previous tutorial](creating-and-managing-roles-vb.md) examined the Roles framework and the `SqlRoleProvider`; we saw how to use the `Roles` class to create, retrieve, and delete roles.</span></span> <span data-ttu-id="8e521-113">を作成し、ロールを削除するだけでなく割り当てまたはロールからユーザーを削除できる必要があります。</span><span class="sxs-lookup"><span data-stu-id="8e521-113">In addition to creating and deleting roles, we need to be able to assign or remove users from a role.</span></span> <span data-ttu-id="8e521-114">残念ながら、ASP.NET では、どのようなユーザー ロールに属しているを管理するためのすべての Web コントロールが付属していません。</span><span class="sxs-lookup"><span data-stu-id="8e521-114">Unfortunately, ASP.NET does not ship with any Web controls for managing what users belong to what roles.</span></span> <span data-ttu-id="8e521-115">代わりに、これらの関連付けを管理する独自の ASP.NET ページを作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="8e521-115">Instead, we must create our own ASP.NET pages to manage these associations.</span></span> <span data-ttu-id="8e521-116">良いニュースは、追加して、ロールへのユーザーを削除することは非常に簡単です。</span><span class="sxs-lookup"><span data-stu-id="8e521-116">The good news is that adding and removing users to roles is quite easy.</span></span> <span data-ttu-id="8e521-117">`Roles`クラスには、1 つまたは複数のロールに 1 つまたは複数のユーザーを追加するためのメソッドの数が含まれています。</span><span class="sxs-lookup"><span data-stu-id="8e521-117">The `Roles` class contains a number of methods for adding one or more users to one or more roles.</span></span>

<span data-ttu-id="8e521-118">このチュートリアルでは、どのようなユーザー ロールに属しているを管理するために 2 つの ASP.NET ページを構築します。</span><span class="sxs-lookup"><span data-stu-id="8e521-118">In this tutorial we will build two ASP.NET pages to assist with managing what users belong to what roles.</span></span> <span data-ttu-id="8e521-119">最初のページには、特定のロールに属しているユーザーを表示する機能が含まれては特定のユーザーが属するロールと権限を割り当てたり、特定のロールから、特定のユーザーを削除します。</span><span class="sxs-lookup"><span data-stu-id="8e521-119">The first page will include facilities to see what users belong to a given role, what roles a particular user belongs to, and the ability to assign or remove a particular user from a particular role.</span></span> <span data-ttu-id="8e521-120">2 番目のページには、新しく作成されたユーザーが所属するロールを指定するステップが含まれるように CreateUserWizard コントロールを補強おがされます。</span><span class="sxs-lookup"><span data-stu-id="8e521-120">In the second page we will augment the CreateUserWizard control so that it includes a step to specify what roles the newly created user belongs to.</span></span> <span data-ttu-id="8e521-121">これは、管理者が新しいユーザー アカウントを作成することであるシナリオで役に立ちます。</span><span class="sxs-lookup"><span data-stu-id="8e521-121">This is useful in scenarios where an administrator is able to create new user accounts.</span></span>

<span data-ttu-id="8e521-122">開始しましょう!</span><span class="sxs-lookup"><span data-stu-id="8e521-122">Let's get started!</span></span>

## <a name="listing-what-users-belong-to-what-roles"></a><span data-ttu-id="8e521-123">ロールに属しているどのようなユーザーを表示します。</span><span class="sxs-lookup"><span data-stu-id="8e521-123">Listing What Users Belong To What Roles</span></span>

<span data-ttu-id="8e521-124">このチュートリアルの最初の注文のビジネスでは、元のユーザーをロールに割り当てることができます、web ページを作成します。</span><span class="sxs-lookup"><span data-stu-id="8e521-124">The first order of business for this tutorial is to create a web page from which users can be assigned to roles.</span></span> <span data-ttu-id="8e521-125">前に、自分をロールにユーザーを割り当てる方法と関係おみましょう最初に集中どのようなユーザー ロールに属しているを確認する方法。</span><span class="sxs-lookup"><span data-stu-id="8e521-125">Before we concern ourselves with how to assign users to roles, let's first concentrate on how to determine what users belong to what roles.</span></span> <span data-ttu-id="8e521-126">この情報を表示する 2 つの方法があります:「ロール"、」ユーザーです"。</span><span class="sxs-lookup"><span data-stu-id="8e521-126">There are two ways to display this information: "by role" or "by user."</span></span> <span data-ttu-id="8e521-127">により、ロールを選択し、表示をユーザー ("ロール"で表示)、ロールに所属するすべてのビジターまたはにユーザーを選択し、そのユーザー (""のユーザーによって表示) に割り当てられているロールのユーザー入力を可能性があります。</span><span class="sxs-lookup"><span data-stu-id="8e521-127">We could allow the visitor to select a role and then show them all of the users that belong to the role (the "by role" display), or we could prompt the visitor to select a user and then show them the roles assigned to that user (the "by user" display).</span></span>

<span data-ttu-id="8e521-128">"ロール"でビューは、ここで、訪問者が特定のロールに属しているユーザーのセットを知りたい状況で役に立ちます"ユーザー"によってビューは、訪問者を特定のユーザー ロールを知る必要がある場合に最適です。</span><span class="sxs-lookup"><span data-stu-id="8e521-128">The "by role" view is useful in circumstances where the visitor wants to know the set of users that belong to a particular role; the "by user" view is ideal when the visitor needs to know a particular user's role(s).</span></span> <span data-ttu-id="8e521-129">みましょう両方「ロール"または」ユーザー"を含む、ページがあるインターフェイスです。</span><span class="sxs-lookup"><span data-stu-id="8e521-129">Let's have our page include both "by role" and "by user" interfaces.</span></span>

<span data-ttu-id="8e521-130">"によって"のユーザー インターフェイスの作成を開始します。</span><span class="sxs-lookup"><span data-stu-id="8e521-130">We will start with creating the "by user" interface.</span></span> <span data-ttu-id="8e521-131">このインターフェイスは、ドロップダウン リストと対応するチェック ボックスの一覧で構成されます。</span><span class="sxs-lookup"><span data-stu-id="8e521-131">This interface will consist of a drop-down list and a list of checkboxes.</span></span> <span data-ttu-id="8e521-132">システムの一連のユーザー ドロップダウン リストは表示されます。対応するチェック ボックスは、ロールを列挙します。</span><span class="sxs-lookup"><span data-stu-id="8e521-132">The drop-down list will be populated with the set of users in the system; the checkboxes will enumerate the roles.</span></span> <span data-ttu-id="8e521-133">ドロップダウン リストからユーザーを選択すると、ユーザーが所属するこれらの役割を確認します。</span><span class="sxs-lookup"><span data-stu-id="8e521-133">Selecting a user from the drop-down list will check those roles the user belongs to.</span></span> <span data-ttu-id="8e521-134">ページにアクセスするユーザーは、確認し、またはを追加または削除、選択したユーザー、対応するロールにあるチェック ボックスをオフにできます。</span><span class="sxs-lookup"><span data-stu-id="8e521-134">The person visiting the page can then check or uncheck the checkboxes to add or remove the selected user from the corresponding roles.</span></span>

> [!NOTE]
> <span data-ttu-id="8e521-135">ドロップダウン リストを使用して、ユーザー アカウントは、web サイトに適してが数百のユーザー アカウントがある可能性があります。</span><span class="sxs-lookup"><span data-stu-id="8e521-135">Using a drop-down list to list the user accounts is not an ideal choice for websites where there may be hundreds of user accounts.</span></span> <span data-ttu-id="8e521-136">ドロップダウン リストは、ユーザーが比較的短い形式の一覧からオプションの 1 つの項目を選択できるように設計されています。</span><span class="sxs-lookup"><span data-stu-id="8e521-136">A drop-down list is designed to allow a user to pick one item from a relatively short list of options.</span></span> <span data-ttu-id="8e521-137">これは、迅速に手に負えなくリスト項目の数の増大に応じて拡張します。</span><span class="sxs-lookup"><span data-stu-id="8e521-137">It quickly becomes unwieldy as the number of list items grows.</span></span> <span data-ttu-id="8e521-138">可能性のある多数のユーザー アカウントを持っている web サイトを作成している可能性がある場合、別のユーザー インターフェイスの使用を検討してページング可能な GridView やを一覧表示するフィルターを適用できるインターフェイスは、文字を選択するビジターを求めるなどしのみユーザー名が、選択した文字で始まるそれらのユーザーを示します。</span><span class="sxs-lookup"><span data-stu-id="8e521-138">If you are building a website that will have potentially large numbers of user accounts, you may want to consider using an alternative user interface, such as a pageable GridView or a filterable interface that lists prompts the visitor to choose a letter and then only shows those users whose username starts with the selected letter.</span></span>


## <a name="step-1-building-the-by-user-user-interface"></a><span data-ttu-id="8e521-139">手順 1:""のユーザーによってユーザー インターフェイスの構築</span><span class="sxs-lookup"><span data-stu-id="8e521-139">Step 1: Building the "By User" User Interface</span></span>

<span data-ttu-id="8e521-140">開く、`UsersAndRoles.aspx`ページ。</span><span class="sxs-lookup"><span data-stu-id="8e521-140">Open the `UsersAndRoles.aspx` page.</span></span> <span data-ttu-id="8e521-141">ページの上部にある、という名前のラベルの Web コントロールを追加`ActionStatus`をクリアし、`Text`プロパティです。</span><span class="sxs-lookup"><span data-stu-id="8e521-141">At the top of the page, add a Label Web control named `ActionStatus` and clear out its `Text` property.</span></span> <span data-ttu-id="8e521-142">このラベルのようにメッセージを表示する、行われた操作に関するフィードバックを提供するを使用する、"ユーザー Tito がロールに追加されて、管理者、"か「ユーザー Jisun はスーパーバイザー ロールから削除されています」。</span><span class="sxs-lookup"><span data-stu-id="8e521-142">We will use this Label to provide feedback on the actions performed, displaying messages like, "User Tito has been added to the Administrators role," or "User Jisun has been removed from the Supervisors role."</span></span> <span data-ttu-id="8e521-143">これらを行うためにメッセージが目立つ設定で、ラベルの`CssClass`プロパティを"Important"です。</span><span class="sxs-lookup"><span data-stu-id="8e521-143">In order to make these messages stand out, set the Label's `CssClass` property to "Important".</span></span>

[!code-aspx[Main](assigning-roles-to-users-vb/samples/sample1.aspx)]

<span data-ttu-id="8e521-144">次の CSS クラス定義を次に、追加、`Styles.css`スタイル シート。</span><span class="sxs-lookup"><span data-stu-id="8e521-144">Next, add the following CSS class definition to the `Styles.css` stylesheet:</span></span>

[!code-css[Main](assigning-roles-to-users-vb/samples/sample2.css)]

<span data-ttu-id="8e521-145">この CSS 定義では、ブラウザーで、大規模な赤いフォントを使用してラベルを表示するように指示します。</span><span class="sxs-lookup"><span data-stu-id="8e521-145">This CSS definition instructs the browser to display the Label using a large, red font.</span></span> <span data-ttu-id="8e521-146">図 1 は、Visual Studio デザイナーでこの特殊効果を示します。</span><span class="sxs-lookup"><span data-stu-id="8e521-146">Figure 1 shows this effect through the Visual Studio Designer.</span></span>


<span data-ttu-id="8e521-147">[![ラベルの CssClass プロパティは、大規模な赤いフォントで結果します。](assigning-roles-to-users-vb/_static/image2.png)](assigning-roles-to-users-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="8e521-147">[![The Label's CssClass Property Results in a Large, Red Font](assigning-roles-to-users-vb/_static/image2.png)](assigning-roles-to-users-vb/_static/image1.png)</span></span>

<span data-ttu-id="8e521-148">**図 1**:、ラベルの`CssClass`大、赤いフォントでプロパティの結果 ([フルサイズのイメージを表示するをクリックして](assigning-roles-to-users-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="8e521-148">**Figure 1**: The Label's `CssClass` Property Results in a Large, Red Font  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image3.png))</span></span>


<span data-ttu-id="8e521-149">次に、設定、DropDownList ページを追加、その`ID`プロパティを`UserList`、設定とその`AutoPostBack`プロパティを True にします。</span><span class="sxs-lookup"><span data-stu-id="8e521-149">Next, add a DropDownList to the page, set its `ID` property to `UserList`, and set its `AutoPostBack` property to True.</span></span> <span data-ttu-id="8e521-150">システム内のすべてのユーザーを一覧表示するのにこの DropDownList を使用します。</span><span class="sxs-lookup"><span data-stu-id="8e521-150">We will use this DropDownList to list all of the users in the system.</span></span> <span data-ttu-id="8e521-151">この DropDownList MembershipUser オブジェクトのコレクションにバインドされます。</span><span class="sxs-lookup"><span data-stu-id="8e521-151">This DropDownList will be bound to a collection of MembershipUser objects.</span></span> <span data-ttu-id="8e521-152">DropDownList を設定するための MembershipUser オブジェクトのユーザー名プロパティを表示 (およびリスト項目の値として使用) に DropDownList、`DataTextField`と`DataValueField`"UserName"をプロパティです。</span><span class="sxs-lookup"><span data-stu-id="8e521-152">Because we want the DropDownList to display the UserName property of the MembershipUser object (and use it as the value of the list items), set the DropDownList's `DataTextField` and `DataValueField` properties to "UserName".</span></span>

<span data-ttu-id="8e521-153">DropDownList を下にある追加というリピータ`UsersRoleList`です。</span><span class="sxs-lookup"><span data-stu-id="8e521-153">Underneath the DropDownList, add a Repeater named `UsersRoleList`.</span></span> <span data-ttu-id="8e521-154">このリピータはすべて一覧表示の役割のシステムを一連のチェック ボックスをオンします。</span><span class="sxs-lookup"><span data-stu-id="8e521-154">This Repeater will list all of the roles in the system as a series of checkboxes.</span></span> <span data-ttu-id="8e521-155">リピータの定義`ItemTemplate`次の宣言型マークアップを使用します。</span><span class="sxs-lookup"><span data-stu-id="8e521-155">Define the Repeater's `ItemTemplate` using the following declarative markup:</span></span>

[!code-aspx[Main](assigning-roles-to-users-vb/samples/sample3.aspx)]

<span data-ttu-id="8e521-156">`ItemTemplate`マークアップには、1 つのチェック ボックスを Web コントロールという名前が含まれています。`RoleCheckBox`です。</span><span class="sxs-lookup"><span data-stu-id="8e521-156">The `ItemTemplate` markup includes a single CheckBox Web control named `RoleCheckBox`.</span></span> <span data-ttu-id="8e521-157">チェック ボックスの`AutoPostBack`プロパティが True に設定され、`Text`プロパティにバインド`Container.DataItem`です。</span><span class="sxs-lookup"><span data-stu-id="8e521-157">The CheckBox's `AutoPostBack` property is set to True and the `Text` property is bound to `Container.DataItem`.</span></span> <span data-ttu-id="8e521-158">理由のデータ バインド構文は単に`Container.DataItem`は、ロール フレームワークには、文字列の配列としてロール名の一覧が返されます。 このリピータにバインドしている文字列配列であるためです。</span><span class="sxs-lookup"><span data-stu-id="8e521-158">The reason the databinding syntax is simply `Container.DataItem` is because the Roles framework returns the list of role names as a string array, and it is this string array that we will be binding to the Repeater.</span></span> <span data-ttu-id="8e521-159">データの Web コントロールにバインドされている配列の内容を表示する次の構文を使用する理由の詳細な説明についてはこのチュートリアルの範囲外です。</span><span class="sxs-lookup"><span data-stu-id="8e521-159">A thorough description of why this syntax is used to display the contents of an array bound to a data Web control is beyond the scope of this tutorial.</span></span> <span data-ttu-id="8e521-160">この問題の詳細についてを参照してください[データ Web コントロールへのスカラー配列のバインド](http://aspnet.4guysfromrolla.com/articles/082504-1.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="8e521-160">For more information on this matter, refer to [Binding a Scalar Array to a Data Web Control](http://aspnet.4guysfromrolla.com/articles/082504-1.aspx).</span></span>

<span data-ttu-id="8e521-161">この時点で、"によって"のユーザー インターフェイスの宣言型マークアップは、次のようになります。</span><span class="sxs-lookup"><span data-stu-id="8e521-161">At this point your "by user" interface's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](assigning-roles-to-users-vb/samples/sample4.aspx)]

<span data-ttu-id="8e521-162">これで、DropDownList するユーザー アカウントのセットとリピータへのロールのセットをバインドするコードを記述する準備が整いました。</span><span class="sxs-lookup"><span data-stu-id="8e521-162">We are now ready to write the code to bind the set of user accounts to the DropDownList and the set of roles to the Repeater.</span></span> <span data-ttu-id="8e521-163">ページの分離コード クラスには、という名前のメソッドを追加`BindUsersToUserList`というもう`BindRolesList`、次のコードを使用します。</span><span class="sxs-lookup"><span data-stu-id="8e521-163">In the page's code-behind class, add a method named `BindUsersToUserList` and another named `BindRolesList`, using the following code:</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample5.vb)]

<span data-ttu-id="8e521-164">`BindUsersToUserList`メソッドはによってシステム内のすべてのユーザー アカウントを取得、 [ `Membership.GetAllUsers`メソッド](https://msdn.microsoft.com/en-us/library/dy8swhya.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="8e521-164">The `BindUsersToUserList` method retrieves all of the user accounts in the system via the [`Membership.GetAllUsers` method](https://msdn.microsoft.com/en-us/library/dy8swhya.aspx).</span></span> <span data-ttu-id="8e521-165">これを返します、 [ `MembershipUserCollection`オブジェクト](https://msdn.microsoft.com/en-us/library/system.web.security.membershipusercollection.aspx)の集合である[`MembershipUser`インスタンス](https://msdn.microsoft.com/en-us/library/system.web.security.membershipuser.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="8e521-165">This returns a [`MembershipUserCollection` object](https://msdn.microsoft.com/en-us/library/system.web.security.membershipusercollection.aspx), which is a collection of [`MembershipUser` instances](https://msdn.microsoft.com/en-us/library/system.web.security.membershipuser.aspx).</span></span> <span data-ttu-id="8e521-166">このコレクションにバインドし、 `UserList` DropDownList です。</span><span class="sxs-lookup"><span data-stu-id="8e521-166">This collection is then bound to the `UserList` DropDownList.</span></span> <span data-ttu-id="8e521-167">`MembershipUser`インスタンスのコレクションにはと同様に、さまざまなプロパティが含まれている構成`UserName`、 `Email`、 `CreationDate`、および`IsOnline`です。</span><span class="sxs-lookup"><span data-stu-id="8e521-167">The `MembershipUser` instances that makeup the collection contain a variety of properties, like `UserName`, `Email`, `CreationDate`, and `IsOnline`.</span></span> <span data-ttu-id="8e521-168">DropDownList の値を表示するように指示するために、`UserName`プロパティ、いることを確認、 `UserList` DropDownList の`DataTextField`と`DataValueField`プロパティは、"UserName"に設定されています。</span><span class="sxs-lookup"><span data-stu-id="8e521-168">In order to instruct the DropDownList to display the value of the `UserName` property, ensure that the `UserList` DropDownList's `DataTextField` and `DataValueField` properties have been set to "UserName".</span></span>

> [!NOTE]
> <span data-ttu-id="8e521-169">`Membership.GetAllUsers`メソッドに次の 2 つのオーバー ロードがあります: 入力パラメーターを受け取らずにあり、ユーザーのすべてを返します、もう 1 つで、ページのインデックスと、ページ サイズの整数値を受け取り、指定したユーザーのサブセットのみを返します。</span><span class="sxs-lookup"><span data-stu-id="8e521-169">The `Membership.GetAllUsers` method has two overloads: one that accepts no input parameters and returns all of the users, and one that takes in integer values for the page index and page size, and returns only the specified subset of the users.</span></span> <span data-ttu-id="8e521-170">大量のページング可能なユーザー インターフェイス要素に表示されているユーザー アカウントが存在する場合、それらのすべてではなくユーザー アカウントの正確なサブセットだけを返すので、2 番目のオーバー ロードはより効率的にユーザーを使用してページを使用できます。</span><span class="sxs-lookup"><span data-stu-id="8e521-170">When there are large amounts of user accounts being displayed in a pageable user interface element, the second overload can be used to more efficiently page through the users since it returns just the precise subset of user accounts rather than all of them.</span></span>


<span data-ttu-id="8e521-171">`BindRolesToList`メソッドを呼び出すことによって開始、`Roles`クラスの[`GetAllRoles`メソッド](https://msdn.microsoft.com/en-us/library/system.web.security.roles.getallroles.aspx)システムの役割を含む文字列配列が返されます。</span><span class="sxs-lookup"><span data-stu-id="8e521-171">The `BindRolesToList` method starts by calling the `Roles` class's [`GetAllRoles` method](https://msdn.microsoft.com/en-us/library/system.web.security.roles.getallroles.aspx), which returns a string array containing the roles in the system.</span></span> <span data-ttu-id="8e521-172">この文字列の配列はリピータにし、バインドされています。</span><span class="sxs-lookup"><span data-stu-id="8e521-172">This string array is then bound to the Repeater.</span></span>

<span data-ttu-id="8e521-173">最後に、ページが最初に読み込まれたときに、これら 2 つのメソッドを呼び出す必要があります。</span><span class="sxs-lookup"><span data-stu-id="8e521-173">Finally, we need to call these two methods when the page is first loaded.</span></span> <span data-ttu-id="8e521-174">`Page_Load` イベント ハンドラーに次のコードを追加します。</span><span class="sxs-lookup"><span data-stu-id="8e521-174">Add the following code to the `Page_Load` event handler:</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample6.vb)]

<span data-ttu-id="8e521-175">このコードですぐを; ブラウザーでページを参照してください。画面は、図 2 のようになります。</span><span class="sxs-lookup"><span data-stu-id="8e521-175">With this code in place, take a moment to visit the page through a browser; your screen should look similar to Figure 2.</span></span> <span data-ttu-id="8e521-176">すべてのユーザー アカウントが設定されますドロップダウン リストで、その下に、各ロールは、チェック ボックスとして表示されます。</span><span class="sxs-lookup"><span data-stu-id="8e521-176">All of the user accounts are populated in the drop-down list and, underneath that, each role appears as a checkbox.</span></span> <span data-ttu-id="8e521-177">設定するため、`AutoPostBack`プロパティ DropDownList と対応するチェック ボックスの true の場合、選択したユーザーを変更するか、オンまたはオフにして、ロール ポストバックが発生します。</span><span class="sxs-lookup"><span data-stu-id="8e521-177">Because we set the `AutoPostBack` properties of the DropDownList and CheckBoxes to True, changing the selected user or checking or unchecking a role causes a postback.</span></span> <span data-ttu-id="8e521-178">アクションは実行されません、ただし、まだこれらのアクションを処理するコードを記述しているためです。</span><span class="sxs-lookup"><span data-stu-id="8e521-178">No action is performed, however, because we have yet to write code to handle these actions.</span></span> <span data-ttu-id="8e521-179">これらのタスクを次の 2 つのセクションで取り上げるです。</span><span class="sxs-lookup"><span data-stu-id="8e521-179">We'll tackle these tasks in the next two sections.</span></span>


<span data-ttu-id="8e521-180">[![ページは、ユーザーおよびロールが表示されます。](assigning-roles-to-users-vb/_static/image5.png)](assigning-roles-to-users-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="8e521-180">[![The Page Displays the Users and Roles](assigning-roles-to-users-vb/_static/image5.png)](assigning-roles-to-users-vb/_static/image4.png)</span></span>

<span data-ttu-id="8e521-181">**図 2**: ページは、ユーザーおよびロールが表示されます ([フルサイズのイメージを表示するをクリックして](assigning-roles-to-users-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="8e521-181">**Figure 2**: The Page Displays the Users and Roles  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image6.png))</span></span>


### <a name="checking-the-roles-the-selected-user-belongs-to"></a><span data-ttu-id="8e521-182">選択したユーザーが所属するロールを確認しています</span><span class="sxs-lookup"><span data-stu-id="8e521-182">Checking the Roles the Selected User Belongs To</span></span>

<span data-ttu-id="8e521-183">ページが最初に読み込まれたとき、または、訪問者がドロップダウン リストから、新しいユーザーを選択するたびに、更新する必要があります、`UsersRoleList`のチェック ボックス、選択したユーザーがそのロールに属している場合にのみ特定のロール checkbox がオンにできるようにします。</span><span class="sxs-lookup"><span data-stu-id="8e521-183">When the page is first loaded, or whenever the visitor selects a new user from the drop-down list, we need to update the `UsersRoleList`'s checkboxes so that a given role checkbox is checked only if the selected user belongs to that role.</span></span> <span data-ttu-id="8e521-184">これを実現する、という名前のメソッドを作成する`CheckRolesForSelectedUser`を次のコード。</span><span class="sxs-lookup"><span data-stu-id="8e521-184">To accomplish this, create a method named `CheckRolesForSelectedUser` with the following code:</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample7.vb)]

<span data-ttu-id="8e521-185">選択したユーザーを決定することにより、上記のコードを開始します。</span><span class="sxs-lookup"><span data-stu-id="8e521-185">The above code starts by determining who the selected user is.</span></span> <span data-ttu-id="8e521-186">ロールのクラスを使用して、 [ `GetRolesForUser(userName)`メソッド](https://msdn.microsoft.com/en-us/library/system.web.security.roles.getrolesforuser.aspx)文字列の配列としての役割の指定したユーザーのセットを取得します。</span><span class="sxs-lookup"><span data-stu-id="8e521-186">It then uses the Roles class's [`GetRolesForUser(userName)` method](https://msdn.microsoft.com/en-us/library/system.web.security.roles.getrolesforuser.aspx) to return the specified user's set of roles as a string array.</span></span> <span data-ttu-id="8e521-187">リピータのアイテムが列挙された次に、および各項目の`RoleCheckBox` チェック ボックスがプログラムによって参照されています。</span><span class="sxs-lookup"><span data-stu-id="8e521-187">Next, the Repeater's items are enumerated and each item's `RoleCheckBox` CheckBox is programmatically referenced.</span></span> <span data-ttu-id="8e521-188">チェック ボックスをオンに対応して、ロールに含まれる場合にのみ、`selectedUsersRoles`文字列配列。</span><span class="sxs-lookup"><span data-stu-id="8e521-188">The CheckBox is checked only if the role it corresponds to is contained within the `selectedUsersRoles` string array.</span></span>

> [!NOTE]
> <span data-ttu-id="8e521-189">`Linq.Enumerable.Contains(Of String)(...)`構文は、ASP.NET 2.0 を使用している場合はコンパイルされません。</span><span class="sxs-lookup"><span data-stu-id="8e521-189">The `Linq.Enumerable.Contains(Of String)(...)` syntax will not compile if you are using ASP.NET version 2.0.</span></span> <span data-ttu-id="8e521-190">`Contains(Of String)`メソッドの一部である、 [LINQ ライブラリ](http://en.wikipedia.org/wiki/Language_Integrated_Query)、ASP.NET 3.5 に新機能です。</span><span class="sxs-lookup"><span data-stu-id="8e521-190">The `Contains(Of String)` method is part of the [LINQ library](http://en.wikipedia.org/wiki/Language_Integrated_Query), which is new to ASP.NET 3.5.</span></span> <span data-ttu-id="8e521-191">ASP.NET version 2.0 を使用して引き続き場合を使用して、 [ `Array.IndexOf(Of String)`メソッド](https://msdn.microsoft.com/en-us/library/eha9t187.aspx)代わりにします。</span><span class="sxs-lookup"><span data-stu-id="8e521-191">If you are still using ASP.NET version 2.0, use the [`Array.IndexOf(Of String)` method](https://msdn.microsoft.com/en-us/library/eha9t187.aspx) instead.</span></span>


<span data-ttu-id="8e521-192">`CheckRolesForSelectedUser`メソッドは、2 つのケースで呼び出される必要があります: およびページが最初に読み込まれたときに、 `UserList` DropDownList の選択されたインデックスを変更します。</span><span class="sxs-lookup"><span data-stu-id="8e521-192">The `CheckRolesForSelectedUser` method needs to be called in two cases: when the page is first loaded and whenever the `UserList` DropDownList's selected index is changed.</span></span> <span data-ttu-id="8e521-193">したがってからこのメソッドを呼び出す、`Page_Load`イベント ハンドラー (の呼び出し後に`BindUsersToUserList`と`BindRolesToList`)。</span><span class="sxs-lookup"><span data-stu-id="8e521-193">Therefore, call this method from the `Page_Load` event handler (after the calls to `BindUsersToUserList` and `BindRolesToList`).</span></span> <span data-ttu-id="8e521-194">またの DropDownList のイベント ハンドラーを作成`SelectedIndexChanged`イベントからこのメソッドを呼び出すとします。</span><span class="sxs-lookup"><span data-stu-id="8e521-194">Also, create an event handler for the DropDownList's `SelectedIndexChanged` event and call this method from there.</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample8.vb)]

<span data-ttu-id="8e521-195">配置でこのコードでは、ブラウザーでページをテストできます。</span><span class="sxs-lookup"><span data-stu-id="8e521-195">With this code in place, you can test the page through the browser.</span></span> <span data-ttu-id="8e521-196">ただし、以降、`UsersAndRoles.aspx`ページに現在のユーザーをロールに割り当てる機能がない、ユーザーにはロールはありません。</span><span class="sxs-lookup"><span data-stu-id="8e521-196">However, since the `UsersAndRoles.aspx` page currently lacks the ability to assign users to roles, no users have roles.</span></span> <span data-ttu-id="8e521-197">いずれかを取得してこのコードが動作する言葉、これは、後で、ことを確認するために、すぐにロールにユーザーを割り当てるためのインターフェイスを作成、またはレコードを挿入することでユーザーをロールに手動で追加することができます、`aspnet_UsersInRoles`この functi をテストするためにテーブルonality ようになりました。</span><span class="sxs-lookup"><span data-stu-id="8e521-197">We will create the interface for assigning users to roles in a moment, so you can either take my word that this code works and verify that it does so later, or you can manually add users to roles by inserting records into the `aspnet_UsersInRoles` table in order to test this functionality now.</span></span>

### <a name="assigning-and-removing-users-from-roles"></a><span data-ttu-id="8e521-198">割り当てると、ユーザーの役割の削除</span><span class="sxs-lookup"><span data-stu-id="8e521-198">Assigning and Removing Users from Roles</span></span>

<span data-ttu-id="8e521-199">訪問者がチェックや内のチェック ボックスをオフに、 `UsersRoleList` Repeater を追加または対応するロールから、選択したユーザーを削除する必要があります。</span><span class="sxs-lookup"><span data-stu-id="8e521-199">When the visitor checks or unchecks a CheckBox in the `UsersRoleList` Repeater we need to add or remove the selected user from the corresponding role.</span></span> <span data-ttu-id="8e521-200">チェック ボックスの`AutoPostBack`プロパティは現在でもリピータ内のチェック ボックスがオンまたはオフ ポストバックが発生する True に設定します。</span><span class="sxs-lookup"><span data-stu-id="8e521-200">The CheckBox's `AutoPostBack` property is currently set to True, which causes a postback anytime a CheckBox in the Repeater is checked or unchecked.</span></span> <span data-ttu-id="8e521-201">つまり、チェック ボックスのイベント ハンドラーを作成する必要があります`CheckChanged`イベント。</span><span class="sxs-lookup"><span data-stu-id="8e521-201">In short, we need to create an event handler for the CheckBox's `CheckChanged` event.</span></span> <span data-ttu-id="8e521-202">チェック ボックスがリピータ コントロール内にあるため、イベント ハンドラーの組み込みを手動で追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="8e521-202">Since the CheckBox is in a Repeater control, we need to manually add the event handler plumbing.</span></span> <span data-ttu-id="8e521-203">分離コード クラスをイベント ハンドラーを追加して、開始、`Protected`メソッド、次のようにします。</span><span class="sxs-lookup"><span data-stu-id="8e521-203">Start by adding the event handler to the code-behind class as a `Protected` method, like so:</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample9.vb)]

<span data-ttu-id="8e521-204">すぐにこのイベント ハンドラーのコードを記述することが戻ります。</span><span class="sxs-lookup"><span data-stu-id="8e521-204">We will return to write the code for this event handler in a moment.</span></span> <span data-ttu-id="8e521-205">まずは、イベント処理の組み込みを完了してみましょう。</span><span class="sxs-lookup"><span data-stu-id="8e521-205">But first let's complete the event handling plumbing.</span></span> <span data-ttu-id="8e521-206">リピータので、このチェック ボックスから`ItemTemplate`、追加`OnCheckedChanged="RoleCheckBox_CheckChanged"`です。</span><span class="sxs-lookup"><span data-stu-id="8e521-206">From the CheckBox within the Repeater's `ItemTemplate`, add `OnCheckedChanged="RoleCheckBox_CheckChanged"`.</span></span> <span data-ttu-id="8e521-207">この構文の接続、`RoleCheckBox_CheckChanged`イベント ハンドラーを`RoleCheckBox`の`CheckedChanged`イベント。</span><span class="sxs-lookup"><span data-stu-id="8e521-207">This syntax wires the `RoleCheckBox_CheckChanged` event handler to the `RoleCheckBox`'s `CheckedChanged` event.</span></span>

[!code-aspx[Main](assigning-roles-to-users-vb/samples/sample10.aspx)]

<span data-ttu-id="8e521-208">最後のタスクが完了するには、`RoleCheckBox_CheckChanged`イベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="8e521-208">Our final task is to complete the `RoleCheckBox_CheckChanged` event handler.</span></span> <span data-ttu-id="8e521-209">イベントが発生したため、このチェック ボックスのインスタンスによるどのような役割が checked または unchecked 経由で CheckBox コントロールを参照することで開始する必要があります、`Text`と`Checked`プロパティです。</span><span class="sxs-lookup"><span data-stu-id="8e521-209">We need to start by referencing the CheckBox control that raised the event because this CheckBox instance tells us what role was checked or unchecked via its `Text` and `Checked` properties.</span></span> <span data-ttu-id="8e521-210">この情報は、選択したユーザーのユーザー名と共に使用して、おを追加または削除ユーザー ロールを介して、`Roles`クラスの[ `AddUserToRole` ](https://msdn.microsoft.com/en-us/library/system.web.security.roles.addusertorole.aspx)または[`RemoveUserFromRole`メソッド](https://msdn.microsoft.com/en-us/library/system.web.security.roles.removeuserfromrole.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="8e521-210">Using this information along with the UserName of the selected user, we add or remove the user from the role via the `Roles` class's [`AddUserToRole`](https://msdn.microsoft.com/en-us/library/system.web.security.roles.addusertorole.aspx) or [`RemoveUserFromRole` method](https://msdn.microsoft.com/en-us/library/system.web.security.roles.removeuserfromrole.aspx).</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample11.vb)]

<span data-ttu-id="8e521-211">プログラムを利用すると、イベントを発生させた チェック ボックスを参照して、上記のコードを開始、`sender`入力パラメーターです。</span><span class="sxs-lookup"><span data-stu-id="8e521-211">The above code starts by programmatically referencing the CheckBox that raised the event, which is available via the `sender` input parameter.</span></span> <span data-ttu-id="8e521-212">チェック ボックスをオンにした場合、指定したロールに、それ以外の場合、ロールから削除された、選択したユーザーが追加されます。</span><span class="sxs-lookup"><span data-stu-id="8e521-212">If the CheckBox is checked, the selected user is added to the specified role, otherwise they are removed from the role.</span></span> <span data-ttu-id="8e521-213">どちらの場合、`ActionStatus`ラベルだけ実行されるアクションの概要を作成するメッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="8e521-213">In either case, the `ActionStatus` Label displays a message summarizing the action just performed.</span></span>

<span data-ttu-id="8e521-214">すぐをブラウザーからこのページをテストします。</span><span class="sxs-lookup"><span data-stu-id="8e521-214">Take a moment to test out this page through a browser.</span></span> <span data-ttu-id="8e521-215">Tito のユーザーを選択し、管理者と管理者の両方のロールに Tito を追加します。</span><span class="sxs-lookup"><span data-stu-id="8e521-215">Select user Tito and then add Tito to both the Administrators and Supervisors roles.</span></span>


<span data-ttu-id="8e521-216">[![Tito が管理者と管理者ロールに追加されました](assigning-roles-to-users-vb/_static/image8.png)](assigning-roles-to-users-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="8e521-216">[![Tito Has Been Added to the Administrators and Supervisors Roles](assigning-roles-to-users-vb/_static/image8.png)](assigning-roles-to-users-vb/_static/image7.png)</span></span>

<span data-ttu-id="8e521-217">**図 3**: Tito が管理者と管理者ロールに追加されました ([フルサイズのイメージを表示するをクリックして](assigning-roles-to-users-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="8e521-217">**Figure 3**: Tito Has Been Added to the Administrators and Supervisors Roles  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image9.png))</span></span>


<span data-ttu-id="8e521-218">次に、ドロップダウン リストからユーザー ブルースを選択します。</span><span class="sxs-lookup"><span data-stu-id="8e521-218">Next, select user Bruce from the drop-down list.</span></span> <span data-ttu-id="8e521-219">ポストバックがあるし、更新されたリピータのチェック ボックス、`CheckRolesForSelectedUser`です。</span><span class="sxs-lookup"><span data-stu-id="8e521-219">There is a postback and the Repeater's CheckBoxes are updated via the `CheckRolesForSelectedUser`.</span></span> <span data-ttu-id="8e521-220">ブルースまだに属さないすべての役割、ので、2 つのチェック ボックスはチェックされません。</span><span class="sxs-lookup"><span data-stu-id="8e521-220">Since Bruce does not yet belong to any roles, the two checkboxes are unchecked.</span></span> <span data-ttu-id="8e521-221">次に、管理者ロールにブルースを追加します。</span><span class="sxs-lookup"><span data-stu-id="8e521-221">Next, add Bruce to the Supervisors role.</span></span>


<span data-ttu-id="8e521-222">[![ブルースが管理者ロールに追加されました](assigning-roles-to-users-vb/_static/image11.png)](assigning-roles-to-users-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="8e521-222">[![Bruce Has Been Added to the Supervisors Role](assigning-roles-to-users-vb/_static/image11.png)](assigning-roles-to-users-vb/_static/image10.png)</span></span>

<span data-ttu-id="8e521-223">**図 4**: ブルースが管理者ロールに追加されました ([フルサイズのイメージを表示するをクリックして](assigning-roles-to-users-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="8e521-223">**Figure 4**: Bruce Has Been Added to the Supervisors Role  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image12.png))</span></span>


<span data-ttu-id="8e521-224">さらの機能を検証する、`CheckRolesForSelectedUser`メソッド、Tito またはブルース以外のユーザーを選択します。</span><span class="sxs-lookup"><span data-stu-id="8e521-224">To further verify the functionality of the `CheckRolesForSelectedUser` method, select a user other than Tito or Bruce.</span></span> <span data-ttu-id="8e521-225">対応するチェック ボックスが自動的にチェックする方法に注意してください、役割に属していないことを示すです。</span><span class="sxs-lookup"><span data-stu-id="8e521-225">Note how the checkboxes are automatically unchecked, denoting that they do not belong to any roles.</span></span> <span data-ttu-id="8e521-226">Tito に戻ります。</span><span class="sxs-lookup"><span data-stu-id="8e521-226">Return to Tito.</span></span> <span data-ttu-id="8e521-227">管理者と管理者の両方のチェック ボックスをチェックする必要があります。</span><span class="sxs-lookup"><span data-stu-id="8e521-227">Both the Administrators and Supervisors checkboxes should be checked.</span></span>

## <a name="step-2-building-the-by-roles-user-interface"></a><span data-ttu-id="8e521-228">手順 2:"ロール"でユーザー インターフェイスの構築</span><span class="sxs-lookup"><span data-stu-id="8e521-228">Step 2: Building the "By Roles" User Interface</span></span>

<span data-ttu-id="8e521-229">この時点で"によって"のユーザー インターフェイスが完了し、"ロール"でインターフェイスへの取り組みを開始する準備が整いました。</span><span class="sxs-lookup"><span data-stu-id="8e521-229">At this point we have completed the "by users" interface and are ready to start tackling the "by roles" interface.</span></span> <span data-ttu-id="8e521-230">"ロール"でインターフェイスでは、ドロップダウン リストからロールを選択するように求めるし、GridView でそのロールに属しているユーザーのセットを表示します。</span><span class="sxs-lookup"><span data-stu-id="8e521-230">The "by roles" interface prompts the user to select a role from a drop-down list and then displays the set of users that belong to that role in a GridView.</span></span>

<span data-ttu-id="8e521-231">別の DropDownList コントロールを追加して、`UsersAndRoles.aspx page`です。</span><span class="sxs-lookup"><span data-stu-id="8e521-231">Add another DropDownList control to the `UsersAndRoles.aspx page`.</span></span> <span data-ttu-id="8e521-232">リピータ コントロールの下に 1 つ配置、名前を付けます`RoleList`、設定とその`AutoPostBack`プロパティを True にします。</span><span class="sxs-lookup"><span data-stu-id="8e521-232">Place this one beneath the Repeater control, name it `RoleList`, and set its `AutoPostBack` property to True.</span></span> <span data-ttu-id="8e521-233">その下に、GridView を追加し、名前`RolesUserList`です。</span><span class="sxs-lookup"><span data-stu-id="8e521-233">Underneath that, add a GridView and name it `RolesUserList`.</span></span> <span data-ttu-id="8e521-234">この GridView には、選択したロールに属しているユーザーが表示されます。</span><span class="sxs-lookup"><span data-stu-id="8e521-234">This GridView will list the users that belong to the selected role.</span></span> <span data-ttu-id="8e521-235">GridView の設定`AutoGenerateColumns`プロパティを False、TemplateField をグリッドに追加の`Columns`コレクション、およびセットその`HeaderText`"Users"をプロパティです。</span><span class="sxs-lookup"><span data-stu-id="8e521-235">Set the GridView's `AutoGenerateColumns` property to False, add a TemplateField to the grid's `Columns` collection, and set its `HeaderText` property to "Users".</span></span> <span data-ttu-id="8e521-236">定義 TemplateField の`ItemTemplate`データ バインド式の値を表示するよう`Container.DataItem`で、`Text`という名前のラベルのプロパティ`UserNameLabel`です。</span><span class="sxs-lookup"><span data-stu-id="8e521-236">Define the TemplateField's `ItemTemplate` so that it displays the value of the databinding expression `Container.DataItem` in the `Text` property of a Label named `UserNameLabel`.</span></span>

<span data-ttu-id="8e521-237">追加し、GridView を構成したら、"ロール"でインターフェイスの宣言型マークアップを次のようになります。</span><span class="sxs-lookup"><span data-stu-id="8e521-237">After adding and configuring the GridView, your "by role" interface's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](assigning-roles-to-users-vb/samples/sample12.aspx)]

<span data-ttu-id="8e521-238">設定する必要があります、 `RoleList` DropDownList 一連のシステムの役割です。</span><span class="sxs-lookup"><span data-stu-id="8e521-238">We need to populate the `RoleList` DropDownList with the set of roles in the system.</span></span> <span data-ttu-id="8e521-239">これを実現する、更新、`BindRolesToList`メソッドがバインドによって文字列の配列が返される、`Roles.GetAllRoles`メソッドを`RolesList`DropDownList (だけでなく`UsersRoleList`リピータ)。</span><span class="sxs-lookup"><span data-stu-id="8e521-239">To accomplish this, update the `BindRolesToList` method so that is binds the string array returned by the `Roles.GetAllRoles` method to the `RolesList` DropDownList (as well as the `UsersRoleList` Repeater).</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample13.vb)]

<span data-ttu-id="8e521-240">最後の 2 つの行、`BindRolesToList`メソッドへのロールのセットをバインドに追加された、 `RoleList` DropDownList コントロール。</span><span class="sxs-lookup"><span data-stu-id="8e521-240">The last two lines in the `BindRolesToList` method have been added to bind the set of roles to the `RoleList` DropDownList control.</span></span> <span data-ttu-id="8e521-241">図 5 は、ドロップダウン リストが、システムの役割を持つが表示されます: ブラウザーを使って表示したときに、最終的な結果を示します。</span><span class="sxs-lookup"><span data-stu-id="8e521-241">Figure 5 shows the end result when viewed through a browser – a drop-down list populated with the system's roles.</span></span>


<span data-ttu-id="8e521-242">[![RoleList DropDownList で、ロールが表示されます。](assigning-roles-to-users-vb/_static/image14.png)](assigning-roles-to-users-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="8e521-242">[![The Roles are Displayed in the RoleList DropDownList](assigning-roles-to-users-vb/_static/image14.png)](assigning-roles-to-users-vb/_static/image13.png)</span></span>

<span data-ttu-id="8e521-243">**図 5**:、ロールが表示されます、 `RoleList` DropDownList ([フルサイズのイメージを表示するをクリックして](assigning-roles-to-users-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="8e521-243">**Figure 5**: The Roles are Displayed in the `RoleList` DropDownList  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image15.png))</span></span>


### <a name="displaying-the-users-that-belong-to-the-selected-role"></a><span data-ttu-id="8e521-244">選択したロールに属しているユーザーを表示します。</span><span class="sxs-lookup"><span data-stu-id="8e521-244">Displaying the Users That Belong To the Selected Role</span></span>

<span data-ttu-id="8e521-245">ページが最初に読み込まれるときに、またはからの新しいロールを選択すると、 `RoleList` DropDownList、GridView でそのロールに属しているユーザーの一覧を表示する必要があります。</span><span class="sxs-lookup"><span data-stu-id="8e521-245">When the page is first loaded, or when a new role is selected from the `RoleList` DropDownList, we need to display the list of users that belong to that role in the GridView.</span></span> <span data-ttu-id="8e521-246">という名前のメソッドを作成する`DisplayUsersBelongingToRole`次のコードを使用します。</span><span class="sxs-lookup"><span data-stu-id="8e521-246">Create a method named `DisplayUsersBelongingToRole` using the following code:</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample14.vb)]

<span data-ttu-id="8e521-247">このメソッドは、選択したロールから取得することによって開始、 `RoleList` DropDownList です。</span><span class="sxs-lookup"><span data-stu-id="8e521-247">This method starts by getting the selected role from the `RoleList` DropDownList.</span></span> <span data-ttu-id="8e521-248">次を使用して、 [ `Roles.GetUsersInRole(roleName)`メソッド](https://msdn.microsoft.com/en-us/library/system.web.security.roles.getusersinrole.aspx)そのロールに属しているユーザーのユーザー名の文字列の配列を取得します。</span><span class="sxs-lookup"><span data-stu-id="8e521-248">It then uses the [`Roles.GetUsersInRole(roleName)` method](https://msdn.microsoft.com/en-us/library/system.web.security.roles.getusersinrole.aspx) to retrieve a string array of the UserNames of the users that belong to that role.</span></span> <span data-ttu-id="8e521-249">この配列にバインドし、 `RolesUserList` GridView です。</span><span class="sxs-lookup"><span data-stu-id="8e521-249">This array is then bound to the `RolesUserList` GridView.</span></span>

<span data-ttu-id="8e521-250">このメソッドは、2 つの状況で呼び出される必要があります。 ページが最初に読み込まれるとき、およびで選択された役割、 `RoleList` DropDownList 変更します。</span><span class="sxs-lookup"><span data-stu-id="8e521-250">This method needs to be called in two circumstances: when the page is initially loaded and when the selected role in the `RoleList` DropDownList changes.</span></span> <span data-ttu-id="8e521-251">このため、更新、`Page_Load`イベント ハンドラー呼び出しの後にこのメソッドが呼び出されるように`CheckRolesForSelectedUser`です。</span><span class="sxs-lookup"><span data-stu-id="8e521-251">Therefore, update the `Page_Load` event handler so that this method is invoked after the call to `CheckRolesForSelectedUser`.</span></span> <span data-ttu-id="8e521-252">イベント ハンドラーを次に、作成、`RoleList`の`SelectedIndexChanged`イベント、しすぎるそこから、このメソッドを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="8e521-252">Next, create an event handler for the `RoleList`'s `SelectedIndexChanged` event, and call this method from there, too.</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample15.vb)]

<span data-ttu-id="8e521-253">代わりに、このコードで、 `RolesUserList` GridView で選択したロールに属しているユーザーを表示する必要があります。</span><span class="sxs-lookup"><span data-stu-id="8e521-253">With this code in place, the `RolesUserList` GridView should display those users that belong to the selected role.</span></span> <span data-ttu-id="8e521-254">スーパーバイザー ロールが 2 つのメンバーで構成図 6 に示す: ブルースと Tito です。</span><span class="sxs-lookup"><span data-stu-id="8e521-254">As Figure 6 shows, the Supervisors role consists of two members: Bruce and Tito.</span></span>


<span data-ttu-id="8e521-255">[![GridView は、選択したロールに属しているユーザーを一覧表示します。](assigning-roles-to-users-vb/_static/image17.png)](assigning-roles-to-users-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="8e521-255">[![The GridView Lists Those Users That Belong to the Selected Role](assigning-roles-to-users-vb/_static/image17.png)](assigning-roles-to-users-vb/_static/image16.png)</span></span>

<span data-ttu-id="8e521-256">**図 6**: GridView を一覧表示、ユーザーに属している、選択したロール ([フルサイズのイメージを表示するをクリックして](assigning-roles-to-users-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="8e521-256">**Figure 6**: The GridView Lists Those Users That Belong to the Selected Role  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image18.png))</span></span>


### <a name="removing-users-from-the-selected-role"></a><span data-ttu-id="8e521-257">選択したロールからユーザーを削除します。</span><span class="sxs-lookup"><span data-stu-id="8e521-257">Removing Users from the Selected Role</span></span>

<span data-ttu-id="8e521-258">みましょう補強、 `RolesUserList` GridView の列が含まれるように [削除] ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="8e521-258">Let's augment the `RolesUserList` GridView so that it includes a column of "Remove" buttons.</span></span> <span data-ttu-id="8e521-259">特定のユーザーの「削除」 をクリックしては、そのロールから削除されます。</span><span class="sxs-lookup"><span data-stu-id="8e521-259">Clicking the "Remove" button for a particular user will remove them from that role.</span></span>

<span data-ttu-id="8e521-260">GridView に削除ボタン フィールドを追加することで開始します。</span><span class="sxs-lookup"><span data-stu-id="8e521-260">Start by adding a Delete button field to the GridView.</span></span> <span data-ttu-id="8e521-261">このフィールドを左側の最もフィールドとして表示され、変更を行うその`DeleteText`プロパティを"Delete"(既定値) から「削除」にします。</span><span class="sxs-lookup"><span data-stu-id="8e521-261">Make this field appear as the left most filed and change its `DeleteText` property from "Delete" (the default) to "Remove".</span></span>


<span data-ttu-id="8e521-262">[![追加します](assigning-roles-to-users-vb/_static/image20.png)](assigning-roles-to-users-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="8e521-262">[![Add the](assigning-roles-to-users-vb/_static/image20.png)](assigning-roles-to-users-vb/_static/image19.png)</span></span>

<span data-ttu-id="8e521-263">**図 7**: GridView に、「削除」ボタンを追加 ([フルサイズのイメージを表示するをクリックして](assigning-roles-to-users-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="8e521-263">**Figure 7**: Add the "Remove" Button to the GridView  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image21.png))</span></span>


<span data-ttu-id="8e521-264">[削除] ボタンをクリックするとポストバックに陥りますおよび GridView の`RowDeleting`イベントが発生します。</span><span class="sxs-lookup"><span data-stu-id="8e521-264">When the "Remove" button is clicked a postback ensues and the GridView's `RowDeleting` event is raised.</span></span> <span data-ttu-id="8e521-265">このイベントのイベント ハンドラーを作成し、選択したロールからユーザーを削除するコードを記述する必要があります。</span><span class="sxs-lookup"><span data-stu-id="8e521-265">We need to create an event handler for this event and write code that removes the user from the selected role.</span></span> <span data-ttu-id="8e521-266">イベント ハンドラーを作成し、次のコードを追加します。</span><span class="sxs-lookup"><span data-stu-id="8e521-266">Create the event handler and then add the following code:</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample16.vb)]

<span data-ttu-id="8e521-267">選択したロール名を決定することにより、コードを開始します。</span><span class="sxs-lookup"><span data-stu-id="8e521-267">The code starts by determining the selected role name.</span></span> <span data-ttu-id="8e521-268">次にプログラムで参照、`UserNameLabel`が [削除] ボタンがクリックされたを削除するユーザーのユーザー名を判断するための行からコントロール。</span><span class="sxs-lookup"><span data-stu-id="8e521-268">It then programmatically references the `UserNameLabel` control from the row whose "Remove" button was clicked in order to determine the UserName of the user to remove.</span></span> <span data-ttu-id="8e521-269">呼び出しを使用して、ロールからユーザーを削除、`Roles.RemoveUserFromRole`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="8e521-269">The user is then removed from the role via a call to the `Roles.RemoveUserFromRole` method.</span></span> <span data-ttu-id="8e521-270">`RolesUserList` GridView は、更新および経由でメッセージが表示されます、`ActionStatus`ラベル コントロール。</span><span class="sxs-lookup"><span data-stu-id="8e521-270">The `RolesUserList` GridView is then refreshed and a message is displayed via the `ActionStatus` Label control.</span></span>

> [!NOTE]
> <span data-ttu-id="8e521-271">「削除」ボタンには、あらゆる種類のロールからユーザーを削除する前に、ユーザーから送信される確認は不要です。</span><span class="sxs-lookup"><span data-stu-id="8e521-271">The "Remove" button does not require any sort of confirmation from the user before removing the user from the role.</span></span> <span data-ttu-id="8e521-272">すればを招待するユーザーの確認のいくつかのレベルを追加します。</span><span class="sxs-lookup"><span data-stu-id="8e521-272">I invite you to add some level of user confirmation.</span></span> <span data-ttu-id="8e521-273">クライアント側の確認 ダイアログ ボックスで、操作を確認する最も簡単な方法の 1 つです。</span><span class="sxs-lookup"><span data-stu-id="8e521-273">One of the easiest ways to confirm an action is through a client-side confirm dialog box.</span></span> <span data-ttu-id="8e521-274">この方法の詳細については、次を参照してください。[削除時にクライアント側の確認を追加する](https://asp.net/learn/data-access/tutorial-42-vb.aspx)です。</span><span class="sxs-lookup"><span data-stu-id="8e521-274">For more information on this technique, see [Adding Client-Side Confirmation When Deleting](https://asp.net/learn/data-access/tutorial-42-vb.aspx).</span></span>


<span data-ttu-id="8e521-275">図 8 は、ユーザー Tito が管理者グループから削除された後に、ページを示します。</span><span class="sxs-lookup"><span data-stu-id="8e521-275">Figure 8 shows the page after user Tito has been removed from the Supervisors group.</span></span>


<span data-ttu-id="8e521-276">[![残念ながら、Tito が不要になったスーパーバイザーです。](assigning-roles-to-users-vb/_static/image23.png)](assigning-roles-to-users-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="8e521-276">[![Alas, Tito is No Longer a Supervisor](assigning-roles-to-users-vb/_static/image23.png)](assigning-roles-to-users-vb/_static/image22.png)</span></span>

<span data-ttu-id="8e521-277">**図 8**: 残念ながら、Tito が不要になったスーパーバイザー ([フルサイズのイメージを表示するをクリックして](assigning-roles-to-users-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="8e521-277">**Figure 8**: Alas, Tito is No Longer a Supervisor  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image24.png))</span></span>


### <a name="adding-new-users-to-the-selected-role"></a><span data-ttu-id="8e521-278">選択したロールに新しいユーザーを追加します。</span><span class="sxs-lookup"><span data-stu-id="8e521-278">Adding New Users to the Selected Role</span></span>

<span data-ttu-id="8e521-279">場合、選択したロールからユーザーを削除すると共に、このページに訪問者のユーザーを選択したロールに追加することも場合があります。</span><span class="sxs-lookup"><span data-stu-id="8e521-279">Along with removing users from the selected role, the visitor to this page should also be able to add a user to the selected role.</span></span> <span data-ttu-id="8e521-280">選択したロールにユーザーを追加するための最適なインターフェイスは、ユーザー アカウントが予想される数に依存します。</span><span class="sxs-lookup"><span data-stu-id="8e521-280">The best interface for adding a user to the selected role depends on the number of user accounts you expect to have.</span></span> <span data-ttu-id="8e521-281">Web サイトは、わずか 1 ダースのユーザー アカウントを格納する以下の場合、DropDownList をここで使用する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="8e521-281">If your website will house just a few dozen user accounts or less, you could use a DropDownList here.</span></span> <span data-ttu-id="8e521-282">何千ものユーザー アカウントである可能性がありますはする場合、検索、特定のアカウントのアカウントを複数のページまたはその他の何らかの方法でユーザー アカウントをフィルター処理するビジターを許可するユーザー インターフェイスが含まれます。</span><span class="sxs-lookup"><span data-stu-id="8e521-282">If there might be thousands of user accounts, you would want to include a user interface that permits the visitor to page through the accounts, search for a particular account, or filter the user accounts in some other fashion.</span></span>

<span data-ttu-id="8e521-283">このページのユーザー アカウントの数に関係なく、システムで動作する非常に単純なインターフェイスを利用してみましょう。</span><span class="sxs-lookup"><span data-stu-id="8e521-283">For this page let's use a very simple interface that works regardless of the number of user accounts in the system.</span></span> <span data-ttu-id="8e521-284">つまり、選択したロールに追加するユーザーのユーザー名を入力するビジターのメッセージを表示、テキスト ボックスを使用します。</span><span class="sxs-lookup"><span data-stu-id="8e521-284">Namely, we will use a TextBox, prompting the visitor to type in the username of the user she wants to add to the selected role.</span></span> <span data-ttu-id="8e521-285">その名前を持つユーザーが存在しない、または、ユーザーが既にロールのメンバーである場合にメッセージを表示します`ActionStatus`ラベル。</span><span class="sxs-lookup"><span data-stu-id="8e521-285">If no user with that name exists, or if the user is already a member of the role, we'll display a message in `ActionStatus` Label.</span></span> <span data-ttu-id="8e521-286">ユーザーが存在し、ロールのメンバーではない場合は、ロールに追加し、グリッドを更新おします。</span><span class="sxs-lookup"><span data-stu-id="8e521-286">But if the user exists and is not a member of the role, we'll add them to the role and refresh the grid.</span></span>

<span data-ttu-id="8e521-287">テキスト ボックスと GridView の下にあるボタンを追加します。</span><span class="sxs-lookup"><span data-stu-id="8e521-287">Add a TextBox and Button beneath the GridView.</span></span> <span data-ttu-id="8e521-288">テキスト ボックスの設定`ID`に`UserNameToAddToRole`ボタンの設定と`ID`と`Text`プロパティ`AddUserToRoleButton`と「ユーザー ロールを追加」、それぞれします。</span><span class="sxs-lookup"><span data-stu-id="8e521-288">Set the TextBox's `ID` to `UserNameToAddToRole` and set the Button's `ID` and `Text` properties to `AddUserToRoleButton` and "Add User to Role", respectively.</span></span>

[!code-aspx[Main](assigning-roles-to-users-vb/samples/sample17.aspx)]

<span data-ttu-id="8e521-289">次に、作成、`Click`のイベント ハンドラー、`AddUserToRoleButton`し、次のコードを追加します。</span><span class="sxs-lookup"><span data-stu-id="8e521-289">Next, create a `Click` event handler for the `AddUserToRoleButton` and add the following code:</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample18.vb)]

<span data-ttu-id="8e521-290">内のコードの大部分、`Click`イベント ハンドラーは、さまざまな検証チェックを実行します。</span><span class="sxs-lookup"><span data-stu-id="8e521-290">The majority of the code in the `Click` event handler performs various validation checks.</span></span> <span data-ttu-id="8e521-291">訪問者が内のユーザー名を提供することを確認、 `UserNameToAddToRole`  ボックスに、ユーザーは、システムに存在して、選択したロールに既に属しているしないことです。</span><span class="sxs-lookup"><span data-stu-id="8e521-291">It ensures that the visitor supplied a username in the `UserNameToAddToRole` TextBox, that the user exists in the system, and that they don't already belong to the selected role.</span></span> <span data-ttu-id="8e521-292">適切なメッセージが表示される場合、これらのいずれかの確認が失敗した、`ActionStatus`し、イベント ハンドラーが終了しました。</span><span class="sxs-lookup"><span data-stu-id="8e521-292">If any of these checks fails, an appropriate message is displayed in `ActionStatus` and the event handler is exited.</span></span> <span data-ttu-id="8e521-293">ユーザーが経由でロールを追加、すべてのチェックに合格した場合、`Roles.AddUserToRole`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="8e521-293">If all of the checks pass, the user is added to the role via the `Roles.AddUserToRole` method.</span></span> <span data-ttu-id="8e521-294">次に、テキスト ボックスの`Text`プロパティがオフ、GridView が更新されると、および`ActionStatus`ラベルには、指定されたユーザーが選択した役割を正常に追加されたことを示すメッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="8e521-294">Following that, the TextBox's `Text` property is cleared out, the GridView is refreshed, and the `ActionStatus` Label displays a message indicating that the specified user was successfully added to the selected role.</span></span>

> [!NOTE]
> <span data-ttu-id="8e521-295">指定されたユーザーは既にに属していないこと、選択したロールには、使用して、 [ `Roles.IsUserInRole(userName, roleName)`メソッド](https://msdn.microsoft.com/en-us/library/system.web.security.roles.isuserinrole.aspx)を示すブール値を返すことをするかどうか*ユーザー名*のメンバーである*roleName*です。</span><span class="sxs-lookup"><span data-stu-id="8e521-295">To ensure that the specified user does not already belong to the selected role, we use the [`Roles.IsUserInRole(userName, roleName)` method](https://msdn.microsoft.com/en-us/library/system.web.security.roles.isuserinrole.aspx), which returns a Boolean value indicating whether *userName* is a member of *roleName*.</span></span> <span data-ttu-id="8e521-296">内で再度このメソッドを使用しては、 <a id="_msoanchor_2"> </a>[次のチュートリアル](role-based-authorization-vb.md)ロールベースの承認を見てとき。</span><span class="sxs-lookup"><span data-stu-id="8e521-296">We will use this method again in the <a id="_msoanchor_2"></a>[next tutorial](role-based-authorization-vb.md) when we look at role-based authorization.</span></span>


<span data-ttu-id="8e521-297">ブラウザーでページを参照してくださいからスーパーバイザー ロールをクリックし、 `RoleList` DropDownList です。</span><span class="sxs-lookup"><span data-stu-id="8e521-297">Visit the page through a browser and select the Supervisors role from the `RoleList` DropDownList.</span></span> <span data-ttu-id="8e521-298">無効なユーザー名を入力してください: ユーザーがシステムに存在しないことを示すメッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="8e521-298">Try entering an invalid username – you should see a message explaining that the user does not exist in the system.</span></span>


<span data-ttu-id="8e521-299">[![ロールに存在しないユーザーを追加することはできません。](assigning-roles-to-users-vb/_static/image26.png)](assigning-roles-to-users-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="8e521-299">[![You Cannot Add a Non-Existent User to a Role](assigning-roles-to-users-vb/_static/image26.png)](assigning-roles-to-users-vb/_static/image25.png)</span></span>

<span data-ttu-id="8e521-300">**図 9**: 存在しないユーザーをロールに追加することはできません ([フルサイズのイメージを表示するをクリックして](assigning-roles-to-users-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="8e521-300">**Figure 9**: You Cannot Add a Non-Existent User to a Role  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image27.png))</span></span>


<span data-ttu-id="8e521-301">有効なユーザーを追加してみましょう。</span><span class="sxs-lookup"><span data-stu-id="8e521-301">Now try adding a valid user.</span></span> <span data-ttu-id="8e521-302">スーパーバイザー ロールに Tito を再度追加してください。</span><span class="sxs-lookup"><span data-stu-id="8e521-302">Go ahead and re-add Tito to the Supervisors role.</span></span>


<span data-ttu-id="8e521-303">[![Tito は、もう一度スーパーバイザーです!](assigning-roles-to-users-vb/_static/image29.png)](assigning-roles-to-users-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="8e521-303">[![Tito Is Once Again a Supervisor!](assigning-roles-to-users-vb/_static/image29.png)](assigning-roles-to-users-vb/_static/image28.png)</span></span>

<span data-ttu-id="8e521-304">**図 10**: Tito はスーパーバイザー、もう一度!</span><span class="sxs-lookup"><span data-stu-id="8e521-304">**Figure 10**: Tito Is Once Again a Supervisor!</span></span>  <span data-ttu-id="8e521-305">([フルサイズのイメージを表示するをクリックして](assigning-roles-to-users-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="8e521-305">([Click to view full-size image](assigning-roles-to-users-vb/_static/image30.png))</span></span>


## <a name="step-3-cross-updating-the-by-user-and-by-role-interfaces"></a><span data-ttu-id="8e521-306">手順 3: クロス更新、「ユーザー"と」ロール"インターフェイス</span><span class="sxs-lookup"><span data-stu-id="8e521-306">Step 3: Cross-Updating the "By User" and "By Role" Interfaces</span></span>

<span data-ttu-id="8e521-307">`UsersAndRoles.aspx`ページには、ユーザーおよびロールを管理するための 2 つの異なるインターフェイスが用意されています。</span><span class="sxs-lookup"><span data-stu-id="8e521-307">The `UsersAndRoles.aspx` page offers two distinct interfaces for managing users and roles.</span></span> <span data-ttu-id="8e521-308">現時点では、ため、1 つのインターフェイスで行われた変更はすぐに反映されません、他のことは、これら 2 つのインターフェイスは互いに動作します。</span><span class="sxs-lookup"><span data-stu-id="8e521-308">Currently, these two interfaces act independently of one another so it is possible that a change made in one interface will not be reflected immediately in the other.</span></span> <span data-ttu-id="8e521-309">たとえば、ページに訪問者からスーパーバイザー ロールを選択すること、 `RoleList` DropDownList で、そのメンバーとしてブルースと Tito の一覧を示します。</span><span class="sxs-lookup"><span data-stu-id="8e521-309">For example, imagine that the visitor to the page selects the Supervisors role from the `RoleList` DropDownList, which lists Bruce and Tito as its members.</span></span> <span data-ttu-id="8e521-310">次に、訪問者が Tito からを選択、`UserList`管理者と管理者のチェック ボックスがチェックインの DropDownList、`UsersRoleList`リピータします。</span><span class="sxs-lookup"><span data-stu-id="8e521-310">Next, the visitor selects Tito from the `UserList` DropDownList, which checks the Administrators and Supervisors checkboxes in the `UsersRoleList` Repeater.</span></span> <span data-ttu-id="8e521-311">訪問者には、リピータからスーパーバイザー ロールがオフにし場合、は、Tito はスーパーバイザー ロールから削除されますが、"ロール"でインターフェイスにこの変更は反映されません。</span><span class="sxs-lookup"><span data-stu-id="8e521-311">If the visitor then unchecks the Supervisor role from the Repeater, Tito is removed from the Supervisors role, but this modification is not reflected in the "by role" interface.</span></span> <span data-ttu-id="8e521-312">GridView は、管理者ロールのメンバーとして Tito を引き続き表示されます。</span><span class="sxs-lookup"><span data-stu-id="8e521-312">The GridView will still show Tito as being a member of the Supervisors role.</span></span>

<span data-ttu-id="8e521-313">ロールが checked または unchecked から GridView を更新する必要がありますこれを解決する、`UsersRoleList`リピータします。</span><span class="sxs-lookup"><span data-stu-id="8e521-313">To fix this we need to refresh the GridView whenever a role is checked or unchecked from the `UsersRoleList` Repeater.</span></span> <span data-ttu-id="8e521-314">同様に、ユーザーが削除されるか、"ロール"でインターフェイスからロールに追加されるたびにリピータを更新する必要があります。</span><span class="sxs-lookup"><span data-stu-id="8e521-314">Likewise, we need to refresh the Repeater whenever a user is removed or added to a role from the "by role" interface.</span></span>

<span data-ttu-id="8e521-315">"によって"のユーザー インターフェイスにリピータが呼び出すことによって更新される、`CheckRolesForSelectedUser`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="8e521-315">The Repeater in the "by user" interface is refreshed by calling the `CheckRolesForSelectedUser` method.</span></span> <span data-ttu-id="8e521-316">"ロール"でインターフェイスを変更できる、 `RolesUserList` GridView の`RowDeleting`イベント ハンドラーと`AddUserToRoleButton`ボタンの`Click`イベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="8e521-316">The "by role" interface can be modified in the `RolesUserList` GridView's `RowDeleting` event handler and the `AddUserToRoleButton` Button's `Click` event handler.</span></span> <span data-ttu-id="8e521-317">したがってを呼び出す必要があります、`CheckRolesForSelectedUser`からこれらの各メソッドのメソッドです。</span><span class="sxs-lookup"><span data-stu-id="8e521-317">Therefore, we need to call the `CheckRolesForSelectedUser` method from each of these methods.</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample19.vb)]

<span data-ttu-id="8e521-318">同様に、"ロール"でインターフェイスの GridView が呼び出すことによってに更新される、`DisplayUsersBelongingToRole`メソッドと、"によって"のユーザー インターフェイスを通じて変更が、`RoleCheckBox_CheckChanged`イベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="8e521-318">Similarly, the GridView in the "by role" interface is refreshed by calling the `DisplayUsersBelongingToRole` method and the "by user" interface is modified through the `RoleCheckBox_CheckChanged` event handler.</span></span> <span data-ttu-id="8e521-319">したがってを呼び出す必要があります、`DisplayUsersBelongingToRole`このイベント ハンドラーからメソッドです。</span><span class="sxs-lookup"><span data-stu-id="8e521-319">Therefore, we need to call the `DisplayUsersBelongingToRole` method from this event handler.</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample20.vb)]

<span data-ttu-id="8e521-320">これらのコードの軽微な変更により、今すぐインターフェイス"でユーザー"と"ロール"で正しく更新プログラムの間です。</span><span class="sxs-lookup"><span data-stu-id="8e521-320">With these minor code changes, the "by user" and "by role" interfaces now correctly cross-update.</span></span> <span data-ttu-id="8e521-321">これを確認するには、ブラウザーでページを参照してください Tito およびからスーパーバイザーをクリックし、`UserList`と`RoleList`DropDownLists、それぞれします。</span><span class="sxs-lookup"><span data-stu-id="8e521-321">To verify this, visit the page through a browser and select Tito and Supervisors from the `UserList` and `RoleList` DropDownLists, respectively.</span></span> <span data-ttu-id="8e521-322">"によって"のユーザー インターフェイスにリピータから Tito の監督者の役割をオフにするとその Tito が自動的に"role"でインターフェイスの GridView から削除することに注意してください。</span><span class="sxs-lookup"><span data-stu-id="8e521-322">Note that as you uncheck the Supervisors role for Tito from the Repeater in the "by user" interface, Tito is automatically removed from the GridView in the "by role" interface.</span></span> <span data-ttu-id="8e521-323">Tito スーパーバイザー ロールに"ロール"でインターフェイスから自動的に再チェックの追加"によって"のユーザー インターフェイスで [監督者] チェック ボックスです。</span><span class="sxs-lookup"><span data-stu-id="8e521-323">Adding Tito back to the Supervisors role from the "by role" interface automatically re-checks the Supervisors checkbox in the "by user" interface.</span></span>

## <a name="step-4-customizing-the-createuserwizard-to-include-a-specify-roles-step"></a><span data-ttu-id="8e521-324">手順 4:「の役割を指定する」手順を含める CreateUserWizard をカスタマイズします。</span><span class="sxs-lookup"><span data-stu-id="8e521-324">Step 4: Customizing the CreateUserWizard to Include a "Specify Roles" Step</span></span>

<span data-ttu-id="8e521-325"><a id="_msoanchor_3"> </a> [*ユーザー アカウントを作成する*](../membership/creating-user-accounts-vb.md)チュートリアル CreateUserWizard Web コントロールを使用して、新しいユーザー アカウントを作成するためのインターフェイスを提供する方法を説明しました。</span><span class="sxs-lookup"><span data-stu-id="8e521-325">In the <a id="_msoanchor_3"></a>[*Creating User Accounts*](../membership/creating-user-accounts-vb.md) tutorial we saw how to use the CreateUserWizard Web control to provide an interface for creating a new user account.</span></span> <span data-ttu-id="8e521-326">CreateUserWizard コントロールは、2 つの方法のいずれかで使用できます。</span><span class="sxs-lookup"><span data-stu-id="8e521-326">The CreateUserWizard control can be used in one of two ways:</span></span>

- <span data-ttu-id="8e521-327">訪問者をサイトで、自分のユーザー アカウントを作成するための手段として、</span><span class="sxs-lookup"><span data-stu-id="8e521-327">As a means for visitors to create their own user account on the site, and</span></span>
- <span data-ttu-id="8e521-328">管理者は新しいアカウントを作成するための手段として</span><span class="sxs-lookup"><span data-stu-id="8e521-328">As a means for administrators to create new accounts</span></span>

<span data-ttu-id="8e521-329">最初のユース ケースでは、訪問者は、サイトの訪問し、サイトに登録するために、それらの情報を入力する、CreateUserWizard に入力します。</span><span class="sxs-lookup"><span data-stu-id="8e521-329">In the first use case, a visitor comes to the site and fills out the CreateUserWizard, entering their information in order to register on the site.</span></span> <span data-ttu-id="8e521-330">2 番目のケースでは、管理者は、他のユーザーの新しいアカウントを作成します。</span><span class="sxs-lookup"><span data-stu-id="8e521-330">In the second case, an administrator creates a new account for another person.</span></span>

<span data-ttu-id="8e521-331">ほかの人の管理者アカウントが作成されている、ときに、管理者が新しいユーザー アカウントに属しているロールを指定できるようにすると役立つ場合があります。</span><span class="sxs-lookup"><span data-stu-id="8e521-331">When an account is being created by an administrator for some other person, it might be helpful to allow the administrator to specify what roles the new user account belongs to.</span></span> <span data-ttu-id="8e521-332"><a id="_msoanchor_4"> </a> [*格納**追加のユーザー情報*](../membership/storing-additional-user-information-vb.md)チュートリアル、CreateUserWizard を追加してカスタマイズする方法を説明しました`WizardSteps`.</span><span class="sxs-lookup"><span data-stu-id="8e521-332">In the <a id="_msoanchor_4"></a>[*Storing* *Additional User Information*](../membership/storing-additional-user-information-vb.md) tutorial we saw how to customize the CreateUserWizard by adding additional `WizardSteps`.</span></span> <span data-ttu-id="8e521-333">新しいユーザーのロールを指定するために、CreateUserWizard に、追加の手順を追加する方法を見てみましょう。</span><span class="sxs-lookup"><span data-stu-id="8e521-333">Let's look at how to add an additional step to the CreateUserWizard in order to specify the new user's roles.</span></span>

<span data-ttu-id="8e521-334">開く、`CreateUserWizardWithRoles.aspx`ページおよびという名前の CreateUserWizard コントロールを追加`RegisterUserWithRoles`です。</span><span class="sxs-lookup"><span data-stu-id="8e521-334">Open the `CreateUserWizardWithRoles.aspx` page and add a CreateUserWizard control named `RegisterUserWithRoles`.</span></span> <span data-ttu-id="8e521-335">コントロールの設定`ContinueDestinationPageUrl`プロパティを"~/Default.aspx"です。</span><span class="sxs-lookup"><span data-stu-id="8e521-335">Set the control's `ContinueDestinationPageUrl` property to "~/Default.aspx".</span></span> <span data-ttu-id="8e521-336">この考え方がいる管理者を使用するこの CreateUserWizard コントロールを新しいユーザー アカウントを作成するための設定コントロールの`LoginCreatedUser`プロパティを False にします。</span><span class="sxs-lookup"><span data-stu-id="8e521-336">Because the idea here is that an administrator will be using this CreateUserWizard control to create new user accounts, set the control's `LoginCreatedUser` property to False.</span></span> <span data-ttu-id="8e521-337">これは、`LoginCreatedUser`プロパティ訪問者が自動的にだけが作成したユーザーとしてログオンし、既定値は True かどうかを指定します。</span><span class="sxs-lookup"><span data-stu-id="8e521-337">This `LoginCreatedUser` property specifies whether the visitor is automatically logged on as the just-created user, and it defaults to True.</span></span> <span data-ttu-id="8e521-338">お False に設定管理者が新しいアカウントを作成するには、彼の自分自身のアカウントでサインインしてください。</span><span class="sxs-lookup"><span data-stu-id="8e521-338">We set it to False because when an administrator creates a new account we want to keep him signed in as himself.</span></span>

<span data-ttu-id="8e521-339">次に、選択、"追加/削除`WizardSteps`..."</span><span class="sxs-lookup"><span data-stu-id="8e521-339">Next, select the "Add/Remove `WizardSteps`…"</span></span> <span data-ttu-id="8e521-340">CreateUserWizard のスマート タグからオプションを追加、新しい`WizardStep`、設定、`ID`に`SpecifyRolesStep`です。</span><span class="sxs-lookup"><span data-stu-id="8e521-340">option from the CreateUserWizard's Smart Tag and add a new `WizardStep`, setting its `ID` to `SpecifyRolesStep`.</span></span> <span data-ttu-id="8e521-341">移動、 `SpecifyRolesStep WizardStep` 「記号に、新しいアカウント」手順の後に、「完了」手順の前になるようにします。</span><span class="sxs-lookup"><span data-stu-id="8e521-341">Move the `SpecifyRolesStep WizardStep` so that it comes after the "Sign Up for Your New Account" step, but before the "Complete" step.</span></span> <span data-ttu-id="8e521-342">設定、`WizardStep`の`Title`プロパティを"Roles"を指定して、その`StepType`プロパティを`Step`、およびその`AllowReturn`プロパティを False にします。</span><span class="sxs-lookup"><span data-stu-id="8e521-342">Set the `WizardStep`'s `Title` property to "Specify Roles", its `StepType` property to `Step`, and its `AllowReturn` property to False.</span></span>


<span data-ttu-id="8e521-343">[![追加します](assigning-roles-to-users-vb/_static/image32.png)](assigning-roles-to-users-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="8e521-343">[![Add the](assigning-roles-to-users-vb/_static/image32.png)](assigning-roles-to-users-vb/_static/image31.png)</span></span>

<span data-ttu-id="8e521-344">**図 11**: ロールを追加する"を指定する" `WizardStep` 、CreateUserWizard に ([フルサイズのイメージを表示するをクリックして](assigning-roles-to-users-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="8e521-344">**Figure 11**: Add the "Specify Roles" `WizardStep` to the CreateUserWizard  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image33.png))</span></span>


<span data-ttu-id="8e521-345">この変更後に CreateUserWizard の宣言型マークアップは、次のようになります。</span><span class="sxs-lookup"><span data-stu-id="8e521-345">After this change your CreateUserWizard's declarative markup should look like the following:</span></span>

[!code-aspx[Main](assigning-roles-to-users-vb/samples/sample21.aspx)]

<span data-ttu-id="8e521-346">「を指定のロール」の`WizardStep`、CheckBoxList という名前の追加`RoleList.`この CheckBoxList に利用可能な役割は一覧表示、新しく作成されたユーザーが所属するロールを確認する人、ページにアクセスを有効にします。</span><span class="sxs-lookup"><span data-stu-id="8e521-346">In the "Specify Roles" `WizardStep`, add a CheckBoxList named `RoleList.` This CheckBoxList will list the available roles, enabling the person visiting the page to check what roles the newly created user belongs to.</span></span>

<span data-ttu-id="8e521-347">2 つのコーディング作業が残さお: おを設定する必要があります最初、`RoleList`システムの役割を持つ CheckBoxList 第二に、ユーザーが指定「ロール」手順「完了」手順に移動すると、選択した役割に、作成したユーザーを追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="8e521-347">We are left with two coding tasks: first we must populate the `RoleList` CheckBoxList with the roles in the system; second, we need to add the created user to the selected roles when the user moves from the "Specify Roles" step to the "Complete" step.</span></span> <span data-ttu-id="8e521-348">最初のタスクを行うには、`Page_Load`イベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="8e521-348">We can accomplish the first task in the `Page_Load` event handler.</span></span> <span data-ttu-id="8e521-349">次のコードの参照でプログラムによって、`RoleList`を最初にチェック ボックス ページにアクセスしてし、をシステムの役割をバインドします。</span><span class="sxs-lookup"><span data-stu-id="8e521-349">The following code programmatically references the `RoleList` CheckBox on the first visit to the page and binds the roles in the system to it.</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample22.vb)]

<span data-ttu-id="8e521-350">上記のコードは、使い慣れたはずです。</span><span class="sxs-lookup"><span data-stu-id="8e521-350">The above code should look familiar.</span></span> <span data-ttu-id="8e521-351"><a id="_msoanchor_5"> </a> [*格納**追加のユーザー情報*](../membership/storing-additional-user-information-vb.md) 2 つを使用したチュートリアル`FindControl`Web コントロールを参照するステートメントカスタム内`WizardStep`です。</span><span class="sxs-lookup"><span data-stu-id="8e521-351">In the <a id="_msoanchor_5"></a>[*Storing* *Additional User Information*](../membership/storing-additional-user-information-vb.md) tutorial we used two `FindControl` statements to reference a Web control from within a custom `WizardStep`.</span></span> <span data-ttu-id="8e521-352">および CheckBoxList にロールをバインドするコードは、このチュートリアルで先ほどから取得されました。</span><span class="sxs-lookup"><span data-stu-id="8e521-352">And the code that binds the roles to the CheckBoxList was taken from earlier in this tutorial.</span></span>

<span data-ttu-id="8e521-353">2 番目のプログラミング タスクを実行するためには、「ロールの指定」手順が完了したときに知っている必要があります。</span><span class="sxs-lookup"><span data-stu-id="8e521-353">In order to perform the second programming task we need to know when the "Specify Roles" step has been completed.</span></span> <span data-ttu-id="8e521-354">CreateUserWizard が取り消し、`ActiveStepChanged`訪問者が 1 つのステップから別に移動するたびに起動するイベントです。</span><span class="sxs-lookup"><span data-stu-id="8e521-354">Recall that the CreateUserWizard has an `ActiveStepChanged` event, which fires each time the visitor navigates from one step to another.</span></span> <span data-ttu-id="8e521-355">ここで、ユーザーが「完了」手順; に達したかどうかを判断できます。場合は、選択したロールにユーザーを追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="8e521-355">Here we can determine if the user has reached the "Complete" step; if so, we need to add the user to the selected roles.</span></span>

<span data-ttu-id="8e521-356">イベント ハンドラーを作成、`ActiveStepChanged`イベントし、次のコードを追加します。</span><span class="sxs-lookup"><span data-stu-id="8e521-356">Create an event handler for the `ActiveStepChanged` event and add the following code:</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample23.vb)]

<span data-ttu-id="8e521-357">イベント ハンドラーがの項目を列挙する場合は、ユーザーは、「完了」手順と同様に達しました、 `RoleList` CheckBoxList とだけで作成されたユーザーが選択した役割に割り当てられます。</span><span class="sxs-lookup"><span data-stu-id="8e521-357">If the user has just reached the "Completed" step, the event handler enumerates the items of the `RoleList` CheckBoxList and the just-created user is assigned to the selected roles.</span></span>

<span data-ttu-id="8e521-358">ブラウザーからこのページを参照してください。</span><span class="sxs-lookup"><span data-stu-id="8e521-358">Visit this page through a browser.</span></span> <span data-ttu-id="8e521-359">CreateUserWizard の最初の手順は、標準の「記号に、新しいアカウント」の手順は、新しいユーザーのユーザー名、パスワード、電子メール、およびその他の重要な情報の入力を求めるです。</span><span class="sxs-lookup"><span data-stu-id="8e521-359">The first step in the CreateUserWizard is the standard "Sign Up for Your New Account" step, which prompts for the new user's username, password, email, and other key information.</span></span> <span data-ttu-id="8e521-360">Wanda をという名前の新しいユーザーを作成する情報を入力します。</span><span class="sxs-lookup"><span data-stu-id="8e521-360">Enter the information to create a new user named Wanda.</span></span>


<span data-ttu-id="8e521-361">[![Wanda をという名前の新しいユーザーを作成します。](assigning-roles-to-users-vb/_static/image35.png)](assigning-roles-to-users-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="8e521-361">[![Create a New User Named Wanda](assigning-roles-to-users-vb/_static/image35.png)](assigning-roles-to-users-vb/_static/image34.png)</span></span>

<span data-ttu-id="8e521-362">**図 12**: 新しいユーザーという Wanda の作成 ([フルサイズのイメージを表示するをクリックして](assigning-roles-to-users-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="8e521-362">**Figure 12**: Create a New User Named Wanda  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image36.png))</span></span>


<span data-ttu-id="8e521-363">"Create User"ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="8e521-363">Click the "Create User" button.</span></span> <span data-ttu-id="8e521-364">CreateUserWizard を内部的に呼び出して、`Membership.CreateUser`方法、新しいユーザー アカウントとし、進行状況に応じて次の手順に作成する「を指定するロールです」。</span><span class="sxs-lookup"><span data-stu-id="8e521-364">The CreateUserWizard internally calls the `Membership.CreateUser` method, creating the new user account, and then progresses to the next step, "Specify Roles."</span></span> <span data-ttu-id="8e521-365">ここでは、システムの役割が一覧表示されます。</span><span class="sxs-lookup"><span data-stu-id="8e521-365">Here the system roles are listed.</span></span> <span data-ttu-id="8e521-366">監督者のチェック ボックスを確認し、[次へ] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="8e521-366">Check the Supervisors checkbox and click Next.</span></span>


<span data-ttu-id="8e521-367">[![Wanda スーパーバイザー ロールのメンバーにします。](assigning-roles-to-users-vb/_static/image38.png)](assigning-roles-to-users-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="8e521-367">[![Make Wanda a Member of the Supervisors Role](assigning-roles-to-users-vb/_static/image38.png)](assigning-roles-to-users-vb/_static/image37.png)</span></span>

<span data-ttu-id="8e521-368">**図 13**: Wanda スーパーバイザー ロールのメンバーにする ([フルサイズのイメージを表示するをクリックして](assigning-roles-to-users-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="8e521-368">**Figure 13**: Make Wanda a Member of the Supervisors Role  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image39.png))</span></span>


<span data-ttu-id="8e521-369">ポストバックと更新プログラム [次へ] をクリックすると、 `ActiveStep` 「完了」手順にします。</span><span class="sxs-lookup"><span data-stu-id="8e521-369">Clicking Next causes a postback and updates the `ActiveStep` to the "Complete" step.</span></span> <span data-ttu-id="8e521-370">`ActiveStepChanged` 、イベント ハンドラー、最近作成されたユーザー アカウントは、管理者ロールに割り当てられます。</span><span class="sxs-lookup"><span data-stu-id="8e521-370">In the `ActiveStepChanged` event handler, the recently-created user account is assigned to the Supervisors role.</span></span> <span data-ttu-id="8e521-371">これを確認するに戻り、`UsersAndRoles.aspx`ページからスーパーバイザーをクリックし、 `RoleList` DropDownList です。</span><span class="sxs-lookup"><span data-stu-id="8e521-371">To verify this, return to the `UsersAndRoles.aspx` page and select Supervisors from the `RoleList` DropDownList.</span></span> <span data-ttu-id="8e521-372">図 14 に示す、監督者が可能になります 3 人のユーザーの: ブルース、Tito、および Wanda です。</span><span class="sxs-lookup"><span data-stu-id="8e521-372">As Figure 14 shows, the Supervisors are now made up of three users: Bruce, Tito, and Wanda.</span></span>


<span data-ttu-id="8e521-373">[![ブルース、Tito、および Wanda は、すべての管理者](assigning-roles-to-users-vb/_static/image41.png)](assigning-roles-to-users-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="8e521-373">[![Bruce, Tito, and Wanda are All Supervisors](assigning-roles-to-users-vb/_static/image41.png)](assigning-roles-to-users-vb/_static/image40.png)</span></span>

<span data-ttu-id="8e521-374">**図 14**: ブルース、Tito、および Wanda は、すべての監督者 ([フルサイズのイメージを表示するをクリックして](assigning-roles-to-users-vb/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="8e521-374">**Figure 14**: Bruce, Tito, and Wanda are All Supervisors  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image42.png))</span></span>


## <a name="summary"></a><span data-ttu-id="8e521-375">概要</span><span class="sxs-lookup"><span data-stu-id="8e521-375">Summary</span></span>

<span data-ttu-id="8e521-376">ロール フレームワークには、特定のユーザー ロールと、指定されたロールに属しているユーザーを決定するためのメソッドに関する情報を取得するための方法が用意されています。</span><span class="sxs-lookup"><span data-stu-id="8e521-376">The Roles framework offers methods for retrieving information about a particular user's roles and methods for determining what users belong to a specified role.</span></span> <span data-ttu-id="8e521-377">さらに、いくつかの追加および 1 つまたは複数の役割を 1 つまたは複数のユーザーを削除するメソッドがあります。</span><span class="sxs-lookup"><span data-stu-id="8e521-377">Furthermore, there are a number of methods for adding and removing one or more users to one or more roles.</span></span> <span data-ttu-id="8e521-378">このチュートリアルでに重点を置きましたこれらのメソッドを 2 つのみ:`AddUserToRole`と`RemoveUserFromRole`です。</span><span class="sxs-lookup"><span data-stu-id="8e521-378">In this tutorial we focused on just two of these methods: `AddUserToRole` and `RemoveUserFromRole`.</span></span> <span data-ttu-id="8e521-379">1 つのロールに複数のユーザーを追加して、1 人のユーザーに複数のロールを割り当てるように設計する追加のバリアントがあります。</span><span class="sxs-lookup"><span data-stu-id="8e521-379">There are additional variants designed to add multiple users to a single role and to assign multiple roles to a single user.</span></span>

<span data-ttu-id="8e521-380">このチュートリアルには、含める CreateUserWizard コントロールの拡張を見ても含まれている、`WizardStep`を新しく作成したユーザーのロールを指定します。</span><span class="sxs-lookup"><span data-stu-id="8e521-380">This tutorial also included a look at extending the CreateUserWizard control to include a `WizardStep` to specify the newly-created user's roles.</span></span> <span data-ttu-id="8e521-381">このような手順、管理者が新しいユーザーのユーザー アカウントを作成するプロセスを効率化できる場合があります。</span><span class="sxs-lookup"><span data-stu-id="8e521-381">Such a step could help an administrator streamline the process of creating user accounts for new users.</span></span>

<span data-ttu-id="8e521-382">この時点で作成し、ロールを削除する方法および追加し、ロールからユーザーを削除する方法をおきました。</span><span class="sxs-lookup"><span data-stu-id="8e521-382">At this point we have seen how to create and delete roles and how to add and remove users from roles.</span></span> <span data-ttu-id="8e521-383">おまだロールベースの承認を適用することを確認します。</span><span class="sxs-lookup"><span data-stu-id="8e521-383">But we have yet to look at applying role-based authorization.</span></span> <span data-ttu-id="8e521-384"><a id="_msoanchor_6"> </a>[次のチュートリアル](role-based-authorization-vb.md)を見てみましょうロール別のロールごとに URL 承認規則を定義すると、現在ログインしているユーザーのロールに基づいて、ページ レベルの機能を制限する方法です。</span><span class="sxs-lookup"><span data-stu-id="8e521-384">In the <a id="_msoanchor_6"></a>[following tutorial](role-based-authorization-vb.md) we will look at defining URL authorization rules on a role-by-role basis, as well as how to limit page-level functionality based on the currently logged in user's roles.</span></span>

<span data-ttu-id="8e521-385">満足プログラミング!</span><span class="sxs-lookup"><span data-stu-id="8e521-385">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="8e521-386">関連項目</span><span class="sxs-lookup"><span data-stu-id="8e521-386">Further Reading</span></span>

<span data-ttu-id="8e521-387">このチュートリアルで説明したトピックの詳細については、次の情報を参照してください。</span><span class="sxs-lookup"><span data-stu-id="8e521-387">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="8e521-388">ASP.NET Web サイト管理ツールの概要</span><span class="sxs-lookup"><span data-stu-id="8e521-388">ASP.NET Web Site Administration Tool Overview</span></span>](https://msdn.microsoft.com/en-us/library/ms228053.aspx)
- [<span data-ttu-id="8e521-389">ASP を検査中です。NET のメンバーシップ、ロール、およびプロファイル</span><span class="sxs-lookup"><span data-stu-id="8e521-389">Examining ASP.NET's Membership, Roles, and Profile</span></span>](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx)
- [<span data-ttu-id="8e521-390">独自の web サイト管理ツールのローリング</span><span class="sxs-lookup"><span data-stu-id="8e521-390">Rolling Your Own Website Administration Tool</span></span>](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx)

### <a name="about-the-author"></a><span data-ttu-id="8e521-391">作成者について</span><span class="sxs-lookup"><span data-stu-id="8e521-391">About the Author</span></span>

<span data-ttu-id="8e521-392">Scott Mitchell、複数の受け取りますブックの作成者と 4GuysFromRolla.com の創設者は、Microsoft の Web テクノロジと 1998 年取り組んできました。</span><span class="sxs-lookup"><span data-stu-id="8e521-392">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="8e521-393">Scott は、コンサルタント、トレーナー、ライターとして機能します。</span><span class="sxs-lookup"><span data-stu-id="8e521-393">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="8e521-394">最新の著書 *[Sam 学べる自分で ASP.NET 2.0 が 24 時間以内に](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*です。</span><span class="sxs-lookup"><span data-stu-id="8e521-394">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="8e521-395">Scott に到達できる[ mitchell@4guysfromrolla.com ](mailto:mitchell@4guysfromrolla.com)または彼のブログでを介して[http://ScottOnWriting.NET](http://scottonwriting.net/)です。</span><span class="sxs-lookup"><span data-stu-id="8e521-395">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="8e521-396">特別に感謝しています.</span><span class="sxs-lookup"><span data-stu-id="8e521-396">Special Thanks To…</span></span>

<span data-ttu-id="8e521-397">このチュートリアルの系列は既に多くの便利なレビュー担当者によって確認済みです。</span><span class="sxs-lookup"><span data-stu-id="8e521-397">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="8e521-398">このチュートリアルのレビュー担当者の潜在顧客が Teresa マーフィーしました。</span><span class="sxs-lookup"><span data-stu-id="8e521-398">Lead reviewer for this tutorial was Teresa Murphy.</span></span> <span data-ttu-id="8e521-399">今後、MSDN の記事を確認することに関心のあるですか。</span><span class="sxs-lookup"><span data-stu-id="8e521-399">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="8e521-400">場合は、ドロップ me 一度に 1 行ずつ[mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="8e521-400">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="8e521-401">[前へ](creating-and-managing-roles-vb.md)
[次へ](role-based-authorization-vb.md)</span><span class="sxs-lookup"><span data-stu-id="8e521-401">[Previous](creating-and-managing-roles-vb.md)
[Next](role-based-authorization-vb.md)</span></span>
