---
uid: web-pages/overview/getting-started/introducing-aspnet-web-pages-2/form-basics
title: "ASP.NET Web ページの HTML フォームの基本の概要 |Microsoft ドキュメント"
author: tfitzmac
description: "このチュートリアルでは、ASP.NET Web Pages (Razor) を使用すると、ユーザーの入力を処理する方法、および入力フォームを作成する方法の基礎を説明します。 今すぐそのしてしています."
ms.author: aspnetcontent
manager: wpickett
ms.date: 05/28/2015
ms.topic: article
ms.assetid: 81ed82bf-b940-44f1-b94a-555d0cb7cc98
ms.technology: dotnet-webpages
ms.prod: .net-framework
msc.legacyurl: /web-pages/overview/getting-started/introducing-aspnet-web-pages-2/form-basics
msc.type: authoredcontent
ms.openlocfilehash: 68056759b2e80230e5fd2c0f9b2d2a89b549cf37
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/24/2018
---
<a name="introducing-aspnet-web-pages---html-form-basics"></a>ASP.NET Web ページの HTML フォームの基本の概要
====================
によって[Tom FitzMacken](https://github.com/tfitzmac)

> このチュートリアルでは、ASP.NET Web Pages (Razor) を使用すると、ユーザーの入力を処理する方法、および入力フォームを作成する方法の基礎を説明します。 データベースを取得したら、これを使用して、フォームのスキル、データベース内の特定のムービーを見つけることができます。 を通じてシリーズを完了すると想定[概要を表示するデータを使用して ASP.NET Web Pages](/aspnet/web-pages/overview/getting-started/introducing-aspnet-web-pages-2/displaying-data)です。
> 
> 学習する内容。
> 
> - 標準の HTML 要素を使用してフォームを作成する方法。
> - ユーザーを読み取る方法は形式で入力します。
> - SQL クエリを選択的に、検索を使用してデータを取得用語をユーザーを作成する方法を提供します。
> - ページで「に注意してください」ユーザーが入力したフィールドを持つ方法です。
>   
> 
> 説明されている機能/テクノロジ:
> 
> - `Request` オブジェクト。
> - SQL`Where`句。


## <a name="what-youll-build"></a>新機能のビルドします。

前のチュートリアルでデータベースを作成、データを追加して使用して、`WebGrid`データを表示するためのヘルパー。 このチュートリアルでは、特定ジャンルの映画を検索するか、タイトルには、入力した任意の単語が含まれています、検索ボックスを追加します。 (たとえば、ことができますをジャンルが"Action"またはタイトルには、"Harry"または"Adventure"が含まれています。 すべての映画を検索する)

このチュートリアルを完了したら、次のようなページが必要があります。

![映画ジャンルとタイトルの検索 ページ](form-basics/_static/image1.png)

ページの一覧の一部は、前回のチュートリアルと同じ&mdash;グリッドです。 違いは、グリッドが表示される映画のみを検索することになります。

## <a name="about-html-forms"></a>HTML フォームについて

(HTML フォームの作成との違いのエクスペリエンスを思うかどうか`GET`と`POST`、このセクションをスキップすることができます)。

フォームがユーザー入力要素を持つ&mdash;テキスト ボックス、ボタン、オプション ボタン、チェック ボックス、ドロップダウン リスト、およびなどです。 ユーザーは、これらのコントロールに入力または選択を行います、ボタンをクリックして、フォームを送信します。

この例で、フォームの基本的な HTML 構文を示します。

[!code-html[Main](form-basics/samples/sample1.html)]

このマークアップ ページで実行されると、次の図のような単純なフォームが作成されます。

![ブラウザーでレンダリングされたとして HTML フォームの基本](form-basics/_static/image2.png)

`<form>`要素を送信する HTML 要素で囲みます。 (ようにする、簡単なミスがページに要素を追加が、内部に配置を忘れること、`<form>`要素。 その場合、何も送信されます。)`method`属性は、ユーザー入力を送信する方法をブラウザーに指示します。 これを設定する`post`サーバー上または更新プログラムを実行する場合`get`場合は、サーバーからデータをフェッチしているだけです。

<a id="GET,_POST,_and_HTTP_Verb_Safety"></a>

> [!TIP] 
> 
> **GET、POST、および HTTP 動詞の安全性**
> 
> HTTP、ブラウザーとサーバーが情報の交換に使用されるプロトコルは、その基本的な操作で非常に単純です。 ブラウザーでは、いくつかの動詞だけを使用して、サーバーに対して要求を行います。 Web 用のコードを記述する場合は、これらの動詞と、ブラウザーとサーバーの使用方法を理解することをお勧めします。 遠く離れたと最もよく使用される動詞とは。
> 
> - `GET`。 ブラウザーでは、この動詞を使用してサーバーからのものを取り出します。 たとえば、お使いのブラウザーに URL を入力すると、ブラウザーを実行、`GET`を目的のページを要求する操作。 ページには、グラフィックスが含まれている場合、ブラウザーが追加を実行`GET`イメージを取得する操作。 場合、`GET`操作は、サーバーに情報を渡す必要がある、情報が URL クエリ文字列内の一部として渡されます。
> - `POST`。 ブラウザーが送信、`POST`にデータを追加またはサーバー上で変更を送信するために要求します。 たとえば、`POST`をデータベースにレコードを作成または既存のテーブルを変更する動詞を使用します。 ほとんどの場合、フォームに入力して送信 ボタンをクリックして、ブラウザーを実行、`POST`操作します。 `POST`操作、サーバーに渡されるデータが、ページの本文。
> 
> これらの動詞を重要な違いは、`GET`操作がサーバー上のデータを変更することはできません: または抽象若干の他の方法で配置する、`GET`操作がサーバー上で状態の変更になりません。 実行することができます、`GET`何度でも、必要な場合、およびそれらのリソースを変更しないと同じリソースで操作します。 (A `GET` 「安全」、または技術の用語を使用する操作とよく言われますは*べき等*)。もちろん、これに対して、`POST`変更を要求、サーバーで何か、操作を実行するたびにします。
> 
> 2 つの例は、この区別を示すことができます。 検索を実行するときに Bing や Google、エンジンを使用して 1 つのテキスト ボックスで構成される形式で入力して、[検索] ボタンをクリックします。 ブラウザーを実行、 `GET` URL の一部として渡されたボックスに入力した値を指定の操作です。 使用して、`GET`操作情報だけこの種類のフォームが、正常では、検索操作は、サーバー上のすべてのリソースは変わらないため、フェッチします。
> 
> ここでのオンライン注文を検討してください。 注文の詳細を入力し、[送信] ボタンをクリックします。 この操作になります、`POST`のため、操作の結果は、新しい注文レコードをアカウント情報の変更とおそらく他多くの変更など、サーバー上の変更を要求します。 異なり、`GET`繰り返すことはできません、操作、`POST`要求: サーバーで新しい注文を生成し、削除できた場合、要求を再送信するたびにします。 (このような場合、web サイトが複数回送信ボタンをクリックする多くの場合は警告または誤ってフォームを再送信されないように、[送信] ボタンを無効になります)。
> 
> このチュートリアルの過程でされます両方を使用する、`GET`操作と`POST`HTML フォームを操作します。 各ケースのために使用する動詞は適切なを用いて説明します。
> 
> (HTTP 動詞の詳細については、次を参照してください、[メソッド定義](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html)W3C サイトの記事です。)。


ほとんどのユーザー入力要素は HTML`<input>`要素。 ように見える`<input type="type" name="name">,`場所*型*対象ユーザーの入力コントロールの種類を示します。 これらの要素が共通します。

- テキスト ボックス:`<input type="text">`
- チェック ボックス:`<input type="check">`
- ラジオ ボタンをクリックします。`<input type="radio">`
- ボタンをクリックします。`<input type="button">`
- ボタンを送信するには。`<input type="submit">`

使用することも、`<textarea>`複数行テキスト ボックスを作成する要素と`<select>`ドロップダウン リストまたはスクロール可能なリストを作成する要素。 (詳細については、HTML フォーム要素を参照してください[HTML フォームおよび入力](http://www.w3schools.com/html/html_forms.asp)W3Schools サイトです)。

`name`属性された非常に重要で、名前が後で、要素の値の取得方法をすぐにわかります。

興味深い部分は、ユーザーの入力とするページの開発者にしないでください。 これらの要素に関連付けられた組み込みの動作はありません。 代わりに、ユーザーが入力または選択された値を取得し、何らかの処理を行う必要があります。 このチュートリアルで学習内容です。

> [!TIP] 
> 
> **HTML5、および入力フォーム**
> 
> 可能性がありますがわかってし、遷移では、HTML、最新バージョン (HTML5) には、ユーザー情報を入力するためのより直観的な方法のサポートが含まれています。 たとえば、html5、(ページ開発者) ことがわかりますページ日付を入力するユーザーをすることです。 ブラウザーに自動的に表示できますカレンダーより日付を手動で入力する必要はありません。 ただし、HTML5 とはまだサポートされていませんすべてのブラウザーでします。
> 
> ASP.NET Web ページには、HTML5、ユーザーのブラウザーがその範囲内の入力がサポートされています。 新しい属性の概念、 `<input>` HTML5、内の要素を参照してください[HTML&lt;入力&gt;type 属性](http://www.w3schools.com/html/html_form_input_types.asp)W3Schools サイトです。


## <a name="creating-the-form"></a>フォームの作成

WebMatrix での**ファイル** ワークスペースで、開く、 *Movies.cshtml*ページ。

終了後に`</h1>`タグおよび開始する前に`<div>`のタグ、`grid.GetHtml`呼び出し、次のマークアップを追加します。

[!code-html[Main](form-basics/samples/sample2.html)]

このマークアップをという名前のテキスト ボックスを持つフォームを作成する`searchGenre`送信ボタン。 テキスト ボックスし、ボタンがで囲まれた送信、`<form>`要素が`method`属性に設定されている`get`です。 (送信中のボタンとテキスト ボックスを配置するされない場合は、必ず、`<form>`要素、ボタンをクリックしたときに何も送信されます)。使用する、`GET`動詞ここでフォームを作成しているためを変更しない、サーバー上: 検索結果だけです。 (前のチュートリアルでは使用して、`post`メソッドは、これは、サーバーへの変更を送信する方法です。 わかりますを次のチュートリアルでもう一度。)

ページを実行します。 フォームのすべての動作を定義していない場合がどのようにが確認できます。

![ジャンルの検索 ボックスと映画 ページ](form-basics/_static/image3.png)

「コメディ」のように、テキスト ボックスに値を入力します。 をクリックして**検索ジャンル**です。

ページの URL を書き留めます。 設定するため、`<form>`要素の`method`属性を`get`、入力した値は、次のように、URL 内のクエリ文字列の一部ではようになりました。

`http://localhost:45661/Movies.cshtml?searchGenre=Comedy`

## <a name="reading-form-values"></a>フォームの値の読み取り

ページには、データベースのデータを取得し、グリッドに結果を表示するコードが既に含まれています。 検索用語を含む SQL クエリを実行できるように、テキスト ボックスの値を読み取りますいくつかのコードを追加する必要があります。

フォームの方法を設定するため`get`次のようにコードを使用して、テキスト ボックスに入力された値を読み取ることができます。

`var searchTerm = Request.QueryString["searchGenre"];`

`Request.QueryString`オブジェクト (、`QueryString`のプロパティ、`Request`オブジェクト) の一部として送信された要素の値が含まれています、`GET`操作します。 `Request.QueryString`プロパティが含まれています、*コレクション*(一覧) の形式で送信される値。 個別の値を取得する要素の名前を指定します。 理由ですが必要、`name`属性を`<input>`要素 (`searchTerm`)、テキスト ボックスを作成します。 (詳細については、`Request`オブジェクトを参照してください、[サイドバー](#BKMK_TheRequestObject)後です)。

単純なので、テキスト ボックスの値を読み取ることはできます。 ユーザーが入力しなかったすべてのテキスト ボックス内をクリックした場合、**検索**を検索する項目がないために、ボタンをクリックするを無視するか、します。

次のコードでは、これらの条件を実装する方法を示す例を示します。 (まだこのコードを追加する必要はありませんは、すぐに実行してみましょう。)

[!code-csharp[Main](form-basics/samples/sample3.cs)]

この方法で分割するテスト。

- 値を取得`Request.QueryString["searchGenre"]`、つまりに入力された値、`<input>`という名前の要素`searchGenre`です。
- 使用して空であるかを調べる、`IsEmpty`メソッドです。 このメソッドは、値が含まれています (たとえば、フォーム要素) のものかどうかを決定する標準的な方法です。 実際には、するがある場合にのみ、目的が*いない*空の場合、そのためしています.
- 追加、`!`演算子の前に、`IsEmpty`をテストします。 (、`!`演算子は論理 NOT)。

英語、全体の`if`条件は、次に変換します*場合は、フォームの searchGenre 要素は空でなく、.。*

このブロックは、検索用語を使用するクエリを作成するためのステージを設定します。 次のセクションを実行してみましょう。

<a id="BKMK_TheRequestObject"></a>

> [!TIP] 
> 
> **要求オブジェクト**
> 
> `Request`オブジェクトには、ブラウザーは、ページが要求または送信されるときに、アプリケーションに送信されるすべての情報が含まれています。 このオブジェクトには、テキスト ボックスの値またはアップロードするファイルと同様に、ユーザーが提供する情報が含まれています。 あらゆる種類の cookie、URL クエリ文字列 (存在する場合) 内の値と同様に、追加の情報も含まれていますページを実行している、ユーザーが使用すると、ブラウザーで設定されている言語の一覧ブラウザーの種類のファイル パス。、その他。
> 
> `Request`オブジェクトが、*コレクション*(リスト) の値。 コレクションから個々 の値は、その名前を指定することによって取得します。
> 
> `var someValue = Request["name"];`
> 
> `Request`オブジェクトが実際にはいくつかのサブセットを公開します。 例:
> 
> - `Request.Form`送信された内の要素から値`<form>`要素要求がある場合、`POST`要求します。
> - `Request.QueryString`使用する値だけ URL のクエリ文字列します。 (ような URL で`http://mysite/myapp/page?searchGenre=action&page=2`、 `?searchGenre=action&page=2` URL のセクションは、クエリ文字列です)。
> - `Request.Cookies`コレクションは、ブラウザーが送信されたクッキーにアクセスできます。
> 
> 送信されたフォームがわかっている値を取得するが、使用することができます`Request["name"]`です。 具体的なバージョンを使用する代わりに、 `Request.Form["name"]` (の`POST`要求) または`Request.QueryString["name"]`(の`GET`要求)。 もちろん、*名前*を取得する項目の名前を指定します。
> 
> 取得する項目の名前は、使用しているコレクション内で一意であることができます。 だからこそ、`Request`オブジェクトは、サブセットと同様に、提供`Request.Form`と`Request.QueryString`です。 ページにはという名前のフォーム要素が含まれていると`userName`と*も*という名前の cookie を含む`userName`です。 表示された場合`Request["userName"]`フォームの値または cookie するかどうかがあいまいです。 ただし、表示された場合`Request.Form["userName"]`または`Request.Cookie["userName"]`、取得するには、どの値を明示するしています。
> 
> 特定してがのサブセットを使用することをお勧め`Request`興味のあると同様に`Request.Form`または`Request.QueryString`です。 このチュートリアルで作成する単純なページに対してその可能性があります本当にも行いません。 ただしより複雑なページを作成すると、明示的なバージョンを使用`Request.Form`または`Request.QueryString`ページには、フォーム (または複数の形式) が含まれている場合に発生する可能性がある問題を回避するための cookie やクエリ文字列値です。


## <a name="creating-a-query-by-using-a-search-term"></a>検索用語を使用してクエリを作成します。

ユーザーが入力した検索用語を取得する方法を理解したところでは、それを使用するクエリを作成できます。 データベースからのすべてのムービー項目を取得するには、このステートメントのような SQL クエリを使用して注意してください。

`SELECT * FROM Movies`

特定の映画のみを取得するを含むクエリを使用する必要が、`Where`句。 この句を使用して、クエリによって返される行を条件を設定できます。 次に例を示します。

`SELECT * FROM Movies WHERE Genre = 'Action'`

基本形式は`WHERE column = value`します。 さまざまな演算子を使用するには、さらに、ジャスト`=`と同様、 `>` (より大きい)、 `<` (より小さい)、 `<>` (等しくない)、 `<=` (以下を)、探している新機能によってなどです。

念のため、SQL ステートメントを大文字小文字が区別されない&mdash;`SELECT`と同じ`Select`(あるいは`select`)。 ただし、ユーザー多くの場合、大文字にする SQL ステートメントでキーワードと同様に`SELECT`と`WHERE`を読みやすきます。

### <a name="passing-the-search-term-as-a-parameter"></a>検索用語をパラメーターとして渡す

特定のジャンルが非常に簡単を検索 (`WHERE Genre = 'Action'`) をユーザーが入力した任意のジャンルを検索できるようにすることです。 実行するには、検索する値のプレース ホルダーを含む SQL クエリとして作成します。 このコマンドのようになります。

`SELECT * FROM Movies WHERE Genre = @0`

プレース ホルダーは、`@`文字の後に 0 個です。 ご想像のとおり、クエリが複数のプレース ホルダーを含めることができ、という名前になります`@0`、 `@1`、 `@2`, などです。

クエリを設定し、実際に値を渡すにするには、次のようにコードを使用します。

[!code-sql[Main](form-basics/samples/sample4.sql)]

このコードは、新機能を既にインストールしているデータを表示するグリッド内に似ています。 唯一の違いは次のとおりです。

- クエリには、プレース ホルダーが含まれています (`WHERE Genre = @0"`)。
- クエリは、変数に格納されます (`selectCommand`) 以外の場合は、クエリに直接渡される前に、`db.Query`メソッドです。
- 呼び出すと、`db.Query`メソッドを渡すクエリと、プレース ホルダーを使用する値の両方です。 (複数のプレース ホルダーがある場合、それらを渡す場合、メソッドに別の値としてすべてです)。

これらすべての要素を一緒に配置する場合は、次のコードを取得します。

[!code-csharp[Main](form-basics/samples/sample5.cs)]

> [!NOTE] 
> 
> **大事な！** プレース ホルダーを使用する (と同様に`@0`) は、SQL コマンドに値を渡す*非常に重要*セキュリティのためです。 ここに表示されること、変数のデータのプレース ホルダーでは唯一の方法が SQL コマンドを構築する必要があります。
> 
> ありません (連結) のリテラル テキストと、ユーザーから取得する値、一緒に配置することにより、SQL ステートメントを構築します。 ようにサイトを開き、SQL ステートメントにユーザー入力の連結、 *SQL インジェクション攻撃*悪意のあるユーザーがハッキング、データベース ページへの値を送信します。 (詳細を読み取ることができます、記事[SQL インジェクション](https://msdn.microsoft.com/library/ms161953.aspx)MSDN web サイトです)。


## <a name="updating-the-movies-page-with-search-code"></a>検索コードと映画 ページを更新

内のコードを更新するようになりました、 *Movies.cshtml*ファイル。 を開始するには、このコードで、ページの上部にあるコード ブロック内のコードを置き換えます。

[!code-csharp[Main](form-basics/samples/sample6.cs)]

ここでの違いは、クエリに配置したこと、`selectCommand`変数を渡します`db.Query`以降。 変数に SQL ステートメントを配置することでは、検索を実行する操作は、ステートメントを変更できます。

配置バックアップの後でこれら 2 つの行も削除されました。

[!code-csharp[Main](form-basics/samples/sample7.cs)]

まだクエリを実行する (つまり、呼び出す`db.Query`) を初期化しないと、`WebGrid`ヘルパーまだです。 実行する SQL ステートメントを理解した後、それらの作業を行います。

この書き換えられたブロックの後に、新しい検索を処理するためのロジックを追加できます。 完成したコードは、次のようになります。 この例に一致するように、ページのコードを更新します。

[!code-cshtml[Main](form-basics/samples/sample8.cshtml)]

ページに次のようになりました。 コードが、データベースを開き、ページを実行するたびに、`selectCommand`変数からのすべてのレコードを取得する SQL ステートメントを設定する、`Movies`テーブル。 また、コードを初期化、`searchTerm`変数。

ただし、現在の要求の値が含まれる場合、`searchGenre`要素では、コード セット`selectCommand`別のクエリを: つまりに含まれています、`Where`ジャンルを検索する句。 また、設定`searchTerm`(可能性のある何も行われません)、検索ボックスに渡されたオブジェクトにします。

ステートメントが、SQL に関係なく`selectCommand`、し、呼び出すコード`db.Query`のクエリを実行するには渡す任意`searchTerm`です。 ある場合は nothing`searchTerm`にかかわらず、その場合に値を渡すためのパラメーターがないため`selectCommand`します。

コードの最後に、初期化、`WebGrid`と同じようにする前に、クエリの結果を使用して、ヘルパー。

SQL ステートメントを記述することによって表示することができ、変数に、検索用語と、柔軟性、コードに追加しました。 このチュートリアルで後述するようこの基本的なフレームワークを使用してさまざまな種類の検索ロジックを追加し続けます。

## <a name="testing-the-search-by-genre-feature"></a>検索-ジャンルで機能のテスト

WebMatrix では、実行、 *Movies.cshtml*ページ。 ジャンルのテキスト ボックスを使用してページを参照してください。

入力 をクリックして、テスト レコードの 1 つの入力をジャンル**検索**です。 ジャンルに一致する映画のみの一覧を表示するこの時間。

![ジャンル 'Comedies' の検索後を一覧表示するビデオ ページ](form-basics/_static/image4.png)

異なるジャンルを入力し、もう一度検索します。 検索では大文字小文字を区別しないことを認識できるように、すべての文字は小文字または大文字すべてを使用して、ジャンルを入力してください。

## <a name="remembering-what-the-user-entered"></a>ユーザーが入力した「記憶」

お気付きをジャンルを入力してクリック、した後に**検索ジャンル**ジャンルの一覧を確認しました。 ただし、検索テキスト ボックスが空でした&mdash;言い換えれば、その覚えのない入力しています。

この現象が発生した理由を理解しておく必要があります。 ページを送信するときに、ブラウザーは、web サーバーに要求を送信します。 ASP.NET では、要求を取得が、ページの新しいインスタンスを作成、コードが実行され、ブラウザーにページをもう一度表示し、します。 実際には、ただし、ページが知りません自体の以前のバージョンでの操作だけがします。 いくつかのある要求を受け取りましたが認識しているすべては、これでデータを形成します。

ページを要求するたびに&mdash;か、最初に送信することによって&mdash;新しいページを取得します。 Web サーバーには、最後の要求のメモリがありません。 ASP.NET、どちらもし、ブラウザーはどちらもします。 これらのページの個別のインスタンス間で唯一の接続は、それらの間に送信するすべてのデータです。 ページを送信した場合など、新しいページ インスタンスは、以前のインスタンスから送信されたフォーム データを取得できます。 (ページ間でデータをやりとりする別の方法は、cookie を使用するのには) です。

Web ページがあるという、このような状況を記述する正式な方法では*ステートレス*です。 Web サーバーおよびページ自体と、ページ内の要素では、ページの直前の状態に関する情報は保持されません。 Web は、個々 の要求の状態を維持するが迅速にリソースを使い果たす、web サーバーは、多くの場合、おそらく何千を処理の 1 秒あたりの要求の数十万もあるために、この方法を設計されました。

その理由になるよう、テキスト ボックスが空でした。 ページを送信した後、ASP.NET は、ページの新しいインスタンスを作成し、コードとマークアップを実行します。 Nothing にありましたを ASP.NET、テキスト ボックスに値を格納するように通知するコード。 ASP.NET 何も出力しないとに値を指定せずにテキスト ボックスが表示されました。

この問題を回避するための簡単な方法実際には テキスト ボックスに入力したジャンル*は*コードで使用可能な&mdash;内にある`Request.QueryString["searchGenre"]`です。

テキスト ボックスのマークアップを更新できるように、`value`属性から値を取得する`searchTerm`などの次の例。

[!code-html[Main](form-basics/samples/sample9.html?highlight=1)]

このページで設定することがも、`value`属性を`searchTerm`その変数にも、ジャンルが含まれているので、変数を入力します。 使用して、`Request`を設定するオブジェクト、`value`属性ようこのタスクを実行する標準的な方法を次に示します。 (とした場合でもこれを行う&mdash;状況によっては、ページを表示するために必要な可能性があります*せず*フィールドの値。 すべてによって異なります、アプリで何が起こっています。)

> [!NOTE]
> 「思い出せない」パスワードに使用されるテキスト ボックスの値。 コードを使用して、[パスワード] フィールドに入力できるようにするセキュリティ ホールがあります。


ページを再度実行し、ジャンルを入力し、クリックして**検索ジャンル**です。 この時間だけでなく操作を確認する、検索の結果が最後に入力したテキスト ボックスの記憶。

![テキスト ボックスが '記憶こと' 前のエントリを表示するページ](form-basics/_static/image5.png)

## <a name="searching-for-any-word-in-the-title"></a>任意の単語でタイトルの検索

ジャンル、今すぐ検索することができますが、タイトルを検索する場合がありますもします。 検索すると、そのため、タイトル内任意の場所に表示される語句を検索することができます、タイトルを正確に取得するには、困難です。 そのためには SQL で使用する、`LIKE`と同様に、次の演算子と構文。

`SELECT * FROM Movies WHERE Title LIKE '%adventure%'`

このコマンドは、タイトルが"adventure"を含むすべてのムービーを取得します。 使用すると、`LIKE`演算子、ワイルドカード文字を含める`%`検索用語の一部として。 検索`LIKE 'adventure%'`「'adventure' で始まる」ことを意味します。 (技術的には、そのという意味の「、文字列 'adventure' が続くものです」)同様に、特定の語句`LIKE '%adventure'`「'adventure' で終了するまで」に別の方法が「何も後に文字列 'adventure'」を意味します。

検索用語`LIKE '%adventure%'`のためことを意味します""adventure'、タイトルに任意の場所です"。 (技術的には、「では何も 'adventure'、何も後に続く、タイトルです。」)

内部、`<form>`要素、終わりの右下にある次のマークアップを追加`</div>`ジャンル検索用のタグ (閉じる`</form>`要素)。

[!code-html[Main](form-basics/samples/sample10.html)]

この検索を処理するコード似ていますが、ジャンル検索用のコードにアセンブルする必要がある、`LIKE`検索します。 ページの上部にあるコード ブロックの内部には、これを追加`if`直後ブロック、`if`ジャンル検索のブロック。

[!code-csharp[Main](form-basics/samples/sample11.cs)]

検索を使用する点を除いて、このコードが、先ほど見た同じロジックを使用して、`LIKE`演算子とコードの配置"`%`"検索用語の前後にします。

どのように簡単に別の検索をページに追加することを確認します。 行う必要があるすべてが発生しました。

- 作成、`if`関連する検索ボックスに、値があったかどうかを確認するためにテストをブロックします。
- 設定、`selectCommand`変数を新しい SQL ステートメントにします。
- 設定、`searchTerm`変数をクエリに渡す値にします。

新しいタイトルの検索ロジックを含む完全なコード ブロックを次に示します。

[!code-cshtml[Main](form-basics/samples/sample12.cshtml)]

このコードの実行内容の概要を次に示します。

- 変数`searchTerm`と`selectCommand`上部に初期化されます。 適切な SQL コマンドが、ユーザーがページではに基づいて、(存在する場合) の適切な検索用語にこれらの変数を設定しようとしているとします。 既定の検索は、単純なケースをデータベースからすべてのムービーを取得することです。
- テストで`searchGenre`と`searchTitle`、コード セット`searchTerm`を検索する値。 それらのコード ブロックの設定も`selectCommand`検索条件に該当する SQL コマンド。
- `db.Query`メソッドが呼び出される 1 回だけでは、どのような SQL コマンドを使用して`selectedCommand`であり、どのような値で`searchTerm`です。 検索語句 (ありませんジャンルおよびタイトル単語を指定しないで) が存在しない場合の値`searchTerm`空の文字列します。 ただし、重要ではない、クエリにパラメーターを必要としない場合はのでです。

## <a name="testing-the-title-search-feature"></a>タイトルの検索機能をテストします。

これで、検索が完了しました ページをテストできます。 実行*Movies.cshtml*です。

ジャンルを入力し、クリックして**検索ジャンル**です。 グリッドには、前のように、ジャンルのムービーが表示されます。

単語のタイトルを入力し、をクリックして**検索タイトル**です。 グリッドには、映画のタイトルにその単語が表示されます。

![映画ページのタイトルに '、' の検索後を一覧表示します。](form-basics/_static/image6.png)

両方のテキスト ボックスを空白のままにし、いずれかのボタンをクリックします。 グリッドには、すべてのムービーが表示されます。

## <a name="combining-the-queries"></a>クエリの結合

検索を行うことができますが排他的なことに注意してください可能性があります。 タイトル、ジャンルは両方の検索ボックスに値がある場合でも、同時に検索することはできません。 たとえば、タイトルには、"Adventure"が含まれています。 すべてのアクション映画を検索できません。 (ように、ページは、ジャンルとタイトルの両方の値を入力する場合、コード化された、タイトルの検索を優先順位)条件を結合する検索を作成するには、構文は次のように SQL クエリを作成する必要があります。

`SELECT * FROM Movies WHERE Genre = @0 AND Title LIKE @1`

次のようにステートメントを使用してクエリを実行することが必要 (大まかに言うと)。

`var selectedData = db.Query(selectCommand, searchGenre, searchTitle);`

検索条件の順列の多くを許可するロジックを作成するを取得できますをビットに関係することがわかります。 そのため、私たちが進まないでください。

## <a name="coming-up-next"></a>次へ直近の見通し

次のチュートリアルでは、ユーザーがデータベースにムービーを追加できるようにするフォームを使用するページを作成します。

## <a name="complete-listing-for-movie-page-updated-with-search"></a>(検索を使用して更新された) ビデオ ページの完全な一覧

[!code-cshtml[Main](form-basics/samples/sample13.cshtml)]

## <a name="additional-resources"></a>その他のリソース

- [Razor 構文を使用して ASP.NET Web プログラミングの概要](https://go.microsoft.com/fwlink/?LinkID=202890)
- [SQL の WHERE 句](http://www.w3schools.com/sql/sql_where.asp)W3Schools サイト
- [メソッドの定義](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html)W3C サイトの記事

>[!div class="step-by-step"]
[前へ](displaying-data.md)
[次へ](entering-data.md)
