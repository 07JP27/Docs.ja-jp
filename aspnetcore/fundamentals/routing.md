---
title: "ASP.NET Core でのルーティング"
author: ardalis
description: "ASP.NET Core ルーティング機能が、受信要求をルート ハンドラーにマップするために対応する方法を検出します。"
ms.author: riande
manager: wpickett
ms.date: 10/14/2016
ms.topic: article
ms.technology: aspnet
ms.prod: asp.net-core
uid: fundamentals/routing
ms.openlocfilehash: 8f6f4fac89afe14d83d629128fc3e4632ae95510
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/24/2018
---
# <a name="routing-in-aspnet-core"></a><span data-ttu-id="63b81-103">ASP.NET Core でのルーティング</span><span class="sxs-lookup"><span data-stu-id="63b81-103">Routing in ASP.NET Core</span></span>

<span data-ttu-id="63b81-104">によって[Ryan Nowak](https://github.com/rynowak)、 [Steve Smith](https://ardalis.com/)、および[Rick Anderson](https://twitter.com/RickAndMSFT)</span><span class="sxs-lookup"><span data-stu-id="63b81-104">By [Ryan Nowak](https://github.com/rynowak), [Steve Smith](https://ardalis.com/), and [Rick Anderson](https://twitter.com/RickAndMSFT)</span></span>

<span data-ttu-id="63b81-105">ルーティング機能は、受信要求をルート ハンドラーにマップします。</span><span class="sxs-lookup"><span data-stu-id="63b81-105">Routing functionality is responsible for mapping an incoming request to a route handler.</span></span> <span data-ttu-id="63b81-106">ルートが ASP.NET アプリケーションで定義されているし、アプリの起動時に構成されています。</span><span class="sxs-lookup"><span data-stu-id="63b81-106">Routes are defined in the ASP.NET app and configured when the app starts up.</span></span> <span data-ttu-id="63b81-107">ルート、要求に含まれている URL から値を抽出できます必要に応じて、要求の処理のため、これらの値を使用し、ことができます。</span><span class="sxs-lookup"><span data-stu-id="63b81-107">A route can optionally extract values from the URL contained in the request, and these values can then be used for request processing.</span></span> <span data-ttu-id="63b81-108">ASP.NET アプリケーションからのルート情報を使用して、ルーティング機能もルート ハンドラーにマップする Url を生成することができます。</span><span class="sxs-lookup"><span data-stu-id="63b81-108">Using route information from the ASP.NET app, the routing functionality is also able to generate URLs that map to route handlers.</span></span> <span data-ttu-id="63b81-109">そのため、ルーティング URL、またはハンドラーのルート情報に基づいて指定されたルート ハンドラーに対応する URL に基づくルート ハンドラーを見つけることができます。</span><span class="sxs-lookup"><span data-stu-id="63b81-109">Therefore, routing can find a route handler based on a URL, or the URL corresponding to a given route handler based on route handler information.</span></span>

>[!IMPORTANT]
> <span data-ttu-id="63b81-110">このドキュメントでは、ルーティング低レベルの ASP.NET Core について説明します。</span><span class="sxs-lookup"><span data-stu-id="63b81-110">This document covers the low level ASP.NET Core routing.</span></span> <span data-ttu-id="63b81-111">ASP.NET Core MVC ルーティングを参照してください[コント ローラー アクションへのルーティング](../mvc/controllers/routing.md)</span><span class="sxs-lookup"><span data-stu-id="63b81-111">For ASP.NET Core MVC routing, see [Routing to Controller Actions](../mvc/controllers/routing.md)</span></span>

<span data-ttu-id="63b81-112">[サンプル コードを表示またはダウンロード](https://github.com/aspnet/Docs/tree/master/aspnetcore/fundamentals/routing/sample)します ([ダウンロード方法](xref:tutorials/index#how-to-download-a-sample))。</span><span class="sxs-lookup"><span data-stu-id="63b81-112">[View or download sample code](https://github.com/aspnet/Docs/tree/master/aspnetcore/fundamentals/routing/sample) ([how to download](xref:tutorials/index#how-to-download-a-sample))</span></span>

## <a name="routing-basics"></a><span data-ttu-id="63b81-113">ルーティングの基礎</span><span class="sxs-lookup"><span data-stu-id="63b81-113">Routing basics</span></span>

<span data-ttu-id="63b81-114">ルーティングは*ルート*(の実装[IRouter](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.routing.irouter)) にします。</span><span class="sxs-lookup"><span data-stu-id="63b81-114">Routing uses *routes* (implementations of [IRouter](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.routing.irouter)) to:</span></span>

* <span data-ttu-id="63b81-115">着信要求をマップ*ハンドラーのルーティング*</span><span class="sxs-lookup"><span data-stu-id="63b81-115">map incoming requests to *route handlers*</span></span>

* <span data-ttu-id="63b81-116">応答で使用される Url を生成します。</span><span class="sxs-lookup"><span data-stu-id="63b81-116">generate URLs used in responses</span></span>

<span data-ttu-id="63b81-117">通常、アプリは、単一のルートのコレクションを持っています。</span><span class="sxs-lookup"><span data-stu-id="63b81-117">Generally, an app has a single collection of routes.</span></span> <span data-ttu-id="63b81-118">要求が到着すると、ルートのコレクションが順番に処理します。</span><span class="sxs-lookup"><span data-stu-id="63b81-118">When a request arrives, the route collection is processed in order.</span></span> <span data-ttu-id="63b81-119">受信要求が呼び出すことによって、要求 URL に一致するルートの検索、`RouteAsync`ルート コレクションで使用可能な各ルートのメソッドです。</span><span class="sxs-lookup"><span data-stu-id="63b81-119">The incoming request looks for a route that matches the request URL by calling the `RouteAsync` method on each available route in the route collection.</span></span> <span data-ttu-id="63b81-120">これに対し、応答は、ルーティングを使用して、ルート情報に基づいて (たとえば、リダイレクトまたはリンク) の Url を生成して、したがってせずに済むようハード コード Url、保守性にも役立ちます。</span><span class="sxs-lookup"><span data-stu-id="63b81-120">By contrast, a response can use routing to generate URLs (for example, for redirection or links) based on route information, and thus avoid having to hard-code URLs, which helps maintainability.</span></span>

<span data-ttu-id="63b81-121">接続されているルーティング、[ミドルウェア](middleware.md)によってパイプライン、`RouterMiddleware`クラスです。</span><span class="sxs-lookup"><span data-stu-id="63b81-121">Routing is connected to the [middleware](middleware.md) pipeline by the `RouterMiddleware` class.</span></span> <span data-ttu-id="63b81-122">[ASP.NET MVC](../mvc/overview.md)追加の構成の一部としてのミドルウェア パイプラインにルーティングします。</span><span class="sxs-lookup"><span data-stu-id="63b81-122">[ASP.NET MVC](../mvc/overview.md) adds routing to the middleware pipeline as part of its configuration.</span></span> <span data-ttu-id="63b81-123">詳細については、スタンドアロン コンポーネントとしてルーティングを使用して、次を参照してください。[を使用して、ルーティングのミドルウェア](#using-routing-middleware)です。</span><span class="sxs-lookup"><span data-stu-id="63b81-123">To learn about using routing as a standalone component, see [using-routing-middleware](#using-routing-middleware).</span></span>

<a name="url-matching-ref"></a>

### <a name="url-matching"></a><span data-ttu-id="63b81-124">一致する URL</span><span class="sxs-lookup"><span data-stu-id="63b81-124">URL matching</span></span>

<span data-ttu-id="63b81-125">URL の一致に入力方向の要求をルーティングするディスパッチによってプロセスでは、*ハンドラー*です。</span><span class="sxs-lookup"><span data-stu-id="63b81-125">URL matching is the process by which routing dispatches an incoming request to a *handler*.</span></span> <span data-ttu-id="63b81-126">この処理は通常、データを基に、URL パスが、要求内のデータを考慮に拡張できます。</span><span class="sxs-lookup"><span data-stu-id="63b81-126">This process is generally based on data in the URL path, but can be extended to consider any data in the request.</span></span> <span data-ttu-id="63b81-127">ハンドラーを独立したに要求をディスパッチする機能は、サイズと、アプリケーションの複雑さをスケーリングするキーです。</span><span class="sxs-lookup"><span data-stu-id="63b81-127">The ability to dispatch requests to separate handlers is key to scaling the size and complexity of an application.</span></span>

<span data-ttu-id="63b81-128">受信要求を入力してください、 `RouterMiddleware`、呼び出し、`RouteAsync`シーケンス内の各ルートのメソッドです。</span><span class="sxs-lookup"><span data-stu-id="63b81-128">Incoming requests enter the `RouterMiddleware`, which calls the `RouteAsync` method on each route in sequence.</span></span> <span data-ttu-id="63b81-129">`IRouter`インスタンスを選択するかどうか*処理*を設定して、要求、 `RouteContext.Handler` null 以外の値に`RequestDelegate`です。</span><span class="sxs-lookup"><span data-stu-id="63b81-129">The `IRouter` instance chooses whether to *handle* the request by setting the `RouteContext.Handler` to a non-null `RequestDelegate`.</span></span> <span data-ttu-id="63b81-130">ルートは、要求のハンドラーを設定、要求を処理するルートの処理が停止し、ハンドラーが呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="63b81-130">If a route sets a handler for the request, route processing stops and the handler will be invoked to process the request.</span></span> <span data-ttu-id="63b81-131">ミドルウェアが呼び出すすべてのルートが試みられたの要求に対するハンドラーが見つからない場合は、*次*され、要求パイプラインの次のミドルウェアが呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="63b81-131">If all routes are tried and no handler is found for the request, the middleware calls *next* and the next middleware in the request pipeline is invoked.</span></span>

<span data-ttu-id="63b81-132">入力をプライマリ`RouteAsync`は、`RouteContext.HttpContext`現在の要求に関連付けられています。</span><span class="sxs-lookup"><span data-stu-id="63b81-132">The primary input to `RouteAsync` is the `RouteContext.HttpContext` associated with the current request.</span></span> <span data-ttu-id="63b81-133">`RouteContext.Handler`と`RouteContext.RouteData`ルートに一致した後に設定される出力します。</span><span class="sxs-lookup"><span data-stu-id="63b81-133">The `RouteContext.Handler` and `RouteContext.RouteData` are outputs that will be set after a route matches.</span></span>

<span data-ttu-id="63b81-134">中に一致する`RouteAsync`のプロパティを設定しても、`RouteContext.RouteData`をこれまでに実行、要求の処理に基づく適切な値です。</span><span class="sxs-lookup"><span data-stu-id="63b81-134">A match during `RouteAsync` will also set the properties of the `RouteContext.RouteData` to appropriate values based on the request processing done so far.</span></span> <span data-ttu-id="63b81-135">ルート、要求に一致する場合、`RouteContext.RouteData`に関する重要な状態情報を格納する、*結果*です。</span><span class="sxs-lookup"><span data-stu-id="63b81-135">If a route matches a request, the `RouteContext.RouteData` will contain important state information about the *result*.</span></span>

<span data-ttu-id="63b81-136">`RouteData.Values`dictionary です*ルート値*をルートから生成します。</span><span class="sxs-lookup"><span data-stu-id="63b81-136">`RouteData.Values` is a dictionary of *route values* produced from the route.</span></span> <span data-ttu-id="63b81-137">これらの値では、通常、URL のトークン化によって決定され、ユーザー入力を受け付けるか、アプリケーション内のさらにディスパッチ意思決定を行うために使用できます。</span><span class="sxs-lookup"><span data-stu-id="63b81-137">These values are usually determined by tokenizing the URL, and can be used to accept user input, or to make further dispatching decisions inside the application.</span></span>

<span data-ttu-id="63b81-138">`RouteData.DataTokens`一致したルートに関連するその他のデータのプロパティ バッグがします。</span><span class="sxs-lookup"><span data-stu-id="63b81-138">`RouteData.DataTokens`  is a property bag of additional data related to the matched route.</span></span> <span data-ttu-id="63b81-139">`DataTokens`アプリケーションが後でどのルートに基づく決定を行うができるように各ルートを使用してデータが一致する関連付けられた状態をサポートするために提供されます。</span><span class="sxs-lookup"><span data-stu-id="63b81-139">`DataTokens` are provided to support associating state data with each route so the application can make decisions later based on which route matched.</span></span> <span data-ttu-id="63b81-140">これらの値は開発者が定義され、操作を行います**いない**任意の方法でルーティングの動作に影響します。</span><span class="sxs-lookup"><span data-stu-id="63b81-140">These values are developer-defined and do **not** affect the behavior of routing in any way.</span></span> <span data-ttu-id="63b81-141">さらに、データのトークンの格納値は、任意の型のルートの値は、文字列との間に簡単に変換できる必要がありますとは対照的できます。</span><span class="sxs-lookup"><span data-stu-id="63b81-141">Additionally, values stashed in data tokens can be of any type, in contrast to route values, which must be easily convertible to and from strings.</span></span>

<span data-ttu-id="63b81-142">`RouteData.Routers`要求を正常に一致するときに関与するルートの一覧を示します。</span><span class="sxs-lookup"><span data-stu-id="63b81-142">`RouteData.Routers` is a list of the routes that took part in successfully matching the request.</span></span> <span data-ttu-id="63b81-143">ルートは、別内にネストすることができます、`Routers`プロパティの検索一致で生成されるルートの論理ツリーのパスに反映されます。</span><span class="sxs-lookup"><span data-stu-id="63b81-143">Routes can be nested inside one another, and the `Routers` property reflects the path through the logical tree of routes that resulted in a match.</span></span> <span data-ttu-id="63b81-144">一般に、最初の項目`Routers`ルートのコレクションは、URL の生成に使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="63b81-144">Generally the first item in `Routers` is the route collection, and should be used for URL generation.</span></span> <span data-ttu-id="63b81-145">最後の項目`Routers`に一致するルート ハンドラーします。</span><span class="sxs-lookup"><span data-stu-id="63b81-145">The last item in `Routers` is the route handler that matched.</span></span>

### <a name="url-generation"></a><span data-ttu-id="63b81-146">URL の生成</span><span class="sxs-lookup"><span data-stu-id="63b81-146">URL generation</span></span>

<span data-ttu-id="63b81-147">URL の生成は、処理、ルーティングでルートの値のセットに基づく URL パスを作成できます。</span><span class="sxs-lookup"><span data-stu-id="63b81-147">URL generation is the process by which routing can create a URL path based on a set of route values.</span></span> <span data-ttu-id="63b81-148">これにより、ハンドラーとそれらにアクセスする Url の間、論理的な分離できます。</span><span class="sxs-lookup"><span data-stu-id="63b81-148">This allows for a logical separation between your handlers and the URLs that access them.</span></span>

<span data-ttu-id="63b81-149">URL の生成と同様の反復的なプロセスに従いますを呼び出すコードをユーザーまたはフレームワーク、`GetVirtualPath`ルートのコレクションのメソッドです。</span><span class="sxs-lookup"><span data-stu-id="63b81-149">URL generation follows a similar iterative process, but starts with user or framework code calling into the `GetVirtualPath` method of the route collection.</span></span> <span data-ttu-id="63b81-150">各*ルート*がその`GetVirtualPath`メソッドが null でないまで順序で呼び出されます`VirtualPathData`が返されます。</span><span class="sxs-lookup"><span data-stu-id="63b81-150">Each *route* will then have its `GetVirtualPath` method called in sequence until a non-null `VirtualPathData` is returned.</span></span>

<span data-ttu-id="63b81-151">プライマリの入力先`GetVirtualPath`は。</span><span class="sxs-lookup"><span data-stu-id="63b81-151">The primary inputs to `GetVirtualPath` are:</span></span>

* `VirtualPathContext.HttpContext`

* `VirtualPathContext.Values`

* `VirtualPathContext.AmbientValues`

<span data-ttu-id="63b81-152">ルートは主にによって提供される、ルート値を使用して、`Values`と`AmbientValues`URL を生成する可能性がある値を含めるかを判断します。</span><span class="sxs-lookup"><span data-stu-id="63b81-152">Routes primarily use the route values provided by the `Values` and `AmbientValues` to decide where it's possible to generate a URL and what values to include.</span></span> <span data-ttu-id="63b81-153">`AmbientValues`ルーティングのシステムでは、現在の要求を照合から生成されたルート値のセットです。</span><span class="sxs-lookup"><span data-stu-id="63b81-153">The `AmbientValues` are the set of route values that were produced from matching the current request with the routing system.</span></span> <span data-ttu-id="63b81-154">これに対し、`Values`は現在の操作の必要な URL を生成する方法を指定するルートの値。</span><span class="sxs-lookup"><span data-stu-id="63b81-154">In contrast, `Values` are the route values that specify how to generate the desired URL for the current operation.</span></span> <span data-ttu-id="63b81-155">`HttpContext`ルートは、サービス、または現在のコンテキストに関連付けられている追加のデータを取得する必要がある場合に提供します。</span><span class="sxs-lookup"><span data-stu-id="63b81-155">The `HttpContext` is provided in case a route needs to get services or additional data associated with the current context.</span></span>

<span data-ttu-id="63b81-156">ヒント: 考える`Values`の上書きのセットとして、`AmbientValues`です。</span><span class="sxs-lookup"><span data-stu-id="63b81-156">Tip: Think of `Values` as being a set of overrides for the `AmbientValues`.</span></span> <span data-ttu-id="63b81-157">URL の生成は、同じルートまたはルートの値を使用してリンクの Url を生成するが簡単に現在の要求からのルート値を再利用しようとします。</span><span class="sxs-lookup"><span data-stu-id="63b81-157">URL generation tries to reuse route values from the current request to make it easy to generate URLs for links using the same route or route values.</span></span>

<span data-ttu-id="63b81-158">出力`GetVirtualPath`は、`VirtualPathData`です。</span><span class="sxs-lookup"><span data-stu-id="63b81-158">The output of `GetVirtualPath` is a `VirtualPathData`.</span></span> <span data-ttu-id="63b81-159">`VirtualPathData`並列は`RouteData`; が含まれている、`VirtualPath`出力 URL としていくつか追加プロパティをルートで設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="63b81-159">`VirtualPathData` is a parallel of `RouteData`; it contains the `VirtualPath` for the output URL as well as the some additional properties that should be set by the route.</span></span>

<span data-ttu-id="63b81-160">`VirtualPathData.VirtualPath`プロパティが含まれています、*仮想パス*ルートによって生成されます。</span><span class="sxs-lookup"><span data-stu-id="63b81-160">The `VirtualPathData.VirtualPath` property contains the *virtual path* produced by the route.</span></span> <span data-ttu-id="63b81-161">必要に応じて、さらに、パスを処理する必要があります。</span><span class="sxs-lookup"><span data-stu-id="63b81-161">Depending on your needs you may need to process the path further.</span></span> <span data-ttu-id="63b81-162">たとえば、html 形式で生成された URL を表示する場合は、前に、アプリケーションのベース パスを付加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="63b81-162">For instance, if you want to render the generated URL in HTML you need to prepend the base path of the application.</span></span>

<span data-ttu-id="63b81-163">`VirtualPathData.Router` URL が正常に生成されるルートへの参照です。</span><span class="sxs-lookup"><span data-stu-id="63b81-163">The `VirtualPathData.Router` is a reference to the route that successfully generated the URL.</span></span>

<span data-ttu-id="63b81-164">`VirtualPathData.DataTokens`プロパティは、URL を生成するルートに関連するその他のデータのディクショナリ。</span><span class="sxs-lookup"><span data-stu-id="63b81-164">The `VirtualPathData.DataTokens` properties is a dictionary of additional data related to the route that generated the URL.</span></span> <span data-ttu-id="63b81-165">これは、並列`RouteData.DataTokens`です。</span><span class="sxs-lookup"><span data-stu-id="63b81-165">This is the parallel of `RouteData.DataTokens`.</span></span>

### <a name="creating-routes"></a><span data-ttu-id="63b81-166">ルートの作成</span><span class="sxs-lookup"><span data-stu-id="63b81-166">Creating routes</span></span>

<span data-ttu-id="63b81-167">ルーティングを提供、`Route`クラスの標準実装として`IRouter`です。</span><span class="sxs-lookup"><span data-stu-id="63b81-167">Routing provides the `Route` class as the standard implementation of `IRouter`.</span></span> <span data-ttu-id="63b81-168">`Route`使用して、*ルート テンプレート*URL パスに対して一致するパターンを定義するための構文と`RouteAsync`と呼びます。</span><span class="sxs-lookup"><span data-stu-id="63b81-168">`Route` uses the *route template* syntax to define patterns that will match against the URL path when `RouteAsync` is called.</span></span> <span data-ttu-id="63b81-169">`Route`URL の生成に、同じルート テンプレートを使用するときに`GetVirtualPath`と呼びます。</span><span class="sxs-lookup"><span data-stu-id="63b81-169">`Route` will use the same route template to generate a URL when `GetVirtualPath` is called.</span></span>

<span data-ttu-id="63b81-170">ほとんどのアプリケーションが呼び出すことによってルートを作成、`MapRoute`で定義されているような拡張メソッドのいずれかまたは`IRouteBuilder`です。</span><span class="sxs-lookup"><span data-stu-id="63b81-170">Most applications will create routes by calling `MapRoute` or one of the similar extension methods defined on `IRouteBuilder`.</span></span> <span data-ttu-id="63b81-171">これらのメソッドのすべてのインスタンスを作成`Route`ルートのコレクションに追加します。</span><span class="sxs-lookup"><span data-stu-id="63b81-171">All of these methods will create an instance of `Route` and add it to the route collection.</span></span>

<span data-ttu-id="63b81-172">注:`MapRoute`は、ルート ハンドラー パラメーターを受け取らないによって処理されるルートを追加するだけ、`DefaultHandler`です。</span><span class="sxs-lookup"><span data-stu-id="63b81-172">Note: `MapRoute` doesn't take a route handler parameter - it only adds routes that will be handled by the `DefaultHandler`.</span></span> <span data-ttu-id="63b81-173">既定のハンドラーはなので、`IRouter`要求を処理するためにないことがあります。</span><span class="sxs-lookup"><span data-stu-id="63b81-173">Since the default handler is an `IRouter`, it may decide not to handle the request.</span></span> <span data-ttu-id="63b81-174">たとえば、ASP.NET MVC 通常構成のみを処理する既定のハンドラーは、使用可能なコント ローラーとアクションに一致するを要求します。</span><span class="sxs-lookup"><span data-stu-id="63b81-174">For example, ASP.NET MVC is typically configured as a default handler that only handles requests that match an available controller and action.</span></span> <span data-ttu-id="63b81-175">Mvc ルーティングの詳細については、次を参照してください。[コント ローラー アクションへのルーティング](../mvc/controllers/routing.md)です。</span><span class="sxs-lookup"><span data-stu-id="63b81-175">To learn more about routing to MVC, see [Routing to Controller Actions](../mvc/controllers/routing.md).</span></span>

<span data-ttu-id="63b81-176">これは、例、`MapRoute`典型的な ASP.NET MVC ルート定義で使用される呼び出し。</span><span class="sxs-lookup"><span data-stu-id="63b81-176">This is an example of a `MapRoute` call used by a typical ASP.NET MVC route definition:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="63b81-177">このテンプレートはのような URL パスを一致`/Products/Details/17`およびルート値を抽出`{ controller = Products, action = Details, id = 17 }`です。</span><span class="sxs-lookup"><span data-stu-id="63b81-177">This template will match a URL path like `/Products/Details/17` and extract the route values `{ controller = Products, action = Details, id = 17 }`.</span></span> <span data-ttu-id="63b81-178">ルートの値が決定される URL パスをセグメントに分割されそれぞれのセグメントに一致する、*パラメーターをルート*ルート テンプレートの名前。</span><span class="sxs-lookup"><span data-stu-id="63b81-178">The route values are determined by splitting the URL path into segments, and matching each segment with the *route parameter* name in the route template.</span></span> <span data-ttu-id="63b81-179">ルート パラメーターがという名前です。</span><span class="sxs-lookup"><span data-stu-id="63b81-179">Route parameters are named.</span></span> <span data-ttu-id="63b81-180">中かっこでパラメーター名を囲むことによって定義される`{ }`です。</span><span class="sxs-lookup"><span data-stu-id="63b81-180">They're defined by enclosing the parameter name in braces `{ }`.</span></span>

<span data-ttu-id="63b81-181">上記のテンプレートは、URL パスを一致もでした`/`と値が生成されると`{ controller = Home, action = Index }`です。</span><span class="sxs-lookup"><span data-stu-id="63b81-181">The template above could also match the URL path `/` and would produce the values `{ controller = Home, action = Index }`.</span></span> <span data-ttu-id="63b81-182">これは、`{controller}`と`{action}`ルート パラメーターが既定値を持つ、`id`ルートのパラメーターは省略可能です。</span><span class="sxs-lookup"><span data-stu-id="63b81-182">This happens because the `{controller}` and `{action}` route parameters have default values, and the `id` route parameter is optional.</span></span> <span data-ttu-id="63b81-183">等号`=`記号続く値ルートのパラメーター名は、パラメーターの既定値を定義した後です。</span><span class="sxs-lookup"><span data-stu-id="63b81-183">An equals `=` sign followed by a value after the route parameter name defines a default value for the parameter.</span></span> <span data-ttu-id="63b81-184">疑問符 ()`?`後、ルートのパラメーター名は、オプションとして、パラメーターを定義します。</span><span class="sxs-lookup"><span data-stu-id="63b81-184">A question mark `?` after the route parameter name defines the parameter as optional.</span></span> <span data-ttu-id="63b81-185">既定値を持つパラメーターをルート*常に*ルートに一致する - 対応する URL パスのセグメントがない場合、省略可能なパラメーターはルート値を生成しない場合は、ルート値を生成します。</span><span class="sxs-lookup"><span data-stu-id="63b81-185">Route parameters with a default value *always* produce a route value when the route matches - optional parameters won't produce a route value if there was no corresponding URL path segment.</span></span>

<span data-ttu-id="63b81-186">参照してください[ルート テンプレート参照](#route-template-reference)ルート テンプレートの機能と構文の詳細な説明をします。</span><span class="sxs-lookup"><span data-stu-id="63b81-186">See [route-template-reference](#route-template-reference) for a thorough description of route template features and syntax.</span></span>

<span data-ttu-id="63b81-187">この例では、*制約をルーティング*:</span><span class="sxs-lookup"><span data-stu-id="63b81-187">This example includes a *route constraint*:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id:int}");
```

<span data-ttu-id="63b81-188">このテンプレートはのような URL パスを一致`/Products/Details/17`、ではなく`/Products/Details/Apples`です。</span><span class="sxs-lookup"><span data-stu-id="63b81-188">This template will match a URL path like `/Products/Details/17`, but not `/Products/Details/Apples`.</span></span> <span data-ttu-id="63b81-189">ルートのパラメーター定義`{id:int}`定義、*制約をルーティング*の`id`パラメーターをルーティングします。</span><span class="sxs-lookup"><span data-stu-id="63b81-189">The route parameter definition `{id:int}` defines a *route constraint* for the `id` route parameter.</span></span> <span data-ttu-id="63b81-190">ルート制約を実装`IRouteConstraint`を確認するルートの値を調べるとします。</span><span class="sxs-lookup"><span data-stu-id="63b81-190">Route constraints implement `IRouteConstraint` and inspect route values to verify them.</span></span> <span data-ttu-id="63b81-191">この例のルートの値で`id`整数に変換できる必要があります。</span><span class="sxs-lookup"><span data-stu-id="63b81-191">In this example the route value `id` must be convertible to an integer.</span></span> <span data-ttu-id="63b81-192">参照してください[ルート制約参照](#route-constraint-reference)フレームワークによって提供されるルート制約の詳細についてはします。</span><span class="sxs-lookup"><span data-stu-id="63b81-192">See [route-constraint-reference](#route-constraint-reference) for a more detailed explanation of route constraints that are provided by the framework.</span></span>

<span data-ttu-id="63b81-193">その他のオーバー ロード`MapRoute`の値を受け入れる`constraints`、 `dataTokens`、および`defaults`です。</span><span class="sxs-lookup"><span data-stu-id="63b81-193">Additional overloads of `MapRoute` accept values for `constraints`, `dataTokens`, and `defaults`.</span></span> <span data-ttu-id="63b81-194">これらの追加パラメーターの`MapRoute`型として定義する`object`です。</span><span class="sxs-lookup"><span data-stu-id="63b81-194">These additional parameters of `MapRoute` are defined as type `object`.</span></span> <span data-ttu-id="63b81-195">これらのパラメーターの一般的な使用法では、匿名型に一致するプロパティ名がパラメーター名をルーティングに匿名型のオブジェクトを渡します。</span><span class="sxs-lookup"><span data-stu-id="63b81-195">The typical usage of these parameters is to pass an anonymously typed object, where the property names of the anonymous type match route parameter names.</span></span>

<span data-ttu-id="63b81-196">次の 2 つの例では、同等のルートを作成します。</span><span class="sxs-lookup"><span data-stu-id="63b81-196">The following two examples create equivalent routes:</span></span>

```csharp
routes.MapRoute(
    name: "default_route",
    template: "{controller}/{action}/{id?}",
    defaults: new { controller = "Home", action = "Index" });

routes.MapRoute(
    name: "default_route",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="63b81-197">ヒント: と既定の制約を定義するためのインライン構文を単純なルートの方が便利にすることができます。</span><span class="sxs-lookup"><span data-stu-id="63b81-197">Tip: The inline syntax for defining constraints and defaults can be more convenient for simple routes.</span></span> <span data-ttu-id="63b81-198">ただし、これにはインライン構文でサポートされていないデータ トークンなどの機能があります。</span><span class="sxs-lookup"><span data-stu-id="63b81-198">However, there are features such as data tokens which are not supported by inline syntax.</span></span>

<span data-ttu-id="63b81-199">この例より多くの機能をいくつかを示します。</span><span class="sxs-lookup"><span data-stu-id="63b81-199">This example demonstrates a few more features:</span></span>

```csharp
routes.MapRoute(
  name: "blog",
  template: "Blog/{*article}",
  defaults: new { controller = "Blog", action = "ReadArticle" });
```

<span data-ttu-id="63b81-200">このテンプレートはのような URL パスを一致`/Blog/All-About-Routing/Introduction`の値を抽出および`{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }`です。</span><span class="sxs-lookup"><span data-stu-id="63b81-200">This template will match a URL path like `/Blog/All-About-Routing/Introduction` and will extract the values `{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }`.</span></span> <span data-ttu-id="63b81-201">既定のルートの値を`controller`と`action`テンプレートに対応するルートのパラメーターがない場合でも、ルートによって生成されます。</span><span class="sxs-lookup"><span data-stu-id="63b81-201">The default route values for `controller` and `action` are produced by the route even though there are no corresponding route parameters in the template.</span></span> <span data-ttu-id="63b81-202">既定値は、ルート テンプレートで指定できます。</span><span class="sxs-lookup"><span data-stu-id="63b81-202">Default values can be specified in the route template.</span></span> <span data-ttu-id="63b81-203">`article`としてルートのパラメーターが定義されている、*キャッチ オール*アスタリスクの見た目で`*`ルートのパラメーター名の前にします。</span><span class="sxs-lookup"><span data-stu-id="63b81-203">The `article` route parameter is defined as a *catch-all* by the appearance of an asterisk `*` before the route parameter name.</span></span> <span data-ttu-id="63b81-204">キャッチ オール ルート パラメーターは、URL パスの残りの部分をキャプチャし、空の文字列を一致もできます。</span><span class="sxs-lookup"><span data-stu-id="63b81-204">Catch-all route parameters capture the remainder of the URL path, and can also match the empty string.</span></span>

<span data-ttu-id="63b81-205">この例は、ルートの制約とデータのトークンを追加します。</span><span class="sxs-lookup"><span data-stu-id="63b81-205">This example adds route constraints and data tokens:</span></span>

```csharp
routes.MapRoute(
    name: "us_english_products",
    template: "en-US/Products/{id}",
    defaults: new { controller = "Products", action = "Details" },
    constraints: new { id = new IntRouteConstraint() },
    dataTokens: new { locale = "en-US" });
```

<span data-ttu-id="63b81-206">このテンプレートはのような URL パスを一致`/Products/5`の値を抽出および`{ controller = Products, action = Details, id = 5 }`およびデータ トークン`{ locale = en-US }`です。</span><span class="sxs-lookup"><span data-stu-id="63b81-206">This template will match a URL path like `/Products/5` and will extract the values `{ controller = Products, action = Details, id = 5 }` and the data tokens `{ locale = en-US }`.</span></span>

![[ローカル] ウィンドウのトークン](routing/_static/tokens.png)

<a name="id1"></a>

### <a name="url-generation"></a><span data-ttu-id="63b81-208">URL の生成</span><span class="sxs-lookup"><span data-stu-id="63b81-208">URL generation</span></span>

<span data-ttu-id="63b81-209">`Route`クラスがそのルート テンプレートでルートの値のセットを組み合わせることで URL の生成も実行できます。</span><span class="sxs-lookup"><span data-stu-id="63b81-209">The `Route` class can also perform URL generation by combining a set of route values with its route template.</span></span> <span data-ttu-id="63b81-210">これは、URL パスに一致する逆のプロセスでは論理的にします。</span><span class="sxs-lookup"><span data-stu-id="63b81-210">This is logically the reverse process of matching the URL path.</span></span>

<span data-ttu-id="63b81-211">ヒント: URL の生成を理解するのには、どのような URL を生成し、ルートのテンプレートがその URL を照合する方法について検討するを想像してください。</span><span class="sxs-lookup"><span data-stu-id="63b81-211">Tip: To better understand URL generation, imagine what URL you want to generate and then think about how a route template would match that URL.</span></span> <span data-ttu-id="63b81-212">どのような値が生成されます。</span><span class="sxs-lookup"><span data-stu-id="63b81-212">What values would be produced?</span></span> <span data-ttu-id="63b81-213">これは、URL の生成がでどのように動作するためにのみ、相当、`Route`クラスです。</span><span class="sxs-lookup"><span data-stu-id="63b81-213">This is the rough equivalent of how URL generation works in the `Route` class.</span></span>

<span data-ttu-id="63b81-214">この例では、基本的な ASP.NET MVC スタイルのルートを使用します。</span><span class="sxs-lookup"><span data-stu-id="63b81-214">This example uses a basic ASP.NET MVC style route:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="63b81-215">ルート値を持つ`{ controller = Products, action = List }`、このルートが URL の生成`/Products/List`です。</span><span class="sxs-lookup"><span data-stu-id="63b81-215">With the route values `{ controller = Products, action = List }`, this route will generate the URL `/Products/List`.</span></span> <span data-ttu-id="63b81-216">ルートの値は、URL パスを形成する対応するルート パラメーターの置換されます。</span><span class="sxs-lookup"><span data-stu-id="63b81-216">The route values are substituted for the corresponding route parameters to form the URL path.</span></span> <span data-ttu-id="63b81-217">`id`は省略可能なパラメーターのルーティング、問題の値が含まれないことはありません。</span><span class="sxs-lookup"><span data-stu-id="63b81-217">Since `id` is an optional route parameter, it's no problem that it doesn't have a value.</span></span>

<span data-ttu-id="63b81-218">ルート値を持つ`{ controller = Home, action = Index }`、このルートが URL の生成`/`です。</span><span class="sxs-lookup"><span data-stu-id="63b81-218">With the route values `{ controller = Home, action = Index }`, this route will generate the URL `/`.</span></span> <span data-ttu-id="63b81-219">それらの値に対応するセグメントを安全に省略するための既定値を指定されたルートの値に一致します。</span><span class="sxs-lookup"><span data-stu-id="63b81-219">The route values that were provided match the default values so the segments corresponding to those values can be safely omitted.</span></span> <span data-ttu-id="63b81-220">生成されたどちらの Url がこのルート定義のラウンド トリップは、URL の生成に使用された同じルートの値を生成ことに注意してください。</span><span class="sxs-lookup"><span data-stu-id="63b81-220">Note that both URLs generated would round-trip with this route definition and produce the same route values that were used to generate the URL.</span></span>

<span data-ttu-id="63b81-221">ヒント: ASP.NET MVC を使用してアプリを使用する必要があります`UrlHelper`を直接ルーティングを呼び出す代わりに Url を生成します。</span><span class="sxs-lookup"><span data-stu-id="63b81-221">Tip: An app using ASP.NET MVC should use `UrlHelper` to generate URLs instead of calling into routing directly.</span></span>

<span data-ttu-id="63b81-222">URL の生成処理の詳細については、次を参照してください。 [url 生成参照](#url-generation-reference)です。</span><span class="sxs-lookup"><span data-stu-id="63b81-222">For more details about the URL generation process, see [url-generation-reference](#url-generation-reference).</span></span>

## <a name="using-routing-middleware"></a><span data-ttu-id="63b81-223">ルーティングのミドルウェアを使用してください。</span><span class="sxs-lookup"><span data-stu-id="63b81-223">Using Routing Middleware</span></span>

<span data-ttu-id="63b81-224">NuGet パッケージ"Microsoft.AspNetCore.Routing"を追加します。</span><span class="sxs-lookup"><span data-stu-id="63b81-224">Add the NuGet package "Microsoft.AspNetCore.Routing".</span></span>

<span data-ttu-id="63b81-225">追加のサービス コンテナーにルーティング*Startup.cs*:</span><span class="sxs-lookup"><span data-stu-id="63b81-225">Add routing to the service container in *Startup.cs*:</span></span>

[!code-csharp[Main](../fundamentals/routing/sample/RoutingSample/Startup.cs?highlight=3&start=11&end=14)]

<span data-ttu-id="63b81-226">ルートを構成する必要があります、`Configure`メソッドで、`Startup`クラスです。</span><span class="sxs-lookup"><span data-stu-id="63b81-226">Routes must be configured in the `Configure` method in the `Startup` class.</span></span> <span data-ttu-id="63b81-227">次のサンプルでは、これらの Api を使用します。</span><span class="sxs-lookup"><span data-stu-id="63b81-227">The sample below uses these APIs:</span></span>

* `RouteBuilder`
* `Build`
* <span data-ttu-id="63b81-228">`MapGet`HTTP GET 要求だけを一致します。</span><span class="sxs-lookup"><span data-stu-id="63b81-228">`MapGet`  Matches only HTTP GET requests</span></span>
* `UseRouter`

```csharp
public void Configure(IApplicationBuilder app, ILoggerFactory loggerFactory)
{
    var trackPackageRouteHandler = new RouteHandler(context =>
    {
        var routeValues = context.GetRouteData().Values;
        return context.Response.WriteAsync(
            $"Hello! Route values: {string.Join(", ", routeValues)}");
    });

    var routeBuilder = new RouteBuilder(app, trackPackageRouteHandler);

    routeBuilder.MapRoute(
        "Track Package Route",
        "package/{operation:regex(^(track|create|detonate)$)}/{id:int}");

    routeBuilder.MapGet("hello/{name}", context =>
    {
        var name = context.GetRouteValue("name");
        // This is the route handler when HTTP GET "hello/<anything>"  matches
        // To match HTTP GET "hello/<anything>/<anything>,
        // use routeBuilder.MapGet("hello/{*name}"
        return context.Response.WriteAsync($"Hi, {name}!");
    });

    var routes = routeBuilder.Build();
    app.UseRouter(routes);
}
```

<span data-ttu-id="63b81-229">次の表は、指定された Uri に応答を示しています。</span><span class="sxs-lookup"><span data-stu-id="63b81-229">The table below shows the responses with the given URIs.</span></span>

| <span data-ttu-id="63b81-230">URI</span><span class="sxs-lookup"><span data-stu-id="63b81-230">URI</span></span> | <span data-ttu-id="63b81-231">応答</span><span class="sxs-lookup"><span data-stu-id="63b81-231">Response</span></span>  |
| ------- | -------- |
| <span data-ttu-id="63b81-232">/package/create/3</span><span class="sxs-lookup"><span data-stu-id="63b81-232">/package/create/3</span></span>  | <span data-ttu-id="63b81-233">Hello!</span><span class="sxs-lookup"><span data-stu-id="63b81-233">Hello!</span></span> <span data-ttu-id="63b81-234">ルート値: [操作の作成]、[id、3]</span><span class="sxs-lookup"><span data-stu-id="63b81-234">Route values: [operation, create], [id, 3]</span></span> |
| <span data-ttu-id="63b81-235">/package/track/-3</span><span class="sxs-lookup"><span data-stu-id="63b81-235">/package/track/-3</span></span>  | <span data-ttu-id="63b81-236">Hello!</span><span class="sxs-lookup"><span data-stu-id="63b81-236">Hello!</span></span> <span data-ttu-id="63b81-237">ルート値: [操作、トラック]、[id、-3]</span><span class="sxs-lookup"><span data-stu-id="63b81-237">Route values: [operation, track], [id, -3]</span></span> |
| <span data-ttu-id="63b81-238">/package/track/-3/</span><span class="sxs-lookup"><span data-stu-id="63b81-238">/package/track/-3/</span></span> | <span data-ttu-id="63b81-239">Hello!</span><span class="sxs-lookup"><span data-stu-id="63b81-239">Hello!</span></span> <span data-ttu-id="63b81-240">ルート値: [操作、トラック]、[id、-3]</span><span class="sxs-lookup"><span data-stu-id="63b81-240">Route values: [operation, track], [id, -3]</span></span>  |
| <span data-ttu-id="63b81-241">/package/track/</span><span class="sxs-lookup"><span data-stu-id="63b81-241">/package/track/</span></span> | <span data-ttu-id="63b81-242">\<フォール スルー、一致なし ></span><span class="sxs-lookup"><span data-stu-id="63b81-242">\<Fall through, no match></span></span> |
| <span data-ttu-id="63b81-243">GET /hello/Joe</span><span class="sxs-lookup"><span data-stu-id="63b81-243">GET /hello/Joe</span></span> | <span data-ttu-id="63b81-244">よろしくお願い Joe!</span><span class="sxs-lookup"><span data-stu-id="63b81-244">Hi, Joe!</span></span> |
| <span data-ttu-id="63b81-245">POST /hello/Joe</span><span class="sxs-lookup"><span data-stu-id="63b81-245">POST /hello/Joe</span></span> | <span data-ttu-id="63b81-246">\<フォール スルーする、一致する HTTP GET のみ ></span><span class="sxs-lookup"><span data-stu-id="63b81-246">\<Fall through, matches HTTP GET only></span></span> |
| <span data-ttu-id="63b81-247">GET /hello/Joe/Smith</span><span class="sxs-lookup"><span data-stu-id="63b81-247">GET /hello/Joe/Smith</span></span> | <span data-ttu-id="63b81-248">\<フォール スルー、一致なし ></span><span class="sxs-lookup"><span data-stu-id="63b81-248">\<Fall through, no match></span></span> |

<span data-ttu-id="63b81-249">1 つのルートを構成する場合を呼び出す`app.UseRouter`を渡して、`IRouter`インスタンス。</span><span class="sxs-lookup"><span data-stu-id="63b81-249">If you are configuring a single route, call `app.UseRouter` passing in an `IRouter` instance.</span></span> <span data-ttu-id="63b81-250">呼び出す必要はありません`RouteBuilder`です。</span><span class="sxs-lookup"><span data-stu-id="63b81-250">You won't need to call `RouteBuilder`.</span></span>

<span data-ttu-id="63b81-251">フレームワークなどのルートを作成するための拡張メソッドのセットを提供します。</span><span class="sxs-lookup"><span data-stu-id="63b81-251">The framework provides a set of extension methods for creating routes such as:</span></span>

* `MapRoute`
* `MapGet`
* `MapPost`
* `MapPut`
* `MapDelete`
* `MapVerb`

<span data-ttu-id="63b81-252">これらのメソッドのようにいくつか`MapGet`が必要、`RequestDelegate`を提供します。</span><span class="sxs-lookup"><span data-stu-id="63b81-252">Some of these methods such as `MapGet` require a `RequestDelegate` to be provided.</span></span> <span data-ttu-id="63b81-253">`RequestDelegate`として使用される、*ルート ハンドラー*ルートに一致する場合。</span><span class="sxs-lookup"><span data-stu-id="63b81-253">The `RequestDelegate` will be used as the *route handler* when the route matches.</span></span> <span data-ttu-id="63b81-254">このファミリの他のメソッドは、ルートのハンドラーとして使用されるミドルウェア パイプラインを構成できるようにします。</span><span class="sxs-lookup"><span data-stu-id="63b81-254">Other methods in this family allow configuring a middleware pipeline which will be used as the route handler.</span></span> <span data-ttu-id="63b81-255">場合、*マップ*メソッド受け取らない、ハンドラーなど`MapRoute`が使用されます、`DefaultHandler`です。</span><span class="sxs-lookup"><span data-stu-id="63b81-255">If the *Map* method doesn't accept a handler, such as `MapRoute`, then it will use the `DefaultHandler`.</span></span>

<span data-ttu-id="63b81-256">`Map[Verb]`メソッドは、HTTP 動詞、メソッド名へのルートを制限する制約を使用します。</span><span class="sxs-lookup"><span data-stu-id="63b81-256">The `Map[Verb]` methods use constraints to limit the route to the HTTP Verb in the method name.</span></span> <span data-ttu-id="63b81-257">たとえばを参照してください[MapGet](https://github.com/aspnet/Routing/blob/1.0.0/src/Microsoft.AspNetCore.Routing/RequestDelegateRouteBuilderExtensions.cs#L85-L88)と[MapVerb](https://github.com/aspnet/Routing/blob/1.0.0/src/Microsoft.AspNetCore.Routing/RequestDelegateRouteBuilderExtensions.cs#L156-L180)です。</span><span class="sxs-lookup"><span data-stu-id="63b81-257">For example, see [MapGet](https://github.com/aspnet/Routing/blob/1.0.0/src/Microsoft.AspNetCore.Routing/RequestDelegateRouteBuilderExtensions.cs#L85-L88) and [MapVerb](https://github.com/aspnet/Routing/blob/1.0.0/src/Microsoft.AspNetCore.Routing/RequestDelegateRouteBuilderExtensions.cs#L156-L180).</span></span>

## <a name="route-template-reference"></a><span data-ttu-id="63b81-258">ルート テンプレート リファレンス</span><span class="sxs-lookup"><span data-stu-id="63b81-258">Route Template Reference</span></span>

<span data-ttu-id="63b81-259">中かっこ内のトークン (`{ }`) 定義*パラメーターをルート*ルートが一致する場合がバインドされます。</span><span class="sxs-lookup"><span data-stu-id="63b81-259">Tokens within curly braces (`{ }`) define *route parameters* which will be bound if the route is matched.</span></span> <span data-ttu-id="63b81-260">セグメントでは、ルート、1 つ以上のルート パラメーターを定義できますが、これらは、リテラル値で区切る必要があります。</span><span class="sxs-lookup"><span data-stu-id="63b81-260">You can define more than one route parameter in a route segment, but they must be separated by a literal value.</span></span> <span data-ttu-id="63b81-261">たとえば`{controller=Home}{action=Index}`間でのリテラル値が存在しないために、有効なルートをでしょう`{controller}`と`{action}`です。</span><span class="sxs-lookup"><span data-stu-id="63b81-261">For example `{controller=Home}{action=Index}` wouldn't be a valid route, since there's no literal value between `{controller}` and `{action}`.</span></span> <span data-ttu-id="63b81-262">これらのルートのパラメーターには、名前が必要です。 と指定可能性があります追加の属性です。</span><span class="sxs-lookup"><span data-stu-id="63b81-262">These route parameters must have a name, and may have additional attributes specified.</span></span>

<span data-ttu-id="63b81-263">ルートのパラメーターとは別のリテラル テキスト (たとえば、 `{id}`) およびパスの区切り文字`/`URL 内のテキストに一致する必要があります。</span><span class="sxs-lookup"><span data-stu-id="63b81-263">Literal text other than route parameters (for example, `{id}`) and the path separator `/` must match the text in the URL.</span></span> <span data-ttu-id="63b81-264">テキストの一致するとは区別されず、Url パスのデコードされた形式に基づいて。</span><span class="sxs-lookup"><span data-stu-id="63b81-264">Text matching is case-insensitive and based on the decoded representation of the URLs path.</span></span> <span data-ttu-id="63b81-265">リテラルのルート パラメーターの区切り記号に一致する`{`または`}`、文字の繰り返しでエスケープ (`{{`または`}}`)。</span><span class="sxs-lookup"><span data-stu-id="63b81-265">To match the literal route parameter delimiter `{` or  `}`, escape it by repeating the character (`{{` or `}}`).</span></span>

<span data-ttu-id="63b81-266">省略可能なファイル拡張子を持つファイル名をキャプチャしようとする URL パターンでは、追加の考慮事項があります。</span><span class="sxs-lookup"><span data-stu-id="63b81-266">URL patterns that attempt to capture a filename with an optional file extension have additional considerations.</span></span> <span data-ttu-id="63b81-267">たとえば、テンプレートを使用して`files/{filename}.{ext?}`: 両方`filename`と`ext`存在、両方の値が設定されます。</span><span class="sxs-lookup"><span data-stu-id="63b81-267">For example, using the template `files/{filename}.{ext?}` - When both `filename` and `ext` exist, both values will be populated.</span></span> <span data-ttu-id="63b81-268">だけの場合`filename`URL、ルートの一致である末尾のピリオド`.`は省略可能です。</span><span class="sxs-lookup"><span data-stu-id="63b81-268">If only `filename` exists in the URL, the route matches because the trailing period `.` is  optional.</span></span> <span data-ttu-id="63b81-269">次の Url には、このルートは一致します。</span><span class="sxs-lookup"><span data-stu-id="63b81-269">The following URLs would match this route:</span></span>

* `/files/myFile.txt`
* `/files/myFile.`
* `/files/myFile`

<span data-ttu-id="63b81-270">使用することができます、`*`をプレフィックスとして文字 - URI の残りの部分にバインドするルートのパラメーターにこれと呼ばれる、*キャッチ オール*パラメーター。</span><span class="sxs-lookup"><span data-stu-id="63b81-270">You can use the `*` character as a prefix to a route parameter to bind to the rest of the URI - this is called a *catch-all* parameter.</span></span> <span data-ttu-id="63b81-271">たとえば、`blog/{*slug}`の使用を開始する任意の URI が一致する`/blog`され、それに続く任意の値 (に割り当てられます`slug`ルーティング値)。</span><span class="sxs-lookup"><span data-stu-id="63b81-271">For example, `blog/{*slug}` would match any URI that started with `/blog` and had any value following it (which would be assigned to the `slug` route value).</span></span> <span data-ttu-id="63b81-272">キャッチ オール パラメーターでは、空の文字列が一致もできます。</span><span class="sxs-lookup"><span data-stu-id="63b81-272">Catch-all parameters can also match the empty string.</span></span>

<span data-ttu-id="63b81-273">ルート パラメーターがあります*既定値*で区切られたパラメーター名の後に既定値を指定することによって指定された、`=`です。</span><span class="sxs-lookup"><span data-stu-id="63b81-273">Route parameters may have *default values*, designated by specifying the default after the parameter name, separated by an `=`.</span></span> <span data-ttu-id="63b81-274">たとえば、`{controller=Home}`定義`Home`の既定値として`controller`です。</span><span class="sxs-lookup"><span data-stu-id="63b81-274">For example, `{controller=Home}` would define `Home` as the default value for `controller`.</span></span> <span data-ttu-id="63b81-275">既定値は、値がない場合、URL でパラメーターに使用されます。</span><span class="sxs-lookup"><span data-stu-id="63b81-275">The default value is used if no value is present in the URL for the parameter.</span></span> <span data-ttu-id="63b81-276">既定値だけでなく、ルート パラメーターが、省略可能な可能性があります (追加することによって指定された、`?`に示すように、パラメーター名の末尾に`id?`)。</span><span class="sxs-lookup"><span data-stu-id="63b81-276">In addition to default values, route parameters may be optional (specified by appending a `?` to the end of the parameter name, as in `id?`).</span></span> <span data-ttu-id="63b81-277">オプションの違い、ルート パラメーターで、既定値は、値を常に生成は、「既定値あり」と提供されている場合にのみ、省略可能なパラメーターは値を持ちます。</span><span class="sxs-lookup"><span data-stu-id="63b81-277">The difference between optional and "has default" is that a route parameter with a default value always produces a value; an optional parameter has a value only when one is provided.</span></span>

<span data-ttu-id="63b81-278">ルート パラメーターには、URL からバインド ルートの値に一致する必要がありますの制約があります。</span><span class="sxs-lookup"><span data-stu-id="63b81-278">Route parameters may also have constraints, which must match the route value bound from the URL.</span></span> <span data-ttu-id="63b81-279">コロンを追加する`:`およびルートのパラメーター名を指定した後、制約の名前、*インライン制約*ルートのパラメーターにします。</span><span class="sxs-lookup"><span data-stu-id="63b81-279">Adding a colon `:` and constraint name after the route parameter name specifies an *inline constraint* on a route parameter.</span></span> <span data-ttu-id="63b81-280">制約には、かっこで囲まれたものは、指定された引数が必要な場合`( )`制約名の後にします。</span><span class="sxs-lookup"><span data-stu-id="63b81-280">If the constraint requires arguments those are provided enclosed in parentheses `( )` after the constraint name.</span></span> <span data-ttu-id="63b81-281">もう 1 つのコロンを追加することによって複数のインライン制約を指定することができます`:`および制約の名前。</span><span class="sxs-lookup"><span data-stu-id="63b81-281">Multiple inline constraints can be specified by appending another colon `:` and constraint name.</span></span> <span data-ttu-id="63b81-282">制約の名前が渡される、`IInlineConstraintResolver`のインスタンスを作成するサービスを`IRouteConstraint`URL の処理で使用します。</span><span class="sxs-lookup"><span data-stu-id="63b81-282">The constraint name is passed to the `IInlineConstraintResolver` service to create an instance of `IRouteConstraint` to use in URL processing.</span></span> <span data-ttu-id="63b81-283">たとえば、ルート テンプレート`blog/{article:minlength(10)}`を指定します、`minlength`引数を指定した制約`10`です。</span><span class="sxs-lookup"><span data-stu-id="63b81-283">For example, the route template `blog/{article:minlength(10)}` specifies the `minlength` constraint with the argument `10`.</span></span> <span data-ttu-id="63b81-284">多くの説明のルート制約と、フレームワークによって提供される制約の一覧は、次を参照してください。[ルート制約参照](#route-constraint-reference)です。</span><span class="sxs-lookup"><span data-stu-id="63b81-284">For more description route constraints, and a listing of the constraints provided by the framework, see [route-constraint-reference](#route-constraint-reference).</span></span>

<span data-ttu-id="63b81-285">次の表は、一部のルート テンプレートとその動作について説明します。</span><span class="sxs-lookup"><span data-stu-id="63b81-285">The following table demonstrates some route templates and their behavior.</span></span>

| <span data-ttu-id="63b81-286">ルート テンプレート</span><span class="sxs-lookup"><span data-stu-id="63b81-286">Route Template</span></span> | <span data-ttu-id="63b81-287">一致する URL の例</span><span class="sxs-lookup"><span data-stu-id="63b81-287">Example Matching URL</span></span> | <span data-ttu-id="63b81-288">メモ</span><span class="sxs-lookup"><span data-stu-id="63b81-288">Notes</span></span> |
| -------- | -------- | ------- |
| <span data-ttu-id="63b81-289">hello</span><span class="sxs-lookup"><span data-stu-id="63b81-289">hello</span></span>  | <span data-ttu-id="63b81-290">/hello</span><span class="sxs-lookup"><span data-stu-id="63b81-290">/hello</span></span>  | <span data-ttu-id="63b81-291">1 つのパスとのみ一致します。`/hello`</span><span class="sxs-lookup"><span data-stu-id="63b81-291">Only matches the single path `/hello`</span></span> |
| <span data-ttu-id="63b81-292">{Page=Home}</span><span class="sxs-lookup"><span data-stu-id="63b81-292">{Page=Home}</span></span> | / | <span data-ttu-id="63b81-293">設定し、一致`Page`に`Home`</span><span class="sxs-lookup"><span data-stu-id="63b81-293">Matches and sets `Page` to `Home`</span></span> |
| <span data-ttu-id="63b81-294">{Page=Home}</span><span class="sxs-lookup"><span data-stu-id="63b81-294">{Page=Home}</span></span>  | <span data-ttu-id="63b81-295">/にお問い合わせください。</span><span class="sxs-lookup"><span data-stu-id="63b81-295">/Contact</span></span>  | <span data-ttu-id="63b81-296">設定し、一致`Page`に`Contact`</span><span class="sxs-lookup"><span data-stu-id="63b81-296">Matches and sets `Page` to `Contact`</span></span> |
| <span data-ttu-id="63b81-297">{controller}/{action}/{id?}</span><span class="sxs-lookup"><span data-stu-id="63b81-297">{controller}/{action}/{id?}</span></span> | <span data-ttu-id="63b81-298">/製品/一覧表示</span><span class="sxs-lookup"><span data-stu-id="63b81-298">/Products/List</span></span> | <span data-ttu-id="63b81-299">マップ`Products`コント ローラーと`List`アクション</span><span class="sxs-lookup"><span data-stu-id="63b81-299">Maps to `Products` controller and `List`  action</span></span> |
| <span data-ttu-id="63b81-300">{controller}/{action}/{id?}</span><span class="sxs-lookup"><span data-stu-id="63b81-300">{controller}/{action}/{id?}</span></span> | <span data-ttu-id="63b81-301">/Products/Details/123</span><span class="sxs-lookup"><span data-stu-id="63b81-301">/Products/Details/123</span></span>  |  <span data-ttu-id="63b81-302">マップ`Products`コント ローラーと`Details`アクション。</span><span class="sxs-lookup"><span data-stu-id="63b81-302">Maps to `Products` controller and  `Details` action.</span></span>  <span data-ttu-id="63b81-303">`id`123 に設定します。</span><span class="sxs-lookup"><span data-stu-id="63b81-303">`id` set to 123</span></span> |
| <span data-ttu-id="63b81-304">{controller=Home}/{action=Index}/{id?}</span><span class="sxs-lookup"><span data-stu-id="63b81-304">{controller=Home}/{action=Index}/{id?}</span></span> | /  |  <span data-ttu-id="63b81-305">マップ`Home`コント ローラーと`Index`メソッドです。`id`は無視されます。</span><span class="sxs-lookup"><span data-stu-id="63b81-305">Maps to `Home` controller and `Index`  method; `id` is ignored.</span></span> |

<span data-ttu-id="63b81-306">テンプレートを使用してルーティングするために最も簡単な方法では通常です。</span><span class="sxs-lookup"><span data-stu-id="63b81-306">Using a template is generally the simplest approach to routing.</span></span> <span data-ttu-id="63b81-307">制約と既定値は、ルート テンプレートの外部も指定できます。</span><span class="sxs-lookup"><span data-stu-id="63b81-307">Constraints and defaults can also be specified outside the route template.</span></span>

<span data-ttu-id="63b81-308">ヒント: を有効にする[ログ](xref:fundamentals/logging/index)を表示する方法などのルーティングを実装に組み込まれている`Route`要求と一致します。</span><span class="sxs-lookup"><span data-stu-id="63b81-308">Tip: Enable [Logging](xref:fundamentals/logging/index) to see how the built in routing implementations, such as `Route`, match requests.</span></span>

## <a name="route-constraint-reference"></a><span data-ttu-id="63b81-309">ルート制約の参照</span><span class="sxs-lookup"><span data-stu-id="63b81-309">Route Constraint Reference</span></span>

<span data-ttu-id="63b81-310">ときに実行されるルート制約、`Route`着信 URL の構文の一致があり、ルートの値に URL パスをトークン化します。</span><span class="sxs-lookup"><span data-stu-id="63b81-310">Route constraints execute when a `Route` has matched the syntax of the incoming URL and tokenized the URL path into route values.</span></span> <span data-ttu-id="63b81-311">ルート制約は一般にルート テンプレートを使用して関連付けられているルート値を検査し、単純な加えて、はい/いいえの値が許容されるかどうかについて意思決定します。</span><span class="sxs-lookup"><span data-stu-id="63b81-311">Route constraints generally inspect the route value associated via the route template and make a simple yes/no decision about whether or not the value is acceptable.</span></span> <span data-ttu-id="63b81-312">何らかのルートの制約では、ルート値外のデータを使用して、要求をルーティングできるかどうかを検討してください。</span><span class="sxs-lookup"><span data-stu-id="63b81-312">Some route constraints use data outside the route value to consider whether the request can be routed.</span></span> <span data-ttu-id="63b81-313">たとえば、`HttpMethodRouteConstraint`受け入れるか、HTTP 動詞に基づいて要求を拒否することができます。</span><span class="sxs-lookup"><span data-stu-id="63b81-313">For example, the `HttpMethodRouteConstraint` can accept or reject a request based on its HTTP verb.</span></span>

>[!WARNING]
> <span data-ttu-id="63b81-314">制約を使用しないでください**入力検証**ようにすることによってにその無効な入力を行うと、適切なエラー メッセージで 400 の代わりに 404 (Not Found) が発生したため、します。</span><span class="sxs-lookup"><span data-stu-id="63b81-314">Avoid using constraints for **input validation**, because doing so means that invalid input will result in a 404 (Not Found) instead of a 400 with an appropriate error message.</span></span> <span data-ttu-id="63b81-315">ルート制約をするために使用する必要があります**あいまいさを解消**間、特定のルートに対する入力の妥当性検査に類似のルートです。</span><span class="sxs-lookup"><span data-stu-id="63b81-315">Route constraints should be used to **disambiguate** between similar routes, not to validate the inputs for a particular route.</span></span>

<span data-ttu-id="63b81-316">次の表は、何らかのルートの制約と、予期される動作について説明します。</span><span class="sxs-lookup"><span data-stu-id="63b81-316">The following table demonstrates some route constraints and their expected behavior.</span></span>

| <span data-ttu-id="63b81-317">制約</span><span class="sxs-lookup"><span data-stu-id="63b81-317">constraint</span></span> | <span data-ttu-id="63b81-318">例</span><span class="sxs-lookup"><span data-stu-id="63b81-318">Example</span></span> | <span data-ttu-id="63b81-319">例と一致します。</span><span class="sxs-lookup"><span data-stu-id="63b81-319">Example Matches</span></span> | <span data-ttu-id="63b81-320">メモ</span><span class="sxs-lookup"><span data-stu-id="63b81-320">Notes</span></span> |
| --------   | ------- | ------------- | ----- |
| `int` | `{id:int}` | <span data-ttu-id="63b81-321">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="63b81-321">`123456789`, `-123456789`</span></span>  | <span data-ttu-id="63b81-322">任意の整数を一致します。</span><span class="sxs-lookup"><span data-stu-id="63b81-322">Matches any integer</span></span> |
| `bool`  | `{active:bool}` | <span data-ttu-id="63b81-323">`true`, `FALSE`</span><span class="sxs-lookup"><span data-stu-id="63b81-323">`true`, `FALSE`</span></span> | <span data-ttu-id="63b81-324">一致`true`または`false`(大文字と小文字)</span><span class="sxs-lookup"><span data-stu-id="63b81-324">Matches `true` or `false` (case-insensitive)</span></span> |
| `datetime` | `{dob:datetime}` | <span data-ttu-id="63b81-325">`2016-12-31`, `2016-12-31 7:32pm`</span><span class="sxs-lookup"><span data-stu-id="63b81-325">`2016-12-31`, `2016-12-31 7:32pm`</span></span>  | <span data-ttu-id="63b81-326">有効な一致`DateTime`値 (インバリアント カルチャのでは、警告を参照してください)</span><span class="sxs-lookup"><span data-stu-id="63b81-326">Matches a valid `DateTime` value (in the invariant culture - see warning)</span></span> |
| `decimal` | `{price:decimal}` | <span data-ttu-id="63b81-327">`49.99`, `-1,000.01`</span><span class="sxs-lookup"><span data-stu-id="63b81-327">`49.99`, `-1,000.01`</span></span> | <span data-ttu-id="63b81-328">有効な一致`decimal`値 (インバリアント カルチャのでは、警告を参照してください)</span><span class="sxs-lookup"><span data-stu-id="63b81-328">Matches a valid `decimal` value (in the invariant culture - see warning)</span></span> |
| `double`  | `{weight:double}` | <span data-ttu-id="63b81-329">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="63b81-329">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="63b81-330">有効な一致`double`値 (インバリアント カルチャのでは、警告を参照してください)</span><span class="sxs-lookup"><span data-stu-id="63b81-330">Matches a valid `double` value (in the invariant culture - see warning)</span></span> |
| `float`  | `{weight:float}` | <span data-ttu-id="63b81-331">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="63b81-331">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="63b81-332">有効な一致`float`値 (インバリアント カルチャのでは、警告を参照してください)</span><span class="sxs-lookup"><span data-stu-id="63b81-332">Matches a valid `float` value (in the invariant culture - see warning)</span></span> |
| `guid`  | `{id:guid}` | <span data-ttu-id="63b81-333">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span><span class="sxs-lookup"><span data-stu-id="63b81-333">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span></span> | <span data-ttu-id="63b81-334">有効な一致`Guid`値</span><span class="sxs-lookup"><span data-stu-id="63b81-334">Matches a valid `Guid` value</span></span> |
| `long` | `{ticks:long}` | <span data-ttu-id="63b81-335">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="63b81-335">`123456789`, `-123456789`</span></span> | <span data-ttu-id="63b81-336">有効な一致`long`値</span><span class="sxs-lookup"><span data-stu-id="63b81-336">Matches a valid `long` value</span></span> |
| `minlength(value)` | `{username:minlength(4)}` | `Rick` | <span data-ttu-id="63b81-337">文字列は 4 文字以上である必要があります。</span><span class="sxs-lookup"><span data-stu-id="63b81-337">String must be at least 4 characters</span></span> |
| `maxlength(value)` | `{filename:maxlength(8)}` | `Richard` | <span data-ttu-id="63b81-338">文字列は 8 個を超える文字である必要があります。</span><span class="sxs-lookup"><span data-stu-id="63b81-338">String must be no more than 8 characters</span></span> |
| `length(length)` | `{filename:length(12)}` | `somefile.txt` | <span data-ttu-id="63b81-339">文字列が正確に 12 文字にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="63b81-339">String must be exactly 12 characters long</span></span> |
| `length(min,max)` | `{filename:length(8,16)}` | `somefile.txt` | <span data-ttu-id="63b81-340">文字列は、少なくとも 8 ~ ない 16 を超える文字である必要があります。</span><span class="sxs-lookup"><span data-stu-id="63b81-340">String must be at least 8 and no more than 16 characters long</span></span> |
| `min(value)` | `{age:min(18)}` | `19` | <span data-ttu-id="63b81-341">整数値は 18 以上である必要があります。</span><span class="sxs-lookup"><span data-stu-id="63b81-341">Integer value must be at least 18</span></span> |
| `max(value)` | `{age:max(120)}` |  `91` | <span data-ttu-id="63b81-342">整数値は 120 個である必要があります。</span><span class="sxs-lookup"><span data-stu-id="63b81-342">Integer value must be no more than 120</span></span> |
| `range(min,max)` | `{age:range(18,120)}` | `91` | <span data-ttu-id="63b81-343">整数値が少なくとも 18 が 120 未満にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="63b81-343">Integer value must be at least 18 but no more than 120</span></span> |
| `alpha` | `{name:alpha}` | `Rick` | <span data-ttu-id="63b81-344">1 つまたは複数の英文字の文字列必要があります (`a`-`z`、大文字と小文字)</span><span class="sxs-lookup"><span data-stu-id="63b81-344">String must consist of one or more alphabetical characters (`a`-`z`, case-insensitive)</span></span> |
| `regex(expression)` | `{ssn:regex(^\\d{{3}}-\\d{{2}}-\\d{{4}}$)}` | `123-45-6789` | <span data-ttu-id="63b81-345">文字列が正規表現に一致する必要があります (正規表現の定義に関するヒントを参照してください)</span><span class="sxs-lookup"><span data-stu-id="63b81-345">String must match the regular expression (see tips about defining a regular expression)</span></span> |
| `required`  | `{name:required}` | `Rick` |  <span data-ttu-id="63b81-346">非パラメーターの値が URL の生成中に存在するを適用するために使用</span><span class="sxs-lookup"><span data-stu-id="63b81-346">Used to enforce that a non-parameter value is present during URL generation</span></span> |

>[!WARNING]
> <span data-ttu-id="63b81-347">CLR 型に変換できる URL を確認するルート制約 (など`int`または`DateTime`) 常にインバリアント カルチャを使用して - URL は非ローカライズ可能な前提です。</span><span class="sxs-lookup"><span data-stu-id="63b81-347">Route constraints that verify the URL can be converted to a CLR type (such as `int` or `DateTime`) always use the invariant culture - they assume the URL is non-localizable.</span></span> <span data-ttu-id="63b81-348">Framework に用意されているルートの制約は、ルートの値に格納された値を変更しないでください。</span><span class="sxs-lookup"><span data-stu-id="63b81-348">The framework-provided route constraints don't modify the values stored in route values.</span></span> <span data-ttu-id="63b81-349">URL から解析されたすべてのルートの値は、文字列として格納されます。</span><span class="sxs-lookup"><span data-stu-id="63b81-349">All route values parsed from the URL will be stored as strings.</span></span> <span data-ttu-id="63b81-350">たとえば、 [Float ルート制約](https://github.com/aspnet/Routing/blob/1.0.0/src/Microsoft.AspNetCore.Routing/Constraints/FloatRouteConstraint.cs#L44-L60)ルートの値を float に変換を試みますが、変換後の値が float に変換できることを確認にのみ使用されます。</span><span class="sxs-lookup"><span data-stu-id="63b81-350">For example, the [Float route constraint](https://github.com/aspnet/Routing/blob/1.0.0/src/Microsoft.AspNetCore.Routing/Constraints/FloatRouteConstraint.cs#L44-L60) will attempt to convert the route value to a float, but the converted value is used only to verify it can be converted to a float.</span></span>

## <a name="regular-expressions"></a><span data-ttu-id="63b81-351">正規表現</span><span class="sxs-lookup"><span data-stu-id="63b81-351">Regular expressions</span></span> 

<span data-ttu-id="63b81-352">ASP.NET Core framework 追加`RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant`正規表現のコンス トラクターにします。</span><span class="sxs-lookup"><span data-stu-id="63b81-352">The ASP.NET Core framework adds `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` to the regular expression constructor.</span></span> <span data-ttu-id="63b81-353">参照してください[RegexOptions 列挙体](https://docs.microsoft.com/dotnet/api/system.text.regularexpressions.regexoptions)これらのメンバーの詳細についてはします。</span><span class="sxs-lookup"><span data-stu-id="63b81-353">See [RegexOptions Enumeration](https://docs.microsoft.com/dotnet/api/system.text.regularexpressions.regexoptions) for a description of these members.</span></span>

<span data-ttu-id="63b81-354">正規表現は、区切り記号およびルーティングと c# 言語で使用されるようなトークンを使用します。</span><span class="sxs-lookup"><span data-stu-id="63b81-354">Regular expressions use delimiters and tokens similar to those used by Routing and the C# language.</span></span> <span data-ttu-id="63b81-355">正規表現のトークンをエスケープする必要があります。</span><span class="sxs-lookup"><span data-stu-id="63b81-355">Regular expression tokens must be escaped.</span></span> <span data-ttu-id="63b81-356">たとえば、正規表現を使用する`^\d{3}-\d{2}-\d{4}$`にルーティングする必要があるが、`\`としてに入力した文字`\\`エスケープするために c# ソース ファイルで、`\`エスケープ文字の文字列 (を使用しない限り、[逐語的文字列リテラル](https://docs.microsoft.com/dotnet/csharp/language-reference/keywords/string)です。</span><span class="sxs-lookup"><span data-stu-id="63b81-356">For example, to use the regular expression `^\d{3}-\d{2}-\d{4}$` in Routing, it needs to have the `\` characters typed in as `\\` in the C# source file to escape the `\` string escape character (unless using [verbatim string literals](https://docs.microsoft.com/dotnet/csharp/language-reference/keywords/string).</span></span> <span data-ttu-id="63b81-357">`{` 、 `}` 、' [' と ']' 文字は、ルーティング パラメーター区切り記号の文字をエスケープするためにそれら 2 つ入力してエスケープする必要があります。</span><span class="sxs-lookup"><span data-stu-id="63b81-357">The `{` , `}` , '[' and ']' characters need to be escaped by doubling them to escape the Routing parameter delimiter characters.</span></span>  <span data-ttu-id="63b81-358">次の表は、正規表現とエスケープされたバージョンを示します。</span><span class="sxs-lookup"><span data-stu-id="63b81-358">The table below shows a regular expression and the escaped version.</span></span>

| <span data-ttu-id="63b81-359">正規表現</span><span class="sxs-lookup"><span data-stu-id="63b81-359">Expression</span></span>               | <span data-ttu-id="63b81-360">メモ</span><span class="sxs-lookup"><span data-stu-id="63b81-360">Note</span></span> |
| ----------------- | ------------ | 
| `^\d{3}-\d{2}-\d{4}$` | <span data-ttu-id="63b81-361">正規表現</span><span class="sxs-lookup"><span data-stu-id="63b81-361">Regular expression</span></span> |
| `^\\d{{3}}-\\d{{2}}-\\d{{4}}$` | <span data-ttu-id="63b81-362">エスケープ</span><span class="sxs-lookup"><span data-stu-id="63b81-362">Escaped</span></span>  |
| `^[a-z]{2}$` | <span data-ttu-id="63b81-363">正規表現</span><span class="sxs-lookup"><span data-stu-id="63b81-363">Regular expression</span></span> |
| `^[[a-z]]{{2}}$` | <span data-ttu-id="63b81-364">エスケープ</span><span class="sxs-lookup"><span data-stu-id="63b81-364">Escaped</span></span>  |

<span data-ttu-id="63b81-365">ルーティングに使用する正規表現が始まるは多くの場合、`^`文字 (文字列の開始位置に一致)、末尾が、`$`文字 (終了、文字列の位置に一致)。</span><span class="sxs-lookup"><span data-stu-id="63b81-365">Regular expressions used in routing will often start with the `^` character (match starting position of the string) and end with the `$` character (match ending position of the string).</span></span> <span data-ttu-id="63b81-366">`^`と`$`文字ことを確認する正規表現の一致、全体のルート パラメーターの値。</span><span class="sxs-lookup"><span data-stu-id="63b81-366">The `^` and `$` characters ensure that the regular expression match the entire route parameter value.</span></span> <span data-ttu-id="63b81-367">なし、`^`と`$`文字、正規表現のたくない多くの場合は、文字列内のサブ文字列は一致します。</span><span class="sxs-lookup"><span data-stu-id="63b81-367">Without the `^` and `$` characters the regular expression will match any sub-string within the string, which is often not what you want.</span></span> <span data-ttu-id="63b81-368">次の表は、いくつかの例を示していて、一致、理由、または一致するように失敗するときを説明します。</span><span class="sxs-lookup"><span data-stu-id="63b81-368">The table below shows some examples and explains why they match or fail to match.</span></span>

| <span data-ttu-id="63b81-369">正規表現</span><span class="sxs-lookup"><span data-stu-id="63b81-369">Expression</span></span>               | <span data-ttu-id="63b81-370">String</span><span class="sxs-lookup"><span data-stu-id="63b81-370">String</span></span> | <span data-ttu-id="63b81-371">一致したもの</span><span class="sxs-lookup"><span data-stu-id="63b81-371">Match</span></span> | <span data-ttu-id="63b81-372">コメント</span><span class="sxs-lookup"><span data-stu-id="63b81-372">Comment</span></span> |
| ----------------- | ------------ |  ------------ |  ------------ | 
| `[a-z]{2}` | <span data-ttu-id="63b81-373">hello</span><span class="sxs-lookup"><span data-stu-id="63b81-373">hello</span></span> | <span data-ttu-id="63b81-374">可</span><span class="sxs-lookup"><span data-stu-id="63b81-374">yes</span></span> | <span data-ttu-id="63b81-375">部分文字列の一致</span><span class="sxs-lookup"><span data-stu-id="63b81-375">substring matches</span></span> |
| `[a-z]{2}` | <span data-ttu-id="63b81-376">123abc456</span><span class="sxs-lookup"><span data-stu-id="63b81-376">123abc456</span></span> | <span data-ttu-id="63b81-377">可</span><span class="sxs-lookup"><span data-stu-id="63b81-377">yes</span></span> | <span data-ttu-id="63b81-378">部分文字列の一致</span><span class="sxs-lookup"><span data-stu-id="63b81-378">substring matches</span></span> |
| `[a-z]{2}` | <span data-ttu-id="63b81-379">mz</span><span class="sxs-lookup"><span data-stu-id="63b81-379">mz</span></span> | <span data-ttu-id="63b81-380">可</span><span class="sxs-lookup"><span data-stu-id="63b81-380">yes</span></span> | <span data-ttu-id="63b81-381">式に一致します。</span><span class="sxs-lookup"><span data-stu-id="63b81-381">matches expression</span></span> |
| `[a-z]{2}` | <span data-ttu-id="63b81-382">MZ</span><span class="sxs-lookup"><span data-stu-id="63b81-382">MZ</span></span> | <span data-ttu-id="63b81-383">可</span><span class="sxs-lookup"><span data-stu-id="63b81-383">yes</span></span> | <span data-ttu-id="63b81-384">大文字と小文字が区別されません。</span><span class="sxs-lookup"><span data-stu-id="63b81-384">not case sensitive</span></span> |
| `^[a-z]{2}$` |  <span data-ttu-id="63b81-385">hello</span><span class="sxs-lookup"><span data-stu-id="63b81-385">hello</span></span> | <span data-ttu-id="63b81-386">Ｘ</span><span class="sxs-lookup"><span data-stu-id="63b81-386">no</span></span> | <span data-ttu-id="63b81-387">参照してください`^`と`$`上</span><span class="sxs-lookup"><span data-stu-id="63b81-387">see `^` and `$` above</span></span> |
| `^[a-z]{2}$` |  <span data-ttu-id="63b81-388">123abc456</span><span class="sxs-lookup"><span data-stu-id="63b81-388">123abc456</span></span> | <span data-ttu-id="63b81-389">Ｘ</span><span class="sxs-lookup"><span data-stu-id="63b81-389">no</span></span> | <span data-ttu-id="63b81-390">参照してください`^`と`$`上</span><span class="sxs-lookup"><span data-stu-id="63b81-390">see `^` and `$` above</span></span> |

<span data-ttu-id="63b81-391">参照してください[.NET Framework 正規表現](https://docs.microsoft.com/dotnet/standard/base-types/regular-expression-language-quick-reference)正規表現の構文についての詳細。</span><span class="sxs-lookup"><span data-stu-id="63b81-391">Refer to [.NET Framework Regular Expressions](https://docs.microsoft.com/dotnet/standard/base-types/regular-expression-language-quick-reference) for more information on regular expression syntax.</span></span>

<span data-ttu-id="63b81-392">既知の使用可能な値のセットへのパラメーターを制限するには、正規表現を使用します。</span><span class="sxs-lookup"><span data-stu-id="63b81-392">To constrain a parameter to a known set of possible values, use a regular expression.</span></span> <span data-ttu-id="63b81-393">たとえば`{action:regex(^(list|get|create)$)}`とのみ一致する、`action`に値をルーティング`list`、 `get`、または`create`です。</span><span class="sxs-lookup"><span data-stu-id="63b81-393">For example `{action:regex(^(list|get|create)$)}` only matches the `action` route value to `list`, `get`, or `create`.</span></span> <span data-ttu-id="63b81-394">制約のディクショナリの文字列に渡された場合"^ (リスト | get | を作成) $"と同じです。</span><span class="sxs-lookup"><span data-stu-id="63b81-394">If passed into the constraints dictionary, the string "^(list|get|create)$" would be equivalent.</span></span> <span data-ttu-id="63b81-395">いずれかの既知の制限が一致しない制約ディクショナリ (テンプレート内のインラインではありません) に渡される制約は、正規表現としても扱われます。</span><span class="sxs-lookup"><span data-stu-id="63b81-395">Constraints that are passed in the constraints dictionary (not inline within a template) that don't match one of the known constraints are also treated as regular expressions.</span></span>

## <a name="url-generation-reference"></a><span data-ttu-id="63b81-396">生成の URL 参照</span><span class="sxs-lookup"><span data-stu-id="63b81-396">URL Generation Reference</span></span>

<span data-ttu-id="63b81-397">次の例は、ルート値のディクショナリを指定されたルートへのリンクを生成する方法を示しています。 および`RouteCollection`です。</span><span class="sxs-lookup"><span data-stu-id="63b81-397">The example below shows how to generate a link to a route given a dictionary of route values and a `RouteCollection`.</span></span>

[!code-csharp[Main](../fundamentals/routing/sample/RoutingSample/Startup.cs?range=45-59)]

<span data-ttu-id="63b81-398">`VirtualPath`は上記の例の最後に生成された`/package/create/123`です。</span><span class="sxs-lookup"><span data-stu-id="63b81-398">The `VirtualPath` generated at the end of the sample above is `/package/create/123`.</span></span>

<span data-ttu-id="63b81-399">2 番目のパラメーター、`VirtualPathContext`コンス トラクターのコレクションは、*アンビエント値*です。</span><span class="sxs-lookup"><span data-stu-id="63b81-399">The second parameter to the `VirtualPathContext` constructor is a collection of *ambient values*.</span></span> <span data-ttu-id="63b81-400">アンビエントの値は、開発者は、特定の要求のコンテキスト内で指定する必要があります値の数を制限することによって、利便性を提供します。</span><span class="sxs-lookup"><span data-stu-id="63b81-400">Ambient values provide convenience by limiting the number of values a developer must specify within a certain request context.</span></span> <span data-ttu-id="63b81-401">現在の要求の現在のルートの値は、リンクの生成にアンビエント値と見なされます。</span><span class="sxs-lookup"><span data-stu-id="63b81-401">The current route values of the current request are considered ambient values for link generation.</span></span> <span data-ttu-id="63b81-402">などの場合は、ASP.NET MVC アプリケーションで、`About`のアクション、 `HomeController`、値を指定する、コント ローラーのルートにリンクする必要はありません、`Index`アクション (のアンビエント値`Home`が適用されます)。</span><span class="sxs-lookup"><span data-stu-id="63b81-402">For example, in an ASP.NET MVC app if you are in the `About` action of the `HomeController`, you don't need to specify the controller route value to link to the `Index` action (the ambient value of `Home` will be used).</span></span>

<span data-ttu-id="63b81-403">パラメーターが一致しないアンビエントの値は無視され、アンビエント値は、明示的に指定値よりも優先、左から右へと向かうときにも無視されます、URL にします。</span><span class="sxs-lookup"><span data-stu-id="63b81-403">Ambient values that don't match a parameter are ignored, and ambient values are also ignored when an explicitly-provided value overrides it, going from left to right in the URL.</span></span>

<span data-ttu-id="63b81-404">明示的に指定したが、何もこれと一致しない値は、クエリ文字列に追加されます。</span><span class="sxs-lookup"><span data-stu-id="63b81-404">Values that are explicitly provided but which don't match anything are added to the query string.</span></span> <span data-ttu-id="63b81-405">ルート テンプレートを使用する場合、次の表は、結果を示しています`{controller}/{action}/{id?}`です。</span><span class="sxs-lookup"><span data-stu-id="63b81-405">The following table shows the result when using the route template `{controller}/{action}/{id?}`.</span></span>

| <span data-ttu-id="63b81-406">アンビエント値</span><span class="sxs-lookup"><span data-stu-id="63b81-406">Ambient Values</span></span> | <span data-ttu-id="63b81-407">明示的な値</span><span class="sxs-lookup"><span data-stu-id="63b81-407">Explicit Values</span></span> | <span data-ttu-id="63b81-408">結果</span><span class="sxs-lookup"><span data-stu-id="63b81-408">Result</span></span> |
| -------------   | -------------- | ------ |
| <span data-ttu-id="63b81-409">コント ローラー「ホーム」を =</span><span class="sxs-lookup"><span data-stu-id="63b81-409">controller="Home"</span></span> | <span data-ttu-id="63b81-410">アクション"About"=</span><span class="sxs-lookup"><span data-stu-id="63b81-410">action="About"</span></span> | `/Home/About` |
| <span data-ttu-id="63b81-411">コント ローラー「ホーム」を =</span><span class="sxs-lookup"><span data-stu-id="63b81-411">controller="Home"</span></span> | <span data-ttu-id="63b81-412">コント ローラー"Order"、操作を = ="About"</span><span class="sxs-lookup"><span data-stu-id="63b81-412">controller="Order",action="About"</span></span> | `/Order/About` |
| <span data-ttu-id="63b81-413">controller="Home",color="Red"</span><span class="sxs-lookup"><span data-stu-id="63b81-413">controller="Home",color="Red"</span></span> | <span data-ttu-id="63b81-414">アクション"About"=</span><span class="sxs-lookup"><span data-stu-id="63b81-414">action="About"</span></span> | `/Home/About` |
| <span data-ttu-id="63b81-415">コント ローラー「ホーム」を =</span><span class="sxs-lookup"><span data-stu-id="63b81-415">controller="Home"</span></span> | <span data-ttu-id="63b81-416">アクション = 色の「バージョン情報」、"Red"を =</span><span class="sxs-lookup"><span data-stu-id="63b81-416">action="About",color="Red"</span></span> | `/Home/About?color=Red`

<span data-ttu-id="63b81-417">ルート、既定値は、パラメーターに対応していない、およびその値が明示的に指定される場合は、既定値に一致する必要があります。</span><span class="sxs-lookup"><span data-stu-id="63b81-417">If a route has a default value that doesn't correspond to a parameter and that value is explicitly provided, it must match the default value.</span></span> <span data-ttu-id="63b81-418">例:</span><span class="sxs-lookup"><span data-stu-id="63b81-418">For example:</span></span>

```csharp
routes.MapRoute("blog_route", "blog/{*slug}",
  defaults: new { controller = "Blog", action = "ReadPost" });
```

<span data-ttu-id="63b81-419">リンクの生成では、コント ローラーとアクションの一致する値を提供する場合、このルートのリンクがのみ生成されます。</span><span class="sxs-lookup"><span data-stu-id="63b81-419">Link generation would only generate a link for this route when the matching values for controller and action are provided.</span></span>
