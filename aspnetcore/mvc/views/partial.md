---
title: ASP.NET Core での部分ビュー
author: ardalis
description: 部分ビューが別のビュー内でどのようにレンダリングされるビューか、ASP.NET Core アプリでどのような場合に使用すべきかについて説明します。
ms.author: riande
ms.date: 03/14/2018
uid: mvc/views/partial
ms.openlocfilehash: f3782961a63c08293a483ec7a75dadff2031b131
ms.sourcegitcommit: a1afd04758e663d7062a5bfa8a0d4dca38f42afc
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/20/2018
ms.locfileid: "36279533"
---
# <a name="partial-views-in-aspnet-core"></a><span data-ttu-id="029e5-103">ASP.NET Core での部分ビュー</span><span class="sxs-lookup"><span data-stu-id="029e5-103">Partial Views in ASP.NET Core</span></span>

<span data-ttu-id="029e5-104">作成者: [Steve Smith](https://ardalis.com/)、[Maher JENDOUBI](https://twitter.com/maherjend)、[Rick Anderson](https://twitter.com/RickAndMSFT)、[Scott Sauber](https://twitter.com/scottsauber)</span><span class="sxs-lookup"><span data-stu-id="029e5-104">By [Steve Smith](https://ardalis.com/), [Maher JENDOUBI](https://twitter.com/maherjend), [Rick Anderson](https://twitter.com/RickAndMSFT), and [Scott Sauber](https://twitter.com/scottsauber)</span></span>

<span data-ttu-id="029e5-105">ASP.NET Core MVC では部分ビューがサポートされます。これらのビューは、さまざまなビューで共有する Web ページの一部を再利用できる場合に便利です。</span><span class="sxs-lookup"><span data-stu-id="029e5-105">ASP.NET Core MVC supports partial views, which are useful when you have reusable parts of web pages you want to share between different views.</span></span>

<span data-ttu-id="029e5-106">[サンプル コードを表示またはダウンロード](https://github.com/aspnet/Docs/tree/master/aspnetcore/mvc/views/partial/sample)します ([ダウンロード方法](xref:tutorials/index#how-to-download-a-sample))。</span><span class="sxs-lookup"><span data-stu-id="029e5-106">[View or download sample code](https://github.com/aspnet/Docs/tree/master/aspnetcore/mvc/views/partial/sample) ([how to download](xref:tutorials/index#how-to-download-a-sample))</span></span>

## <a name="what-are-partial-views"></a><span data-ttu-id="029e5-107">部分ビューとは</span><span class="sxs-lookup"><span data-stu-id="029e5-107">What are Partial Views?</span></span>

<span data-ttu-id="029e5-108">部分ビューとは、別のビュー内でレンダリングされるビューのことです。</span><span class="sxs-lookup"><span data-stu-id="029e5-108">A partial view is a view that's rendered within another view.</span></span> <span data-ttu-id="029e5-109">部分ビューを実行して生成される HTML 出力は、呼び出し元 (または親) のビューにレンダリングされます。</span><span class="sxs-lookup"><span data-stu-id="029e5-109">The HTML output generated by executing the partial view is rendered into the calling (or parent) view.</span></span> <span data-ttu-id="029e5-110">ビューと同様、部分ビューでは *.cshtml* ファイル拡張子を使用します。</span><span class="sxs-lookup"><span data-stu-id="029e5-110">Like views, partial views use the *.cshtml* file extension.</span></span>

## <a name="when-should-i-use-partial-views"></a><span data-ttu-id="029e5-111">部分ビューを使用する必要があるタイミング</span><span class="sxs-lookup"><span data-stu-id="029e5-111">When Should I Use Partial Views?</span></span>

<span data-ttu-id="029e5-112">部分ビューは、より小さい要素に大きいビューを分割する効果的な方法です。</span><span class="sxs-lookup"><span data-stu-id="029e5-112">Partial views are an effective way of breaking up large views into smaller components.</span></span> <span data-ttu-id="029e5-113">ビュー コンテンツの重複を減らし、ビュー要素を再利用できます。</span><span class="sxs-lookup"><span data-stu-id="029e5-113">They can reduce duplication of view content and allow view elements to be reused.</span></span> <span data-ttu-id="029e5-114">一般的なレイアウト要素は、[_Layout.cshtml](layout.md) に指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="029e5-114">Common layout elements should be specified in [_Layout.cshtml](layout.md).</span></span> <span data-ttu-id="029e5-115">レイアウト以外の再利用可能なコンテンツは、部分ビューにカプセル化できます。</span><span class="sxs-lookup"><span data-stu-id="029e5-115">Non-layout reusable content can be encapsulated into partial views.</span></span>

<span data-ttu-id="029e5-116">いくつかの論理部分で構成される複雑なページがある場合、それぞれの部分を独自の部分ビューとして操作する際に役立ちます。</span><span class="sxs-lookup"><span data-stu-id="029e5-116">If you have a complex page made up of several logical pieces, it can be helpful to work with each piece as its own partial view.</span></span> <span data-ttu-id="029e5-117">ページの各部分はページの残りの部分とは別に表示でき、ページ自体のビューははるかに単純になります。これは、部分ビューをレンダリングするための呼び出しとページ構造全体のみが含まれるためです。</span><span class="sxs-lookup"><span data-stu-id="029e5-117">Each piece of the page can be viewed in isolation from the rest of the page, and the view for the page itself becomes much simpler since it only contains the overall page structure and calls to render the partial views.</span></span>

<span data-ttu-id="029e5-118">ヒント: ビューでは [DRY 原則](http://deviq.com/don-t-repeat-yourself/)に従ってください。</span><span class="sxs-lookup"><span data-stu-id="029e5-118">Tip: Follow the [Don't Repeat Yourself Principle](http://deviq.com/don-t-repeat-yourself/) in your views.</span></span>

## <a name="declaring-partial-views"></a><span data-ttu-id="029e5-119">部分ビューの宣言</span><span class="sxs-lookup"><span data-stu-id="029e5-119">Declaring Partial Views</span></span>

<span data-ttu-id="029e5-120">部分ビューは他のビューと同様に作成されます。その場合、*Views* フォルダー内に *.cshtml* ファイルを作成します。</span><span class="sxs-lookup"><span data-stu-id="029e5-120">Partial views are created like any other view: you create a *.cshtml* file within the *Views* folder.</span></span> <span data-ttu-id="029e5-121">部分ビューと標準ビューのセマンティックに違いはありません。ただ、レンダリングの方法が異なるだけです。</span><span class="sxs-lookup"><span data-stu-id="029e5-121">There's no semantic difference between a partial view and a regular view - they're just rendered differently.</span></span> <span data-ttu-id="029e5-122">コントローラーの `ViewResult` から直接返されるビューを使用でき、これと同じビューを部分ビューとして使用できます。</span><span class="sxs-lookup"><span data-stu-id="029e5-122">You can have a view that's returned directly from a controller's `ViewResult`, and the same view can be used as a partial view.</span></span> <span data-ttu-id="029e5-123">ビューと部分ビューのレンダリング方法の主な違いは、部分ビューでは *_ViewStart.cshtml* を実行しないことです (ビューでは実行します。詳細については、「[レイアウト](layout.md)」の *_ViewStart.cshtml* に関する記述を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="029e5-123">The main difference between how a view and a partial view are rendered is that partial views don't run *_ViewStart.cshtml* (while views do - learn more about *_ViewStart.cshtml* in [Layout](layout.md)).</span></span>

## <a name="referencing-a-partial-view"></a><span data-ttu-id="029e5-124">部分ビューの参照</span><span class="sxs-lookup"><span data-stu-id="029e5-124">Referencing a Partial View</span></span>

<span data-ttu-id="029e5-125">ビュー ページ内から、部分ビューをレンダリングできる方法がいくつかあります。</span><span class="sxs-lookup"><span data-stu-id="029e5-125">From within a view page, there are several ways in which you can render a partial view.</span></span> <span data-ttu-id="029e5-126">ベスト プラクティスは、`Html.PartialAsync` を使用することです。この場合、`IHtmlString` を返し、呼び出しの前に `@` を指定して参照できます。</span><span class="sxs-lookup"><span data-stu-id="029e5-126">The best practice is to use `Html.PartialAsync`, which returns an `IHtmlString` and can be referenced by prefixing the call with `@`:</span></span>

[!code-cshtml[](partial/sample/src/PartialViewsSample/Views/Home/About.cshtml?range=8)]

<span data-ttu-id="029e5-127">`RenderPartialAsync` を使用して、部分ビューをレンダリングできます。</span><span class="sxs-lookup"><span data-stu-id="029e5-127">You can render a partial view with `RenderPartialAsync`.</span></span> <span data-ttu-id="029e5-128">このメソッドは結果を返しません。レンダリングされた出力を直接応答にストリーミングします。</span><span class="sxs-lookup"><span data-stu-id="029e5-128">This method doesn't return a result; it streams the rendered output directly to the response.</span></span> <span data-ttu-id="029e5-129">結果を返さないため、Razor コード ブロック内で呼び出す必要があります。</span><span class="sxs-lookup"><span data-stu-id="029e5-129">Because it doesn't return a result, it must be called within a Razor code block:</span></span>

[!code-cshtml[](partial/sample/src/PartialViewsSample/Views/Home/About.cshtml?range=11-13)]

<span data-ttu-id="029e5-130">結果を直接ストリーミングするため、一部のシナリオでは `RenderPartialAsync` のパフォーマンスが向上する場合がありますが、</span><span class="sxs-lookup"><span data-stu-id="029e5-130">Because it streams the result directly, `RenderPartialAsync` may perform better in some scenarios.</span></span> <span data-ttu-id="029e5-131">`PartialAsync` を使用することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="029e5-131">However, it's recommended you use `PartialAsync`.</span></span>

<span data-ttu-id="029e5-132">`Html.PartialAsync` (`Html.Partial`) と `Html.RenderPartialAsync` (`Html.RenderPartial`) という同期相当の機能がありますが、デッドロックが発生するシナリオがあるため、同期相当の機能の使用はお勧めしません。</span><span class="sxs-lookup"><span data-stu-id="029e5-132">While there are synchronous equivalents of `Html.PartialAsync` (`Html.Partial`) and `Html.RenderPartialAsync` (`Html.RenderPartial`), use of the synchronous equivalents isn't recommended because there are scenarios where they deadlock.</span></span> <span data-ttu-id="029e5-133">今後のバージョンでは、この同期方法は使用されなくなる予定です。</span><span class="sxs-lookup"><span data-stu-id="029e5-133">The synchronous methods will be unavailable in future versions.</span></span>

> [!NOTE]
> <span data-ttu-id="029e5-134">ビューでコードを実行する必要がある場合は、部分ビューの代わりに[ビュー コンポーネント](view-components.md)を使用するパターンをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="029e5-134">If your views need to execute code, the recommended pattern is to use a [view component](view-components.md) instead of a partial view.</span></span>

### <a name="partial-view-discovery"></a><span data-ttu-id="029e5-135">部分ビューの検出</span><span class="sxs-lookup"><span data-stu-id="029e5-135">Partial View Discovery</span></span>

<span data-ttu-id="029e5-136">部分ビューを参照するときに、いくつかの方法でその場所を参照することができます。</span><span class="sxs-lookup"><span data-stu-id="029e5-136">When referencing a partial view, you can refer to its location in several ways:</span></span>

```cshtml
// Uses a view in current folder with this name
// If none is found, searches the Shared folder
@await Html.PartialAsync("ViewName")

// A view with this name must be in the same folder
@await Html.PartialAsync("ViewName.cshtml")

// Locate the view based on the application root
// Paths that start with "/" or "~/" refer to the application root
@await Html.PartialAsync("~/Views/Folder/ViewName.cshtml")
@await Html.PartialAsync("/Views/Folder/ViewName.cshtml")

// Locate the view using relative paths
@await Html.PartialAsync("../Account/LoginPartial.cshtml")
```

<span data-ttu-id="029e5-137">別のビュー フォルダーで同じ名前の別の部分ビューを使用することができます。</span><span class="sxs-lookup"><span data-stu-id="029e5-137">You can have different partial views with the same name in different view folders.</span></span> <span data-ttu-id="029e5-138">名前 (ファイル拡張子なし) でビューを参照する場合、各フォルダー内のビューではそれと同じフォルダーの部分ビューを使用します。</span><span class="sxs-lookup"><span data-stu-id="029e5-138">When referencing the views by name (without file extension), views in each folder will use the partial view in the same folder with them.</span></span> <span data-ttu-id="029e5-139">*Shared* フォルダーに配置して、使用する既定の部分ビューを指定することもできます。</span><span class="sxs-lookup"><span data-stu-id="029e5-139">You can also specify a default partial view to use, placing it in the *Shared* folder.</span></span> <span data-ttu-id="029e5-140">共有部分ビューは、部分ビューの独自のバージョンがないすべてのビューで使用されます。</span><span class="sxs-lookup"><span data-stu-id="029e5-140">The shared partial view will be used by any views that don't have their own version of the partial view.</span></span> <span data-ttu-id="029e5-141">親ビューと同じフォルダーの同じ名前の部分ビューによってオーバーライドされる、既定の部分ビューを (*Shared* 内で) 使用できます。</span><span class="sxs-lookup"><span data-stu-id="029e5-141">You can have a default partial view (in *Shared*), which is overridden by a partial view with the same name in the same folder as the parent view.</span></span>

<span data-ttu-id="029e5-142">部分ビューを*チェーンする*ことができます。</span><span class="sxs-lookup"><span data-stu-id="029e5-142">Partial views can be *chained*.</span></span> <span data-ttu-id="029e5-143">つまり、部分ビューは別の部分ビューを呼び出すことができます (ただし、ループを作成しない場合)。</span><span class="sxs-lookup"><span data-stu-id="029e5-143">That is, a partial view can call another partial view (as long as you don't create a loop).</span></span> <span data-ttu-id="029e5-144">各ビューまたは部分ビュー内では、相対パスは、ルートや親ビューではなく、常にそのビューに対して相対的になります。</span><span class="sxs-lookup"><span data-stu-id="029e5-144">Within each view or partial view, relative paths are always relative to that view, not the root or parent view.</span></span>

> [!NOTE]
> <span data-ttu-id="029e5-145">部分ビューで [Razor](razor.md) `section` を宣言すると、その親に表示されなくなります。これは親ビューに限定されます。</span><span class="sxs-lookup"><span data-stu-id="029e5-145">If you declare a [Razor](razor.md) `section` in a partial view, it will not be visible to its parent(s); it will be limited to the partial view.</span></span>

## <a name="accessing-data-from-partial-views"></a><span data-ttu-id="029e5-146">部分ビューからのデータへのアクセス</span><span class="sxs-lookup"><span data-stu-id="029e5-146">Accessing Data From Partial Views</span></span>

<span data-ttu-id="029e5-147">親ビューのインスタンス化の際に、親ビューの `ViewData` ディクショナリのコピーが取得されます。</span><span class="sxs-lookup"><span data-stu-id="029e5-147">When a partial view is instantiated, it gets a copy of the parent view's `ViewData` dictionary.</span></span> <span data-ttu-id="029e5-148">親ビュー内のデータに対して行われた更新は、親ビューでは保持されません。</span><span class="sxs-lookup"><span data-stu-id="029e5-148">Updates made to the data within the partial view are not persisted to the parent view.</span></span> <span data-ttu-id="029e5-149">部分ビューで変更された `ViewData` は、部分ビューから返されるときに失われます。</span><span class="sxs-lookup"><span data-stu-id="029e5-149">`ViewData` changed in a partial view is lost when the partial view returns.</span></span>

<span data-ttu-id="029e5-150">`ViewDataDictionary` のインスタンスを部分ビューに渡すことができます。</span><span class="sxs-lookup"><span data-stu-id="029e5-150">You can pass an instance of `ViewDataDictionary` to the partial view:</span></span>

```cshtml
@await Html.PartialAsync("PartialName", customViewData)
```

<span data-ttu-id="029e5-151">部分ビューにモデルを渡すこともできます。</span><span class="sxs-lookup"><span data-stu-id="029e5-151">You can also pass a model into a partial view.</span></span> <span data-ttu-id="029e5-152">これは、ページのビュー モデルまたはカスタム オブジェクトの場合があります。</span><span class="sxs-lookup"><span data-stu-id="029e5-152">This can be the page's view model or a custom object.</span></span> <span data-ttu-id="029e5-153">モデルを `PartialAsync` または `RenderPartialAsync` に渡すことができます。</span><span class="sxs-lookup"><span data-stu-id="029e5-153">You can pass a model to `PartialAsync` or `RenderPartialAsync`:</span></span>

```cshtml
@await Html.PartialAsync("PartialName", viewModel)
```

<span data-ttu-id="029e5-154">`ViewDataDictionary` のインスタンスとビュー モデルを部分ビューに渡すことができます。</span><span class="sxs-lookup"><span data-stu-id="029e5-154">You can pass an instance of `ViewDataDictionary` and a view model to a partial view:</span></span>

[!code-cshtml[](partial/sample/src/PartialViewsSample/Views/Articles/Read.cshtml?range=15-16)]

<span data-ttu-id="029e5-155">以下のマークアップは、2 つの部分ビューを含む *Views/Articles/Read.cshtml* ビューを示しています。</span><span class="sxs-lookup"><span data-stu-id="029e5-155">The markup below shows the *Views/Articles/Read.cshtml* view which contains two partial views.</span></span> <span data-ttu-id="029e5-156">2 番目の部分ビューは、モデルと `ViewData` を部分ビューに渡します。</span><span class="sxs-lookup"><span data-stu-id="029e5-156">The second partial view passes in a model and `ViewData` to the partial view.</span></span> <span data-ttu-id="029e5-157">以下の強調表示されている `ViewDataDictionary` のコンストラクター オーバーロードを使用する場合、既存の `ViewData` を維持したまま、新しい `ViewData` ディクショナリを渡すことができます。</span><span class="sxs-lookup"><span data-stu-id="029e5-157">You can pass new `ViewData` dictionary while retaining the existing `ViewData` if you use the constructor overload of the `ViewDataDictionary` highlighted below:</span></span>

[!code-cshtml[](partial/sample/src/PartialViewsSample/Views/Articles/Read.cshtml)]

<span data-ttu-id="029e5-158">*Views/Shared/AuthorPartial*:</span><span class="sxs-lookup"><span data-stu-id="029e5-158">*Views/Shared/AuthorPartial*:</span></span>

[!code-cshtml[](partial/sample/src/PartialViewsSample/Views/Shared/AuthorPartial.cshtml)]

<span data-ttu-id="029e5-159">*ArticleSection* 部分:</span><span class="sxs-lookup"><span data-stu-id="029e5-159">The *ArticleSection* partial:</span></span>

[!code-cshtml[](partial/sample/src/PartialViewsSample/Views/Articles/ArticleSection.cshtml)]

<span data-ttu-id="029e5-160">実行時に、この部分は親ビューにレンダリングされます。親ビュー自体は共有されている *_Layout.cshtml* 内にレンダリングされます。</span><span class="sxs-lookup"><span data-stu-id="029e5-160">At runtime, the partials are rendered into the parent view, which itself is rendered within the shared *_Layout.cshtml*</span></span>

![部分ビューの出力](partial/_static/output.png)
