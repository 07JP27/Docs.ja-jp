---
uid: web-forms/overview/data-access/accessing-the-database-directly-from-an-aspnet-page/inserting-updating-and-deleting-data-with-the-sqldatasource-cs
title: "挿入、更新、および (c#)、SqlDataSource によるデータの削除 |Microsoft ドキュメント"
author: rick-anderson
description: "前のチュートリアルでの挿入、更新、およびデータの削除、ObjectDataSource コントロールが許可されている方法がわかりました。 SqlDataSource コントロールは、t をサポートしています."
ms.author: aspnetcontent
manager: wpickett
ms.date: 02/20/2007
ms.topic: article
ms.assetid: a526f0ec-779e-4a2b-a476-6604090d25ce
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/accessing-the-database-directly-from-an-aspnet-page/inserting-updating-and-deleting-data-with-the-sqldatasource-cs
msc.type: authoredcontent
ms.openlocfilehash: 3b080046df49ff6d4c83063d782962c5fcb33e94
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/10/2017
---
<a name="inserting-updating-and-deleting-data-with-the-sqldatasource-c"></a><span data-ttu-id="ddae8-104">挿入、更新、および (c#)、SqlDataSource によるデータの削除</span><span class="sxs-lookup"><span data-stu-id="ddae8-104">Inserting, Updating, and Deleting Data with the SqlDataSource (C#)</span></span>
====================
<span data-ttu-id="ddae8-105">によって[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="ddae8-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="ddae8-106">[サンプル アプリをダウンロード](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_49_CS.exe)または[PDF のダウンロード](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/datatutorial49cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="ddae8-106">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_49_CS.exe) or [Download PDF](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/datatutorial49cs1.pdf)</span></span>

> <span data-ttu-id="ddae8-107">前のチュートリアルでの挿入、更新、およびデータの削除、ObjectDataSource コントロールが許可されている方法がわかりました。</span><span class="sxs-lookup"><span data-stu-id="ddae8-107">In previous tutorials we learned how the ObjectDataSource control allowed for inserting, updating, and deleting of data.</span></span> <span data-ttu-id="ddae8-108">SqlDataSource コントロールをサポートしますが同じ操作が、アプローチが異なるため、このチュートリアルは、挿入、更新、およびデータを削除する SqlDataSource を構成する方法を示します。</span><span class="sxs-lookup"><span data-stu-id="ddae8-108">The SqlDataSource control supports the same operations, but the approach is different, and this tutorial shows how to configure the SqlDataSource to insert, update, and delete data.</span></span>


## <a name="introduction"></a><span data-ttu-id="ddae8-109">はじめに</span><span class="sxs-lookup"><span data-stu-id="ddae8-109">Introduction</span></span>

<span data-ttu-id="ddae8-110">説明したよう[、概要の挿入、更新、および削除](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md)GridView コントロールは、組み込みの更新、およびと共に DetailsView およびフォームのコントロールには、挿入するときに、削除の機能をサポート編集および機能を削除します。</span><span class="sxs-lookup"><span data-stu-id="ddae8-110">As discussed in [An Overview of Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md), the GridView control provides built-in updating and deleting capabilities, while the DetailsView and FormView controls include inserting support along with editing and deleting functionality.</span></span> <span data-ttu-id="ddae8-111">これらのデータ変更機能は、書き込まれる必要があるコードの行がないデータ ソース コントロールに直接接続できます。</span><span class="sxs-lookup"><span data-stu-id="ddae8-111">These data modification capabilities can be plugged directly into a data source control without a line of code needing to be written.</span></span> <span data-ttu-id="ddae8-112">[概要の挿入、更新、および削除](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md)ObjectDataSource を使用して挿入、更新、および GridView、DetailsView、フォーム ビューのコントロールを使用した削除が容易にするかを確認します。</span><span class="sxs-lookup"><span data-stu-id="ddae8-112">[An Overview of Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md) examined using the ObjectDataSource to facilitate inserting, updating, and deleting with the GridView, DetailsView, and FormView controls.</span></span> <span data-ttu-id="ddae8-113">また、SqlDataSource、ObjectDataSource の代わりに使用できます。</span><span class="sxs-lookup"><span data-stu-id="ddae8-113">Alternatively, the SqlDataSource can be used in place of the ObjectDataSource.</span></span>

<span data-ttu-id="ddae8-114">挿入、更新、および削除、ObjectDataSource おために必要なメソッドを指定する、オブジェクト層の挿入を実行するために呼び出す更新、または削除操作をサポートすることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="ddae8-114">Recall that to support inserting, updating, and deleting, with the ObjectDataSource we needed to specify the object layer methods to invoke to perform the insert, update, or delete action.</span></span> <span data-ttu-id="ddae8-115">指定しなければ、SqlDataSource による`INSERT`、 `UPDATE`、および`DELETE`SQL ステートメント (またはストアド プロシージャ) を実行します。</span><span class="sxs-lookup"><span data-stu-id="ddae8-115">With the SqlDataSource, we need to provide `INSERT`, `UPDATE`, and `DELETE` SQL statements (or stored procedures) to execute.</span></span> <span data-ttu-id="ddae8-116">このチュートリアルで後ほどお見せ、これらのステートメントを手動で作成または SqlDataSource のデータ ソース構成ウィザードによって自動的に生成できます。</span><span class="sxs-lookup"><span data-stu-id="ddae8-116">As we'll see in this tutorial, these statements can be created manually or can be automatically generated by the SqlDataSource s Configure Data Source wizard.</span></span>

> [!NOTE]
> <span data-ttu-id="ddae8-117">以降既に説明した、挿入、編集、および GridView DetailsView の機能を削除して FormView コントロール、このチュートリアルをこれらの操作をサポートする SqlDataSource コントロールの構成に焦点を当てます。</span><span class="sxs-lookup"><span data-stu-id="ddae8-117">Since we ve already discussed the inserting, editing, and deleting capabilities of the GridView, DetailsView, and FormView controls, this tutorial will focus on configuring the SqlDataSource control to support these operations.</span></span> <span data-ttu-id="ddae8-118">編集、挿入、および削除するデータのチュートリアルへ GridView、DetailsView、および FormView、戻り値内でこれらの機能の実装を復習する必要がある場合で始まる[、概要の挿入、更新、および削除](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md)です。</span><span class="sxs-lookup"><span data-stu-id="ddae8-118">If you need to brush up on implementing these features within the GridView, DetailsView, and FormView, return to the Editing, Inserting, and Deleting Data tutorials, starting with [An Overview of Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md).</span></span>


## <a name="step-1-specifyinginsertupdate-anddeletestatements"></a><span data-ttu-id="ddae8-119">手順 1: 指定`INSERT`、`UPDATE`、および`DELETE`ステートメント</span><span class="sxs-lookup"><span data-stu-id="ddae8-119">Step 1: Specifying`INSERT`,`UPDATE`, and`DELETE`Statements</span></span>

<span data-ttu-id="ddae8-120">おとしては、過去の 2 つのチュートリアルでは、データを取得する必要があります、SqlDataSource コントロールから見てきましたは、2 つのプロパティを設定します。</span><span class="sxs-lookup"><span data-stu-id="ddae8-120">As we ve seen in the past two tutorials, to retrieve data from a SqlDataSource control we need to set two properties:</span></span>

1. <span data-ttu-id="ddae8-121">`ConnectionString`、、クエリを送信するデータベースの内容を指定し、</span><span class="sxs-lookup"><span data-stu-id="ddae8-121">`ConnectionString`, which specifies what database to send the query to, and</span></span>
2. <span data-ttu-id="ddae8-122">`SelectCommand`、アドホック SQL ステートメントまたはを実行結果を返すストアド プロシージャの名前を指定します。</span><span class="sxs-lookup"><span data-stu-id="ddae8-122">`SelectCommand`, which specifies the ad-hoc SQL statement or stored procedure name to execute to return the results.</span></span>

<span data-ttu-id="ddae8-123">`SelectCommand`パラメーターの値、値が SqlDataSource s を介して指定されたパラメーター`SelectParameters`コレクション ハード コーディングされた値、共通パラメーターのソース値を含めることができます (クエリ文字列フィールド、セッション変数、Web コントロールの値とよびな)、またはプログラムによって割り当てられたことができます。</span><span class="sxs-lookup"><span data-stu-id="ddae8-123">For `SelectCommand` values with parameters, the parameter values are specified via the SqlDataSource s `SelectParameters` collection and can include hard-coded values, common parameter source values (querystring fields, session variables, Web control values, and so on), or can be programmatically assigned.</span></span> <span data-ttu-id="ddae8-124">SqlDataSource が s を制御するときに`Select()`メソッドが呼び出されたプログラムでも自動的に Web コントロールのデータから、データベースへの接続が確立される、パラメーターの値は、クエリに割り当てられたおよびにコマンドが渡さオフ、データベースです。</span><span class="sxs-lookup"><span data-stu-id="ddae8-124">When the SqlDataSource control s `Select()` method is invoked either programmatically or automatically from a data Web control a connection to the database is established, the parameter values are assigned to the query, and the command is shuttled off to the database.</span></span> <span data-ttu-id="ddae8-125">結果がデータセットか、DataReader のいずれかとしてコントロール秒の値に応じて、返される`DataSourceMode`プロパティです。</span><span class="sxs-lookup"><span data-stu-id="ddae8-125">The results are then returned as either a DataSet or DataReader, depending on the value of the control s `DataSourceMode` property.</span></span>

<span data-ttu-id="ddae8-126">データを選択すると、と共に、SqlDataSource コントロールを使用して挿入、更新、および指定することによってデータを削除する`INSERT`、 `UPDATE`、および`DELETE`ほぼ同じ方法で SQL ステートメント。</span><span class="sxs-lookup"><span data-stu-id="ddae8-126">Along with selecting data, the SqlDataSource control can be used to insert, update, and delete data by supplying `INSERT`, `UPDATE`, and `DELETE` SQL statements in much the same way.</span></span> <span data-ttu-id="ddae8-127">割り当てるだけで、 `InsertCommand`、 `UpdateCommand`、および`DeleteCommand`プロパティ、 `INSERT`、 `UPDATE`、および`DELETE`SQL ステートメントを実行します。</span><span class="sxs-lookup"><span data-stu-id="ddae8-127">Simply assign the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties the `INSERT`, `UPDATE`, and `DELETE` SQL statements to execute.</span></span> <span data-ttu-id="ddae8-128">(ようほとんど常に) ステートメントがパラメーターを持つかどうかに含める、 `InsertParameters`、 `UpdateParameters`、および`DeleteParameters`コレクション。</span><span class="sxs-lookup"><span data-stu-id="ddae8-128">If the statements have parameters (as they most always will), include them in the `InsertParameters`, `UpdateParameters`, and `DeleteParameters` collections.</span></span>

<span data-ttu-id="ddae8-129">1 回、 `InsertCommand`、 `UpdateCommand`、または`DeleteCommand`値が指定されて、Web コントロールのスマート タグの対応するデータの挿入を有効にする、編集を有効にする、または削除を有効にするオプションを使用可能になる予定です。</span><span class="sxs-lookup"><span data-stu-id="ddae8-129">Once an `InsertCommand`, `UpdateCommand`, or `DeleteCommand` value has been specified, the Enable Inserting, Enable Editing, or Enable Deleting option in the corresponding data Web control s smart tag will become available.</span></span> <span data-ttu-id="ddae8-130">Let s はこれを示すためから例を見て、 `Querying.aspx`  ページで作成した、 [SqlDataSource コントロールでのデータのクエリを実行する](querying-data-with-the-sqldatasource-control-cs.md)チュートリアルおよびを追加するための削除機能を強化します。</span><span class="sxs-lookup"><span data-stu-id="ddae8-130">To illustrate this, let s take an example from the `Querying.aspx` page we created in the [Querying Data with the SqlDataSource Control](querying-data-with-the-sqldatasource-control-cs.md) tutorial and augment it to include delete capabilities.</span></span>

<span data-ttu-id="ddae8-131">開いて開始、`InsertUpdateDelete.aspx`と`Querying.aspx`ページから、`SqlDataSource`フォルダーです。</span><span class="sxs-lookup"><span data-stu-id="ddae8-131">Start by opening the `InsertUpdateDelete.aspx` and `Querying.aspx` pages from the `SqlDataSource` folder.</span></span> <span data-ttu-id="ddae8-132">上のデザイナーから、 `Querying.aspx`  ページで、最初の例から SqlDataSource GridView を選択します (、`ProductsDataSource`と`GridView1`コントロール)。</span><span class="sxs-lookup"><span data-stu-id="ddae8-132">From the Designer on the `Querying.aspx` page, select the SqlDataSource and GridView from the first example (the `ProductsDataSource` and `GridView1` controls).</span></span> <span data-ttu-id="ddae8-133">2 つのコントロールを選択すると、[編集] メニューに移動およびコピーを選択 (または Ctrl + C キーを押すだけ)。</span><span class="sxs-lookup"><span data-stu-id="ddae8-133">After selecting the two controls, go to the Edit menu and choose Copy (or just hit Ctrl+C).</span></span> <span data-ttu-id="ddae8-134">次のデザイナーへ移動`InsertUpdateDelete.aspx`コントロールに貼り付けます。</span><span class="sxs-lookup"><span data-stu-id="ddae8-134">Next, go to the Designer of `InsertUpdateDelete.aspx` and paste in the controls.</span></span> <span data-ttu-id="ddae8-135">に 2 つのコントロールを移動した後に`InsertUpdateDelete.aspx`ブラウザーでページをテストします。</span><span class="sxs-lookup"><span data-stu-id="ddae8-135">After you have moved the two controls over to `InsertUpdateDelete.aspx`, test out the page in a browser.</span></span> <span data-ttu-id="ddae8-136">値を確認する必要があります、 `ProductID`、 `ProductName`、および`UnitPrice`レコード内のすべての列、`Products`データベース テーブルです。</span><span class="sxs-lookup"><span data-stu-id="ddae8-136">You should see the values of the `ProductID`, `ProductName`, and `UnitPrice` columns for all of the records in the `Products` database table.</span></span>


<span data-ttu-id="ddae8-137">[![すべての製品が一覧表示されます ProductID 順](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image1.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="ddae8-137">[![All of the Products are Listed, Ordered by ProductID](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image1.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image1.png)</span></span>

<span data-ttu-id="ddae8-138">**図 1**: すべての製品の一覧表示されますの順で`ProductID`([フルサイズのイメージを表示するをクリックして](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="ddae8-138">**Figure 1**: All of the Products are Listed, Ordered by `ProductID` ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image2.png))</span></span>


## <a name="adding-the-sqldatasource-sdeletecommandanddeleteparametersproperties"></a><span data-ttu-id="ddae8-139">SqlDataSource s を追加する`DeleteCommand`と`DeleteParameters`プロパティ</span><span class="sxs-lookup"><span data-stu-id="ddae8-139">Adding the SqlDataSource s`DeleteCommand`and`DeleteParameters`Properties</span></span>

<span data-ttu-id="ddae8-140">この時点であるだけで、すべてのレコードから返す SqlDataSource、`Products`テーブルとデータを表示する GridView。</span><span class="sxs-lookup"><span data-stu-id="ddae8-140">At this point we have a SqlDataSource that simply returns all of the records from the `Products` table and a GridView that renders this data.</span></span> <span data-ttu-id="ddae8-141">目標は GridView 経由で製品を削除するユーザーに対して許可するには、この例を拡張することです。</span><span class="sxs-lookup"><span data-stu-id="ddae8-141">Our goal is to extend this example to allow for the user to delete products via the GridView.</span></span> <span data-ttu-id="ddae8-142">SqlDataSource コントロール秒の値を指定する必要があります。 これを実現する`DeleteCommand`と`DeleteParameters`プロパティおよび削除をサポートする GridView を構成します。</span><span class="sxs-lookup"><span data-stu-id="ddae8-142">To accomplish this we need to specify values for the SqlDataSource control s `DeleteCommand` and `DeleteParameters` properties and then configure the GridView to support deleting.</span></span>

<span data-ttu-id="ddae8-143">`DeleteCommand`と`DeleteParameters`さまざまな方法でプロパティを指定することができます。</span><span class="sxs-lookup"><span data-stu-id="ddae8-143">The `DeleteCommand` and `DeleteParameters` properties can be specified in a number of ways:</span></span>

- <span data-ttu-id="ddae8-144">宣言の構文を使用</span><span class="sxs-lookup"><span data-stu-id="ddae8-144">Through the declarative syntax</span></span>
- <span data-ttu-id="ddae8-145">デザイナーで [プロパティ] ウィンドウ</span><span class="sxs-lookup"><span data-stu-id="ddae8-145">From the Properties window in the Designer</span></span>
- <span data-ttu-id="ddae8-146">カスタム SQL ステートメントまたはストアド プロシージャがデータ ソースの構成ウィザードでの画面を指定してから</span><span class="sxs-lookup"><span data-stu-id="ddae8-146">From the Specify a custom SQL statement or stored procedure screen in the Configure Data Source wizard</span></span>
- <span data-ttu-id="ddae8-147">データ ソースの構成ウィザードでの表示画面のテーブルから列を指定の詳細設定 ボタンを使用してこれが実際に自動的に生成、`DELETE`で使用される SQL ステートメントやパラメーターのコレクション、`DeleteCommand`と`DeleteParameters`プロパティ</span><span class="sxs-lookup"><span data-stu-id="ddae8-147">Via the Advanced button in the Specify columns from a table of view screen in the Configure Data Source wizard, which will actually automatically generate the `DELETE` SQL statement and parameter collection used in the `DeleteCommand` and `DeleteParameters` properties</span></span>

<span data-ttu-id="ddae8-148">自動的に実施する方法について確認、`DELETE`手順 2. で作成されたステートメント。</span><span class="sxs-lookup"><span data-stu-id="ddae8-148">We'll examine how to automatically have the `DELETE` statement created in Step 2.</span></span> <span data-ttu-id="ddae8-149">ここでは、により、s、デザイナーの [プロパティ] ウィンドウを使用して、データ ソース構成ウィザードまたは宣言構文オプションは機能と同様。</span><span class="sxs-lookup"><span data-stu-id="ddae8-149">For now, let s use the Properties window in the Designer, although the Configure Data Source wizard or declarative syntax option would work just as well.</span></span>

<span data-ttu-id="ddae8-150">デザイナーから`InsertUpdateDelete.aspx`、をクリックして、 `ProductsDataSource` SqlDataSource し、[プロパティ] ウィンドウを開き ([表示] メニューから [プロパティ] ウィンドウを選択または、f4 キーを押すだけで)。</span><span class="sxs-lookup"><span data-stu-id="ddae8-150">From the Designer in `InsertUpdateDelete.aspx`, click on the `ProductsDataSource` SqlDataSource and then bring up the Properties window (from the View menu, choose Properties window, or simply hit F4).</span></span> <span data-ttu-id="ddae8-151">省略記号のセットが表示されます、DeleteQuery プロパティを選択します。</span><span class="sxs-lookup"><span data-stu-id="ddae8-151">Select the DeleteQuery property, which will bring up a set of ellipses.</span></span>


![[プロパティ] ウィンドウから DeleteQuery プロパティを選択します。](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image2.gif)

<span data-ttu-id="ddae8-153">**図 2**: [プロパティ] ウィンドウから DeleteQuery プロパティを選択</span><span class="sxs-lookup"><span data-stu-id="ddae8-153">**Figure 2**: Select the DeleteQuery Property from the Properties Window</span></span>


> [!NOTE]
> <span data-ttu-id="ddae8-154">SqlDataSource されないでは、DeleteQuery プロパティがあります。</span><span class="sxs-lookup"><span data-stu-id="ddae8-154">The SqlDataSource doesn t have a DeleteQuery property.</span></span> <span data-ttu-id="ddae8-155">DeleteQuery の組み合わせは、代わりに、`DeleteCommand`と`DeleteParameters`プロパティと、デザイナーでウィンドウを表示するときにのみ、[プロパティ] ウィンドウに表示します。</span><span class="sxs-lookup"><span data-stu-id="ddae8-155">Rather, DeleteQuery is a combination of the `DeleteCommand` and `DeleteParameters` properties and is only listed in the Properties window when viewing the window through the Designer.</span></span> <span data-ttu-id="ddae8-156">場合は、ソース ビューの [プロパティ] ウィンドウを見ることがわかります、`DeleteCommand`プロパティ代わりにします。</span><span class="sxs-lookup"><span data-stu-id="ddae8-156">If you are looking at the Properties window in the Source view, you'll find the `DeleteCommand` property instead.</span></span>


<span data-ttu-id="ddae8-157">コマンドおよびパラメーターのエディター ダイアログを表示する DeleteQuery プロパティ内の省略記号ボックス (図 3 を参照) をクリックします。</span><span class="sxs-lookup"><span data-stu-id="ddae8-157">Click the ellipses in the DeleteQuery property to bring up the Command and Parameter Editor dialog box (see Figure 3).</span></span> <span data-ttu-id="ddae8-158">このダイアログ ボックスで指定することができます、 `DELETE` SQL ステートメントのパラメーターを指定します。</span><span class="sxs-lookup"><span data-stu-id="ddae8-158">From this dialog box you can specify the `DELETE` SQL statement and specify the parameters.</span></span> <span data-ttu-id="ddae8-159">次のクエリを入力、 `DELETE`  ボックスにコマンド (か、手動でまたはしたい場合は、クエリ ビルダーを使用して)。</span><span class="sxs-lookup"><span data-stu-id="ddae8-159">Enter the following query into the `DELETE` command textbox (either manually or using the Query Builder, if you prefer):</span></span>

[!code-sql[Main](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/samples/sample1.sql)]

<span data-ttu-id="ddae8-160">次に、追加パラメーターの更新ボタンをクリックして、`@ProductID`パラメーター以下のパラメーターの一覧にします。</span><span class="sxs-lookup"><span data-stu-id="ddae8-160">Next, click the Refresh Parameters button to add the `@ProductID` parameter to the list of parameters below.</span></span>


<span data-ttu-id="ddae8-161">[![[プロパティ] ウィンドウから DeleteQuery プロパティを選択します。](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image3.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="ddae8-161">[![Select the DeleteQuery Property from the Properties Window](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image3.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image3.png)</span></span>

<span data-ttu-id="ddae8-162">**図 3**: [プロパティ] ウィンドウから DeleteQuery プロパティを選択 ([フルサイズのイメージを表示するをクリックして](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="ddae8-162">**Figure 3**: Select the DeleteQuery Property from the Properties Window ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image4.png))</span></span>


<span data-ttu-id="ddae8-163">*いない*(そのパラメーターのソースなし のままにして) このパラメーターの値を指定します。</span><span class="sxs-lookup"><span data-stu-id="ddae8-163">Do *not* provide a value for this parameter (leave its Parameter source at None ).</span></span> <span data-ttu-id="ddae8-164">GridView に、削除のサポートを追加した GridView は自動的にこの値を入力パラメーターの値を使用してその`DataKeys`の削除 ボタンがクリックしてされた行のコレクション。</span><span class="sxs-lookup"><span data-stu-id="ddae8-164">Once we add deleting support to the GridView, the GridView will automatically supply this parameter value, using the value of its `DataKeys` collection for the row whose Delete button was clicked.</span></span>

> [!NOTE]
> <span data-ttu-id="ddae8-165">使用されるパラメーター名、`DELETE`クエリ*必要があります*の名前と同じである、 `DataKeyNames` GridView、DetailsView、またはフォーム ビュー内の値。</span><span class="sxs-lookup"><span data-stu-id="ddae8-165">The parameter name used in the `DELETE` query *must* be the same as the name of the `DataKeyNames` value in the GridView, DetailsView, or FormView.</span></span> <span data-ttu-id="ddae8-166">内のパラメーターは、`DELETE`ステートメントの名前は意図的に`@ProductID`(の代わりに、たとえば、 `@ID`)、Products テーブル (およびそのため、GridView にされている DataKeyNames 値) の主キー列名があるため、`ProductID`です。</span><span class="sxs-lookup"><span data-stu-id="ddae8-166">That is, the parameter in the `DELETE` statement is purposefully named `@ProductID` (instead of, say, `@ID`), because the primary key column name in the Products table (and therefore the DataKeyNames value in the GridView) is `ProductID`.</span></span>


<span data-ttu-id="ddae8-167">場合、パラメーター名と`DataKeyNames`値が一致していない GridView に自動的に値を代入できません、パラメーターから、`DataKeys`コレクション。</span><span class="sxs-lookup"><span data-stu-id="ddae8-167">If the parameter name and `DataKeyNames` value doesn t match, the GridView cannot automatically assign the parameter the value from the `DataKeys` collection.</span></span>

<span data-ttu-id="ddae8-168">コマンドおよびパラメーターのエディター ダイアログ ボックスに、削除の関連情報を入力した後に ok をクリックし、結果として得られるの宣言型マークアップをソース ビューに移動します。</span><span class="sxs-lookup"><span data-stu-id="ddae8-168">After entering the delete-related information into the Command and Parameter Editor dialog box click OK and go to the Source view to examine the resulting declarative markup:</span></span>

[!code-aspx[Main](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/samples/sample2.aspx)]

<span data-ttu-id="ddae8-169">追加に注意してください、`DeleteCommand`プロパティだけでなく`<DeleteParameters>`セクションとという名前のパラメーター オブジェクト`productID`です。</span><span class="sxs-lookup"><span data-stu-id="ddae8-169">Note the addition of the `DeleteCommand` property as well as the `<DeleteParameters>` section and the Parameter object named `productID`.</span></span>

## <a name="configuring-the-gridview-for-deleting"></a><span data-ttu-id="ddae8-170">削除する GridView の構成</span><span class="sxs-lookup"><span data-stu-id="ddae8-170">Configuring the GridView for Deleting</span></span>

<span data-ttu-id="ddae8-171">`DeleteCommand`プロパティの追加、GridView s のスマート タグが削除を有効にするオプションを含むようになりました。</span><span class="sxs-lookup"><span data-stu-id="ddae8-171">With the `DeleteCommand` property added, the GridView s smart tag now contains the Enable Deleting option.</span></span> <span data-ttu-id="ddae8-172">このチェック ボックスを確認してください。</span><span class="sxs-lookup"><span data-stu-id="ddae8-172">Go ahead and check this checkbox.</span></span> <span data-ttu-id="ddae8-173">説明したよう[、概要の挿入、更新、および削除](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md)、これが原因で CommandField を追加する GridView の`ShowDeleteButton`プロパティに設定`true`です。</span><span class="sxs-lookup"><span data-stu-id="ddae8-173">As discussed in [An Overview of Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md), this causes the GridView to add a CommandField with its `ShowDeleteButton` property set to `true`.</span></span> <span data-ttu-id="ddae8-174">図に 4 に示すページがブラウザーからアクセスしたときに、[削除] ボタンが含まれます。</span><span class="sxs-lookup"><span data-stu-id="ddae8-174">As Figure 4 shows, when the page is visited through a browser a Delete button is included.</span></span> <span data-ttu-id="ddae8-175">このページをテストするには、いくつかの製品を削除します。</span><span class="sxs-lookup"><span data-stu-id="ddae8-175">Test this page out by deleting some products.</span></span>


<span data-ttu-id="ddae8-176">[![GridView の行ごとに [削除] ボタンが含まれています](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image4.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="ddae8-176">[![Each GridView Row Now Includes a Delete Button](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image4.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image5.png)</span></span>

<span data-ttu-id="ddae8-177">**図 4**: GridView 行ごとに、[削除] ボタンが含まれています ([フルサイズのイメージを表示するをクリックして](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="ddae8-177">**Figure 4**: Each GridView Row Now Includes a Delete Button ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image6.png))</span></span>


<span data-ttu-id="ddae8-178">削除 ボタンをクリックすると、ポストバックが発生した、GridView 割り当てます、`ProductID`パラメーター値の`DataKeys`コレクションの値の行の削除 ボタンがクリックされ、SqlDataSource s を呼び出す`Delete()`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="ddae8-178">Upon clicking a Delete button, a postback occurs, the GridView assigns the `ProductID` parameter the value of the `DataKeys` collection value for the row whose Delete button was clicked, and invokes the SqlDataSource s `Delete()` method.</span></span> <span data-ttu-id="ddae8-179">SqlDataSource コントロールは、データベースに接続し、実行、`DELETE`ステートメントです。</span><span class="sxs-lookup"><span data-stu-id="ddae8-179">The SqlDataSource control then connects to the database and executes the `DELETE` statement.</span></span> <span data-ttu-id="ddae8-180">SqlDataSource を取得して、(を不要になったばかり削除されたレコードを含む) の製品の現在のセットを表示する GridView を再バインドします。</span><span class="sxs-lookup"><span data-stu-id="ddae8-180">The GridView then rebinds to the SqlDataSource, getting back and displaying the current set of products (which no longer includes the just-deleted record).</span></span>

> [!NOTE]
> <span data-ttu-id="ddae8-181">GridView が使用されるため、 `DataKeys` SqlDataSource パラメーターを設定するコレクション、s の重要なを GridView s`DataKeyNames`プロパティと主キーを構成する列に設定する SqlDataSource の`SelectCommand`を返しますこれらの列です。</span><span class="sxs-lookup"><span data-stu-id="ddae8-181">Since the GridView uses its `DataKeys` collection to populate the SqlDataSource parameters, it s vital that the GridView s `DataKeyNames` property be set to the column(s) that constitute the primary key and that the SqlDataSource s `SelectCommand` returns these columns.</span></span> <span data-ttu-id="ddae8-182">さらに、その SqlDataSource s でパラメーターの名前、重要な`DeleteCommand`に設定されている`@ProductID`です。</span><span class="sxs-lookup"><span data-stu-id="ddae8-182">Moreover, it s important that the parameter name in the SqlDataSource s `DeleteCommand` is set to `@ProductID`.</span></span> <span data-ttu-id="ddae8-183">場合、`DataKeyNames`プロパティが設定されていないか、パラメーターの名前が付いていない`@ProductsID`ポストバックを [削除] ボタンをクリックすると生成されますが、受注 t が実際には任意のレコードを削除します。</span><span class="sxs-lookup"><span data-stu-id="ddae8-183">If the `DataKeyNames` property is not set or the parameter is not named `@ProductsID`, clicking the Delete button will cause a postback, but won t actually delete any record.</span></span>


<span data-ttu-id="ddae8-184">図 5 では、この操作を視覚的に示しています。</span><span class="sxs-lookup"><span data-stu-id="ddae8-184">Figure 5 depicts this interaction graphically.</span></span> <span data-ttu-id="ddae8-185">戻って、 [、イベントに関連付けられている挿入、更新、および削除を確認する](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-cs.md)挿入、更新、およびデータ Web コントロールからの削除に関連するイベントのチェーンについては詳細なチュートリアルです。</span><span class="sxs-lookup"><span data-stu-id="ddae8-185">Refer back to the [Examining the Events Associated with Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-cs.md) tutorial for a more detailed discussion on the chain of events associated with inserting, updating, and deleting from a data Web control.</span></span>


![GridView で [削除] ボタンをクリックするとメソッドを呼び出し、SqlDataSource の Delete()](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image5.gif)

<span data-ttu-id="ddae8-187">**図 5**: SqlDataSource の GridView で [削除] ボタンをクリックすると呼び出す`Delete()`メソッド</span><span class="sxs-lookup"><span data-stu-id="ddae8-187">**Figure 5**: Clicking the Delete Button in the GridView Invokes the SqlDataSource s `Delete()` Method</span></span>


## <a name="step-2-automatically-generating-theinsertupdate-anddeletestatements"></a><span data-ttu-id="ddae8-188">手順 2: が自動的に生成する、`INSERT`、`UPDATE`、および`DELETE`ステートメント</span><span class="sxs-lookup"><span data-stu-id="ddae8-188">Step 2: Automatically Generating the`INSERT`,`UPDATE`, and`DELETE`Statements</span></span>

<span data-ttu-id="ddae8-189">調べてから、手順 1. として`INSERT`、 `UPDATE`、および`DELETE`プロパティ ウィンドウまたはコントロール s 宣言の構文によって SQL ステートメントを指定できます。</span><span class="sxs-lookup"><span data-stu-id="ddae8-189">As Step 1 examined, `INSERT`, `UPDATE`, and `DELETE` SQL statements can be specified through the Properties window or the control s declarative syntax.</span></span> <span data-ttu-id="ddae8-190">ただし、この方法を手動で書き込みます SQL ステートメントを手動で単調とエラーが発生しやすいできる必要があります。</span><span class="sxs-lookup"><span data-stu-id="ddae8-190">However, this approach requires that we manually write out the SQL statements by hand, which can be monotonous and error-prone.</span></span> <span data-ttu-id="ddae8-191">幸いにも、データ ソース構成ウィザードする機能が、 `INSERT`、 `UPDATE`、および`DELETE`ステートメントの表示画面のテーブルから列を指定を使用すると自動的に生成します。</span><span class="sxs-lookup"><span data-stu-id="ddae8-191">Fortunately, the Configure Data Source wizard provides an option to have the `INSERT`, `UPDATE`, and `DELETE` statements automatically generated when using the Specify columns from a table of view screen.</span></span>

<span data-ttu-id="ddae8-192">この自動生成オプションを探索 s を使用できます。</span><span class="sxs-lookup"><span data-stu-id="ddae8-192">Let s explore this automatic generation option.</span></span> <span data-ttu-id="ddae8-193">DetailsView にデザイナーでは、追加`InsertUpdateDelete.aspx`設定とその`ID`プロパティを`ManageProducts`です。</span><span class="sxs-lookup"><span data-stu-id="ddae8-193">Add a DetailsView to the Designer in `InsertUpdateDelete.aspx` and set its `ID` property to `ManageProducts`.</span></span> <span data-ttu-id="ddae8-194">次に、DetailsView s のスマート タグから新しいデータ ソースを作成し、名前付き SqlDataSource を作成する選択`ManageProductsDataSource`です。</span><span class="sxs-lookup"><span data-stu-id="ddae8-194">Next, from the DetailsView s smart tag, choose to create a new data source and create a SqlDataSource named `ManageProductsDataSource`.</span></span>


<span data-ttu-id="ddae8-195">[![ManageProductsDataSource をという名前の新しい SqlDataSource を作成します。](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image6.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="ddae8-195">[![Create a New SqlDataSource Named ManageProductsDataSource](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image6.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image7.png)</span></span>

<span data-ttu-id="ddae8-196">**図 6**: 名前付き新しい SqlDataSource 作成`ManageProductsDataSource`([フルサイズのイメージを表示するをクリックして](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="ddae8-196">**Figure 6**: Create a New SqlDataSource Named `ManageProductsDataSource` ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image8.png))</span></span>


<span data-ttu-id="ddae8-197">データ ソースの構成の作成ウィザードを使用してよう、`NORTHWINDConnectionString`接続文字列を [次へ] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="ddae8-197">From the Configure Data Source wizard, opt to use the `NORTHWINDConnectionString` connection string and click Next.</span></span> <span data-ttu-id="ddae8-198">Select ステートメントの画面の構成 から選択したテーブルまたはビューのオプション ボタンから列を指定のままにし、選択、`Products`ドロップダウン リストからテーブル。</span><span class="sxs-lookup"><span data-stu-id="ddae8-198">From the Configure the Select Statement screen, leave the Specify columns from a table or view radio button selected and pick the `Products` table from the drop-down list.</span></span> <span data-ttu-id="ddae8-199">選択、 `ProductID`、 `ProductName`、 `UnitPrice`、および`Discontinued` チェック ボックスの一覧から列です。</span><span class="sxs-lookup"><span data-stu-id="ddae8-199">Select the `ProductID`, `ProductName`, `UnitPrice`, and `Discontinued` columns from the checkbox list.</span></span>


<span data-ttu-id="ddae8-200">[![ProductID、ProductName、単価、および提供が中止された列を返す、Products テーブルを使用して、](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image7.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="ddae8-200">[![Using the Products Table, Return the ProductID, ProductName, UnitPrice, and Discontinued Columns](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image7.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image9.png)</span></span>

<span data-ttu-id="ddae8-201">**図 7**: を使用して、`Products`テーブルで、返す、 `ProductID`、 `ProductName`、 `UnitPrice`、および`Discontinued`列 ([フルサイズのイメージを表示するをクリックして](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="ddae8-201">**Figure 7**: Using the `Products` Table, Return the `ProductID`, `ProductName`, `UnitPrice`, and `Discontinued` Columns ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image10.png))</span></span>


<span data-ttu-id="ddae8-202">自動的に生成`INSERT`、 `UPDATE`、および`DELETE`、選択したテーブルと列に基づいて、ステートメントが高度なボタンをクリックし、確認の生成`INSERT`、`UPDATE`と`DELETE`ステートメントのチェック ボックスをオンします。</span><span class="sxs-lookup"><span data-stu-id="ddae8-202">To automatically generate `INSERT`, `UPDATE`, and `DELETE` statements based on the selected table and columns, click the Advanced button and check the Generate `INSERT`, `UPDATE`, and `DELETE` statements checkbox.</span></span>


![生成 INSERT、UPDATE、および DELETE ステートメントのチェック ボックス](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image8.gif)

<span data-ttu-id="ddae8-204">**図 8**: 確認生成`INSERT`、 `UPDATE`、および`DELETE`ステートメント チェック ボックス</span><span class="sxs-lookup"><span data-stu-id="ddae8-204">**Figure 8**: Check the Generate `INSERT`, `UPDATE`, and `DELETE` statements Checkbox</span></span>


<span data-ttu-id="ddae8-205">生成`INSERT`、 `UPDATE`、および`DELETE`選択されたテーブルが主キーと主キー列 (または列) が返される列の一覧に含まれている場合、ステートメントのチェック ボックスはチェック可能必ずです。</span><span class="sxs-lookup"><span data-stu-id="ddae8-205">The Generate `INSERT`, `UPDATE`, and `DELETE` statements checkbox will only be checkable if the table selected has a primary key and the primary key column (or columns) are included in the list of returned columns.</span></span> <span data-ttu-id="ddae8-206">選択可能になりますオプティミスティック同時実行制御チェック ボックスを使用して 1 回生成`INSERT`、 `UPDATE`、および`DELETE`ステートメントのチェック ボックスがチェックされている、強化は、`WHERE`結果内の句`UPDATE`と`DELETE`オプティミスティック同時実行制御を提供するステートメント。</span><span class="sxs-lookup"><span data-stu-id="ddae8-206">The Use optimistic concurrency checkbox, which becomes selectable once the Generate `INSERT`, `UPDATE`, and `DELETE` statements checkbox has been checked, will augment the `WHERE` clauses in the resulting `UPDATE` and `DELETE` statements to provide optimistic concurrency control.</span></span> <span data-ttu-id="ddae8-207">ここでは、このチェック ボックスをオンにせずです。次のチュートリアルでは、SqlDataSource コントロールでオプティミスティック同時実行制御について確認します。</span><span class="sxs-lookup"><span data-stu-id="ddae8-207">For now, leave this checkbox unchecked; we'll examine optimistic concurrency with the SqlDataSource control in the next tutorial.</span></span>

<span data-ttu-id="ddae8-208">生成をチェックした後`INSERT`、 `UPDATE`、および`DELETE`ステートメント、Select ステートメントの構成画面に戻り、次に、をクリックし [ok] をクリックしてボックスとし、[完了] で、データ ソースの構成ウィザードを完了します。</span><span class="sxs-lookup"><span data-stu-id="ddae8-208">After checking the Generate `INSERT`, `UPDATE`, and `DELETE` statements checkbox, click OK to return to the Configure Select Statement screen, then click Next, and then Finish, to complete the Configure Data Source wizard.</span></span> <span data-ttu-id="ddae8-209">ウィザードを完了すると、Visual Studio が追加 BoundFields の DetailsView、 `ProductID`、 `ProductName`、および`UnitPrice`列との CheckBoxField、`Discontinued`列です。</span><span class="sxs-lookup"><span data-stu-id="ddae8-209">Upon completing the wizard, Visual Studio will add BoundFields to the DetailsView for the `ProductID`, `ProductName`, and `UnitPrice` columns and a CheckBoxField for the `Discontinued` column.</span></span> <span data-ttu-id="ddae8-210">DetailsView s のスマート タグからこのページにアクセスしたユーザーを製品ステップスルーようにページングを有効にするオプションを確認します。</span><span class="sxs-lookup"><span data-stu-id="ddae8-210">From the DetailsView s smart tag, check the Enable Paging option so that the user visiting this page can step through the products.</span></span> <span data-ttu-id="ddae8-211">DetailsView s もクリア`Width`と`Height`プロパティです。</span><span class="sxs-lookup"><span data-stu-id="ddae8-211">Also clear out the DetailsView s `Width` and `Height` properties.</span></span>

<span data-ttu-id="ddae8-212">スマート タグに挿入を有効にする、編集を有効にするには、および削除を有効にするオプションがありますに注意してください。</span><span class="sxs-lookup"><span data-stu-id="ddae8-212">Notice that the smart tag has the Enable Inserting, Enable Editing, and Enable Deleting options available.</span></span> <span data-ttu-id="ddae8-213">これは、SqlDataSource に値が含まれているため、 `InsertCommand`、 `UpdateCommand`、および`DeleteCommand`次の宣言の構文に示すように、します。</span><span class="sxs-lookup"><span data-stu-id="ddae8-213">This is because the SqlDataSource contains values for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand`, as the following declarative syntax shows:</span></span>

[!code-aspx[Main](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/samples/sample3.aspx)]

<span data-ttu-id="ddae8-214">値が自動的に設定する SqlDataSource コントロールがどのようにに注意してください。 その`InsertCommand`、 `UpdateCommand`、および`DeleteCommand`プロパティです。</span><span class="sxs-lookup"><span data-stu-id="ddae8-214">Note how the SqlDataSource control has had values automatically set for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span> <span data-ttu-id="ddae8-215">参照される列のセット、`InsertCommand`と`UpdateCommand`プロパティに基づいて内、`SELECT`ステートメントです。</span><span class="sxs-lookup"><span data-stu-id="ddae8-215">The set of columns referenced in the `InsertCommand` and `UpdateCommand` properties are based on those in the `SELECT` statement.</span></span> <span data-ttu-id="ddae8-216">つまりではなく*すべて*製品列で、`InsertCommand`と`UpdateCommand`で指定された列のみがある、 `SelectCommand` (小さい`ProductID`、ためこれを省略すると、s、 [`IDENTITY`列](http://www.sqlteam.com/item.asp?ItemID=102)編集する際に、値が変更されたことはできません、および挿入するときに自動的に割り当てられる)。</span><span class="sxs-lookup"><span data-stu-id="ddae8-216">That is, rather than having *every* Products column in the `InsertCommand` and `UpdateCommand`, there are only those columns specified in the `SelectCommand` (less `ProductID`, which is omitted because it s an [`IDENTITY` column](http://www.sqlteam.com/item.asp?ItemID=102), whose value cannot be changed when edited and which is automatically assigned when inserting).</span></span> <span data-ttu-id="ddae8-217">さらの各パラメーターに、 `InsertCommand`、 `UpdateCommand`、および`DeleteCommand`プロパティに対応するパラメーターがある、 `InsertParameters`、 `UpdateParameters`、および`DeleteParameters`コレクション。</span><span class="sxs-lookup"><span data-stu-id="ddae8-217">Moreover, for each parameter in the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties there are corresponding parameters in the `InsertParameters`, `UpdateParameters`, and `DeleteParameters` collections.</span></span>

<span data-ttu-id="ddae8-218">DetailsView のデータ変更機能を有効にするには、挿入を有効にする、編集を有効にして、スマート タグの削除を有効にするオプションを確認します。</span><span class="sxs-lookup"><span data-stu-id="ddae8-218">To turn on the DetailsView s data modification features, check the Enable Inserting, Enable Editing, and Enable Deleting options in its smart tag.</span></span> <span data-ttu-id="ddae8-219">CommandField が追加されます、 `ShowInsertButton`、 `ShowEditButton`、および`ShowDeleteButton`プロパティに設定`true`です。</span><span class="sxs-lookup"><span data-stu-id="ddae8-219">This adds a CommandField with its `ShowInsertButton`, `ShowEditButton`, and `ShowDeleteButton` properties set to `true`.</span></span>

<span data-ttu-id="ddae8-220">ブラウザーでページを参照してください、編集、削除、および DetailsView に含まれる新しいボタンに注意してください。</span><span class="sxs-lookup"><span data-stu-id="ddae8-220">Visit the page in a browser and note the Edit, Delete, and New buttons included in the DetailsView.</span></span> <span data-ttu-id="ddae8-221">各 BoundField を表示する編集モードに DetailsView をオンに [編集] ボタンをクリックするとが`ReadOnly`プロパティに設定されている`false`(既定)、テキスト ボックスとチェック ボックスとして CheckBoxField として。</span><span class="sxs-lookup"><span data-stu-id="ddae8-221">Clicking the Edit button turns the DetailsView into edit mode, which displays each BoundField whose `ReadOnly` property is set to `false` (the default) as a TextBox, and the CheckBoxField as a checkbox.</span></span>


<span data-ttu-id="ddae8-222">[![DetailsView の既定の編集用のインターフェイス](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image9.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="ddae8-222">[![The DetailsView s Default Editing Interface](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image9.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image11.png)</span></span>

<span data-ttu-id="ddae8-223">**図 9**:「DetailsView s 編集インターフェイス既定の ([フルサイズ イメージを表示するに、をクリックして](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="ddae8-223">**Figure 9**: The DetailsView s Default Editing Interface ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image12.png))</span></span>


<span data-ttu-id="ddae8-224">同様に、現在選択されている製品を削除したり、新しい製品をシステムに追加できます。</span><span class="sxs-lookup"><span data-stu-id="ddae8-224">Similarly, you can delete the currently selected product or add a new product to the system.</span></span> <span data-ttu-id="ddae8-225">以降、`InsertCommand`ステートメントに対してのみ適用、 `ProductName`、 `UnitPrice`、および`Discontinued`列、他の列であるか、`NULL`または挿入時にデータベースによって割り当てられる既定値です。</span><span class="sxs-lookup"><span data-stu-id="ddae8-225">Since the `InsertCommand` statement only works with the `ProductName`, `UnitPrice`, and `Discontinued` columns, the other columns have either `NULL` or their default value assigned by the database upon insert.</span></span> <span data-ttu-id="ddae8-226">同じように、ObjectDataSource の場合、`InsertCommand`ない列で使用できる任意のデータベース テーブルがありません`NULL`s としない既定の値を持つ、SQL エラーが発生実行しようとするとき、`INSERT`ステートメントです。</span><span class="sxs-lookup"><span data-stu-id="ddae8-226">Just like with the ObjectDataSource, if the `InsertCommand` is missing any database table columns that don t allow `NULL` s and don t have a default value, a SQL error will occur when attempting to execute the `INSERT` statement.</span></span>

> [!NOTE]
> <span data-ttu-id="ddae8-227">DetailsView の s を挿入して、インターフェイスを編集するには、あらゆる種類のカスタマイズや検証が不足しています。</span><span class="sxs-lookup"><span data-stu-id="ddae8-227">The DetailsView s inserting and editing interfaces lack any sort of customization or validation.</span></span> <span data-ttu-id="ddae8-228">検証コントロールを追加する、またはインターフェイスをカスタマイズするには、TemplateFields、BoundFields に変換する必要があります。</span><span class="sxs-lookup"><span data-stu-id="ddae8-228">To add validation controls or to customize the interfaces, you need to convert the BoundFields to TemplateFields.</span></span> <span data-ttu-id="ddae8-229">参照してください、[検証コントロールを編集および挿入するインターフェイスを追加する](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-cs.md)と[データ変更インターフェイスのカスタマイズ](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-cs.md)詳細については、チュートリアルです。</span><span class="sxs-lookup"><span data-stu-id="ddae8-229">Refer to the [Adding Validation Controls to the Editing and Inserting Interfaces](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-cs.md) and [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-cs.md) tutorials for more information.</span></span>


<span data-ttu-id="ddae8-230">またの更新と削除を DetailsView で使用される、現在の製品の注意してください`DataKey`場合にのみ存在する値、`DataKeyNames`プロパティを構成します。</span><span class="sxs-lookup"><span data-stu-id="ddae8-230">Also, keep in mind that for updating and deleting, the DetailsView uses the current product s `DataKey` value, which is only present if the `DataKeyNames` property is configured.</span></span> <span data-ttu-id="ddae8-231">編集または削除に見える場合がある影響しない、いることを確認、`DataKeyNames`プロパティを設定します。</span><span class="sxs-lookup"><span data-stu-id="ddae8-231">If editing or deleting appears to have no effect, ensure that the `DataKeyNames` property is set.</span></span>

## <a name="limitations-of-automatically-generating-sql-statements"></a><span data-ttu-id="ddae8-232">SQL ステートメントを自動的に生成の制限事項</span><span class="sxs-lookup"><span data-stu-id="ddae8-232">Limitations of Automatically Generating SQL Statements</span></span>

<span data-ttu-id="ddae8-233">生成後`INSERT`、 `UPDATE`、および`DELETE`ステートメント オプションは、独自に作成する必要があるより複雑なため、テーブルの列を選択するときにのみ使用可能な`INSERT`、 `UPDATE`、および`DELETE`手順 1. で同じようにステートメントです。</span><span class="sxs-lookup"><span data-stu-id="ddae8-233">Since the Generate `INSERT`, `UPDATE`, and `DELETE` statements option is only available when picking columns from a table, for more complex queries you will have to write your own `INSERT`, `UPDATE`, and `DELETE` statements like we did in Step 1.</span></span> <span data-ttu-id="ddae8-234">一般的には、SQL`SELECT`ステートメントを使用して`JOIN`の 1 つまたは複数のルックアップ テーブルからデータを表示目的に戻すには (元に戻す方法など、`Categories`表の`CategoryName`製品情報を表示するときにフィールド)。</span><span class="sxs-lookup"><span data-stu-id="ddae8-234">Commonly, SQL `SELECT` statements use `JOIN` s to bring back data from one or more lookup tables for display purposes (such as bringing back the `Categories` table s `CategoryName` field when displaying product information).</span></span> <span data-ttu-id="ddae8-235">同時に、編集、更新、または、中核となるテーブルにデータを挿入するユーザーを許可するか可能性があります (`Products`、ここで)。</span><span class="sxs-lookup"><span data-stu-id="ddae8-235">At the same time, we might want to allow the user to edit, update, or insert data into the core table (`Products`, in this case).</span></span>

<span data-ttu-id="ddae8-236">中に、 `INSERT`、 `UPDATE`、および`DELETE`ステートメントが手動で入力することができますし、次の時間を節約のヒントを検討してください。</span><span class="sxs-lookup"><span data-stu-id="ddae8-236">While the `INSERT`, `UPDATE`, and `DELETE` statements can be entered manually, consider the following time-saving tip.</span></span> <span data-ttu-id="ddae8-237">最初に、バックアップからデータをプルしたように、SqlDataSource をセットアップ、`Products`テーブル。</span><span class="sxs-lookup"><span data-stu-id="ddae8-237">Initially setup the SqlDataSource so that it pulls back data just from the `Products` table.</span></span> <span data-ttu-id="ddae8-238">自動的に生成できるように、テーブルまたはビューの画面からデータ ソースの構成ウィザードの列と s を指定を使用して、 `INSERT`、 `UPDATE`、および`DELETE`ステートメントです。</span><span class="sxs-lookup"><span data-stu-id="ddae8-238">Use the Configure Data Source wizard s Specify columns from a table or view screen so that you can automatically generate the `INSERT`, `UPDATE`, and `DELETE` statements.</span></span> <span data-ttu-id="ddae8-239">次に、ウィザードを完了すると、[プロパティ] ウィンドウから SelectQuery を構成する (か、または、使用するカスタム SQL ステートメントの指定が、データ ソース構成ウィザードまたはストアド プロシージャのオプションに戻る)。</span><span class="sxs-lookup"><span data-stu-id="ddae8-239">Then, after completing the wizard, choose to configure the SelectQuery from the Properties window (or, alternatively, go back to the Configure Data Source wizard, but use the Specify a custom SQL statement or stored procedure option).</span></span> <span data-ttu-id="ddae8-240">更新して、`SELECT`を含めるようにステートメント、`JOIN`構文です。</span><span class="sxs-lookup"><span data-stu-id="ddae8-240">Then update the `SELECT` statement to include the `JOIN` syntax.</span></span> <span data-ttu-id="ddae8-241">この手法は、時間節約の利点が自動的に生成された SQL ステートメントのでき、さらにカスタマイズしたことができます`SELECT`ステートメントです。</span><span class="sxs-lookup"><span data-stu-id="ddae8-241">This technique offers the time-saving benefits of the automatically generated SQL statements and allows for a more customized `SELECT` statement.</span></span>

<span data-ttu-id="ddae8-242">自動的に生成する別の制限、 `INSERT`、 `UPDATE`、および`DELETE`ステートメントは、内の列を提供する、`INSERT`と`UPDATE`ステートメントは、によって返される列に基づいて、`SELECT`ステートメントです。</span><span class="sxs-lookup"><span data-stu-id="ddae8-242">Another limitation of automatically generating the `INSERT`, `UPDATE`, and `DELETE` statements is that the columns in the `INSERT` and `UPDATE` statements are based on the columns returned by the `SELECT` statement.</span></span> <span data-ttu-id="ddae8-243">更新またはただし、またはより少ないフィールドを挿入する必要があります。</span><span class="sxs-lookup"><span data-stu-id="ddae8-243">We may need to update or insert more or fewer fields, however.</span></span> <span data-ttu-id="ddae8-244">たとえば、手順 2 の例にすることができますが、 `UnitPrice` BoundField 読み取り専用になります。</span><span class="sxs-lookup"><span data-stu-id="ddae8-244">For example, in the example from Step 2, maybe we want to have the `UnitPrice` BoundField be read-only.</span></span> <span data-ttu-id="ddae8-245">その場合は、それに表示されるべきで t、`UpdateCommand`です。</span><span class="sxs-lookup"><span data-stu-id="ddae8-245">In that case, it shouldn t appear in the `UpdateCommand`.</span></span> <span data-ttu-id="ddae8-246">またはに GridView で表示されていない、テーブルのフィールドの値を設定することがあります。</span><span class="sxs-lookup"><span data-stu-id="ddae8-246">Or we may want to set the value of a table field that does not appear in the GridView.</span></span> <span data-ttu-id="ddae8-247">たとえば、新しいを追加するときにレコードお場合、`QuantityPerUnit`値 TODO に設定します。</span><span class="sxs-lookup"><span data-stu-id="ddae8-247">For example, when adding a new record we may want the `QuantityPerUnit` value set to TODO .</span></span>

<span data-ttu-id="ddae8-248">このようなカスタマイズが必要な場合は、ように手動で、[プロパティ] ウィンドウ、カスタム SQL ステートメントの指定またはウィザードで、または宣言の構文を使用してストアド プロシージャのオプションから必要があります。</span><span class="sxs-lookup"><span data-stu-id="ddae8-248">If such customizations are required, you need to make them manually, either through the Properties window, the Specify a custom SQL statement or stored procedure option in the wizard, or via the declarative syntax.</span></span>

> [!NOTE]
> <span data-ttu-id="ddae8-249">データの対応するフィールドがないパラメーターの追加は、コントロールを Web、ときに、これらのパラメーターの値は、なんらかの方法で値を割り当てる必要があることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="ddae8-249">When adding parameters that do not have corresponding fields in the data Web control, keep in mind that these parameters values will need to be assigned values in some manner.</span></span> <span data-ttu-id="ddae8-250">これらの値を指定できます。 ハード コーディングされたで直接、`InsertCommand`または`UpdateCommand`; は、(クエリ文字列、セッション状態、ページ上の Web コントロール); いくつかの事前定義されたソースから取得できますか、またはプログラムでは、前のチュートリアルで示したように割り当てることができます。</span><span class="sxs-lookup"><span data-stu-id="ddae8-250">These values can be: hard-coded directly in the `InsertCommand` or `UpdateCommand`; can come from some pre-defined source (the querystring, session state, Web controls on the page, and so on); or can be assigned programmatically, as we saw in the preceding tutorial.</span></span>


## <a name="summary"></a><span data-ttu-id="ddae8-251">概要</span><span class="sxs-lookup"><span data-stu-id="ddae8-251">Summary</span></span>

<span data-ttu-id="ddae8-252">Web コントロールを組み込みの挿入、編集、および削除機能を利用して、データの順序でにバインドされているデータ ソース コントロールは、このような機能を提供する必要があります。</span><span class="sxs-lookup"><span data-stu-id="ddae8-252">In order for the data Web controls to utilize their built-in inserting, editing, and deleting capabilities, the data source control they are bound to must offer such functionality.</span></span> <span data-ttu-id="ddae8-253">SqlDataSource、これは意味を`INSERT`、 `UPDATE`、および`DELETE`SQL ステートメントを割り当てる必要があります、 `InsertCommand`、 `UpdateCommand`、および`DeleteCommand`プロパティです。</span><span class="sxs-lookup"><span data-stu-id="ddae8-253">For the SqlDataSource, this means that `INSERT`, `UPDATE`, and `DELETE` SQL statements must be assigned to the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span> <span data-ttu-id="ddae8-254">これらのプロパティとは対応するパラメーターのコレクションを手動で追加またはデータ ソースの構成ウィザードを自動的に生成します。</span><span class="sxs-lookup"><span data-stu-id="ddae8-254">These properties, and the corresponding parameters collections, can be added manually or generated automatically through the Configure Data Source wizard.</span></span> <span data-ttu-id="ddae8-255">このチュートリアルでは、両方の方法を確認します。</span><span class="sxs-lookup"><span data-stu-id="ddae8-255">In this tutorial we examined both techniques.</span></span>

<span data-ttu-id="ddae8-256">ObjectDataSource でオプティミスティック同時実行制御の使用について説明しました、[オプティミスティック同時実行制御で実装する](../editing-inserting-and-deleting-data/implementing-optimistic-concurrency-cs.md)チュートリアルです。</span><span class="sxs-lookup"><span data-stu-id="ddae8-256">We examined using optimistic concurrency with the ObjectDataSource in the [Implementing Optimistic Concurrency](../editing-inserting-and-deleting-data/implementing-optimistic-concurrency-cs.md) tutorial.</span></span> <span data-ttu-id="ddae8-257">SqlDataSource コントロールでは、オプティミスティック同時実行制御のサポートも提供します。</span><span class="sxs-lookup"><span data-stu-id="ddae8-257">The SqlDataSource control also provides optimistic concurrency support.</span></span> <span data-ttu-id="ddae8-258">自動的に生成するときに、手順 2. で説明したとおり、 `INSERT`、 `UPDATE`、および`DELETE`ステートメントを使用するオプティミスティック同時実行制御オプションに、ウィザードで提供しています。</span><span class="sxs-lookup"><span data-stu-id="ddae8-258">As noted in Step 2, when automatically generating the `INSERT`, `UPDATE`, and `DELETE` statements, the wizard offers a Use optimistic concurrency option.</span></span> <span data-ttu-id="ddae8-259">次のチュートリアルで後ほどお見せ、として、SqlDataSource によるオプティミスティック同時実行制御を使用して変更、`WHERE`内の句、`UPDATE`と`DELETE`ステートメントを他の列の値が t の後、データが最後に変更をまだことを確認してください。ページに表示されます。</span><span class="sxs-lookup"><span data-stu-id="ddae8-259">As we'll see in the next tutorial, using optimistic concurrency with the SqlDataSource modifies the `WHERE` clauses in the `UPDATE` and `DELETE` statements to ensure that the values for the other columns haven t changed since the data was last displayed on the page.</span></span>

<span data-ttu-id="ddae8-260">満足プログラミング!</span><span class="sxs-lookup"><span data-stu-id="ddae8-260">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="ddae8-261">作成者について</span><span class="sxs-lookup"><span data-stu-id="ddae8-261">About the Author</span></span>

<span data-ttu-id="ddae8-262">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)、7 つ受け取りますブックとの創設者の作成者[4GuysFromRolla.com](http://www.4guysfromrolla.com)、1998 年からマイクロソフトの Web テクノロジで取り組んできました。</span><span class="sxs-lookup"><span data-stu-id="ddae8-262">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="ddae8-263">Scott は、コンサルタント、トレーナー、ライターとして機能します。</span><span class="sxs-lookup"><span data-stu-id="ddae8-263">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="ddae8-264">最新の著書[ *Sam 学べる自分で ASP.NET 2.0 が 24 時間以内に*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)です。</span><span class="sxs-lookup"><span data-stu-id="ddae8-264">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="ddae8-265">彼に到達できる[ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)彼のブログを使用して含まれているのか[http://ScottOnWriting.NET](http://ScottOnWriting.NET)です。</span><span class="sxs-lookup"><span data-stu-id="ddae8-265">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="ddae8-266">[前へ](using-parameterized-queries-with-the-sqldatasource-cs.md)
[次へ](implementing-optimistic-concurrency-with-the-sqldatasource-cs.md)</span><span class="sxs-lookup"><span data-stu-id="ddae8-266">[Previous](using-parameterized-queries-with-the-sqldatasource-cs.md)
[Next](implementing-optimistic-concurrency-with-the-sqldatasource-cs.md)</span></span>
