---
uid: web-forms/overview/older-versions-getting-started/aspnet-ajax/understanding-asp-net-ajax-web-services
title: "ASP.NET AJAX の Web サービスを理解する |Microsoft ドキュメント"
author: scottcate
description: "Web サービスは、分散システムの間でデータを交換するため、クロスプラット フォーム ソリューションを提供する .NET framework の不可欠な構成です。 Web しています."
ms.author: aspnetcontent
manager: wpickett
ms.date: 03/28/2008
ms.topic: article
ms.assetid: 3332d6e7-e2e1-4144-b805-e71d51e7e415
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-getting-started/aspnet-ajax/understanding-asp-net-ajax-web-services
msc.type: authoredcontent
ms.openlocfilehash: 8eb3486c9b3f4ddb6a8bc2c1cdcac774a6852574
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/10/2017
---
<a name="understanding-aspnet-ajax-web-services"></a><span data-ttu-id="bd3d8-104">ASP.NET AJAX の Web サービスを理解します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-104">Understanding ASP.NET AJAX Web Services</span></span>
====================
<span data-ttu-id="bd3d8-105">によって[Scott カテゴリ](https://github.com/scottcate)</span><span class="sxs-lookup"><span data-stu-id="bd3d8-105">by [Scott Cate](https://github.com/scottcate)</span></span>

[<span data-ttu-id="bd3d8-106">PDF をダウンロードします。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-106">Download PDF</span></span>](http://download.microsoft.com/download/C/1/9/C19A3451-1D14-477C-B703-54EF22E197EE/AJAX_tutorial05_Web_Services_with_MS_Ajax_cs.pdf)

> <span data-ttu-id="bd3d8-107">Web サービスは、分散システムの間でデータを交換するため、クロスプラット フォーム ソリューションを提供する .NET framework の不可欠な構成です。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-107">Web Services are an integral part of the .NET framework that provide a cross-platform solution for exchanging data between distributed systems.</span></span> <span data-ttu-id="bd3d8-108">通常、さまざまなオペレーティング システム、オブジェクト モデルおよびデータを送受信するプログラミング言語を許可する Web サービスが使用されます、動的に ASP.NET AJAX ページにデータを挿入またはバックエンド システムにページからデータを送信する使用できます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-108">Although Web Services are normally used to allow different operating systems, object models and programming languages to send and receive data, they can also be used to dynamically inject data into an ASP.NET AJAX page or send data from a page to a back-end system.</span></span> <span data-ttu-id="bd3d8-109">このすべては、操作のポストバックを使用しなくても実行できます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-109">All of this can be done without resorting to postback operations.</span></span>


## <a name="calling-web-services-with-aspnet-ajax"></a><span data-ttu-id="bd3d8-110">ASP.NET AJAX を使用した Web サービスの呼び出し</span><span class="sxs-lookup"><span data-stu-id="bd3d8-110">Calling Web Services with ASP.NET AJAX</span></span>

<span data-ttu-id="bd3d8-111">Dan Wahlin</span><span class="sxs-lookup"><span data-stu-id="bd3d8-111">Dan Wahlin</span></span>

<span data-ttu-id="bd3d8-112">Web サービスは、分散システムの間でデータを交換するため、クロスプラット フォーム ソリューションを提供する .NET framework の不可欠な構成です。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-112">Web Services are an integral part of the .NET framework that provide a cross-platform solution for exchanging data between distributed systems.</span></span> <span data-ttu-id="bd3d8-113">通常、さまざまなオペレーティング システム、オブジェクト モデルおよびデータを送受信するプログラミング言語を許可する Web サービスが使用されます、動的に ASP.NET AJAX ページにデータを挿入またはバックエンド システムにページからデータを送信する使用できます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-113">Although Web Services are normally used to allow different operating systems, object models and programming languages to send and receive data, they can also be used to dynamically inject data into an ASP.NET AJAX page or send data from a page to a back-end system.</span></span> <span data-ttu-id="bd3d8-114">このすべては、操作のポストバックを使用しなくても実行できます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-114">All of this can be done without resorting to postback operations.</span></span>

<span data-ttu-id="bd3d8-115">ASP.NET AJAX UpdatePanel コントロールには、AJAX を簡単な方法が用意されています。 ASP.NET ページを有効にする、UpdatePanel を使用せず、サーバー上のデータを動的にアクセスする必要がある場合があります。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-115">While the ASP.NET AJAX UpdatePanel control provides a simple way to AJAX enable any ASP.NET page, there may be times when you need to dynamically access data on the server without using an UpdatePanel.</span></span> <span data-ttu-id="bd3d8-116">この記事の内容を作成して、ASP.NET AJAX ページ内で Web サービスを利用してこれを実行する方法が表示されます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-116">In this article you'll see how to accomplish this by creating and consuming Web Services within ASP.NET AJAX pages.</span></span>

<span data-ttu-id="bd3d8-117">この記事コア ASP.NET AJAX 拡張機能だけでなく、AutoCompleteExtender と呼ばれる ASP.NET AJAX ツールキットでの Web サービスを有効にコントロールで利用できる機能に焦点を当てます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-117">This article will focus on functionality available in the core ASP.NET AJAX Extensions as well as a Web Service enabled control in the ASP.NET AJAX Toolkit called the AutoCompleteExtender.</span></span> <span data-ttu-id="bd3d8-118">説明のトピックには、AJAX 対応の Web サービスを定義する、クライアント プロキシを作成および JavaScript での Web サービスの呼び出しが含まれます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-118">Topics covered include defining AJAX-enabled Web Services, creating client proxies and calling Web Services with JavaScript.</span></span> <span data-ttu-id="bd3d8-119">ASP.NET ページ メソッドを直接 Web サービスの呼び出しを行う方法も表示されます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-119">You'll also see how Web Service calls can be made directly to ASP.NET page methods.</span></span>

## <a name="web-services-configuration"></a><span data-ttu-id="bd3d8-120">Web サービスの構成</span><span class="sxs-lookup"><span data-stu-id="bd3d8-120">Web Services Configuration</span></span>

<span data-ttu-id="bd3d8-121">Visual Studio 2008 に新しい Web サイト プロジェクトが作成されると、web.config ファイルは以前のバージョンの Visual Studio のユーザーになじみがない可能性がありますを新しく追加するメンバーの数がします。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-121">When a new Web Site project is created with Visual Studio 2008, the web.config file has a number of new additions that may be unfamiliar to users of previous versions of Visual Studio.</span></span> <span data-ttu-id="bd3d8-122">これらの変更の一部"asp"プレフィックスにマップ ASP.NET AJAX コントロール HttpHandlers、HttpModules が必要な他のユーザーを定義するときにページで使用できるようにします。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-122">Some of these modifications map the "asp" prefix to ASP.NET AJAX controls so they can be used in pages while others define required HttpHandlers and HttpModules.</span></span> <span data-ttu-id="bd3d8-123">加えられた変更を示しています 1 を一覧表示する、 `<httpHandlers>` Web サービス呼び出しに影響を与える web.config 内の要素。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-123">Listing 1 shows modifications made to the `<httpHandlers>` element in web.config that affects Web Service calls.</span></span> <span data-ttu-id="bd3d8-124">HttpHandler .asmx 呼び出しを処理するために使用する既定値は削除され、System.Web.Extensions.dll アセンブリ内にある ScriptHandlerFactory クラスに置き換えられます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-124">The default HttpHandler used to process .asmx calls is removed and replaced with a ScriptHandlerFactory class located in the System.Web.Extensions.dll assembly.</span></span> <span data-ttu-id="bd3d8-125">System.Web.Extensions.dll には、すべての ASP.NET AJAX で使用されるコア機能が含まれています。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-125">System.Web.Extensions.dll contains all of the core functionality used by ASP.NET AJAX.</span></span>

<span data-ttu-id="bd3d8-126">**1 を一覧表示します。ASP.NET AJAX Web サービスのハンドラーの構成**</span><span class="sxs-lookup"><span data-stu-id="bd3d8-126">**Listing 1. ASP.NET AJAX Web Service Handler Configuration**</span></span>

[!code-xml[Main](understanding-asp-net-ajax-web-services/samples/sample1.xml)]

<span data-ttu-id="bd3d8-127">この HttpHandler 置換が JavaScript の Web サービス プロキシを使用して JavaScript Object Notation (JSON) 呼び出しを .NET Web サービスに ASP.NET AJAX ページから作成できるようにするために行われます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-127">This HttpHandler replacement is made in order to allow JavaScript Object Notation (JSON) calls to be made from ASP.NET AJAX pages to .NET Web Services using a JavaScript Web Service proxy.</span></span> <span data-ttu-id="bd3d8-128">ASP.NET AJAX では、通常 Web サービスに関連付けられている標準的な簡易オブジェクト アクセス プロトコル (SOAP) の呼び出しではなく、JSON メッセージを Web サービスに送信します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-128">ASP.NET AJAX sends JSON messages to Web Services as opposed to the standard Simple Object Access Protocol (SOAP) calls typically associated with Web Services.</span></span> <span data-ttu-id="bd3d8-129">これは、結果より小さな要求および応答メッセージ全体にします。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-129">This results in smaller request and response messages overall.</span></span> <span data-ttu-id="bd3d8-130">ASP.NET AJAX JavaScript ライブラリの最適化の JSON オブジェクトを操作するためもデータのクライアント側の処理をより効率的にできます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-130">It also allows for more efficient client-side processing of data since the ASP.NET AJAX JavaScript library is optimized to work with JSON objects.</span></span> <span data-ttu-id="bd3d8-131">2 および 3 の一覧表示する表示を JSON 形式にシリアル化された Web サービス要求と応答メッセージの例を示しますの一覧です。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-131">Listing 2 and Listing 3 show examples of Web Service request and response messages serialized to JSON format.</span></span> <span data-ttu-id="bd3d8-132">リスト 2 に示すように要求メッセージは、リスト 3 の応答メッセージは、顧客オブジェクトの配列とその関連プロパティの中に「ベルギー」の値を持つ国パラメーターを渡します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-132">The request message shown in Listing 2 passes a country parameter with a value of "Belgium" while the response message in Listing 3 passes an array of Customer objects and their associated properties.</span></span>

<span data-ttu-id="bd3d8-133">**2 を一覧表示します。Web サービス要求メッセージが JSON にシリアル化します。**</span><span class="sxs-lookup"><span data-stu-id="bd3d8-133">**Listing 2. Web Service Request Message Serialized to JSON**</span></span>

[!code-json[Main](understanding-asp-net-ajax-web-services/samples/sample2.json)]

> <span data-ttu-id="bd3d8-134">*>[!NOTE]操作名が web サービスへの URL の一部として定義されている以外の場合はさらに、要求メッセージは送信されません。 常に JSON を使用しています。Web サービスは、ScriptMethod 属性を利用して UseHttpGet パラメーターが true の場合、これにより、経由で渡されるパラメーターを設定して、クエリ文字列パラメーター。*</span><span class="sxs-lookup"><span data-stu-id="bd3d8-134">*> [!NOTE] the operation name is defined as part of the URL to the web service; additionally, request messages are not always submitted via JSON. Web Services can utilize the ScriptMethod attribute with the UseHttpGet parameter set to true, which causes parameters to be passed via a the query string parameters.*</span></span>


<span data-ttu-id="bd3d8-135">**3 を一覧表示します。Web サービス応答メッセージが JSON にシリアル化します。**</span><span class="sxs-lookup"><span data-stu-id="bd3d8-135">**Listing 3. Web Service Response Message Serialized to JSON**</span></span>

[!code-json[Main](understanding-asp-net-ajax-web-services/samples/sample3.json)]

<span data-ttu-id="bd3d8-136">次のセクションでは、JSON 要求メッセージを処理し、両方単純型と複合型で応答することのできる Web サービスを作成する方法が表示されます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-136">In the next section you'll see how to create Web Services capable of handling JSON request messages and responding with both simple and complex types.</span></span>

## <a name="creating-ajax-enabled-web-services"></a><span data-ttu-id="bd3d8-137">AJAX 対応 Web サービスを作成します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-137">Creating AJAX-Enabled Web Services</span></span>

<span data-ttu-id="bd3d8-138">ASP.NET AJAX framework には、Web サービスを呼び出すいくつかの方法が用意されています。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-138">The ASP.NET AJAX framework provides several different ways to call Web Services.</span></span> <span data-ttu-id="bd3d8-139">(ASP.NET AJAX Toolkit で使用可能) AutoCompleteExtender コントロールまたは JavaScript を使用することができます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-139">You can use the AutoCompleteExtender control (available in the ASP.NET AJAX Toolkit) or JavaScript.</span></span> <span data-ttu-id="bd3d8-140">ただし、サービスを呼び出す前にする必要がある AJAX を有効にする、クライアント スクリプト コードから呼び出すことができるようにします。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-140">However, before calling a service you have to AJAX-enable it so that it can be called by client-script code.</span></span>

<span data-ttu-id="bd3d8-141">初めて使用する ASP.NET Web サービス、かどうかに簡単に作成および AJAX を有効にするサービスがあります。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-141">Whether or not you're new to ASP.NET Web Services, you'll find it straightforward to create and AJAX-enable services.</span></span> <span data-ttu-id="bd3d8-142">.NET framework は、ASP.NET Web サービスの作成 2002年の初期リリース以降、サポートされ、ASP.NET AJAX 拡張機能は、.NET framework の既定の機能セットに基づいて作成された追加の AJAX 機能を提供します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-142">The .NET framework has supported the creation of ASP.NET Web Services since its initial release in 2002 and the ASP.NET AJAX Extensions provide additional AJAX functionality that builds upon the .NET framework's default set of features.</span></span> <span data-ttu-id="bd3d8-143">Visual Studio .NET 2008 Beta 2 は、.asmx Web サービス ファイルを作成するための組み込みサポートを持ち、System.Web.Services.WebService クラスからクラスの横にある関連付けられているコードを自動的に派生します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-143">Visual Studio .NET 2008 Beta 2 has built-in support for creating .asmx Web Service files and automatically derives associated code beside classes from the System.Web.Services.WebService class.</span></span> <span data-ttu-id="bd3d8-144">クラスにメソッドを追加すると、Web サービスのコンシューマーによって呼び出されるこれらのために WebMethod 属性を適用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-144">As you add methods into the class you must apply the WebMethod attribute in order for them to be called by Web Service consumers.</span></span>

<span data-ttu-id="bd3d8-145">リスト 4 GetCustomersByCountry() をという名前のメソッドに WebMethod 属性を適用する例を示します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-145">Listing 4 shows an example of applying the WebMethod attribute to a method named GetCustomersByCountry().</span></span>

<span data-ttu-id="bd3d8-146">**4 を一覧表示します。Web サービスで WebMethod 属性の使用**</span><span class="sxs-lookup"><span data-stu-id="bd3d8-146">**Listing 4. Using the WebMethod Attribute in a Web Service**</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample4.cs)]

<span data-ttu-id="bd3d8-147">GetCustomersByCountry() メソッドでは、国のパラメーターを受け取り、顧客オブジェクトの配列を返します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-147">The GetCustomersByCountry() method accepts a country parameter and returns a Customer object array.</span></span> <span data-ttu-id="bd3d8-148">メソッドに渡されたの国の値は、データベースからデータを取得するデータ レイヤーのクラスがデータを顧客オブジェクトのプロパティを入力し、配列を返しますの呼び出しになるビジネス レイヤー クラスに転送されます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-148">The country value passed into the method is forwarded to a business layer class which in turn calls a data layer class to retrieve the data from the database, fill the Customer object properties with data and return the array.</span></span>

## <a name="using-the-scriptservice-attribute"></a><span data-ttu-id="bd3d8-149">ScriptService 属性を使用します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-149">Using the ScriptService Attribute</span></span>

<span data-ttu-id="bd3d8-150">Web メソッド属性を使用して、Web サービスに標準的な SOAP メッセージを送信するクライアントによって呼び出される GetCustomersByCountry() メソッドを追加するときに JSON の呼び出しをすぐに ASP.NET AJAX アプリケーションからことはできません。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-150">While adding the WebMethod attribute allows the GetCustomersByCountry() method to be called by clients that send standard SOAP messages to the Web Service, it doesn't allow JSON calls to be made from ASP.NET AJAX applications out of the box.</span></span> <span data-ttu-id="bd3d8-151">JSON の ASP.NET AJAX 拡張機能の適用に必要になる呼び出しを許可する`ScriptService`属性を Web サービス クラスにします。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-151">To allow JSON calls to be made you have to apply the ASP.NET AJAX Extension's `ScriptService` attribute to the Web Service class.</span></span> <span data-ttu-id="bd3d8-152">これにより、Web サービスで JSON を使用してフォーマットされた応答メッセージを送信でき、JSON メッセージを送信することによって、サービスを呼び出すためにクライアント側スクリプト。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-152">This enables a Web Service to send response messages formatted using JSON and allows client-side script to call a service by sending JSON messages.</span></span>

<span data-ttu-id="bd3d8-153">5 を一覧表示する CustomersService をという名前の Web サービス クラスに ScriptService 属性を適用する例を示します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-153">Listing 5 shows an example of applying the ScriptService attribute to a Web Service class named CustomersService.</span></span>

<span data-ttu-id="bd3d8-154">**5 を一覧表示します。Web サービスを AJAX を有効にする ScriptService 属性を使用します。**</span><span class="sxs-lookup"><span data-stu-id="bd3d8-154">**Listing 5. Using the ScriptService Attribute to AJAX-enable a Web Service**</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample5.cs)]

<span data-ttu-id="bd3d8-155">ScriptService 属性は、AJAX スクリプト コードから呼び出すことを示すマーカーとして機能します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-155">The ScriptService attribute acts as a marker that indicates it can be called from AJAX script code.</span></span> <span data-ttu-id="bd3d8-156">すべてのバック グラウンドで発生する JSON シリアル化または逆シリアル化のタスクを処理、しない実際にします。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-156">It doesn't actually handle any of the JSON serialization or deserialization tasks that occur behind the scenes.</span></span> <span data-ttu-id="bd3d8-157">(Web.config で構成されている) ScriptHandlerFactory およびその他の関連するクラスは、JSON の処理の大部分を行います。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-157">The ScriptHandlerFactory (configured in web.config) and other related classes do the bulk of JSON processing.</span></span>

## <a name="using-the-scriptmethod-attribute"></a><span data-ttu-id="bd3d8-158">ScriptMethod 属性を使用します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-158">Using the ScriptMethod Attribute</span></span>

<span data-ttu-id="bd3d8-159">ScriptService 属性は、ASP.NET AJAX ページで使用するために .NET Web サービスで定義されている必要のある唯一の ASP.NET AJAX 属性です。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-159">The ScriptService attribute is the only ASP.NET AJAX attribute that has to be defined in a .NET Web Service in order for it to be used by ASP.NET AJAX pages.</span></span> <span data-ttu-id="bd3d8-160">ただし、ScriptMethod をという名前の別の属性はサービスの Web メソッドの直接にも適用できます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-160">However, another attribute named ScriptMethod can also be applied directly to Web Methods in a service.</span></span> <span data-ttu-id="bd3d8-161">含む 3 つのプロパティを定義する ScriptMethod `UseHttpGet`、`ResponseFormat`と`XmlSerializeString`です。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-161">ScriptMethod defines three properties including `UseHttpGet`, `ResponseFormat` and `XmlSerializeString`.</span></span> <span data-ttu-id="bd3d8-162">これらのプロパティの値の変更は、Web メソッドで受け入れられる要求の種類が、Web メソッドの形式の生の XML データを返す必要がある場合、GET に変更する必要がある場合に役に立ちます、`XmlDocument`または`XmlElement`オブジェクトまたはから返されたデータの場合、 サービスは、JSON ではなく XML として常にシリアル化する必要があります。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-162">Changing the values of these properties can be useful in cases where the type of request accepted by a Web Method needs to be changed to GET, when a Web Method needs to return raw XML data in the form of an `XmlDocument` or `XmlElement` object or when data returned from a service should always be serialized as XML instead of JSON.</span></span>

<span data-ttu-id="bd3d8-163">プロパティは、Web メソッドを受け取らなければなりませんときに使用できる UseHttpGet は、POST 要求ではなく要求を取得します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-163">The UseHttpGet property can be used when a Web Method should accept GET requests as opposed to POST requests.</span></span> <span data-ttu-id="bd3d8-164">要求を送信するには、Web メソッドの入力パラメーターを使用して URL を使用してクエリ文字列パラメーターに変換されます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-164">Requests are sent using a URL with Web Method input parameters converted to QueryString parameters.</span></span> <span data-ttu-id="bd3d8-165">設定されているプロパティの既定値は false とのみ UseHttpGet`true`操作の safe と機密データが Web サービスに渡されない場合のことが知られています。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-165">The UseHttpGet property defaults to false and should only be set to `true` when operations are known to be safe and when sensitive data is not passed to a Web Service.</span></span> <span data-ttu-id="bd3d8-166">リスト 6 UseHttpGet プロパティを持つ ScriptMethod 属性の使用例を示します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-166">Listing 6 shows an example of using the ScriptMethod attribute with the UseHttpGet property.</span></span>

<span data-ttu-id="bd3d8-167">**6 を一覧表示します。UseHttpGet プロパティを持つ ScriptMethod 属性を使用します。**</span><span class="sxs-lookup"><span data-stu-id="bd3d8-167">**Listing 6. Using the ScriptMethod attribute with the UseHttpGet property.**</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample6.cs)]

<span data-ttu-id="bd3d8-168">リスト 6 に示す HttpGetEcho Web メソッドが呼び出されたときに送信したヘッダーの例を次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-168">An example of the headers sent when the HttpGetEcho Web Method shown in Listing 6 is called are shown next:</span></span>

`GET /CustomerViewer/DemoService.asmx/HttpGetEcho?input=%22Input Value%22 HTTP/1.1`

<span data-ttu-id="bd3d8-169">Web メソッドを HTTP GET 要求を受け入れるようにできるだけでなく、ScriptMethod 属性も使用できます XML の応答は、JSON ではなく、サービスから返される必要がある場合。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-169">In addition to allowing Web Methods to accept HTTP GET requests, the ScriptMethod attribute can also be used when XML responses need to be returned from a service rather than JSON.</span></span> <span data-ttu-id="bd3d8-170">たとえば、Web サービスはリモート サイトから RSS フィードを取得し、XmlDocument または XmlElement オブジェクトとして返す場合があります。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-170">For example, a Web Service may retrieve an RSS feed from a remote site and return it as an XmlDocument or XmlElement object.</span></span> <span data-ttu-id="bd3d8-171">XML の処理をデータにし、クライアントで発生します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-171">Processing of the XML data can then occur on the client.</span></span>

<span data-ttu-id="bd3d8-172">7 を一覧表示する ResponseFormat プロパティを使用して XML データを Web メソッドから返されることを指定する例を示します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-172">Listing 7 shows an example of using the ResponseFormat property to specify that XML data should be returned from a Web Method.</span></span>

<span data-ttu-id="bd3d8-173">**7 を一覧表示します。ResponseFormat プロパティを持つ ScriptMethod 属性を使用します。**</span><span class="sxs-lookup"><span data-stu-id="bd3d8-173">**Listing 7. Using the ScriptMethod attribute with the ResponseFormat property.**</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample7.cs)]

<span data-ttu-id="bd3d8-174">ResponseFormat プロパティは、XmlSerializeString プロパティと共に使用できます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-174">The ResponseFormat property can also be used along with the XmlSerializeString property.</span></span> <span data-ttu-id="bd3d8-175">XmlSerializeString プロパティが、既定値は false で、Web メソッドから返される文字列以外の型が XML としてシリアル化をすべて返すときに、`ResponseFormat`プロパティに設定されている`ResponseFormat.Xml`です。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-175">The XmlSerializeString property has a default value of false which means that all return types except strings returned from a Web Method are serialized as XML when the `ResponseFormat` property is set to `ResponseFormat.Xml`.</span></span> <span data-ttu-id="bd3d8-176">ときに`XmlSerializeString`に設定されている`true`、Web メソッドから返されるすべての型は文字列型を含む XML としてシリアル化します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-176">When `XmlSerializeString` is set to `true`, all types returned from a Web Method are serialized as XML including string types.</span></span> <span data-ttu-id="bd3d8-177">ResponseFormat プロパティの値を持つ場合`ResponseFormat.Json`XmlSerializeString プロパティは無視されます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-177">If the ResponseFormat property has a value of `ResponseFormat.Json` the XmlSerializeString property is ignored.</span></span>

<span data-ttu-id="bd3d8-178">リスト 8 XmlSerializeString プロパティを使って強制的に文字列を XML としてシリアル化する例を示します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-178">Listing 8 shows an example of using the XmlSerializeString property to force strings to be serialized as XML.</span></span>

<span data-ttu-id="bd3d8-179">**8 を一覧表示します。XmlSerializeString プロパティを持つ ScriptMethod 属性を使用します。**</span><span class="sxs-lookup"><span data-stu-id="bd3d8-179">**Listing 8. Using the ScriptMethod attribute with the XmlSerializeString property**</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample8.cs)]

<span data-ttu-id="bd3d8-180">リスト 8 に示すように、GetXmlString Web メソッドの呼び出しから返される値は、[次へ] に表示されます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-180">The value returned from calling the GetXmlString Web Method shown in Listing 8 is shown next:</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample9.cs)]

<span data-ttu-id="bd3d8-181">既定の JSON 形式では、要求および応答メッセージの全体的なサイズを最小化されより簡単に、ブラウザーに依存しない方法で ASP.NET AJAX クライアントによって使用される、ResponseFormat と XmlSerializeString プロパティができる場合に使用率が低いクライアントアプリケーションなど、Internet Explorer 5 以降では、Web メソッドから返される XML データを期待します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-181">Although the default JSON format minimizes the overall size of request and response messages and is more readily consumed by ASP.NET AJAX clients in a cross-browser manner, the ResponseFormat and XmlSerializeString properties can be utilized when client applications such as Internet Explorer 5 or higher expect XML data to be returned from a Web Method.</span></span>

## <a name="working-with-complex-types"></a><span data-ttu-id="bd3d8-182">複合型の使用</span><span class="sxs-lookup"><span data-stu-id="bd3d8-182">Working with Complex Types</span></span>

<span data-ttu-id="bd3d8-183">5 を一覧表示する Web サービスから Customer という名前の複合型を返す例を示しました。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-183">Listing 5 showed an example of returning a complex type named Customer from a Web Service.</span></span> <span data-ttu-id="bd3d8-184">Customer クラスは、FirstName および LastName から構成などのプロパティとして内部的に複数の単純な種類を定義します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-184">The Customer class defines several different simple types internally as properties such as FirstName and LastName.</span></span> <span data-ttu-id="bd3d8-185">入力パラメーターとして使用される複合型または AJAX 対応の Web メソッドの戻り値の型が JSON にクライアント側に送信される前に自動的にシリアル化します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-185">Complex types used as an input parameter or return type on an AJAX-enabled Web Method are automatically serialized into JSON before being sent to the client-side.</span></span> <span data-ttu-id="bd3d8-186">ただし、(別の種類内で内部的に定義されたもの)、入れ子になった複合型いないで利用可能なクライアントにスタンドアロン オブジェクトとして既定値です。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-186">However, nested complex types (those defined internally within another type) are not made available to the client as standalone objects by default.</span></span>

<span data-ttu-id="bd3d8-187">Web サービスによって使用される入れ子になった複合型必要がありますもする使用されている場合、クライアントのページで、Web サービスに ASP.NET AJAX GenerateScriptType 属性を追加できます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-187">In cases where a nested complex type used by a Web Service must also be used in a client page, the ASP.NET AJAX GenerateScriptType attribute can be added to the Web Service.</span></span> <span data-ttu-id="bd3d8-188">たとえば、リスト 9 に示すように CustomerDetails クラスにはアドレス] と [性別のプロパティが含まれます***入れ子になった複合型を表します。***</span><span class="sxs-lookup"><span data-stu-id="bd3d8-188">For example, the CustomerDetails class shown in Listing 9 contains Address and Gender properties which ***represent nested complex types.***</span></span>

<span data-ttu-id="bd3d8-189">**9 を一覧表示します。次に示す CustomerDetails クラスには、次の 2 つの入れ子になった複合型が含まれています。**</span><span class="sxs-lookup"><span data-stu-id="bd3d8-189">**Listing 9. The CustomerDetails class shown here contains two nested complex types.**</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample10.cs)]

<span data-ttu-id="bd3d8-190">リスト 9 に示すように CustomerDetails クラス内で定義されているアドレスと性別オブジェクトはありません自動的を可能にするを使用して JavaScript を使用してクライアント側で入れ子にされた型であるため (アドレスは、クラス、性別は列挙型)。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-190">The Address and Gender objects defined within the CustomerDetails class shown in Listing 9 won't automatically be made available for use on the client-side via JavaScript since they are nested types (Address is a class and Gender is an enumeration).</span></span> <span data-ttu-id="bd3d8-191">Web サービス内で使用される入れ子にされた型がクライアント側で使用可能なあります状況では、前に述べた GenerateScriptType 属性を使用できます (10 の一覧を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-191">In situations where a nested type used within a Web Service must be available on the client-side, the GenerateScriptType attribute mentioned earlier can be used (see Listing 10).</span></span> <span data-ttu-id="bd3d8-192">この属性は、別の入れ子になった複合型がサービスから返される位置の場合も複数回追加することができます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-192">This attribute can be added multiple times in cases where different nested complex types are returned from a service.</span></span> <span data-ttu-id="bd3d8-193">これは、特定の Web メソッドの上または Web サービス クラスに直接適用できます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-193">It can be applied directly to the Web Service class or above specific Web Methods.</span></span>

<span data-ttu-id="bd3d8-194">**10 を一覧表示します。GenerateScriptService 属性を使用して、クライアントで利用できる必要がある入れ子にされた型を定義します。**</span><span class="sxs-lookup"><span data-stu-id="bd3d8-194">**Listing 10. Using the GenerateScriptService attribute to define nested types that should be available to the client.**</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample11.cs)]

<span data-ttu-id="bd3d8-195">適用することによって、`GenerateScriptType`属性 Web サービス、アドレス、性別の種類を自動的に利用可能になります使用するクライアント側の ASP.NET AJAX JavaScript コードでします。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-195">By applying the `GenerateScriptType` attribute to the Web Service, the Address and Gender types will automatically be made available for use by client-side ASP.NET AJAX JavaScript code.</span></span> <span data-ttu-id="bd3d8-196">自動的に生成され、Web サービスに対して GenerateScriptType 属性を追加することによって、クライアントに送信する JavaScript の例は、11 の一覧に表示されます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-196">An example of the JavaScript that is automatically generated and sent to the client by adding the GenerateScriptType attribute on a Web Service is shown in Listing 11.</span></span> <span data-ttu-id="bd3d8-197">記事の後半で入れ子になった複合型を使用する方法が表示されます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-197">You'll see how to use nested complex types later in the article.</span></span>

<span data-ttu-id="bd3d8-198">**11 を一覧表示します。入れ子になった複合型が ASP.NET AJAX ページからアクセスできます。**</span><span class="sxs-lookup"><span data-stu-id="bd3d8-198">**Listing 11. Nested complex types made available to an ASP.NET AJAX page.**</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample12.cs)]

<span data-ttu-id="bd3d8-199">これで、Web サービスを作成し、ASP.NET AJAX ページにアクセスできるようにする方法を説明しました、作成および JavaScript プロキシを使用して、データを取得または Web サービスに送信されるようにする方法を見てをみましょう。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-199">Now that you've seen how to create Web Services and make them accessible to ASP.NET AJAX pages, let's take a look at how to create and use JavaScript proxies so that data can be retrieved or sent to Web Services.</span></span>

## <a name="creating-javascript-proxies"></a><span data-ttu-id="bd3d8-200">JavaScript プロキシを作成します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-200">Creating JavaScript Proxies</span></span>

<span data-ttu-id="bd3d8-201">通常、標準の Web サービス (.NET または別のプラットフォーム) を呼び出すには、SOAP 要求と応答メッセージを送信する複雑な作業から明らかにならないようにするプロキシ オブジェクトの作成が含まれます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-201">Calling a standard Web Service (.NET or another platform) typically involves creating a proxy object that shields you from the complexities of sending SOAP request and response messages.</span></span> <span data-ttu-id="bd3d8-202">、ASP.NET AJAX の Web サービス呼び出しで JavaScript プロキシを作成してシリアル化して、JSON メッセージを逆シリアル化を心配せずに簡単にサービスを呼び出すために使用します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-202">With ASP.NET AJAX Web Service calls, JavaScript proxies can be created and used to easily call services without worrying about serializing and deserializing JSON messages.</span></span> <span data-ttu-id="bd3d8-203">JavaScript プロキシは、ASP.NET AJAX ScriptManager コントロールを使用して自動的に生成できます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-203">JavaScript proxies can be automatically generated by using the ASP.NET AJAX ScriptManager control.</span></span>

<span data-ttu-id="bd3d8-204">Web サービスを呼び出すことができる JavaScript プロキシの作成は、ScriptManager のサービス プロパティを使用して行われます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-204">Creating a JavaScript proxy that can call Web Services is accomplished by using the ScriptManager's Services property.</span></span> <span data-ttu-id="bd3d8-205">このプロパティでは、ASP.NET AJAX ページがポストバックの操作を必要とせず、データの送受信に非同期的に呼び出すことができる 1 つまたは複数のサービスを定義することができます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-205">This property allows you to define one or more services that an ASP.NET AJAX page can call asynchronously to send or receive data without requiring postback operations.</span></span> <span data-ttu-id="bd3d8-206">ASP.NET AJAX を使用してサービスを定義する`ServiceReference`コントロールとコントロールの Web サービスの URL を割り当てる`Path`プロパティです。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-206">You define a service by using the ASP.NET AJAX `ServiceReference` control and assigning the Web Service URL to the control's `Path` property.</span></span> <span data-ttu-id="bd3d8-207">12 を一覧表示する CustomersService.asmx をという名前のサービスを参照する例を示します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-207">Listing 12 shows an example of referencing a service named CustomersService.asmx.</span></span>

[!code-aspx[Main](understanding-asp-net-ajax-web-services/samples/sample13.aspx)]

<span data-ttu-id="bd3d8-208">**12 を一覧表示します。ASP.NET AJAX ページで、Web サービスを定義します。**</span><span class="sxs-lookup"><span data-stu-id="bd3d8-208">**Listing 12. Defining a Web Service used in an ASP.NET AJAX page.**</span></span>

<span data-ttu-id="bd3d8-209">ScriptManager コントロールを介して CustomersService.asmx への参照を追加すると、動的に生成され、ページによって参照されている JavaScript プロキシ。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-209">Adding a reference to the CustomersService.asmx through the ScriptManager control causes a JavaScript proxy to be dynamically generated and referenced by the page.</span></span> <span data-ttu-id="bd3d8-210">使用して、プロキシが埋め込まれている、&lt;スクリプト&gt;タグ、および CustomersService.asmx ファイルを呼び出すことと、/js の末尾に追加することによって動的に読み込まれます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-210">The proxy is embedded by using the &lt;script&gt; tag and dynamically loaded by calling the CustomersService.asmx file and appending /js to the end of it.</span></span> <span data-ttu-id="bd3d8-211">次の例では、web.config でデバッグが無効になっているときに、ページ内に埋め込まれて JavaScript プロキシの方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-211">The following example shows how the JavaScript proxy is embedded in the page when debugging is disabled in web.config:</span></span>

[!code-html[Main](understanding-asp-net-ajax-web-services/samples/sample14.html)]

> <span data-ttu-id="bd3d8-212">*>[!NOTE]かどうかは、生成される実際の JavaScript プロキシ コードを参照してくださいたい Internet Explorer のアドレス ボックスに目的の .NET Web サービスの URL を入力して/js の末尾に追加します。*</span><span class="sxs-lookup"><span data-stu-id="bd3d8-212">*> [!NOTE] If you'd like to see the actual JavaScript proxy code that is generated you can type the URL to the desired .NET Web Service into Internet Explorer's address box and append /js to the end of it.*</span></span>


<span data-ttu-id="bd3d8-213">JavaScript プロキシのデバッグ バージョンとしてそのページに埋め込まれます web.config でデバッグが有効になっている場合は、[次へ] を表示します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-213">If debugging is enabled in web.config a debug version of the JavaScript proxy will be embedded in the page as shown next:</span></span>

[!code-html[Main](understanding-asp-net-ajax-web-services/samples/sample15.html)]

<span data-ttu-id="bd3d8-214">Scriptmanager コントロールによって作成された JavaScript プロキシもページに直接埋め込むことが可能ではなくを使用して参照、&lt;スクリプト&gt;タグの src 属性。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-214">The JavaScript proxy created by the ScriptManager can also be embedded directly into the page rather than referenced using the &lt;script&gt; tag's src attribute.</span></span> <span data-ttu-id="bd3d8-215">これは、ServiceReference コントロールの InlineScript のプロパティを true (既定値は false) に設定して実行できます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-215">This can be done by setting the ServiceReference control's InlineScript property to true (the default is false).</span></span> <span data-ttu-id="bd3d8-216">これは、複数のページを使用して、サーバーへのネットワーク呼び出しの数を削減するには、プロキシが共有されていない場合に役立ちます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-216">This can be useful when a proxy isn't shared across multiple pages and when you'd like to reduce the number of network calls made to the server.</span></span> <span data-ttu-id="bd3d8-217">InlineScript は、プロキシ スクリプトを true に設定するときにありませんブラウザーをキャッシュする、ため、ASP.NET AJAX アプリケーションの複数のページで、プロキシが使用されている場合、既定値は false をお勧めします。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-217">When InlineScript is set to true the proxy script won't be cached by the browser so the default value of false is recommended in cases where the proxy is used by multiple pages in an ASP.NET AJAX application.</span></span> <span data-ttu-id="bd3d8-218">InlineScript プロパティを使用する例を次に表示されます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-218">An example of using the InlineScript property is shown next:</span></span>

[!code-aspx[Main](understanding-asp-net-ajax-web-services/samples/sample16.aspx)]

## <a name="using-javascript-proxies"></a><span data-ttu-id="bd3d8-219">JavaScript プロキシを使用します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-219">Using JavaScript Proxies</span></span>

<span data-ttu-id="bd3d8-220">Web サービスは、ScriptManager コントロールを使用して、ASP.NET AJAX ページによって参照され、Web サービスへの呼び出しができるコールバック関数を使用して、返されたデータを処理できます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-220">Once a Web Service is referenced by an ASP.NET AJAX page using the ScriptManager control, a call can be made to the Web Service and the returned data can be handled using callback functions.</span></span> <span data-ttu-id="bd3d8-221">Web サービスは、1 つ存在する場合)、名前空間を参照する、クラス名および Web メソッド名によって呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-221">A Web Service is called by referencing its namespace (if one exists), class name and Web Method name.</span></span> <span data-ttu-id="bd3d8-222">Web サービスに渡されるパラメーターは、返されたデータを処理するコールバック関数と共に定義できます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-222">Any parameters passed to the Web Service can be defined along with a callback function that handles the returned data.</span></span>

<span data-ttu-id="bd3d8-223">JavaScript プロキシを使用する GetCustomersByCountry() をという名前の Web メソッドの呼び出しの例は、13 の一覧に表示されます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-223">An example of using a JavaScript proxy to call a Web Method named GetCustomersByCountry() is shown in Listing 13.</span></span> <span data-ttu-id="bd3d8-224">GetCustomersByCountry() 関数は、エンドユーザーが、ページ上のボタンをクリックしたときに呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-224">The GetCustomersByCountry() function is called when an end user clicks a button on the page.</span></span>

<span data-ttu-id="bd3d8-225">**13 を一覧表示します。JavaScript プロキシを備えた Web サービスの呼び出しです。**</span><span class="sxs-lookup"><span data-stu-id="bd3d8-225">**Listing 13. Calling a Web Service with a JavaScript proxy.**</span></span>

[!code-javascript[Main](understanding-asp-net-ajax-web-services/samples/sample17.js)]

<span data-ttu-id="bd3d8-226">この呼び出しが InterfaceTraining 名前空間を参照、CustomersService クラスと GetCustomersByCountry Web メソッドが、サービスで定義されています。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-226">This call references the InterfaceTraining namespace, CustomersService class and GetCustomersByCountry Web Method defined in the service.</span></span> <span data-ttu-id="bd3d8-227">テキスト ボックスから取得した国の値だけでなく、非同期の Web サービス呼び出しが戻るときに呼び出すことができる OnWSRequestComplete をという名前のコールバック関数に渡します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-227">It passes a country value obtained from a textbox as well as a callback function named OnWSRequestComplete that should be invoked when the asynchronous Web Service call returns.</span></span> <span data-ttu-id="bd3d8-228">OnWSRequestComplete では、サービスから返される顧客オブジェクトの配列を処理し、ページに表示されているテーブルに変換します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-228">OnWSRequestComplete handles the array of Customer objects returned from the service and converts them into a table that is displayed in the page.</span></span> <span data-ttu-id="bd3d8-229">呼び出しから生成された出力は、図 1 に表示されます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-229">The output generated from the call is shown in Figure 1.</span></span>


<span data-ttu-id="bd3d8-230">[![Web サービスへの非同期 AJAX 呼び出しをすることで取得したデータをバインドします。](understanding-asp-net-ajax-web-services/_static/image2.png)](understanding-asp-net-ajax-web-services/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="bd3d8-230">[![Binding data obtained by making an asynchronous AJAX call to a Web Service.](understanding-asp-net-ajax-web-services/_static/image2.png)](understanding-asp-net-ajax-web-services/_static/image1.png)</span></span>

<span data-ttu-id="bd3d8-231">**図 1**: Web サービスへの非同期 AJAX 呼び出しをすることで取得したデータをバインドします。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-231">**Figure 1**: Binding data obtained by making an asynchronous AJAX call to a Web Service.</span></span>  <span data-ttu-id="bd3d8-232">([フルサイズのイメージを表示するをクリックして](understanding-asp-net-ajax-web-services/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="bd3d8-232">([Click to view full-size image](understanding-asp-net-ajax-web-services/_static/image3.png))</span></span>


<span data-ttu-id="bd3d8-233">JavaScript プロキシは、Web メソッドを呼び出す必要がありますいてもプロキシは応答を待つ場合に Web サービスへの一方向の呼び出しをこともできます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-233">JavaScript proxies can also make one-way calls to Web Services in cases where a Web Method should be called but the proxy shouldn't wait for a response.</span></span> <span data-ttu-id="bd3d8-234">たとえば、サービスからの戻り値を待たないはなど作業フローの処理を開始する Web サービスを呼び出す可能性があります。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-234">For example, you may want to call a Web Service to start a process such as a work-flow but not wait for a return value from the service.</span></span> <span data-ttu-id="bd3d8-235">一方向の呼び出しがサービスに対して行う必要がある場合、13 の一覧に示すように、コールバック関数を単に省略できます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-235">In cases where a one-way call needs to be made to a service, the callback function shown in Listing 13 can simply be omitted.</span></span> <span data-ttu-id="bd3d8-236">コールバック関数が定義されていないため、プロキシ オブジェクトはデータを返す Web サービスを待機しません。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-236">Since no callback function is defined the proxy object will not wait for the Web Service to return data.</span></span>

## <a name="handling-errors"></a><span data-ttu-id="bd3d8-237">エラー処理</span><span class="sxs-lookup"><span data-stu-id="bd3d8-237">Handling Errors</span></span>

<span data-ttu-id="bd3d8-238">Web サービスへの非同期コールバックには、さまざまな種類の Web サービスが利用できないか、例外が返されるダウンされているネットワークなどのエラーが発生することができます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-238">Asynchronous callbacks to Web Services can encounter different types of errors such as the network being down, the Web Service being unavailable or an exception being returned.</span></span> <span data-ttu-id="bd3d8-239">さいわい、scriptmanager コントロールによって生成された JavaScript プロキシ オブジェクトは、エラーと、成功コールバックの前に示しただけでなくエラーを処理するために定義する複数のコールバックを許可します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-239">Fortunately, JavaScript proxy objects generated by the ScriptManager allow multiple callbacks to be defined to handle errors and failures in addition to the success callback shown earlier.</span></span> <span data-ttu-id="bd3d8-240">14 の一覧に示すように、Web メソッドの呼び出しで標準のコールバック関数の後にすぐに、エラーのコールバック関数を定義できます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-240">An error callback function can be defined immediately after the standard callback function in the call to the Web Method as shown in Listing 14.</span></span>

<span data-ttu-id="bd3d8-241">**14 を一覧表示します。エラーのコールバック関数を定義し、エラーを表示します。**</span><span class="sxs-lookup"><span data-stu-id="bd3d8-241">**Listing 14. Defining an error callback function and displaying errors.**</span></span>

[!code-javascript[Main](understanding-asp-net-ajax-web-services/samples/sample18.js)]

<span data-ttu-id="bd3d8-242">Web サービスが呼び出されたときに発生したエラーをパラメーターとしてエラーを表すオブジェクトを受け入れる呼び出せる OnWSRequestFailed() コールバック関数がトリガーされます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-242">Any errors that occur when the Web Service is called will trigger the OnWSRequestFailed() callback function to be called which accepts an object representing the error as a parameter.</span></span> <span data-ttu-id="bd3d8-243">Error オブジェクトは、エラーの原因をできるだけでなく、呼び出しがタイムアウトするかどうかを決定するさまざまな機能を公開します。別のエラー関数を使用する例を示しています 14 を一覧表示して、図 2 は、関数によって生成される出力の例を示します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-243">The error object exposes several different functions to determine the cause of the error as well as whether or not the call timed out. Listing 14 shows an example of using the different error functions and Figure 2 shows an example of the output generated by the functions.</span></span>


<span data-ttu-id="bd3d8-244">[![ASP.NET AJAX エラー関数を呼び出すことによって生成された出力します。](understanding-asp-net-ajax-web-services/_static/image5.png)](understanding-asp-net-ajax-web-services/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="bd3d8-244">[![Output generated by calling ASP.NET AJAX error functions.](understanding-asp-net-ajax-web-services/_static/image5.png)](understanding-asp-net-ajax-web-services/_static/image4.png)</span></span>

<span data-ttu-id="bd3d8-245">**図 2**: ASP.NET AJAX エラー関数を呼び出すことによって生成された出力します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-245">**Figure 2**: Output generated by calling ASP.NET AJAX error functions.</span></span>  <span data-ttu-id="bd3d8-246">([フルサイズのイメージを表示するをクリックして](understanding-asp-net-ajax-web-services/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="bd3d8-246">([Click to view full-size image](understanding-asp-net-ajax-web-services/_static/image6.png))</span></span>


## <a name="handling-xml-data-returned-from-a-web-service"></a><span data-ttu-id="bd3d8-247">Web サービスから返された XML データの処理</span><span class="sxs-lookup"><span data-stu-id="bd3d8-247">Handling XML Data Returned from a Web Service</span></span>

<span data-ttu-id="bd3d8-248">前述方法 Web メソッドは、ResponseFormat プロパティと共に ScriptMethod 属性を使用して、生の XML データを返す可能性があります。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-248">Earlier you saw how a Web Method could return raw XML data by using the ScriptMethod attribute along with its ResponseFormat property.</span></span> <span data-ttu-id="bd3d8-249">ResponseFormat が ResponseFormat.Xml に設定されている場合、Web サービスから返されたデータは JSON ではなく XML としてシリアル化されます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-249">When ResponseFormat is set to ResponseFormat.Xml, data returned from the Web Service is serialized as XML rather than JSON.</span></span> <span data-ttu-id="bd3d8-250">これは、XML データは、JavaScript または XSLT を使用して処理するため、クライアントに直接渡される必要がある場合に役立ちます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-250">This can be useful when XML data needs to be passed directly to the client for processing using JavaScript or XSLT.</span></span> <span data-ttu-id="bd3d8-251">現在の時間には、Internet Explorer 5 以降は、最適なクライアント側オブジェクト モデルの解析と MSXML の組み込みサポートにより、XML データのフィルター処理を提供します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-251">At the current time, Internet Explorer 5 or higher provides the best client-side object model for parsing and filtering XML data due to its built-in support for MSXML.</span></span>

<span data-ttu-id="bd3d8-252">Web サービスから XML データの取得は、他のデータ型を取得するよりも変わりません。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-252">Retrieving XML data from a Web Service is no different than retrieving other data types.</span></span> <span data-ttu-id="bd3d8-253">適切な関数を呼び出すし、コールバック関数を定義する JavaScript プロキシを呼び出すことによって開始します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-253">Start by invoking the JavaScript proxy to call the appropriate function and define a callback function.</span></span> <span data-ttu-id="bd3d8-254">呼び出しが復帰し、コールバック関数でデータを処理できます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-254">Once the call returns you can then process the data in the callback function.</span></span>

<span data-ttu-id="bd3d8-255">15 を一覧表示する XmlElement オブジェクトを返す GetRssFeed() をという名前の Web メソッドの呼び出しの例に示します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-255">Listing 15 shows an example of calling a Web Method named GetRssFeed() that returns an XmlElement object.</span></span> <span data-ttu-id="bd3d8-256">GetRssFeed() は、rss フィードを取得する URL を表す 1 つのパラメーターを受け入れます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-256">GetRssFeed() accepts a single parameter representing the URL for the RSS feed to retrieve.</span></span>

<span data-ttu-id="bd3d8-257">**15 を一覧表示します。Web サービスから返された XML データを操作します。**</span><span class="sxs-lookup"><span data-stu-id="bd3d8-257">**Listing 15. Working with XML data returned from a Web Service.**</span></span>

[!code-html[Main](understanding-asp-net-ajax-web-services/samples/sample19.html)]

<span data-ttu-id="bd3d8-258">この例では、RSS フィードに URL を渡し、OnWSRequestComplete() 関数で返される XML データを処理します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-258">This example passes a URL to an RSS feed and processes the returned XML data in the OnWSRequestComplete() function.</span></span> <span data-ttu-id="bd3d8-259">OnWSRequestComplete() は、まず、ブラウザーが Internet Explorer、MSXML パーサーが使用できるかどうかを知っているかどうかを確認します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-259">OnWSRequestComplete() first checks to see if the browser is Internet Explorer to know whether or not the MSXML parser is available.</span></span> <span data-ttu-id="bd3d8-260">すべての検索に XPath ステートメントを使用する場合は、&lt;項目&gt;RSS フィード内のタグ。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-260">If it is, an XPath statement is used to locate all &lt;item&gt; tags within the RSS feed.</span></span> <span data-ttu-id="bd3d8-261">各項目が反復し、関連付けられた&lt;タイトル&gt;と&lt;リンク&gt;タグがあるし、各項目のデータを表示するために処理します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-261">Each item is then iterated through and the associated &lt;title&gt; and &lt;link&gt; tags are located and processed to display each item's data.</span></span> <span data-ttu-id="bd3d8-262">図 3 は、GetRssFeed() Web メソッドに JavaScript プロキシを介して呼び出しを ASP.NET AJAX の作成から生成された出力の例を示します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-262">Figure 3 shows an example of the output generated from making an ASP.NET AJAX call through a JavaScript proxy to the GetRssFeed() Web Method.</span></span>

## <a name="handling-complex-types"></a><span data-ttu-id="bd3d8-263">複合型の処理</span><span class="sxs-lookup"><span data-stu-id="bd3d8-263">Handling Complex Types</span></span>

<span data-ttu-id="bd3d8-264">受理されるか、Web サービスによって返される、複合型は、JavaScript プロキシを自動的に公開されます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-264">Complex types accepted or returned by a Web Service are automatically exposed through a JavaScript proxy.</span></span> <span data-ttu-id="bd3d8-265">ただし、前述したようにサービスに GenerateScriptType 属性が適用される場合を除き、入れ子になった複合型はクライアント側で直接アクセスできません。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-265">However, nested complex types are not directly accessible on the client-side unless the GenerateScriptType attribute is applied to the service as discussed earlier.</span></span> <span data-ttu-id="bd3d8-266">クライアント側で入れ子になった複合型を使用する理由を指定ようにしますか。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-266">Why would you want to use a nested complex type on the client-side?</span></span>

<span data-ttu-id="bd3d8-267">この質問に答える、ASP.NET AJAX ページは顧客データを表示し、エンドユーザーは、顧客の住所を更新できると仮定します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-267">To answer this question, assume that an ASP.NET AJAX page displays customer data and allows end users to update a customer's address.</span></span> <span data-ttu-id="bd3d8-268">Web サービスは、アドレスの種類 (CustomerDetails クラス内で定義された複合型) をクライアントに送信できることを指定する場合、更新プロセスはより優れたコードの再利用の別の機能に分割できます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-268">If the Web Service specifies that the Address type (a complex type defined within a CustomerDetails class) can be sent to the client then the update process can be divided into separate functions for better code re-use.</span></span>


<span data-ttu-id="bd3d8-269">[![出力から RSS データを返す Web サービスの呼び出しを作成します。](understanding-asp-net-ajax-web-services/_static/image8.png)](understanding-asp-net-ajax-web-services/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="bd3d8-269">[![Output creating from calling a Web Service that returns RSS data.](understanding-asp-net-ajax-web-services/_static/image8.png)](understanding-asp-net-ajax-web-services/_static/image7.png)</span></span>

<span data-ttu-id="bd3d8-270">**図 3**: RSS データを返す Web サービスの呼び出しからの作成を出力します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-270">**Figure 3**: Output creating from calling a Web Service that returns RSS data.</span></span>  <span data-ttu-id="bd3d8-271">([フルサイズのイメージを表示するをクリックして](understanding-asp-net-ajax-web-services/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="bd3d8-271">([Click to view full-size image](understanding-asp-net-ajax-web-services/_static/image9.png))</span></span>


<span data-ttu-id="bd3d8-272">16 を一覧表示するには、モデルの名前空間で定義されているアドレス オブジェクトを呼び出すクライアント側のコード例が更新されたデータが格納し、CustomerDetails オブジェクトのアドレス プロパティに割り当てますが示しています。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-272">Listing 16 shows an example of client-side code that invokes an Address object defined in a Model namespace, fills it with updated data and assigns it to a CustomerDetails object's Address property.</span></span> <span data-ttu-id="bd3d8-273">CustomerDetails オブジェクトは、処理のため、Web サービスに渡されます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-273">The CustomerDetails object is then passed to the Web Service for processing.</span></span>

<span data-ttu-id="bd3d8-274">**16 を一覧表示します。入れ子になった複合型を使用します。**</span><span class="sxs-lookup"><span data-stu-id="bd3d8-274">**Listing 16. Using nested complex types**</span></span>

[!code-javascript[Main](understanding-asp-net-ajax-web-services/samples/sample20.js)]

## <a name="creating-and-using-page-methods"></a><span data-ttu-id="bd3d8-275">作成して、ページ メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-275">Creating and Using Page Methods</span></span>

<span data-ttu-id="bd3d8-276">Web サービスは、さまざまな ASP.NET AJAX ページを含む、クライアントに再利用可能なサービスを公開する優れた方法を提供します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-276">Web Services provide an excellent way to expose re-useable services to a variety of clients including ASP.NET AJAX pages.</span></span> <span data-ttu-id="bd3d8-277">ただし、ページが使用またはその他のページで共有されませんはこれまでデータを取得する必要がある場合があります。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-277">However, there may be cases where a page needs to retrieve data that won't ever be used or shared by other pages.</span></span> <span data-ttu-id="bd3d8-278">ここでは、ページ データへのアクセスを許可する .asmx ファイルの作成に思えます過剰サービスが 1 つのページでのみ使用されるためです。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-278">In this case, making an .asmx file to allow the page to access the data may seem like overkill since the service is only used by a single page.</span></span>

<span data-ttu-id="bd3d8-279">ASP.NET AJAX では、スタンドアロンの .asmx ファイルを作成する Web サービスのような呼び出しを行うための別のメカニズムを提供します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-279">ASP.NET AJAX provides another mechanism for making Web Service-like calls without creating standalone .asmx files.</span></span> <span data-ttu-id="bd3d8-280">これは、「ページのメソッド」と呼ばれる手法を使用して行います。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-280">This is done by using a technique referred to as "page methods".</span></span> <span data-ttu-id="bd3d8-281">ページ メソッドは、それらに適用された WebMethod 属性を持つように、ページやコード側ファイルに直接埋め込む静的 (共有で VB.NET) メソッドです。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-281">Page methods are static (shared in VB.NET) methods embedded directly in a page or code-beside file that have the WebMethod attribute applied to them.</span></span> <span data-ttu-id="bd3d8-282">WebMethod 属性を適用することで呼び出すことができますを取得、実行時に動的に作成された内容をという名前の特殊な JavaScript オブジェクトを使用します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-282">By applying the WebMethod attribute they can be called using a special JavaScript object named PageMethods that gets dynamically created at runtime.</span></span> <span data-ttu-id="bd3d8-283">内容のオブジェクトは、JSON のシリアル化または逆シリアル化プロセスを明らかにならないようにするプロキシとして機能します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-283">The PageMethods object acts as a proxy that shields you from the JSON serialization/deserialization process.</span></span> <span data-ttu-id="bd3d8-284">内容のオブジェクトを使用するために設定することする必要があります ScriptManager の EnablePageMethods プロパティを true に注意してください。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-284">Note that in order to use the PageMethods object you must set the ScriptManager's EnablePageMethods property to true.</span></span>

[!code-aspx[Main](understanding-asp-net-ajax-web-services/samples/sample21.aspx)]

<span data-ttu-id="bd3d8-285">ASP.NET 分離コード クラスの 2 つのページ メソッドを定義する例を示します 17 を一覧表示します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-285">Listing 17 shows an example of defining two page methods in an ASP.NET code-beside class.</span></span> <span data-ttu-id="bd3d8-286">これらのメソッドは、アプリにあるビジネス レイヤーのクラスからデータを取得\_web サイトのコード フォルダーです。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-286">These methods retrieve data from a business layer class located in the App\_Code folder of the Website.</span></span>

<span data-ttu-id="bd3d8-287">**17 を一覧表示します。ページのメソッドを定義します。**</span><span class="sxs-lookup"><span data-stu-id="bd3d8-287">**Listing 17. Defining page methods.**</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample22.cs)]

<span data-ttu-id="bd3d8-288">ScriptManager がページに Web メソッドの存在を検出したときは、既に説明した内容オブジェクトへの参照を動的が生成されます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-288">When ScriptManager detects the presence of Web Methods in the page it generates a dynamic reference to the PageMethods object mentioned earlier.</span></span> <span data-ttu-id="bd3d8-289">Web メソッドを呼び出すことは、メソッドを渡す必要があるために必要なパラメーター データの名前、内容クラスを参照することによって実現されます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-289">Calling a Web Method is accomplished by referencing the PageMethods class followed by the name of the method and any necessary parameter data that should be passed.</span></span> <span data-ttu-id="bd3d8-290">18 を一覧表示する前に示した 2 つのページのメソッドの呼び出しの例を示しています。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-290">Listing 18 shows examples of calling the two page methods shown earlier.</span></span>

<span data-ttu-id="bd3d8-291">**18 を一覧表示します。内容 JavaScript オブジェクトを持つページ メソッドを呼び出しています。**</span><span class="sxs-lookup"><span data-stu-id="bd3d8-291">**Listing 18. Calling page methods with the PageMethods JavaScript object.**</span></span>

[!code-javascript[Main](understanding-asp-net-ajax-web-services/samples/sample23.js)]

<span data-ttu-id="bd3d8-292">内容オブジェクトを使用することは、JavaScript プロキシ オブジェクトを使用してによく似ています。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-292">Using the PageMethods object is very similar to using a JavaScript proxy object.</span></span> <span data-ttu-id="bd3d8-293">最初に、すべてのページ メソッドに渡す必要があり、非同期呼び出しが返されたときに呼び出されるコールバック関数を定義するパラメーターのデータを指定します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-293">You first specify all of the parameter data that should be passed to the page method and then define the callback function that should be called when the asynchronous call returns.</span></span> <span data-ttu-id="bd3d8-294">エラーのコールバックを指定することも (エラーの処理の例については 14 の一覧を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-294">A failure callback can also be specified (refer to Listing 14 for an example of handling failures).</span></span>

## <a name="the-autocompleteextender-and-the-aspnet-ajax-toolkit"></a><span data-ttu-id="bd3d8-295">AutoCompleteExtender および ASP.NET AJAX 用ツールキット</span><span class="sxs-lookup"><span data-stu-id="bd3d8-295">The AutoCompleteExtender and the ASP.NET AJAX Toolkit</span></span>

<span data-ttu-id="bd3d8-296">ASP.NET AJAX ツールキット (から使用可能な[http://ajax.asp.net](http://ajax.asp.net)) Web サービスにアクセスするために使用するいくつかのコントロールを提供します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-296">The ASP.NET AJAX Toolkit (available from [http://ajax.asp.net](http://ajax.asp.net)) offers several controls that can be used to access Web Services.</span></span> <span data-ttu-id="bd3d8-297">具体的には、ツールキットのという名前に役立ちますコントロールを含む`AutoCompleteExtender`を使用して Web サービスを呼び出すし、すべての JavaScript コードをまったく記述しなくてもページ内のデータの表示をすることができます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-297">Specifically, the toolkit contains a useful control named `AutoCompleteExtender` that can be used to call Web Services and show data in pages without writing any JavaScript code at all.</span></span>

<span data-ttu-id="bd3d8-298">テキスト ボックスの既存の機能を拡張し、探しているデータを簡単に見つける複数ユーザーを支援する AutoCompleteExtender コントロールを使用できます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-298">The AutoCompleteExtender control can be used to extend existing functionality of a textbox and help users more easily locate data they're looking for.</span></span> <span data-ttu-id="bd3d8-299">テキスト ボックスに入力するとき、コントロールは Web サービスのクエリに使用できるし、動的にテキスト ボックスの下の結果を示します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-299">As they type into a textbox the control can be used to query a Web Service and shows results below the textbox dynamically.</span></span> <span data-ttu-id="bd3d8-300">図 4 は、サポート アプリケーションの顧客 id を表示する AutoCompleteExtender コントロールを使用する例を示します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-300">Figure 4 shows an example of using the AutoCompleteExtender control to display customer ids for a support application.</span></span> <span data-ttu-id="bd3d8-301">ユーザーには、テキスト ボックスに別の文字が入力、その下にある入力に基づくさまざまなアイテムが表示されます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-301">As the user types different characters into the textbox, different items will be shown below it based upon their input.</span></span> <span data-ttu-id="bd3d8-302">ユーザーは、目的の顧客の id を選択できます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-302">Users can then select the desired customer id.</span></span>

<span data-ttu-id="bd3d8-303">ASP.NET AJAX ページ内で AutoCompleteExtender を使用するには、AjaxControlToolkit.dll アセンブリが、web サイトの bin フォルダーに追加することが必要です。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-303">Using the AutoCompleteExtender within an ASP.NET AJAX page requires that the AjaxControlToolkit.dll assembly be added to the Website's bin folder.</span></span> <span data-ttu-id="bd3d8-304">Toolkit アセンブリが追加されて、コントロールが含まれていますが、アプリケーションのすべてのページを使用できるように、web.config を参照する必要があります。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-304">Once the toolkit assembly has been added, you'll want to reference it in web.config so that the controls it contains are available to all pages in an application.</span></span> <span data-ttu-id="bd3d8-305">Web.config の内の次のタグを追加することによってこれ行う&lt;コントロール&gt;タグ。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-305">This can be done by adding the following tag within web.config's &lt;controls&gt; tag:</span></span>

[!code-xml[Main](understanding-asp-net-ajax-web-services/samples/sample24.xml)]

<span data-ttu-id="bd3d8-306">のみ必要がある場合、特定のページで、コントロールを使用するには、web.config の更新ではなく次に示すように、ページのトップへ参照ディレクティブを追加することで参照することができます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-306">In cases where you only need to use the control in a specific page you can reference it by adding the Reference directive to the top of a page as shown next rather than updating web.config:</span></span>

[!code-aspx[Main](understanding-asp-net-ajax-web-services/samples/sample25.aspx)]


<span data-ttu-id="bd3d8-307">[![AutoCompleteExtender コントロールを使用します。](understanding-asp-net-ajax-web-services/_static/image11.png)](understanding-asp-net-ajax-web-services/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="bd3d8-307">[![Using the AutoCompleteExtender control.](understanding-asp-net-ajax-web-services/_static/image11.png)](understanding-asp-net-ajax-web-services/_static/image10.png)</span></span>

<span data-ttu-id="bd3d8-308">**図 4**: AutoCompleteExtender コントロールを使用します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-308">**Figure 4**: Using the AutoCompleteExtender control.</span></span>  <span data-ttu-id="bd3d8-309">([フルサイズのイメージを表示するをクリックして](understanding-asp-net-ajax-web-services/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="bd3d8-309">([Click to view full-size image](understanding-asp-net-ajax-web-services/_static/image12.png))</span></span>


<span data-ttu-id="bd3d8-310">ASP.NET AJAX ツールキットを使用する web サイトを構成すると、AutoCompleteExtender コントロールを追加できるページにかなり正規 ASP.NET サーバー コントロールを追加すると同じようにします。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-310">Once the Website has been configured to use the ASP.NET AJAX Toolkit, an AutoCompleteExtender control can be added into the page much like you'd add a regular ASP.NET server control.</span></span> <span data-ttu-id="bd3d8-311">19 を一覧表示するコントロールを使用して Web サービスの呼び出しの例に示します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-311">Listing 19 shows an example of using the control to call a Web Service.</span></span>

<span data-ttu-id="bd3d8-312">**19 を一覧表示します。ASP.NET AJAX Toolkit AutoCompleteExtender コントロールを使用します。**</span><span class="sxs-lookup"><span data-stu-id="bd3d8-312">**Listing 19. Using the ASP.NET AJAX Toolkit AutoCompleteExtender control.**</span></span>

[!code-aspx[Main](understanding-asp-net-ajax-web-services/samples/sample26.aspx)]

<span data-ttu-id="bd3d8-313">AutoCompleteExtender には、サーバー コントロールに標準の ID と runat プロパティを含むいくつかの異なるプロパティがあります。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-313">The AutoCompleteExtender has several different properties including the standard ID and runat properties found on server controls.</span></span> <span data-ttu-id="bd3d8-314">これらに加えてすることができますの何文字か Web サービスの前に、エンド ユーザー型がデータのクエリを定義します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-314">In addition to these, it allows you to define how many characters an end user types before the Web Service is queried for data.</span></span> <span data-ttu-id="bd3d8-315">一覧表示する 19 に示すように MinimumPrefixLength プロパティは、文字がテキスト ボックスに入力されるたびに呼び出されるサービスをによりします。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-315">The MinimumPrefixLength property shown in Listing 19 causes the service to be called each time a character is typed into the textbox.</span></span> <span data-ttu-id="bd3d8-316">注意のテキスト ボックス内の文字に一致する値の検索に呼び出されるたびに、ユーザーが文字、Web サービスを入力するために、この値を設定します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-316">You'll want to be careful setting this value since each time the user types a character the Web Service will be called to search for values that match the characters in the textbox.</span></span> <span data-ttu-id="bd3d8-317">Web サービスを呼び出すだけでなく、ターゲット Web メソッドは、それぞれ、ServicePath および ServiceMethod プロパティを使用して定義されます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-317">The Web Service to call as well as the target Web Method are defined using the ServicePath and ServiceMethod properties respectively.</span></span> <span data-ttu-id="bd3d8-318">最後に、TargetControlID プロパティは、AutoCompleteExtender コントロールをフックするためにどの textbox を識別します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-318">Finally, the TargetControlID property identifies which textbox to hook the AutoCompleteExtender control to.</span></span>

<span data-ttu-id="bd3d8-319">呼び出される Web サービスは、前述したように適用される ScriptService 属性を持つ必要があり、ターゲット Web メソッドが prefixText およびカウントをという名前の 2 つのパラメーターを受け入れる必要があります。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-319">The Web Service being called must have the ScriptService attribute applied as discussed earlier and the target Web Method must accept two parameters named prefixText and count.</span></span> <span data-ttu-id="bd3d8-320">PrefixText パラメーターは、エンドユーザーが入力した文字を表し、count パラメーターの値が返される項目の数を表します (既定値は 10)。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-320">The prefixText parameter represents the characters typed by the end user and the count parameter represents how many items to return (the default is 10).</span></span> <span data-ttu-id="bd3d8-321">20 を一覧表示する前の一覧表示する 19 で示した AutoCompleteExtender コントロールにより呼び出されます GetCustomerIDs Web メソッドの例に示します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-321">Listing 20 shows an example of the GetCustomerIDs Web Method called by the AutoCompleteExtender control shown earlier in Listing 19.</span></span> <span data-ttu-id="bd3d8-322">Web メソッドをさらに呼び出し、データ レイヤーのデータをフィルター処理と一致する結果を返すを処理するメソッド、ビジネス レイヤー メソッドを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-322">The Web Method calls a business layer method that in turn calls a data layer method that handles filtering the data and returning the matching results.</span></span> <span data-ttu-id="bd3d8-323">データ層のメソッドのコードは、21 の一覧に表示されます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-323">The code for the data layer method is shown in Listing 21.</span></span>

<span data-ttu-id="bd3d8-324">**20 を一覧表示します。AutoCompleteExtender コントロールから送信されたデータをフィルター処理します。**</span><span class="sxs-lookup"><span data-stu-id="bd3d8-324">**Listing 20. Filtering data sent from the AutoCompleteExtender control.**</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample27.cs)]

<span data-ttu-id="bd3d8-325">**21 を一覧表示します。エンド ユーザー入力に基づく結果をフィルター処理します。**</span><span class="sxs-lookup"><span data-stu-id="bd3d8-325">**Listing 21. Filtering results based upon end user input.**</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample28.cs)]

## <a name="conclusion"></a><span data-ttu-id="bd3d8-326">まとめ</span><span class="sxs-lookup"><span data-stu-id="bd3d8-326">Conclusion</span></span>

<span data-ttu-id="bd3d8-327">ASP.NET AJAX では、大量の要求と応答メッセージを処理するカスタムの JavaScript コードを記述しなくても Web サービスの呼び出しの優れたサポートを提供します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-327">ASP.NET AJAX provides excellent support for calling Web Services without writing a lot of custom JavaScript code to handle the request and response messages.</span></span> <span data-ttu-id="bd3d8-328">この記事の内容を見てきました ScriptManager コントロールを使用して JavaScript プロキシを定義する方法と JSON メッセージを処理できるように、.NET Web サービスを AJAX を有効にする方法です。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-328">In this article you've seen how to AJAX-enable .NET Web Services to enable them to process JSON messages and how to define JavaScript proxies using the ScriptManager control.</span></span> <span data-ttu-id="bd3d8-329">プロキシは、Web サービスの呼び出しに使用できる JavaScript が単純型と複合型を処理およびがエラーに対処方法も説明しました。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-329">You've also seen how JavaScript proxies can be used to call Web Services, handle simple and complex types and deal with failures.</span></span> <span data-ttu-id="bd3d8-330">最後に、ページ メソッドを使用して、作成、および Web サービス呼び出しのプロセスを簡略化する方法と AutoCompleteExtender コントロールできますを提供する方法をエンドユーザーのヘルプ入力するときを見てきました。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-330">Finally, you've seen how page methods can be used to simplify the process of creating and making Web Service calls and how the AutoCompleteExtender control can provide help to end users as they type.</span></span> <span data-ttu-id="bd3d8-331">ASP.NET AJAX で使用できる UpdatePanel では、その簡潔さのための AJAX プログラマの多くの選択肢の制御を確実には、JavaScript プロキシを介して Web サービスを呼び出す方法についての知識は多くのアプリケーションで役に立ちます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-331">Although the UpdatePanel available in ASP.NET AJAX will certainly be the control of choice for many AJAX programmers due to its simplicity, knowing how to call Web Services through JavaScript proxies can be useful in many applications.</span></span>

## <a name="bio"></a><span data-ttu-id="bd3d8-332">略歴</span><span class="sxs-lookup"><span data-stu-id="bd3d8-332">Bio</span></span>

<span data-ttu-id="bd3d8-333">Dan Wahlin (Microsoft 最も有益な Professional ASP.NET と XML Web サービス) は、インターフェイスの技術的なトレーニングで .NET 開発インストラクターとアーキテクチャ コンサルタント ([http://www.interfacett.com](http://www.interfacett.com))。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-333">Dan Wahlin (Microsoft Most Valuable Professional for ASP.NET and XML Web Services) is a .NET development instructor and architecture consultant at Interface Technical Training ([http://www.interfacett.com](http://www.interfacett.com)).</span></span> <span data-ttu-id="bd3d8-334">Dan は ASP.NET 開発者 Web サイトの XML を設立 ([www.XMLforASP.NET](http://www.XMLforASP.NET))、INETA スピーカーの事務所では、いくつかの会議で読みます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-334">Dan founded the XML for ASP.NET Developers Web site ([www.XMLforASP.NET](http://www.XMLforASP.NET)), is on the INETA Speaker's Bureau and speaks at several conferences.</span></span> <span data-ttu-id="bd3d8-335">Dan 共同 Professional Windows DNA (Wrox)、ASP.NET で作成: ヒント、チュートリアルとコード (Sam)、ASP.NET 1.1 Insider ソリューション、Professional ASP.NET 2.0 AJAX (Wrox)、ASP.NET 2.0 MVP ハックおよび ASP.NET 開発者向け (Sam) の XML を作成します。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-335">Dan co-authored Professional Windows DNA (Wrox), ASP.NET: Tips, Tutorials and Code (Sams), ASP.NET 1.1 Insider Solutions, Professional ASP.NET 2.0 AJAX (Wrox), ASP.NET 2.0 MVP Hacks and authored XML for ASP.NET Developers (Sams).</span></span> <span data-ttu-id="bd3d8-336">コード、文書またはブックが作成されません、ときに、Dan は書き込みと音楽を記録し、再生するゴルフと自分の子供と妻のバスケット楽しんでいます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-336">When he's not writing code, articles or books, Dan enjoys writing and recording music and playing golf and basketball with his wife and kids.</span></span>

<span data-ttu-id="bd3d8-337">Scott カテゴリは、1997 年以降の Microsoft の Web テクノロジの使用されているがあり、myKB.com の代表者 ([www.myKB.com](http://www.myKB.com))、専門分野は、ASP.NET の書き込みの際にベースのアプリケーションのナレッジ ベースのソフトウェア ソリューションに重点を置きます。</span><span class="sxs-lookup"><span data-stu-id="bd3d8-337">Scott Cate has been working with Microsoft Web technologies since 1997 and is the President of myKB.com ([www.myKB.com](http://www.myKB.com)) where he specializes in writing ASP.NET based applications focused on Knowledge Base Software solutions.</span></span> <span data-ttu-id="bd3d8-338">Scott が接続時に電子メール[ scott.cate@myKB.com ](mailto:scott.cate@myKB.com)または彼のブログで[ScottCate.com](http://ScottCate.com)</span><span class="sxs-lookup"><span data-stu-id="bd3d8-338">Scott can be contacted via email at [scott.cate@myKB.com](mailto:scott.cate@myKB.com) or his blog at [ScottCate.com](http://ScottCate.com)</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="bd3d8-339">[前へ](understanding-asp-net-ajax-localization.md)
[次へ](understanding-asp-net-ajax-debugging-capabilities.md)</span><span class="sxs-lookup"><span data-stu-id="bd3d8-339">[Previous](understanding-asp-net-ajax-localization.md)
[Next](understanding-asp-net-ajax-debugging-capabilities.md)</span></span>
